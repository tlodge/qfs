(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[342],{5786:function(e,t,n){"use strict";n.d(t,{ZP:function(){return tD}});var r=n(7294);function a(e){return null}function i(e){return null}a.getCollectionNode=function*(e,t){let{childItems:n,title:a,children:i}=e,s=e.title||e.children,o=e.textValue||("string"==typeof s?s:"")||e["aria-label"]||"";o||(null==t?void 0:t.suppressTextValueWarning)||console.warn("<Item> with non-plain text contents is unsupported by type to select for accessibility. Please add a `textValue` prop."),yield{type:"item",props:e,rendered:s,textValue:o,"aria-label":e["aria-label"],hasChildNodes:null!=e.hasChildItems?e.hasChildItems:!!(e.childItems||e.title&&r.Children.count(e.children)>0),*childNodes(){if(n)for(let e of n)yield{type:"item",value:e};else if(a){let t=[];r.Children.forEach(i,e=>{t.push({type:"item",element:e})}),yield*t}}}},i.getCollectionNode=function*(e){let{children:t,title:n,items:a}=e;yield{type:"section",props:e,hasChildNodes:!0,rendered:n,"aria-label":e["aria-label"],*childNodes(){if("function"==typeof t){if(!a)throw Error("props.children was a function but props.items is missing");for(let e of a)yield{type:"item",value:e,renderer:t}}else{let n=[];r.Children.forEach(t,e=>{n.push({type:"item",element:e})}),yield*n}}}};class s{build(e,t){return this.context=t,o(()=>this.iterateCollection(e))}*iterateCollection(e){let{children:t,items:n}=e;if("function"==typeof t){if(!n)throw Error("props.children was a function but props.items is missing");for(let a of e.items)yield*this.getFullNode({value:a},{renderer:t})}else{let i=[];r.Children.forEach(t,e=>{i.push(e)});let s=0;for(let o of i)for(let l of this.getFullNode({element:o,index:s},{}))s++,yield l}}getKey(e,t,n,r){if(null!=e.key)return e.key;if("cell"===t.type&&null!=t.key)return`${r}${t.key}`;let a=t.value;if(null!=a){var i;let s=null!==(i=a.key)&&void 0!==i?i:a.id;if(null==s)throw Error("No key found for item");return s}return r?`${r}.${t.index}`:`$.${t.index}`}getChildState(e,t){return{renderer:t.renderer||e.renderer}}*getFullNode(e,t,n,a){let i=e.element;if(!i&&e.value&&t&&t.renderer){let s=this.cache.get(e.value);if(s&&(!s.shouldInvalidate||!s.shouldInvalidate(this.context))){s.index=e.index,s.parentKey=a?a.key:null,yield s;return}i=t.renderer(e.value)}if(r.isValidElement(i)){let u=i.type;if("function"!=typeof u&&"function"!=typeof u.getCollectionNode)throw Error(`Unknown element <${"function"==typeof i.type?i.type.name:i.type}> in collection.`);let h=u.getCollectionNode(i.props,this.context),c=e.index,d=h.next();for(;!d.done&&d.value;){let p=d.value;e.index=c;let f=p.key;f||(f=p.element?null:this.getKey(i,e,t,n));let m=[...this.getFullNode({...p,key:f,index:c,wrapper:function(e,t){return e&&t?n=>e(t(n)):e||t||void 0}(e.wrapper,p.wrapper)},this.getChildState(t,p),n?`${n}${i.key}`:i.key,a)];for(let g of m){if(g.value=p.value||e.value,g.value&&this.cache.set(g.value,g),e.type&&g.type!==e.type)throw Error(`Unsupported type <${l(g.type)}> in <${l(a.type)}>. Only <${l(e.type)}> is supported.`);c++,yield g}d=h.next(m)}return}if(null==e.key)return;let y=this,b={type:e.type,props:e.props,key:e.key,parentKey:a?a.key:null,value:e.value,level:a?a.level+1:0,index:e.index,rendered:e.rendered,textValue:e.textValue,"aria-label":e["aria-label"],wrapper:e.wrapper,shouldInvalidate:e.shouldInvalidate,hasChildNodes:e.hasChildNodes,childNodes:o(function*(){if(!e.hasChildNodes)return;let n=0;for(let r of e.childNodes())for(let a of(null!=r.key&&(r.key=`${b.key}${r.key}`),r.index=n,y.getFullNode(r,y.getChildState(t,r),b.key,b)))n++,yield a})};yield b}constructor(){this.cache=new WeakMap}}function o(e){let t=[],n=null;return{*[Symbol.iterator](){for(let r of t)yield r;for(let a of(n||(n=e()),n))t.push(a),yield a}}}function l(e){return e[0].toUpperCase()+e.slice(1)}let u=new WeakMap,h=a;h.toString=()=>".nextui-dropdown-item-base";var c=n(2556),d=n(3569),p=n(3952),f=n(7430),m=n(8420);let g=e=>e?e.replace("-"," "):"bottom",y=e=>{if(!e)return"bottom";switch(e){case"bottom":default:return"top center";case"top":return"bottom center";case"left":return"right center";case"right":return"left center";case"bottom-left":return"top left";case"bottom-right":return"top right";case"top-left":return"bottom left";case"top-right":return"bottom right";case"left-top":return"right top";case"left-bottom":return"right bottom";case"right-top":return"left top";case"right-bottom":return"left bottom"}};var b=n(4077);let[x,v]=(0,b.k)({name:"PopoverContext",errorMessage:"usePopoverContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Popover />`"});var w=n(5893);let I=r.forwardRef((e,t)=>{let{children:n,...a}=e,i=function(e={}){let{ref:t,triggerRef:n,scrollRef:a,isOpen:i,defaultOpen:s,onOpenChange:o,isBordered:l,borderWeight:u,disableShadow:h,shouldFlip:d=!0,offset:y=12,placement:b="bottom",onClose:x,triggerType:v="dialog",isDismissable:w=!0,shouldCloseOnBlur:I=!1,isKeyboardDismissDisabled:k=!1,disableAnimation:S=!1,shouldCloseOnInteractOutside:C}=e,E=(0,r.useRef)(null),T=(0,r.useRef)(null),$=t||E,N=n||T,A=function(e){let[t,n]=(0,f.zk)(e.isOpen,e.defaultOpen||!1,e.onOpenChange);return{isOpen:t,setOpen:n,open(){n(!0)},close(){n(!1)},toggle(){n(!t)}}}({isOpen:i,defaultOpen:s,onOpenChange:o}),[D,F]=(0,r.useState)(!A.isOpen),R=(0,r.useMemo)(()=>A.isOpen?"open":"closed",[A.isOpen]),_=(0,r.useCallback)(()=>{null==x||x(),A.close()},[A,x]),O=(0,r.useCallback)(()=>{F(!1)},[]),M=(0,r.useCallback)(()=>{F(!0)},[]),{triggerProps:B,overlayProps:P}=(0,c.IB)({type:v},A,N),L=(0,r.useMemo)(()=>g(b),[b]),{overlayProps:U}=(0,c.tN)({isOpen:A.isOpen,targetRef:N,scrollRef:a,placement:L,overlayRef:$,shouldFlip:d,offset:y}),W=(0,r.useCallback)((e={},t=null)=>({...null!=n&&n.current?(0,p.dG)(B,e):(0,p.dG)(e,B),ref:(0,m.l)(N,t)}),[N,n,B]),z=(0,r.useCallback)((e={})=>({...e,...P,...U,"data-state":R,"data-placement":b}),[R,U,P,b]);return{state:A,exited:D,overlayRef:$,triggerRef:N,placement:b,disableShadow:h,disableAnimation:S,shouldCloseOnBlur:I,isDismissable:w,isBordered:l,borderWeight:u,isKeyboardDismissDisabled:k,shouldCloseOnInteractOutside:C,isOpen:A.isOpen,onClose:_,onExited:M,onEntered:O,triggerProps:B,overlayProps:P,positionProps:U,getTriggerProps:W,getPopoverProps:z}}({ref:t,...a}),[s,o]=r.Children.toArray(n),l=i.state.isOpen||!i.exited;return(0,w.jsxs)(x,{value:i,children:[s,l&&(0,w.jsx)(c.Xj,{children:o})]})});d.Ts&&(I.displayName="NextUI.Popover"),I.toString=()=>".nextui-popover";var k=I,S=n(4663),C=n(6979),E=n(8894),T=n(9644);let $=r.forwardRef((e,t)=>{let{state:n,triggerRef:a,getTriggerProps:i}=v(),{children:s,...o}=e,l=()=>n.open(),{buttonProps:u}=(0,S.U)({onPress:l,...o},a),h="string"==typeof s?(0,w.jsx)(C.Z,{children:s}):r.Children.only(s),[,c]=(0,T.xC)(e.children,E.ZP),d=void 0!==(null==c?void 0:c[0]);return r.cloneElement(h,i((0,p.dG)(h.props,d?{onPress:l}:u,o),h.ref))});d.Ts&&($.displayName="NextUI.PopoverTrigger"),$.toString=()=>".nextui-popover-trigger";var N=n(9641),A=n(8327),D=n(1309),F=n(275),R=n(9975);let _=(0,F.F4)({"0%":{opacity:0,transform:"scale(0.95)"},"60%":{opacity:.75,backfaceVisibility:"hidden",webkitFontSmoothing:"antialiased",transform:"translateZ(0) scale(1.05)"},"100%":{opacity:1}}),O=(0,F.F4)({"0%":{opacity:1,transform:"scale(1)"},"100%":{opacity:0,transform:"scale(0.5)"}}),M=(0,F.zo)("div",{$$popoverMinWidth:"$space$13",$$popoverMinHeight:"$space$13",$$popoverBorderRadius:"$radii$lg",$$popoverBackground:"$colors$backgroundContrast",$$popoverBoxShadow:"$shadows$md",$$popoverBorderColor:"$colors$border",boxShadow:"$$popoverBoxShadow",outline:"none",overflow:"hidden auto",bg:"$$popoverBackground",display:"inline-flex",flexDirection:"column",boxSizing:"border-box",minWidth:"$$popoverMinWidth",minHeight:"$$popoverMinHeight",maxWidth:"calc(100% - $$popoverMinWidth)",maxHeight:"calc(100% - $$popoverMinWidth)",borderRadius:"$$popoverBorderRadius",animationFillMode:"forwards",willChange:"transform, opacity","@motion":{transition:"none"},"&.nextui-popover-content-enter":{animationName:_,animationTimingFunction:"ease-out",animationDirection:"normal",animationDuration:"250ms"},"&.nextui-popover-content-leave":{animationName:O,animationTimingFunction:"ease-in",animationDuration:"60ms"},variants:{disableShadow:{true:{boxShadow:"none"}},isBordered:{true:{borderStyle:"solid",borderColor:"$$popoverBorderColor"}},borderWeight:{light:{bw:"$light",$$popoverBorderWeight:"$borderWeights$light"},normal:{bw:"$normal",$$popoverBorderWeight:"$borderWeights$normal"},bold:{bw:"$bold",$$popoverBorderWeight:"$borderWeights$bold"},extrabold:{bw:"$extrabold",$$popoverBorderWeight:"$borderWeights$extrabold"},black:{bw:"$black",$$popoverBorderWeight:"$borderWeights$black"}}},defaultVariants:{isBordered:!1,borderWeight:"light"}},R.BM),B=(0,F.zo)("div",{}),P=r.forwardRef((e,t)=>{let{children:n,as:a,css:i,className:s,...o}=e,{state:l,placement:u,overlayRef:h,disableAnimation:d,disableShadow:f,shouldCloseOnBlur:g,isDismissable:b,isKeyboardDismissDisabled:x,shouldCloseOnInteractOutside:I,getPopoverProps:k,isBordered:S,borderWeight:C,onClose:E,onEntered:T,onExited:$}=v(),F=y(u),{modalProps:R}=(0,c.dd)({isDisabled:!0}),{dialogProps:_}=function(e,t){let{role:n="dialog"}=e,a=(0,p.mp)();return a=e["aria-label"]?void 0:a,(0,r.useEffect)(()=>{if(t.current&&!t.current.contains(document.activeElement)){(0,N.ex)(t.current);let e=setTimeout(()=>{document.activeElement===t.current&&(t.current.blur(),(0,N.ex)(t.current))},500);return()=>{clearTimeout(e)}}},[t]),{dialogProps:{...(0,p.zL)(e,{labelable:!0}),role:n,tabIndex:-1,"aria-labelledby":e["aria-labelledby"]||a},titleProps:{id:a}}}({role:"dialog"},h),{overlayProps:O}=(0,c.Ir)({onClose:E,isOpen:l.isOpen,isDismissable:b&&l.isOpen,shouldCloseOnBlur:g,isKeyboardDismissDisabled:x,shouldCloseOnInteractOutside:I},h),P=(0,p.dG)({isBordered:S,disableShadow:f,borderWeight:C},o),{isFocusVisible:L,focusProps:U}=(0,N.Fx)(),W=(0,w.jsxs)(M,{ref:(0,m.l)(h,t),...k((0,p.dG)(O,R,_,U,P)),as:a,className:(0,D.Z)("nextui-popover-content-container",s),css:{transformOrigin:F,...i},isFocusVisible:L,children:[(0,w.jsx)(c.U4,{onDismiss:E}),(0,w.jsx)(B,{className:"nextui-popover-content",children:n}),(0,w.jsx)(c.U4,{onDismiss:E})]});return(0,w.jsx)(w.Fragment,{children:d?l.isOpen?(0,w.jsx)(N.MT,{restoreFocus:!0,children:W}):null:(0,w.jsx)(N.MT,{restoreFocus:!0,children:(0,w.jsx)(A.Z,{clearTime:300,enterTime:20,leaveTime:60,name:"nextui-popover-content",visible:l.isOpen,onEntered:T,onExited:$,children:W})})})});d.Ts&&(P.displayName="NextUI.PopoverContent"),P.toString=()=>".nextui-popover-content",k.Content=P,k.Trigger=$;let[L,U]=(0,b.k)({name:"DropdownContext",errorMessage:"useDropdownContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Dropdown />`"}),W=r.forwardRef((e,t)=>{let{children:n,...r}=e,{getMenuTriggerProps:a}=U();return(0,w.jsx)(k.Trigger,{...a(r),children:n})});d.Ts&&(W.displayName="NextUI.DropdownTrigger"),W.toString=()=>".nextui-dropdown-trigger";var z=n(3176),V=n(7354),G=n(6010);let j="undefined"!=typeof window?r.useLayoutEffect:()=>{},H=new Map;function K(...e){let t={...e[0]};for(let n=1;n<e.length;n++){let r=e[n];for(let a in r){let i=t[a],s=r[a];"function"==typeof i&&"function"==typeof s&&"o"===a[0]&&"n"===a[1]&&a.charCodeAt(2)>=65&&90>=a.charCodeAt(2)?t[a]=function(...e){return(...t)=>{for(let n of e)"function"==typeof n&&n(...t)}}(i,s):("className"===a||"UNSAFE_className"===a)&&"string"==typeof i&&"string"==typeof s?t[a]=(0,G.Z)(i,s):"id"===a&&i&&s?t.id=function(e,t){if(e===t)return e;let n=H.get(e);if(n)return n(t),t;let r=H.get(t);return r?(r(e),e):t}(i,s):t[a]=void 0!==s?s:i}}return t}function X(e){if(function(){if(null==q){q=!1;try{document.createElement("div").focus({get preventScroll(){return q=!0,!0}})}catch(e){}}return q}())e.focus({preventScroll:!0});else{let t=function(e){for(var t=e.parentNode,n=[],r=document.scrollingElement||document.documentElement;t instanceof HTMLElement&&t!==r;)(t.offsetHeight<t.scrollHeight||t.offsetWidth<t.scrollWidth)&&n.push({element:t,scrollTop:t.scrollTop,scrollLeft:t.scrollLeft}),t=t.parentNode;return r instanceof HTMLElement&&n.push({element:r,scrollTop:r.scrollTop,scrollLeft:r.scrollLeft}),n}(e);e.focus(),function(e){for(let{element:t,scrollTop:n,scrollLeft:r}of e)t.scrollTop=n,t.scrollLeft=r}(t)}}let q=null,Y=new Map,Q=new Set;function Z(){if("undefined"==typeof window)return;let e=e=>{let n=Y.get(e.target);n||(n=new Set,Y.set(e.target,n),e.target.addEventListener("transitioncancel",t)),n.add(e.propertyName)},t=e=>{let n=Y.get(e.target);if(n&&(n.delete(e.propertyName),0===n.size&&(e.target.removeEventListener("transitioncancel",t),Y.delete(e.target)),0===Y.size)){for(let r of Q)r();Q.clear()}};document.body.addEventListener("transitionrun",e),document.body.addEventListener("transitionend",t)}function J(e){requestAnimationFrame(()=>{0===Y.size?e():Q.add(e)})}function ee(){let e=(0,r.useRef)(new Map),t=(0,r.useCallback)((t,n,r,a)=>{let i=(null==a?void 0:a.once)?(...t)=>{e.current.delete(r),r(...t)}:r;e.current.set(r,{type:n,eventTarget:t,fn:i,options:a}),t.addEventListener(n,r,a)},[]),n=(0,r.useCallback)((t,n,r,a)=>{var i;let s=(null===(i=e.current.get(r))||void 0===i?void 0:i.fn)||r;t.removeEventListener(n,s,a),e.current.delete(r)},[]),a=(0,r.useCallback)(()=>{e.current.forEach((e,t)=>{n(e.eventTarget,e.type,t,e.options)})},[n]);return(0,r.useEffect)(()=>a,[a]),{addGlobalListener:t,removeGlobalListener:n,removeAllGlobalListeners:a}}"undefined"!=typeof document&&("loading"!==document.readyState?Z():document.addEventListener("DOMContentLoaded",Z)),"undefined"!=typeof window&&window.visualViewport;let et=0,en=new Map;function er(e){var t;return"undefined"!=typeof window&&null!=window.navigator&&e.test((null===(t=window.navigator.userAgentData)||void 0===t?void 0:t.platform)||window.navigator.platform)}function ea(){return er(/^Mac/i)}function ei(){return er(/^iPhone/i)||er(/^iPad/i)||ea()&&navigator.maxTouchPoints>1}function es(e,t){let n=eo(e,t,"left"),r=eo(e,t,"top"),a=t.offsetWidth,i=t.offsetHeight,s=e.scrollLeft,o=e.scrollTop,l=s+e.offsetWidth,u=o+e.offsetHeight;n<=s?s=n:n+a>l&&(s+=n+a-l),r<=o?o=r:r+i>u&&(o+=r+i-u),e.scrollLeft=s,e.scrollTop=o}function eo(e,t,n){let r="left"===n?"offsetLeft":"offsetTop",a=0;for(;t.offsetParent&&(a+=t[r],t.offsetParent!==e);){if(t.offsetParent.contains(e)){a-=e[r];break}t=t.offsetParent}return a}function el(e){var t,n;return 0===e.mozInputSource&&!!e.isTrusted||((t=/Android/i,"undefined"!=typeof window&&null!=window.navigator&&((null===(n=window.navigator.userAgentData)||void 0===n?void 0:n.brands.some(e=>t.test(e.brand)))||t.test(window.navigator.userAgent))&&e.pointerType)?"click"===e.type&&1===e.buttons:0===e.detail&&!e.pointerType)}let eu="default",eh="",ec=new WeakMap;function ed(e){ei()?("default"===eu&&(eh=document.documentElement.style.webkitUserSelect,document.documentElement.style.webkitUserSelect="none"),eu="disabled"):(e instanceof HTMLElement||e instanceof SVGElement)&&(ec.set(e,e.style.userSelect),e.style.userSelect="none")}function ep(e){if(ei())"disabled"===eu&&(eu="restoring",setTimeout(()=>{J(()=>{"restoring"===eu&&("none"===document.documentElement.style.webkitUserSelect&&(document.documentElement.style.webkitUserSelect=eh||""),eh="",eu="default")})},300));else if((e instanceof HTMLElement||e instanceof SVGElement)&&e&&ec.has(e)){let t=ec.get(e);"none"===e.style.userSelect&&(e.style.userSelect=t),""===e.getAttribute("style")&&e.removeAttribute("style"),ec.delete(e)}}let ef=r.createContext(null);function em(e){let{onPress:t,onPressChange:n,onPressStart:a,onPressEnd:i,onPressUp:s,isDisabled:o,isPressed:l,preventFocusOnPress:u,shouldCancelOnPointerExit:h,allowTextSelectionOnPress:c,ref:d,...p}=function(e){var t,n;let a=(0,r.useContext)(ef);if(a){let{register:i,...s}=a;e=K(s,e),i()}return j(()=>{if(t&&t.ref&&n)return t.ref.current=n.current,()=>{t.ref.current=null}},[t=a,n=e.ref]),e}(e),f=(0,r.useRef)(null);f.current={onPress:t,onPressChange:n,onPressStart:a,onPressEnd:i,onPressUp:s,isDisabled:o,shouldCancelOnPointerExit:h};let[m,g]=(0,r.useState)(!1),y=(0,r.useRef)({isPressed:!1,ignoreEmulatedMouseEvents:!1,ignoreClickAfterPress:!1,didFirePressStart:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null}),{addGlobalListener:b,removeAllGlobalListeners:x}=ee(),v=(0,r.useMemo)(()=>{let e=y.current,t=(t,n)=>{let{onPressStart:r,onPressChange:a,isDisabled:i}=f.current;i||e.didFirePressStart||(r&&r({type:"pressstart",pointerType:n,target:t.currentTarget,shiftKey:t.shiftKey,metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey}),a&&a(!0),e.didFirePressStart=!0,g(!0))},n=(t,n,r=!0)=>{let{onPressEnd:a,onPressChange:i,onPress:s,isDisabled:o}=f.current;e.didFirePressStart&&(e.ignoreClickAfterPress=!0,e.didFirePressStart=!1,a&&a({type:"pressend",pointerType:n,target:t.currentTarget,shiftKey:t.shiftKey,metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey}),i&&i(!1),g(!1),s&&r&&!o&&s({type:"press",pointerType:n,target:t.currentTarget,shiftKey:t.shiftKey,metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey}))},r=(e,t)=>{let{onPressUp:n,isDisabled:r}=f.current;!r&&n&&n({type:"pressup",pointerType:t,target:e.currentTarget,shiftKey:e.shiftKey,metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey})},a=t=>{e.isPressed&&(e.isOverTarget&&n(ex(e.target,t),e.pointerType,!1),e.isPressed=!1,e.isOverTarget=!1,e.activePointerId=null,e.pointerType=null,x(),c||ep(e.target))},i={onKeyDown(n){ey(n.nativeEvent,n.currentTarget)&&n.currentTarget.contains(n.target)?(eI(n.target,n.key)&&n.preventDefault(),n.stopPropagation(),e.isPressed||n.repeat||(e.target=n.currentTarget,e.isPressed=!0,t(n,"keyboard"),b(document,"keyup",s,!1))):"Enter"===n.key&&eg(n.currentTarget)&&n.stopPropagation()},onKeyUp(t){ey(t.nativeEvent,t.currentTarget)&&!t.repeat&&t.currentTarget.contains(t.target)&&r(ex(e.target,t),"keyboard")},onClick(a){(!a||a.currentTarget.contains(a.target))&&a&&0===a.button&&(a.stopPropagation(),o&&a.preventDefault(),!e.ignoreClickAfterPress&&!e.ignoreEmulatedMouseEvents&&("virtual"===e.pointerType||el(a.nativeEvent))&&(o||u||X(a.currentTarget),t(a,"virtual"),r(a,"virtual"),n(a,"virtual")),e.ignoreEmulatedMouseEvents=!1,e.ignoreClickAfterPress=!1)}},s=t=>{if(e.isPressed&&ey(t,e.target)){eI(t.target,t.key)&&t.preventDefault(),t.stopPropagation(),e.isPressed=!1;let r=t.target;n(ex(e.target,t),"keyboard",e.target.contains(r)),x(),e.target instanceof HTMLElement&&e.target.contains(r)&&(eg(e.target)||"link"===e.target.getAttribute("role"))&&e.target.click()}};if("undefined"!=typeof PointerEvent){i.onPointerDown=n=>{if(0===n.button&&n.currentTarget.contains(n.target)){var r;if(0===(r=n.nativeEvent).width&&0===r.height||1===r.width&&1===r.height&&0===r.pressure&&0===r.detail&&"mouse"===r.pointerType){e.pointerType="virtual";return}ew(n.currentTarget)&&n.preventDefault(),e.pointerType=n.pointerType,n.stopPropagation(),e.isPressed||(e.isPressed=!0,e.isOverTarget=!0,e.activePointerId=n.pointerId,e.target=n.currentTarget,o||u||X(n.currentTarget),c||ed(e.target),t(n,e.pointerType),b(document,"pointermove",l,!1),b(document,"pointerup",h,!1),b(document,"pointercancel",d,!1))}},i.onMouseDown=e=>{e.currentTarget.contains(e.target)&&0===e.button&&(ew(e.currentTarget)&&e.preventDefault(),e.stopPropagation())},i.onPointerUp=t=>{t.currentTarget.contains(t.target)&&"virtual"!==e.pointerType&&0===t.button&&ev(t,t.currentTarget)&&r(t,e.pointerType||t.pointerType)};let l=r=>{r.pointerId===e.activePointerId&&(ev(r,e.target)?e.isOverTarget||(e.isOverTarget=!0,t(ex(e.target,r),e.pointerType)):e.isOverTarget&&(e.isOverTarget=!1,n(ex(e.target,r),e.pointerType,!1),f.current.shouldCancelOnPointerExit&&a(r)))},h=t=>{t.pointerId===e.activePointerId&&e.isPressed&&0===t.button&&(ev(t,e.target)?n(ex(e.target,t),e.pointerType):e.isOverTarget&&n(ex(e.target,t),e.pointerType,!1),e.isPressed=!1,e.isOverTarget=!1,e.activePointerId=null,e.pointerType=null,x(),c||ep(e.target))},d=e=>{a(e)};i.onDragStart=e=>{e.currentTarget.contains(e.target)&&a(e)}}else{i.onMouseDown=n=>{0===n.button&&n.currentTarget.contains(n.target)&&(ew(n.currentTarget)&&n.preventDefault(),n.stopPropagation(),e.ignoreEmulatedMouseEvents||(e.isPressed=!0,e.isOverTarget=!0,e.target=n.currentTarget,e.pointerType=el(n.nativeEvent)?"virtual":"mouse",o||u||X(n.currentTarget),t(n,e.pointerType),b(document,"mouseup",p,!1)))},i.onMouseEnter=n=>{n.currentTarget.contains(n.target)&&(n.stopPropagation(),e.isPressed&&!e.ignoreEmulatedMouseEvents&&(e.isOverTarget=!0,t(n,e.pointerType)))},i.onMouseLeave=t=>{t.currentTarget.contains(t.target)&&(t.stopPropagation(),e.isPressed&&!e.ignoreEmulatedMouseEvents&&(e.isOverTarget=!1,n(t,e.pointerType,!1),f.current.shouldCancelOnPointerExit&&a(t)))},i.onMouseUp=t=>{t.currentTarget.contains(t.target)&&!e.ignoreEmulatedMouseEvents&&0===t.button&&r(t,e.pointerType)};let p=t=>{if(0===t.button){if(e.isPressed=!1,x(),e.ignoreEmulatedMouseEvents){e.ignoreEmulatedMouseEvents=!1;return}ev(t,e.target)?n(ex(e.target,t),e.pointerType):e.isOverTarget&&n(ex(e.target,t),e.pointerType,!1),e.isOverTarget=!1}};i.onTouchStart=n=>{if(!n.currentTarget.contains(n.target))return;n.stopPropagation();let r=function(e){let{targetTouches:t}=e;return t.length>0?t[0]:null}(n.nativeEvent);r&&(e.activePointerId=r.identifier,e.ignoreEmulatedMouseEvents=!0,e.isOverTarget=!0,e.isPressed=!0,e.target=n.currentTarget,e.pointerType="touch",o||u||X(n.currentTarget),c||ed(e.target),t(n,e.pointerType),b(window,"scroll",m,!0))},i.onTouchMove=r=>{if(!r.currentTarget.contains(r.target)||(r.stopPropagation(),!e.isPressed))return;let i=eb(r.nativeEvent,e.activePointerId);i&&ev(i,r.currentTarget)?e.isOverTarget||(e.isOverTarget=!0,t(r,e.pointerType)):e.isOverTarget&&(e.isOverTarget=!1,n(r,e.pointerType,!1),f.current.shouldCancelOnPointerExit&&a(r))},i.onTouchEnd=t=>{if(!t.currentTarget.contains(t.target)||(t.stopPropagation(),!e.isPressed))return;let a=eb(t.nativeEvent,e.activePointerId);a&&ev(a,t.currentTarget)?(r(t,e.pointerType),n(t,e.pointerType)):e.isOverTarget&&n(t,e.pointerType,!1),e.isPressed=!1,e.activePointerId=null,e.isOverTarget=!1,e.ignoreEmulatedMouseEvents=!0,c||ep(e.target),x()},i.onTouchCancel=t=>{t.currentTarget.contains(t.target)&&(t.stopPropagation(),e.isPressed&&a(t))};let m=t=>{e.isPressed&&t.target.contains(e.target)&&a({currentTarget:e.target,shiftKey:!1,ctrlKey:!1,metaKey:!1,altKey:!1})};i.onDragStart=e=>{e.currentTarget.contains(e.target)&&a(e)}}return i},[b,o,u,x,c]);return(0,r.useEffect)(()=>()=>{c||ep(y.current.target)},[c]),{isPressed:l||m,pressProps:K(p,v)}}function eg(e){return"A"===e.tagName&&e.hasAttribute("href")}function ey(e,t){let{key:n,code:r}=e,a=t.getAttribute("role");return("Enter"===n||" "===n||"Spacebar"===n||"Space"===r)&&!(t instanceof HTMLInputElement&&!eS(t,n)||t instanceof HTMLTextAreaElement||t.isContentEditable)&&(!eg(t)||"button"===a&&"Enter"!==n)&&!("link"===a&&"Enter"!==n)}function eb(e,t){let n=e.changedTouches;for(let r=0;r<n.length;r++){let a=n[r];if(a.identifier===t)return a}return null}function ex(e,t){return{currentTarget:e,shiftKey:t.shiftKey,ctrlKey:t.ctrlKey,metaKey:t.metaKey,altKey:t.altKey}}function ev(e,t){let n,r,a=t.getBoundingClientRect(),i=(n=e.width/2||e.radiusX||0,r=e.height/2||e.radiusY||0,{top:e.clientY-r,right:e.clientX+n,bottom:e.clientY+r,left:e.clientX-n});return!(a.left>i.right)&&!(i.left>a.right)&&!(a.top>i.bottom)&&!(i.top>a.bottom)}function ew(e){return!(e instanceof HTMLElement)||!e.draggable}function eI(e,t){return e instanceof HTMLInputElement?!eS(e,t):!(e instanceof HTMLButtonElement)||"submit"!==e.type}ef.displayName="PressResponderContext";let ek=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function eS(e,t){return"checkbox"===e.type||"radio"===e.type?" "===t:ek.has(e.type)}let eC=null,eE=new Set,eT=!1,e$=!1,eN=!1;function eA(e,t){for(let n of eE)n(e,t)}function eD(e){e$=!0,e.metaKey||!ea()&&e.altKey||e.ctrlKey||"Control"===e.key||"Shift"===e.key||"Meta"===e.key||(eC="keyboard",eA("keyboard",e))}function eF(e){eC="pointer",("mousedown"===e.type||"pointerdown"===e.type)&&(e$=!0,eA("pointer",e))}function eR(e){el(e)&&(e$=!0,eC="virtual")}function e_(e){e.target!==window&&e.target!==document&&(e$||eN||(eC="virtual",eA("virtual",e)),e$=!1,eN=!1)}function eO(){e$=!1,eN=!0}function eM(){if("undefined"==typeof window||eT)return;let e=HTMLElement.prototype.focus;HTMLElement.prototype.focus=function(){e$=!0,e.apply(this,arguments)},document.addEventListener("keydown",eD,!0),document.addEventListener("keyup",eD,!0),document.addEventListener("click",eR,!0),window.addEventListener("focus",e_,!0),window.addEventListener("blur",eO,!1),"undefined"!=typeof PointerEvent?(document.addEventListener("pointerdown",eF,!0),document.addEventListener("pointermove",eF,!0),document.addEventListener("pointerup",eF,!0)):(document.addEventListener("mousedown",eF,!0),document.addEventListener("mousemove",eF,!0),document.addEventListener("mouseup",eF,!0)),eT=!0}function eB(e){if("virtual"===eC){let t=document.activeElement;J(()=>{document.activeElement===t&&document.contains(e)&&X(e)})}else X(e)}"undefined"!=typeof document&&("loading"!==document.readyState?eM():document.addEventListener("DOMContentLoaded",eM));let eP=["input:not([disabled]):not([type=hidden])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[contenteditable]"],eL=eP.join(":not([hidden]),")+",[tabindex]:not([disabled]):not([hidden])";eP.push('[tabindex]:not([tabindex="-1"]):not([disabled])');let eU=eP.join(':not([hidden]):not([tabindex="-1"]),');function eW(e,t){return t.some(t=>t.contains(e))}class ez{get size(){return this.fastMap.size}getTreeNode(e){return this.fastMap.get(e)}addTreeNode(e,t,n){let r=this.fastMap.get(null!=t?t:null),a=new eV({scopeRef:e});r.addChild(a),a.parent=r,this.fastMap.set(e,a),n&&(a.nodeToRestore=n)}removeTreeNode(e){if(null===e)return;let t=this.fastMap.get(e),n=t.parent;for(let r of this.traverse())r!==t&&t.nodeToRestore&&r.nodeToRestore&&t.scopeRef.current&&eW(r.nodeToRestore,t.scopeRef.current)&&(r.nodeToRestore=t.nodeToRestore);let a=t.children;n.removeChild(t),a.length>0&&a.forEach(e=>n.addChild(e)),this.fastMap.delete(t.scopeRef)}*traverse(e=this.root){if(null!=e.scopeRef&&(yield e),e.children.length>0)for(let t of e.children)yield*this.traverse(t)}clone(){let e=new ez;for(let t of this.traverse())e.addTreeNode(t.scopeRef,t.parent.scopeRef,t.nodeToRestore);return e}constructor(){this.fastMap=new Map,this.root=new eV({scopeRef:null}),this.fastMap.set(null,this.root)}}class eV{addChild(e){this.children.push(e),e.parent=this}removeChild(e){this.children.splice(this.children.indexOf(e),1),e.parent=void 0}constructor(e){this.children=[],this.contain=!1,this.scopeRef=e.scopeRef}}new ez;let eG={prefix:String(Math.round(1e10*Math.random())),current:0},ej=r.createContext(eG);"undefined"!=typeof window&&window.document&&window.document.createElement;let eH=new Set(["Arab","Syrc","Samr","Mand","Thaa","Mend","Nkoo","Adlm","Rohg","Hebr"]),eK=new Set(["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"]);function eX(){let e="undefined"!=typeof navigator&&(navigator.language||navigator.userLanguage)||"en-US";try{Intl.DateTimeFormat.supportedLocalesOf([e])}catch(t){e="en-US"}return{locale:e,direction:!function(e){if(Intl.Locale){let t=new Intl.Locale(e).maximize().script;return eH.has(t)}let n=e.split("-")[0];return eK.has(n)}(e)?"ltr":"rtl"}}let eq=eX(),eY=new Set;function eQ(){for(let e of(eq=eX(),eY))e(eq)}let eZ=r.createContext(null);function eJ(){let e=function(){let e=function(){let e=(0,r.useContext)(ej)!==eG,[t,n]=(0,r.useState)(e);return"undefined"!=typeof window&&e&&(0,r.useLayoutEffect)(()=>{n(!1)},[]),t}(),[t,n]=(0,r.useState)(eq);return((0,r.useEffect)(()=>(0===eY.size&&window.addEventListener("languagechange",eQ),eY.add(n),()=>{eY.delete(n),0===eY.size&&window.removeEventListener("languagechange",eQ)}),[]),e)?{locale:"en-US",direction:"ltr"}:t}();return(0,r.useContext)(eZ)||e}new WeakMap;let e0=new Map;function e1(e){return ea()||ei()?e.altKey:e.ctrlKey}function e2(e){return ea()?e.metaKey:e.ctrlKey}function e3(){let e=window.event;return(null==e?void 0:e.key)==="Enter"}function e4(){let e=window.event;return(null==e?void 0:e.key)===" "||(null==e?void 0:e.code)==="Space"}class e6{getKeyBelow(e){for(e=this.collection.getKeyAfter(e);null!=e;){if("item"===this.collection.getItem(e).type&&!this.disabledKeys.has(e))return e;e=this.collection.getKeyAfter(e)}}getKeyAbove(e){for(e=this.collection.getKeyBefore(e);null!=e;){if("item"===this.collection.getItem(e).type&&!this.disabledKeys.has(e))return e;e=this.collection.getKeyBefore(e)}}getFirstKey(){let e=this.collection.getFirstKey();for(;null!=e;){if("item"===this.collection.getItem(e).type&&!this.disabledKeys.has(e))return e;e=this.collection.getKeyAfter(e)}}getLastKey(){let e=this.collection.getLastKey();for(;null!=e;){if("item"===this.collection.getItem(e).type&&!this.disabledKeys.has(e))return e;e=this.collection.getKeyBefore(e)}}getItem(e){return this.ref.current.querySelector(`[data-key="${e}"]`)}getKeyPageAbove(e){let t=this.ref.current,n=this.getItem(e);if(!n)return null;let r=Math.max(0,n.offsetTop+n.offsetHeight-t.offsetHeight);for(;n&&n.offsetTop>r;)e=this.getKeyAbove(e),n=this.getItem(e);return e}getKeyPageBelow(e){let t=this.ref.current,n=this.getItem(e);if(!n)return null;let r=Math.min(t.scrollHeight,n.offsetTop-n.offsetHeight+t.offsetHeight);for(;n&&n.offsetTop<r;)e=this.getKeyBelow(e),n=this.getItem(e);return e}getKeyForSearch(e,t){if(!this.collator)return null;let n=this.collection,r=t||this.getFirstKey();for(;null!=r;){let a=n.getItem(r),i=a.textValue.slice(0,e.length);if(a.textValue&&0===this.collator.compare(i,e))return r;r=this.getKeyBelow(r)}return null}constructor(e,t,n,r){this.collection=e,this.disabledKeys=t,this.ref=n,this.collator=r}}var e5={};e5={"ar-AE":{longPressMessage:`اضغط مطولاً أو اضغط على Alt + السهم لأسفل لفتح القائمة`},"bg-BG":{longPressMessage:`Натиснете продължително или натиснете Alt+ стрелка надолу, за да отворите менюто`},"cs-CZ":{longPressMessage:`Dlouh\xfdm stiskem nebo stisknut\xedm kl\xe1ves Alt + šipka dolů otevřete nab\xeddku`},"da-DK":{longPressMessage:`Langt tryk eller tryk p\xe5 Alt + pil ned for at \xe5bne menuen`},"de-DE":{longPressMessage:`Dr\xfccken Sie lange oder dr\xfccken Sie Alt + Nach-unten, um das Men\xfc zu \xf6ffnen`},"el-GR":{longPressMessage:`Πιέστε παρατεταμένα ή πατήστε Alt + κάτω βέλος για να ανοίξετε το μενού`},"en-US":{longPressMessage:"Long press or press Alt + ArrowDown to open menu"},"es-ES":{longPressMessage:`Mantenga pulsado o pulse Alt + flecha abajo para abrir el men\xfa`},"et-EE":{longPressMessage:`Men\xfc\xfc avamiseks vajutage pikalt v\xf5i vajutage klahve Alt + allanool`},"fi-FI":{longPressMessage:`Avaa valikko painamalla pohjassa tai n\xe4pp\xe4inyhdistelm\xe4ll\xe4 Alt + Alanuoli`},"fr-FR":{longPressMessage:`Appuyez de mani\xe8re prolong\xe9e ou appuyez sur Alt\xa0+\xa0Fl\xe8che vers le bas pour ouvrir le menu.`},"he-IL":{longPressMessage:`לחץ לחיצה ארוכה או הקש Alt + ArrowDown כדי לפתוח את התפריט`},"hr-HR":{longPressMessage:"Dugo pritisnite ili pritisnite Alt + strelicu prema dolje za otvaranje izbornika"},"hu-HU":{longPressMessage:`Nyomja meg hosszan, vagy nyomja meg az Alt + lefele ny\xedl gombot a men\xfc megnyit\xe1s\xe1hoz`},"it-IT":{longPressMessage:`Premere a lungo o premere Alt + Freccia gi\xf9 per aprire il menu`},"ja-JP":{longPressMessage:`長押しまたは Alt+下矢印キーでメニューを開く`},"ko-KR":{longPressMessage:`길게 누르거나 Alt + 아래쪽 화살표를 눌러 메뉴 열기`},"lt-LT":{longPressMessage:`Norėdami atidaryti meniu, nuspaudę palaikykite arba paspauskite „Alt + ArrowDown“.`},"lv-LV":{longPressMessage:`Lai atvērtu izvēlni, turiet nospiestu vai nospiediet taustiņu kombināciju Alt + lejupvērstā bultiņa`},"nb-NO":{longPressMessage:`Langt trykk eller trykk Alt + PilNed for \xe5 \xe5pne menyen`},"nl-NL":{longPressMessage:"Druk lang op Alt + pijl-omlaag of druk op Alt om het menu te openen"},"pl-PL":{longPressMessage:`Naciśnij i przytrzymaj lub naciśnij klawisze Alt + Strzałka w d\xf3ł, aby otworzyć menu`},"pt-BR":{longPressMessage:"Pressione e segure ou pressione Alt + Seta para baixo para abrir o menu"},"pt-PT":{longPressMessage:"Prima continuamente ou prima Alt + Seta Para Baixo para abrir o menu"},"ro-RO":{longPressMessage:`Apăsați lung sau apăsați pe Alt + săgeată \xeen jos pentru a deschide meniul`},"ru-RU":{longPressMessage:`Нажмите и удерживайте или нажмите Alt + Стрелка вниз, чтобы открыть меню`},"sk-SK":{longPressMessage:`Ponuku otvor\xedte dlh\xfdm stlačen\xedm alebo stlačen\xedm kl\xe1vesu Alt + kl\xe1vesu so š\xedpkou nadol`},"sl-SI":{longPressMessage:`Za odprtje menija pritisnite in držite gumb ali pritisnite Alt+puščica navzdol`},"sr-SP":{longPressMessage:"Dugo pritisnite ili pritisnite Alt + strelicu prema dole da otvorite meni"},"sv-SE":{longPressMessage:`H\xe5ll nedtryckt eller tryck p\xe5 Alt + pil ned\xe5t f\xf6r att \xf6ppna menyn`},"tr-TR":{longPressMessage:`Men\xfcy\xfc a\xe7mak i\xe7in uzun basın veya Alt + Aşağı Ok tuşuna basın`},"uk-UA":{longPressMessage:`Довго або звичайно натисніть комбінацію клавіш Alt і стрілка вниз, щоб відкрити меню`},"zh-CN":{longPressMessage:`长按或按 Alt + 向下方向键以打开菜单`},"zh-TW":{longPressMessage:`長按或按 Alt+向下鍵以開啟功能表`}};let e7=new WeakMap;class e8 extends Set{constructor(e,t,n){super(e),e instanceof e8?(this.anchorKey=t||e.anchorKey,this.currentKey=n||e.currentKey):(this.anchorKey=t,this.currentKey=n)}}function e9(e,t){return e?"all"===e?"all":new e8(e):t}class te{get selectionMode(){return this.state.selectionMode}get disallowEmptySelection(){return this.state.disallowEmptySelection}get selectionBehavior(){return this.state.selectionBehavior}setSelectionBehavior(e){this.state.setSelectionBehavior(e)}get isFocused(){return this.state.isFocused}setFocused(e){this.state.setFocused(e)}get focusedKey(){return this.state.focusedKey}get childFocusStrategy(){return this.state.childFocusStrategy}setFocusedKey(e,t){(null==e||this.collection.getItem(e))&&this.state.setFocusedKey(e,t)}get selectedKeys(){return"all"===this.state.selectedKeys?new Set(this.getSelectAllKeys()):this.state.selectedKeys}get rawSelection(){return this.state.selectedKeys}isSelected(e){return"none"!==this.state.selectionMode&&(e=this.getKey(e),"all"===this.state.selectedKeys?this.canSelectItem(e):this.state.selectedKeys.has(e))}get isEmpty(){return"all"!==this.state.selectedKeys&&0===this.state.selectedKeys.size}get isSelectAll(){if(this.isEmpty)return!1;if("all"===this.state.selectedKeys)return!0;if(null!=this._isSelectAll)return this._isSelectAll;let e=this.getSelectAllKeys(),t=this.state.selectedKeys;return this._isSelectAll=e.every(e=>t.has(e)),this._isSelectAll}get firstSelectedKey(){let e=null;for(let t of this.state.selectedKeys){let n=this.collection.getItem(t);(!e||(null==n?void 0:n.index)<e.index)&&(e=n)}return null==e?void 0:e.key}get lastSelectedKey(){let e=null;for(let t of this.state.selectedKeys){let n=this.collection.getItem(t);(!e||(null==n?void 0:n.index)>e.index)&&(e=n)}return null==e?void 0:e.key}get disabledKeys(){return this.state.disabledKeys}get disabledBehavior(){return this.state.disabledBehavior}extendSelection(e){let t;if("none"!==this.selectionMode){if("single"===this.selectionMode){this.replaceSelection(e);return}if(e=this.getKey(e),"all"===this.state.selectedKeys)t=new e8([e],e,e);else{let n=this.state.selectedKeys,r=n.anchorKey||e;for(let a of(t=new e8(n,r,e),this.getKeyRange(r,n.currentKey||e)))t.delete(a);for(let i of this.getKeyRange(e,r))this.canSelectItem(i)&&t.add(i)}this.state.setSelectedKeys(t)}}getKeyRange(e,t){let n=this.collection.getItem(e),r=this.collection.getItem(t);return n&&r?n.index<=r.index?this.getKeyRangeInternal(e,t):this.getKeyRangeInternal(t,e):[]}getKeyRangeInternal(e,t){let n=[],r=e;for(;r;){let a=this.collection.getItem(r);if((a&&"item"===a.type||"cell"===a.type&&this.allowsCellSelection)&&n.push(r),r===t)return n;r=this.collection.getKeyAfter(r)}return[]}getKey(e){let t=this.collection.getItem(e);if(!t||"cell"===t.type&&this.allowsCellSelection)return e;for(;"item"!==t.type&&null!=t.parentKey;)t=this.collection.getItem(t.parentKey);return t&&"item"===t.type?t.key:null}toggleSelection(e){if("none"===this.selectionMode)return;if("single"===this.selectionMode&&!this.isSelected(e)){this.replaceSelection(e);return}if(null==(e=this.getKey(e)))return;let t=new e8("all"===this.state.selectedKeys?this.getSelectAllKeys():this.state.selectedKeys);t.has(e)?t.delete(e):this.canSelectItem(e)&&(t.add(e),t.anchorKey=e,t.currentKey=e),this.disallowEmptySelection&&0===t.size||this.state.setSelectedKeys(t)}replaceSelection(e){if("none"===this.selectionMode||null==(e=this.getKey(e)))return;let t=this.canSelectItem(e)?new e8([e],e,e):new e8;this.state.setSelectedKeys(t)}setSelectedKeys(e){if("none"===this.selectionMode)return;let t=new e8;for(let n of e)if(null!=(n=this.getKey(n))&&(t.add(n),"single"===this.selectionMode))break;this.state.setSelectedKeys(t)}getSelectAllKeys(){let e=[],t=n=>{for(;n;){if(this.canSelectItem(n)){let r=this.collection.getItem(n);"item"===r.type&&e.push(n),r.hasChildNodes&&(this.allowsCellSelection||"item"!==r.type)&&t([...r.childNodes][0].key)}n=this.collection.getKeyAfter(n)}};return t(this.collection.getFirstKey()),e}selectAll(){"multiple"===this.selectionMode&&this.state.setSelectedKeys("all")}clearSelection(){!this.disallowEmptySelection&&("all"===this.state.selectedKeys||this.state.selectedKeys.size>0)&&this.state.setSelectedKeys(new e8)}toggleSelectAll(){this.isSelectAll?this.clearSelection():this.selectAll()}select(e,t){"none"!==this.selectionMode&&("single"===this.selectionMode?this.isSelected(e)&&!this.disallowEmptySelection?this.toggleSelection(e):this.replaceSelection(e):"toggle"===this.selectionBehavior||t&&("touch"===t.pointerType||"virtual"===t.pointerType)?this.toggleSelection(e):this.replaceSelection(e))}isSelectionEqual(e){if(e===this.state.selectedKeys)return!0;let t=this.selectedKeys;if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;for(let r of t)if(!e.has(r))return!1;return!0}canSelectItem(e){if("none"===this.state.selectionMode||this.state.disabledKeys.has(e))return!1;let t=this.collection.getItem(e);return!!t&&("cell"!==t.type||!!this.allowsCellSelection)}isDisabled(e){return this.state.disabledKeys.has(e)&&"all"===this.state.disabledBehavior}constructor(e,t,n){var r;this.collection=e,this.state=t,this.allowsCellSelection=null!==(r=null==n?void 0:n.allowsCellSelection)&&void 0!==r&&r,this._isSelectAll=null}}var tt=Symbol.iterator;class tn{*[tt](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(e){let t=this.keyMap.get(e);return t?t.prevKey:null}getKeyAfter(e){let t=this.keyMap.get(e);return t?t.nextKey:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(e){return this.keyMap.get(e)}at(e){let t=[...this.getKeys()];return this.getItem(t[e])}constructor(e,{expandedKeys:t}={}){let n;this.keyMap=new Map,this.iterable=e,t=t||new Set;let r=e=>{if(this.keyMap.set(e.key,e),e.childNodes&&("section"===e.type||t.has(e.key)))for(let n of e.childNodes)r(n)};for(let a of e)r(a);let i=0;for(let[s,o]of this.keyMap)n?(n.nextKey=s,o.prevKey=n.key):(this.firstKey=s,o.prevKey=void 0),"item"===o.type&&(o.index=i++),(n=o).nextKey=void 0;this.lastKey=null==n?void 0:n.key}}var tr=n(2903),ta=n(88);let ti=e=>`calc(${15.25*e}pt + 1px * ${e-1})`,ts=(0,F.zo)("div",{width:"100%",maxWidth:"100%",position:"relative",variants:{color:{default:{bg:"$border"},primary:{bg:"$primary"},secondary:{bg:"$secondary"},success:{bg:"$success"},warning:{bg:"$warning"},error:{bg:"$error"}}},defaultVariants:{color:"default"}}),to=(0,F.zo)("span",{position:"absolute",left:"50%",top:"50%",minHeight:"100%",display:"inline-flex",jc:"center",ai:"center",transform:"translate(-50%, -50%)",padding:"0 $lg",fontSize:"$base",fontWeight:"bold",textTransform:"capitalize",backgroundColor:"$background",zIndex:"$1",variants:{color:{default:{color:"$text"},primary:{color:"$primary"},secondary:{color:"$secondary"},success:{color:"$success"},warning:{color:"$warning"},error:{color:"$error"}}}}),tl=({height:e,x:t,y:n,align:a,children:i,textColor:s,css:o,...l})=>{let u=(0,r.useMemo)(()=>a&&"center"!==a?"left"===a||"start"===a?{transform:"translateY(-50%)",left:"7%"}:{transform:"translateY(-50%)",left:"auto",right:"7%"}:"",[a]),h=n?ti(n/2):0,c=t?ti(t/2):0;return(0,w.jsx)(ts,{css:{margin:`${h} ${c}`,height:`calc(${e} * 1px)`,...o},role:"separator",...l,children:i&&(0,w.jsx)(to,{className:"nextui-divider-text",color:s,css:{...u},children:i})})};tl.toString=()=>".nextui-divider";let tu=r.memo(tl);var th=(0,ta.Z)(tu,{x:0,y:0,height:1,align:"center"});let tc=(0,F.zo)("ul",{$$dropdownItemHeight:"$space$13",$$dropdownMenuPadding:"$space$4",$$dropdownMenuWidth:"250px",$$dropdownMenuMinWidth:"250px",listStyle:"none",position:"relative",maxWidth:"$$dropdownMenuWidth",minWidth:"$$dropdownMenuMinWidth",width:"100%",p:"$$dropdownMenuPadding",m:0,outline:"none"}),td=(0,F.zo)("span",{dflex:"center",flexShrink:0,mr:"$4"}),tp=(0,F.zo)("kbd",{opacity:.8,ml:"$4",mr:0,dflex:"center",color:"$$dropdownItemKeyboardColor",fontSize:"$xs",fontFamily:"$sans",boxShadow:"none",bg:"transparent",transition:"border 0.12s ease 0s"}),tf=(0,F.zo)("div",{d:"flex",flex:"1 1 0%",flexDirection:"column",alignItems:"flex-start",lineHeight:1.2}),tm=(0,F.zo)("span",{flex:"1 1 0%"}),tg=(0,F.zo)("span",{fontSize:"$xs",color:"$$dropdownItemDescriptionColor",truncateText:"calc($$dropdownMenuWidth * 0.9)",transition:"color 0.12s ease 0s",variants:{hasIcon:{true:{truncateText:"calc($$dropdownMenuWidth * 0.7)"}},hasCommand:{true:{truncateText:"calc($$dropdownMenuWidth * 0.7)"}}},compoundVariants:[{hasIcon:!0,hasCommand:!0,css:{truncateText:"calc($$dropdownMenuWidth * 0.6)"}}]}),ty=(0,F.zo)("li",{$$dropdownItemPressedScale:.97,$$dropdownItemTextColor:"$colors$text",$$dropdownItemBorderRadius:"$radii$sm",$$dropdownItemKeyboardColor:"$colors$accents8",$$dropdownItemDescriptionColor:"$colors$accents8",dflex:"center",outline:"none",cursor:"pointer",justifyContent:"space-between",bg:"transparent",position:"relative",height:"$$dropdownItemHeight",px:"$6",br:"$$dropdownItemBorderRadius",color:"$$dropdownItemTextColor",mb:0,transition:"$dropdownItem",transform:"translateZ(0)",backfaceVisibility:"hidden",$$dropdownItemShadow:"$colors$primaryShadow","@motion":{transition:"none",[`& ${tp}`]:{transition:"none"},[`& ${tg}`]:{transition:"none"}},variants:{color:{default:{$$dropdownItemHoverBackground:"$colors$neutralLight",$$dropdownItemHoverTextColor:"$colors$neutralLightContrast",$$dropdownItemActiveBackground:"$colors$neutralLightActive",$$dropdownItemSolidHoverBackground:"$colors$neutral",$$dropdownItemSolidHoverTextColor:"$colors$neutralSolidContrast",$$dropdownItemShadow:"$colors$neutralShadow",$$dropdownItemHoverBorderColor:"$colors$neutralBorder"},primary:{$$dropdownItemHoverBackground:"$colors$primaryLight",$$dropdownItemHoverTextColor:"$colors$primaryLightContrast",$$dropdownItemActiveBackground:"$colors$primaryLightActive",$$dropdownItemSolidHoverBackground:"$colors$primary",$$dropdownItemSolidHoverTextColor:"$colors$primarySolidContrast",$$dropdownItemShadow:"$colors$primaryShadow",$$dropdownItemHoverBorderColor:"$colors$primaryBorder"},secondary:{$$dropdownItemHoverBackground:"$colors$secondaryLight",$$dropdownItemHoverTextColor:"$colors$secondaryLightContrast",$$dropdownItemActiveBackground:"$colors$secondaryLightActive",$$dropdownItemSolidHoverBackground:"$colors$secondary",$$dropdownItemSolidHoverTextColor:"$colors$secondarySolidContrast",$$dropdownItemShadow:"$colors$secondaryShadow",$$dropdownItemHoverBorderColor:"$colors$secondaryBorder"},success:{$$dropdownItemHoverBackground:"$colors$successLight",$$dropdownItemHoverTextColor:"$colors$successLightContrast",$$dropdownItemActiveBackground:"$colors$successLightActive",$$dropdownItemSolidHoverBackground:"$colors$success",$$dropdownItemSolidHoverTextColor:"$colors$successSolidContrast",$$dropdownItemShadow:"$colors$successShadow",$$dropdownItemHoverBorderColor:"$colors$successBorder"},warning:{$$dropdownItemHoverBackground:"$colors$warningLight",$$dropdownItemHoverTextColor:"$colors$warningLightContrast",$$dropdownItemActiveBackground:"$colors$warningLightActive",$$dropdownItemSolidHoverBackground:"$colors$warning",$$dropdownItemSolidHoverTextColor:"$colors$warningSolidContrast",$$dropdownItemShadow:"$colors$warningShadow",$$dropdownItemHoverBorderColor:"$colors$warningBorder"},error:{$$dropdownItemHoverBackground:"$colors$errorLight",$$dropdownItemHoverTextColor:"$colors$errorLightContrast",$$dropdownItemActiveBackground:"$colors$errorLightActive",$$dropdownItemSolidHoverBackground:"$colors$error",$$dropdownItemSolidHoverTextColor:"$colors$errorSolidContrast",$$dropdownItemShadow:"$colors$errorShadow",$$dropdownItemHoverBorderColor:"$colors$errorBorder"}},textColor:{default:{},primary:{$$dropdownItemTextColor:"$colors$primaryLightContrast",$$dropdownItemHoverTextColor:"$colors$primaryLightContrast"},secondary:{$$dropdownItemTextColor:"$colors$secondaryLightContrast",$$dropdownItemHoverTextColor:"$colors$secondaryLightContrast"},success:{$$dropdownItemTextColor:"$colors$successLightContrast",$$dropdownItemHoverTextColor:"$colors$successLightContrast"},warning:{$$dropdownItemTextColor:"$colors$warningLightContrast",$$dropdownItemHoverTextColor:"$colors$warningLightContrast"},error:{$$dropdownItemTextColor:"$colors$errorLightContrast",$$dropdownItemHoverTextColor:"$colors$errorLightContrast"}},variant:{flat:{true:{}},light:{true:{}},solid:{true:{}},shadow:{true:{}}},isPressed:{true:{bg:"$$dropdownItemActiveBackground"}},isFocused:{true:{bg:"$$dropdownItemHoverBackground",color:"$$dropdownItemHoverTextColor",zIndex:"$1",[`& ${tp}`]:{color:"$$dropdownItemHoverTextColor",borderColor:"$$dropdownItemHoverBorderColor"},[`& ${tg}`]:{color:"currentColor"}}},isHovered:{true:{bg:"$$dropdownItemHoverBackground",color:"$$dropdownItemHoverTextColor",[`& ${tp}`]:{color:"$$dropdownItemHoverTextColor",borderColor:"$$dropdownItemHoverBorderColor"},[`& ${tg}`]:{color:"currentColor"}}},shouldShowOutline:{true:{outline:"solid 2px $$dropdownItemActiveBackground"}},isSelected:{true:{}},isSelectable:{true:{}},isDisabled:{true:{color:"$accents5",cursor:"default"}},withDescription:{true:{height:"calc($$dropdownItemHeight * 1.2)"}},withDivider:{true:{mt:"$6","&:before":{content:'""',position:"absolute",top:"-$3",left:"-$$dropdownMenuPadding",right:"-$$dropdownMenuPadding",height:"$$dropdownItemBorderWeight",bg:"$border"}}},dividerWeight:{light:{$$dropdownItemBorderWeight:"$borderWeights$light"},normal:{$$dropdownItemBorderWeight:"$borderWeights$normal"},bold:{$$dropdownItemBorderWeight:"$borderWeights$bold"},extrabold:{$$dropdownItemBorderWeight:"$borderWeights$extrabold"},black:{$$dropdownItemBorderWeight:"$borderWeights$black"}},showFullDescription:{true:{[`& ${tg}`]:{mt:"$2",overflow:"visible",textOverflow:"visible",whiteSpace:"normal"}}},disableAnimation:{true:{transition:"none",[`& ${tp}`]:{transition:"none"},[`& ${tg}`]:{transition:"none"}}}},compoundVariants:[{isPressed:!0,disableAnimation:!1,css:{transform:"scale($$dropdownItemPressedScale)"}},{isHovered:!0,variant:"light",css:{bg:"transparent"}},{isFocused:!0,variant:"light",css:{bg:"transparent"}},{isHovered:!0,variant:"solid",css:{bg:"$$dropdownItemSolidHoverBackground",color:"$$dropdownItemSolidHoverTextColor",[`& ${tp}`]:{color:"$$dropdownItemSolidHoverTextColor"}}},{isFocused:!0,variant:"solid",css:{bg:"$$dropdownItemSolidHoverBackground",color:"$$dropdownItemSolidHoverTextColor",[`& ${tp}`]:{color:"$$dropdownItemSolidHoverTextColor"}}},{isHovered:!0,variant:"shadow",css:{bg:"$$dropdownItemSolidHoverBackground",color:"$$dropdownItemSolidHoverTextColor",boxShadow:"0 3px 10px 0 $$dropdownItemShadow",[`& ${tp}`]:{color:"$$dropdownItemSolidHoverTextColor"}}},{isFocused:!0,variant:"shadow",css:{bg:"$$dropdownItemSolidHoverBackground",color:"$$dropdownItemSolidHoverTextColor",boxShadow:"0 3px 10px 0 $$dropdownItemShadow",[`& ${tp}`]:{color:"$$dropdownItemSolidHoverTextColor"}}},{variant:"flat",color:"default",css:{$$dropdownItemHoverTextColor:"$colors$foreground"}}],defaultVariants:{color:"default",textColor:"default",dividerWeight:"light",variant:"flat"}},R.BM),tb=(0,F.zo)("li",{mb:0}),tx=(0,F.zo)("ul",{m:0,p:0,listStyle:"none"}),tv=(0,F.zo)("span",{fontWeight:"$medium",fontSize:"$xs",padding:"0 $4",color:"$accents8"}),tw=(0,F.F4)({"100%":{strokeDashoffset:0}}),tI=(0,F.zo)("svg",{d:"block",path:{transformOrigin:"50% 50%",strokeDasharray:48,strokeDashoffset:48,animation:`${tw} .25s cubic-bezier(0.650, 0.000, 0.450, 1.000) forwards`}}),tk=e=>{let{width:t=24,height:n=24,size:r,strokeWidth:a=3,fill:i="currentColor",css:s,className:o}=e;return(0,w.jsx)(tI,{className:(0,D.Z)("nextui-checkmark",o),css:{...s},height:r||n,role:"img",viewBox:"0 0 52 52",width:r||t,xmlns:"http://www.w3.org/2000/svg",children:(0,w.jsx)("path",{d:"M14.1 27.2l7.1 7.2 16.7-16.8",fill:"none",stroke:i,strokeWidth:a})})};d.Ts&&(tk.displayName="NextUI.Checkmark"),tk.toString=()=>".nextui-checkmark";let tS=({as:e,css:t,item:n,state:a,color:i,icon:s,command:o,description:l,textColor:h,variant:c,autoFocus:d,isVirtualized:f,withDivider:m,dividerWeight:g,showFullDescription:y,className:b,onAction:x})=>{let{onClose:v,closeOnSelect:I,disableAnimation:k,borderWeight:S}=U(),{rendered:C,key:E}=n,T=a.selectionManager.isSelected(E),$=a.selectionManager.focusedKey===n.key,A=a.disabledKeys.has(E),F=(0,r.useRef)(null),{pressProps:R,isPressed:_}=(0,V.r7)({ref:F,isDisabled:A}),{isFocusVisible:O,focusProps:M}=(0,N.Fx)({autoFocus:d}),{hoverProps:B,isHovered:P}=(0,V.XI)({isDisabled:A}),L="none"!==a.selectionManager.selectionMode&&!A,{menuItemProps:W,labelProps:z,descriptionProps:G,keyboardShortcutProps:H}=function(e,t,n){var a,i;let{key:s,closeOnSelect:o,isVirtualized:l}=e,h=null!==(a=e.isDisabled)&&void 0!==a?a:t.disabledKeys.has(s),c=null!==(i=e.isSelected)&&void 0!==i?i:t.selectionManager.isSelected(s),d=t.selectionManager.focusedKey===s,f=e7.get(t),m=e.onClose||f.onClose,g=e.onAction||f.onAction,y="menuitem";"single"===t.selectionManager.selectionMode?y="menuitemradio":"multiple"===t.selectionManager.selectionMode&&(y="menuitemcheckbox");let b=(0,p.mp)(),x=(0,p.mp)(),v=(0,p.mp)(),w={"aria-disabled":h,role:y,"aria-label":e["aria-label"],"aria-labelledby":b,"aria-describedby":[x,v].filter(Boolean).join(" ")||void 0};"none"!==t.selectionManager.selectionMode&&(w["aria-checked"]=c),l&&(w["aria-posinset"]=t.collection.getItem(s).index,w["aria-setsize"]=function e(t){let n=u.get(t);if(null!=n)return n;for(let r of(n=0,t))"section"===r.type?n+=e(r.childNodes):n++;return u.set(t,n),n}(t.collection));let I=e=>{if(!e.repeat)switch(e.key){case" ":!h&&"none"===t.selectionManager.selectionMode&&!1!==o&&m&&m();break;case"Enter":!h&&!1!==o&&m&&m()}},k=e=>{"keyboard"===e.pointerType&&g&&g(s)},S=e=>{"keyboard"!==e.pointerType&&(g&&g(s),m&&(null!=o?o:"multiple"!==t.selectionManager.selectionMode)&&m())},{itemProps:C}=function(e){let{selectionManager:t,key:n,ref:a,shouldSelectOnPressUp:i,isVirtualized:s,shouldUseVirtualFocus:o,focus:l,isDisabled:u,onAction:h,allowsDifferentPressOrigin:c}=e,d=e=>{if("keyboard"===e.pointerType&&e1(e))t.toggleSelection(n);else{if("none"===t.selectionMode)return;"single"===t.selectionMode?t.isSelected(n)&&!t.disallowEmptySelection?t.toggleSelection(n):t.replaceSelection(n):e&&e.shiftKey?t.extendSelection(n):"toggle"===t.selectionBehavior||e&&(e2(e)||"touch"===e.pointerType||"virtual"===e.pointerType)?t.toggleSelection(n):t.replaceSelection(n)}};(0,r.useEffect)(()=>{n===t.focusedKey&&t.isFocused&&!o&&document.activeElement!==a.current&&(l?l():eB(a.current))},[a,n,t.focusedKey,t.childFocusStrategy,t.isFocused,o]),u=u||t.isDisabled(n);let p={};o||u?u&&(p.onMouseDown=e=>{e.preventDefault()}):p={tabIndex:n===t.focusedKey?0:-1,onFocus(e){e.target===a.current&&t.setFocusedKey(n)}};let f=!u&&t.canSelectItem(n),m=h&&!u,g=m&&("replace"===t.selectionBehavior?!f:t.isEmpty),y=m&&f&&"replace"===t.selectionBehavior,b=g||y,x=(0,r.useRef)(null),v=b&&f,w=(0,r.useRef)(!1),I=(0,r.useRef)(!1),k={};i?(k.onPressStart=e=>{x.current=e.pointerType,w.current=v,"keyboard"===e.pointerType&&(!b||e4())&&d(e)},c?(k.onPressUp=e=>{"keyboard"!==e.pointerType&&d(e)},k.onPress=g?()=>h():null):k.onPress=e=>{g||y&&"mouse"!==e.pointerType?("keyboard"!==e.pointerType||e3())&&h():"keyboard"!==e.pointerType&&d(e)}):(k.onPressStart=e=>{x.current=e.pointerType,w.current=v,I.current=g,("mouse"===e.pointerType&&!g||"keyboard"===e.pointerType&&(!h||e4()))&&d(e)},k.onPress=e=>{("touch"===e.pointerType||"pen"===e.pointerType||"virtual"===e.pointerType||"keyboard"===e.pointerType&&b&&e3()||"mouse"===e.pointerType&&I.current)&&(b?h():d(e))}),s||(p["data-key"]=n),k.preventFocusOnPress=o;let{pressProps:S,isPressed:C}=em(k),E=y?e=>{"mouse"===x.current&&(e.stopPropagation(),e.preventDefault(),h())}:void 0,{longPressProps:T}=function(e){let{isDisabled:t,onLongPressStart:n,onLongPressEnd:a,onLongPress:i,threshold:s=500,accessibilityDescription:o}=e,l=(0,r.useRef)(null),{addGlobalListener:u,removeGlobalListener:h}=ee(),{pressProps:c}=em({isDisabled:t,onPressStart(e){if(("mouse"===e.pointerType||"touch"===e.pointerType)&&(n&&n({...e,type:"longpressstart"}),l.current=setTimeout(()=>{e.target.dispatchEvent(new PointerEvent("pointercancel",{bubbles:!0})),i&&i({...e,type:"longpress"}),l.current=null},s),"touch"===e.pointerType)){let t=e=>{e.preventDefault()};u(e.target,"contextmenu",t,{once:!0}),u(window,"pointerup",()=>{setTimeout(()=>{h(e.target,"contextmenu",t)},30)},{once:!0})}},onPressEnd(e){l.current&&clearTimeout(l.current),a&&("mouse"===e.pointerType||"touch"===e.pointerType)&&a({...e,type:"longpressend"})}});return{longPressProps:K(c,function(e){let[t,n]=(0,r.useState)(void 0);return j(()=>{if(!e)return;let t=en.get(e);if(t)n(t.element.id);else{let r=`react-aria-description-${et++}`;n(r);let a=document.createElement("div");a.id=r,a.style.display="none",a.textContent=e,document.body.appendChild(a),t={refCount:0,element:a},en.set(e,t)}return t.refCount++,()=>{0==--t.refCount&&(t.element.remove(),en.delete(e))}},[e]),{"aria-describedby":e?t:void 0}}(i&&!t?o:null))}}({isDisabled:!v,onLongPress(e){"touch"===e.pointerType&&(d(e),t.setSelectionBehavior("toggle"))}});return{itemProps:K(p,f||g?S:{},v?T:{},{onDoubleClick:E,onDragStartCapture(e){"touch"===x.current&&w.current&&e.preventDefault()}}),isPressed:C,isSelected:t.isSelected(n),isDisabled:u,allowsSelection:f,hasAction:b}}({selectionManager:t.selectionManager,key:s,ref:n,shouldSelectOnPressUp:!0,allowsDifferentPressOrigin:!0}),{pressProps:E,isPressed:T}=(0,V.r7)({onPressStart:k,onPressUp:S,isDisabled:h}),{hoverProps:$}=(0,V.XI)({isDisabled:h,onHoverStart(){(0,V.E)()||(t.selectionManager.setFocused(!0),t.selectionManager.setFocusedKey(s))}});return{menuItemProps:{...w,...(0,p.dG)(C,E,$,{onKeyDown:I})},labelProps:{id:b},descriptionProps:{id:x},keyboardShortcutProps:{id:v},isFocused:d,isSelected:c,isPressed:T,isDisabled:h}}({key:E,onClose:v,isSelected:T,isDisabled:A,"aria-label":n["aria-label"],closeOnSelect:I,isVirtualized:f,onAction:x},a,F),X=(0,r.useMemo)(()=>P?"hovered":T?"selected":_?"pressed":A?"disabled":"ready",[T,A,P,_]),q=(0,r.useMemo)(()=>n.props.textColor?n.props.textColor:n.props.color&&"default"===h?n.props.color:h,[h,n.props.color,n.props.textColor]),Y=(0,r.useMemo)(()=>l||n.props.description,[l,n.props.description]),Q=(0,r.useMemo)(()=>o||n.props.command,[o,n.props.command]),Z=(0,r.useMemo)(()=>s||n.props.icon,[s,n.props.icon]);return(0,w.jsxs)(ty,{ref:F,...(0,p.dG)(W,B,R,M),as:n.props.as||e,className:(0,D.Z)("nextui-dropdown-item",{"is-disabled":A,"is-selected":T,"is-selectable":L,"is-hovered":P,"is-focused":$,"is-pressed":_},b,n.props.className),color:n.props.color||i,css:{...(0,p.dG)(t,n.props.css)},"data-state":X,disableAnimation:k,dividerWeight:g||n.props.dividerWeight||S,isDisabled:A,isFocusVisible:O,isFocused:$,isHovered:P,isPressed:_,isSelectable:L,isSelected:T,shouldShowOutline:O&&"shadow"===c,showFullDescription:y||n.props.showFullDescription,textColor:q,variant:n.props.variant||c,withDescription:!!Y,withDivider:m||n.props.withDivider,children:[Z&&(0,w.jsx)(td,{className:"nextui-dropdown-item-icon-wrapper",children:Z}),Y?(0,w.jsxs)(tf,{children:[(0,w.jsx)(tm,{className:"nextui-dropdown-item-content",...z,children:C}),(0,w.jsx)(tg,{className:"nextui-dropdown-item-description",hasCommand:!!Q,hasIcon:!!Z,...G,children:Y})]}):(0,w.jsx)(tm,{className:"nextui-dropdown-item-content",...z,children:C}),Q&&(0,w.jsx)(tp,{className:"nextui-dropdown-item-command",...H,children:Q}),T&&(0,w.jsx)(tk,{css:{ml:"$4"}})]})};d.Ts&&(tS.displayName="NextUI.DropdownItem"),tS.toString=()=>".nextui-dropdown-item";let tC=e=>{var t,n;let{item:a,state:i,css:s,as:o,color:l,textColor:u,variant:h,withDivider:c=!0,className:d,onAction:f}=e,{itemProps:m,headingProps:g,groupProps:y}=function(e){let{heading:t,"aria-label":n}=e,r=(0,p.Me)();return{itemProps:{role:"presentation"},headingProps:t?{id:r,"aria-hidden":!0}:{},groupProps:{role:"group","aria-label":n,"aria-labelledby":t?r:void 0}}}({heading:a.rendered,"aria-label":a["aria-label"]});return(0,w.jsxs)(r.Fragment,{children:[a.key!==i.collection.getFirstKey()&&c&&(0,w.jsx)(th,{as:"li",className:"nextui-dropdown-section-divider",css:{my:"$2"}}),(0,w.jsxs)(tb,{...m,className:"nextui-dropdown-section-wrapper",children:[a.rendered&&(0,w.jsx)(tv,{...g,className:"nextui-dropdown-section-title",children:a.rendered}),(0,w.jsx)(tx,{...y,as:(null==(t=a.props)?void 0:t.as)||o,className:(0,D.Z)("nextui-dropdown-section",d),css:{...(0,p.dG)(s,null==(n=a.props)?void 0:n.css)},children:[...a.childNodes].map(e=>{let t=(0,w.jsx)(tS,{color:l,item:e,state:i,textColor:u,variant:h,onAction:f},e.key);return e.wrapper&&(t=e.wrapper(t)),t})})]})]})};d.Ts&&(tC.displayName="NextUI.DropdownSection"),tC.toString=()=>".nextui-dropdown-section";let tE=r.forwardRef((e,t)=>{let{css:n={},as:a,color:i="default",textColor:o="default",variant:l="flat",...u}=e,h=U(),c={...(0,p.dG)(h,u)},d=(0,tr.gy)(t),m=function(e){let[t,n]=(0,f.zk)(e.expandedKeys?new Set(e.expandedKeys):void 0,e.defaultExpandedKeys?new Set(e.defaultExpandedKeys):new Set,e.onExpandedChange),a=function(e){let{selectionMode:t="none",disallowEmptySelection:n,allowDuplicateSelectionEvents:a,selectionBehavior:i="toggle",disabledBehavior:s="all"}=e,o=(0,r.useRef)(!1),[,l]=(0,r.useState)(!1),u=(0,r.useRef)(null),h=(0,r.useRef)(null),[,c]=(0,r.useState)(null),d=(0,r.useMemo)(()=>e9(e.selectedKeys),[e.selectedKeys]),p=(0,r.useMemo)(()=>e9(e.defaultSelectedKeys,new e8),[e.defaultSelectedKeys]),[m,g]=(0,f.zk)(d,p,e.onSelectionChange),y=(0,r.useMemo)(()=>e.disabledKeys?new Set(e.disabledKeys):new Set,[e.disabledKeys]),[b,x]=(0,r.useState)(i);"replace"===i&&"toggle"===b&&"object"==typeof m&&0===m.size&&x("replace");let v=(0,r.useRef)(i);return(0,r.useEffect)(()=>{i!==v.current&&(x(i),v.current=i)},[i]),{selectionMode:t,disallowEmptySelection:n,selectionBehavior:b,setSelectionBehavior:x,get isFocused(){return o.current},setFocused(e){o.current=e,l(e)},get focusedKey(){return u.current},get childFocusStrategy(){return h.current},setFocusedKey(e,t="first"){u.current=e,h.current=t,c(e)},selectedKeys:m,setSelectedKeys(e){(a||!function(e,t){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}(e,m))&&g(e)},disabledKeys:y,disabledBehavior:s}}(e),i=(0,r.useMemo)(()=>e.disabledKeys?new Set(e.disabledKeys):new Set,[e.disabledKeys]),o=function(e,t,n,a=[]){let i=(0,r.useMemo)(()=>new s,[]),o=(0,r.useRef)(null);return(0,r.useMemo)(()=>{let r=i.build(e,n);return o.current=t(r,o.current),o.current},[i,e.children,e.items,n,...a])}(e,e=>new tn(e,{expandedKeys:t}),null,[t]);(0,r.useEffect)(()=>{null==a.focusedKey||o.getItem(a.focusedKey)||a.setFocusedKey(null)},[o,a.focusedKey]);let l=e=>{let r;n(((r=new Set(t)).has(e)?r.delete(e):r.add(e),r))};return{collection:o,expandedKeys:t,disabledKeys:i,toggleKey:l,selectionManager:new te(o,a)}}(c),{menuProps:g}=function(e,t,n){let{shouldFocusWrap:a=!0,...i}=e;e["aria-label"]||e["aria-labelledby"]||console.warn("An aria-label or aria-labelledby prop is required for accessibility.");let s=(0,p.zL)(e,{labelable:!0}),{listProps:o}=function(e){let{selectionManager:t,collection:n,disabledKeys:a,ref:i,keyboardDelegate:s,autoFocus:o,shouldFocusWrap:l,isVirtualized:u,disallowEmptySelection:h,selectOnFocus:c="replace"===t.selectionBehavior,disallowTypeAhead:d,shouldUseVirtualFocus:p,allowsTabNavigation:f}=e,m=function(e){let{locale:t}=eJ(),n=t+(e?Object.entries(e).sort((e,t)=>e[0]<t[0]?-1:1).join():"");if(e0.has(n))return e0.get(n);let r=new Intl.Collator(t,e);return e0.set(n,r),r}({usage:"search",sensitivity:"base"}),g=t.disabledBehavior,y=(0,r.useMemo)(()=>s||new e6(n,"selection"===g?new Set:a,i,m),[s,n,a,i,m,g]),{collectionProps:b}=function(e){let t,{selectionManager:n,keyboardDelegate:a,ref:i,autoFocus:s=!1,shouldFocusWrap:o=!1,disallowEmptySelection:l=!1,disallowSelectAll:u=!1,selectOnFocus:h="replace"===n.selectionBehavior,disallowTypeAhead:c=!1,shouldUseVirtualFocus:d,allowsTabNavigation:p=!1,isVirtualized:f,scrollRef:m=i}=e,{direction:g}=eJ(),y=e=>{var t,r,s,c,d,f,m;if(e.altKey&&"Tab"===e.key&&e.preventDefault(),!i.current.contains(e.target))return;let y=(t,r)=>{null!=t&&(n.setFocusedKey(t,r),e.shiftKey&&"multiple"===n.selectionMode?n.extendSelection(t):h&&!e1(e)&&n.replaceSelection(t))};switch(e.key){case"ArrowDown":if(a.getKeyBelow){e.preventDefault();let b=null!=n.focusedKey?a.getKeyBelow(n.focusedKey):null===(t=a.getFirstKey)||void 0===t?void 0:t.call(a);null==b&&o&&(b=null===(r=a.getFirstKey)||void 0===r?void 0:r.call(a,n.focusedKey)),y(b)}break;case"ArrowUp":if(a.getKeyAbove){e.preventDefault();let x=null!=n.focusedKey?a.getKeyAbove(n.focusedKey):null===(s=a.getLastKey)||void 0===s?void 0:s.call(a);null==x&&o&&(x=null===(c=a.getLastKey)||void 0===c?void 0:c.call(a,n.focusedKey)),y(x)}break;case"ArrowLeft":a.getKeyLeftOf&&(e.preventDefault(),y(a.getKeyLeftOf(n.focusedKey),"rtl"===g?"first":"last"));break;case"ArrowRight":a.getKeyRightOf&&(e.preventDefault(),y(a.getKeyRightOf(n.focusedKey),"rtl"===g?"last":"first"));break;case"Home":if(a.getFirstKey){e.preventDefault();let v=a.getFirstKey(n.focusedKey,e2(e));n.setFocusedKey(v),e2(e)&&e.shiftKey&&"multiple"===n.selectionMode?n.extendSelection(v):h&&n.replaceSelection(v)}break;case"End":if(a.getLastKey){e.preventDefault();let w=a.getLastKey(n.focusedKey,e2(e));n.setFocusedKey(w),e2(e)&&e.shiftKey&&"multiple"===n.selectionMode?n.extendSelection(w):h&&n.replaceSelection(w)}break;case"PageDown":a.getKeyPageBelow&&(e.preventDefault(),y(a.getKeyPageBelow(n.focusedKey)));break;case"PageUp":a.getKeyPageAbove&&(e.preventDefault(),y(a.getKeyPageAbove(n.focusedKey)));break;case"a":e2(e)&&"multiple"===n.selectionMode&&!0!==u&&(e.preventDefault(),n.selectAll());break;case"Escape":e.preventDefault(),l||n.clearSelection();break;case"Tab":if(!p){if(e.shiftKey)i.current.focus();else{let I,k;let S,C,E=(d=i.current,I=(f={tabbable:!0}).tabbable?eU:eL,k=document.createTreeWalker(d,NodeFilter.SHOW_ELEMENT,{acceptNode(e){var t;return(null==f?void 0:null===(t=f.from)||void 0===t?void 0:t.contains(e))?NodeFilter.FILTER_REJECT:e.matches(I)&&function e(t,n){return"#comment"!==t.nodeName&&function(e){if(!(e instanceof HTMLElement)&&!(e instanceof SVGElement))return!1;let{display:t,visibility:n}=e.style,r="none"!==t&&"hidden"!==n&&"collapse"!==n;if(r){let{getComputedStyle:a}=e.ownerDocument.defaultView,{display:i,visibility:s}=a(e);r="none"!==i&&"hidden"!==s&&"collapse"!==s}return r}(t)&&!t.hasAttribute("hidden")&&("DETAILS"!==t.nodeName||!n||"SUMMARY"===n.nodeName||t.hasAttribute("open"))&&(!t.parentElement||e(t.parentElement,t))}(e)&&(!m||eW(e,m))&&(!(null==f?void 0:f.accept)||f.accept(e))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}}),(null==f?void 0:f.from)&&(k.currentNode=f.from),k);do(C=E.lastChild())&&(S=C);while(C);S&&!S.contains(document.activeElement)&&X(S)}}}},b=(0,r.useRef)({top:0,left:0});!function(e,t,n,a){let i=(0,r.useRef)(n);i.current=n;let s=null==n;(0,r.useEffect)(()=>{if(s)return;let n=e.current,r=e=>i.current.call(this,e);return n.addEventListener(t,r,a),()=>{n.removeEventListener(t,r,a)}},[e,t,a,s])}(m,"scroll",f?null:()=>{b.current={top:m.current.scrollTop,left:m.current.scrollLeft}});let x=e=>{if(n.isFocused){e.currentTarget.contains(e.target)||n.setFocused(!1);return}if(e.currentTarget.contains(e.target)){if(n.setFocused(!0),null==n.focusedKey){var t,r,i;let s=e.relatedTarget;null!=(i=s&&e.currentTarget.compareDocumentPosition(s)&Node.DOCUMENT_POSITION_FOLLOWING?null!==(t=n.lastSelectedKey)&&void 0!==t?t:a.getLastKey():null!==(r=n.firstSelectedKey)&&void 0!==r?r:a.getFirstKey())&&(n.setFocusedKey(i),h&&n.replaceSelection(i))}else if(!f){m.current.scrollTop=b.current.top,m.current.scrollLeft=b.current.left;let o=m.current.querySelector(`[data-key="${n.focusedKey}"]`);o&&(X(o),es(m.current,o))}}},v=e=>{e.currentTarget.contains(e.relatedTarget)||n.setFocused(!1)},w=(0,r.useRef)(s);(0,r.useEffect)(()=>{if(w.current){let e=null;"first"===s&&(e=a.getFirstKey()),"last"===s&&(e=a.getLastKey());let t=n.selectedKeys;t.size&&(e=t.values().next().value),n.setFocused(!0),n.setFocusedKey(e),null!=e||d||eB(i.current)}w.current=!1},[]),(0,r.useEffect)(()=>{if(!f&&n.focusedKey&&(null==m?void 0:m.current)){let e=m.current.querySelector(`[data-key="${n.focusedKey}"]`);e&&es(m.current,e)}},[f,m,n.focusedKey]);let I={onKeyDown:y,onFocus:x,onBlur:v,onMouseDown(e){m.current===e.target&&e.preventDefault()}},{typeSelectProps:k}=function(e){let{keyboardDelegate:t,selectionManager:n,onTypeSelect:a}=e,i=(0,r.useRef)({search:"",timeout:null}).current,s=e=>{var r;let s=1!==(r=e.key).length&&/^[A-Z]/i.test(r)?"":r;if(!s||e.ctrlKey||e.metaKey)return;" "!==s||!(i.search.trim().length>0)||(e.preventDefault(),"continuePropagation"in e||e.stopPropagation()),i.search+=s;let o=t.getKeyForSearch(i.search,n.focusedKey);null==o&&(o=t.getKeyForSearch(i.search)),null!=o&&(n.setFocusedKey(o),a&&a(o)),clearTimeout(i.timeout),i.timeout=setTimeout(()=>{i.search=""},1e3)};return{typeSelectProps:{onKeyDownCapture:t.getKeyForSearch?s:null}}}({keyboardDelegate:a,selectionManager:n});return c||(I=K(k,I)),d||(t=null==n.focusedKey?0:-1),{collectionProps:{...I,tabIndex:t}}}({ref:i,selectionManager:t,keyboardDelegate:y,autoFocus:o,shouldFocusWrap:l,disallowEmptySelection:h,selectOnFocus:c,disallowTypeAhead:d,shouldUseVirtualFocus:p,allowsTabNavigation:f,isVirtualized:u,scrollRef:i});return{listProps:b}}({...i,ref:n,selectionManager:t.selectionManager,collection:t.collection,disabledKeys:t.disabledKeys,shouldFocusWrap:a});return e7.set(t,{onClose:e.onClose,onAction:e.onAction}),{menuProps:(0,p.dG)(s,{role:"menu",...o})}}(c,m,d);return(0,tr.lE)(h,d),(0,w.jsx)(tc,{ref:d,as:a,className:(0,D.Z)("nextui-dropdown-menu",e.className),css:{...n},...g,children:[...m.collection].map(e=>{if("section"===e.type)return(0,w.jsx)(tC,{color:i,item:e,state:m,textColor:o,variant:l,onAction:c.onAction},e.key);let t=(0,w.jsx)(tS,{color:i,item:e,state:m,textColor:o,variant:l,onAction:c.onAction},e.key);return e.wrapper&&(t=e.wrapper(t)),t})})});d.Ts&&(tE.displayName="NextUI.DropdownMenu"),tE.toString=()=>".nextui-dropdown-menu";let tT=({fill:e,size:t,height:n,width:r,...a})=>(0,w.jsx)("svg",{fill:"none",height:t||n||24,viewBox:"0 0 24 24",width:t||r||24,xmlns:"http://www.w3.org/2000/svg",...a,children:(0,w.jsx)("path",{d:"M17.9188 8.17969H11.6888H6.07877C5.11877 8.17969 4.63877 9.33969 5.31877 10.0197L10.4988 15.1997C11.3288 16.0297 12.6788 16.0297 13.5088 15.1997L15.4788 13.2297L18.6888 10.0197C19.3588 9.33969 18.8788 8.17969 17.9188 8.17969Z",fill:e})});d.Ts&&(tT.displayName="NextUI.DropdownIcon"),tT.toString=()=>".nextui-dropdown-icon";let t$=r.forwardRef((e,t)=>{let{css:n,children:a,className:i,iconRight:s,iconRightCss:o,auto:l=!0,animated:u,...h}=e,{disableAnimation:c}=U(),d=(0,tr.gy)(t),p=(0,r.useMemo)(()=>s||(0,w.jsx)(tT,{fill:"currentColor",size:14}),[s]),f=(0,r.useMemo)(()=>u||!c,[u,c]);return(0,w.jsx)(W,{css:{"& .nextui-button-icon-right, & .nextui-button-text-right":{pointerEvents:"none"},...n},children:(0,w.jsx)(E.ZP,{ref:d,animated:f,auto:l,className:(0,D.Z)("nextui-dropdown-button",i),iconRight:p,iconRightCss:{mt:"$1",...o},...h,children:a})})});d.Ts&&(t$.displayName="NextUI.DropdownButton"),t$.toString=()=>".nextui-dropdown-button";let tN=e=>{let{children:t,...n}=e,a=function(e={}){let{triggerRef:t,type:n="menu",trigger:a="press",isDisabled:i=!1,borderWeight:s,closeOnSelect:o,disableAnimation:l=!1,disableTriggerPressedAnimation:u=!1,...h}=e,d=(0,r.useRef)(null),g=t||d,y=(0,r.useRef)(null),b=(0,r.useRef)(null),x=function(e){let t=function(e){let[t,n]=(0,f.zk)(e.isOpen,e.defaultOpen||!1,e.onOpenChange);return{isOpen:t,setOpen:n,open(){n(!0)},close(){n(!1)},toggle(){n(!t)}}}(e),[n,a]=(0,r.useState)(null);return{focusStrategy:n,...t,open(e=null){a(e),t.open()},toggle(e=null){a(e),t.toggle()}}}(e),{menuTriggerProps:v,menuProps:w}=function(e,t,n){var r;let{type:a="menu",isDisabled:i,trigger:s="press"}=e,o=(0,p.Me)(),{triggerProps:l,overlayProps:u}=(0,c.IB)({type:a},t,n),h=e=>{if(!i&&("longPress"!==s||e.altKey)&&n&&n.current)switch(e.key){case"Enter":case" ":if("longPress"===s)return;case"ArrowDown":"continuePropagation"in e||e.stopPropagation(),e.preventDefault(),t.toggle("first");break;case"ArrowUp":"continuePropagation"in e||e.stopPropagation(),e.preventDefault(),t.toggle("last")}},d=(0,z.qb)((r=e5)&&r.__esModule?r.default:r),{longPressProps:f}=(0,V.TA)({isDisabled:i||"longPress"!==s,accessibilityDescription:d.format("longPressMessage"),onLongPressStart(){t.close()},onLongPress(){t.open("first")}});return delete l.onPress,{menuTriggerProps:{...l,..."press"===s?{onPressStart(e){"touch"===e.pointerType||"keyboard"===e.pointerType||i||t.toggle("virtual"===e.pointerType?"first":null)},onPress(e){"touch"!==e.pointerType||i||t.toggle()}}:f,id:o,onKeyDown:h},menuProps:{...u,"aria-labelledby":o,autoFocus:t.focusStrategy,onClose:t.close}}}({type:n,trigger:a,isDisabled:i},x,g),I=(0,r.useCallback)((e={},n=null)=>{let{css:r,...a}=null!=t&&t.current?(0,p.dG)(v,e):(0,p.dG)(e,v);return{ref:(0,m.l)(d,n),css:u?r:{'&[aria-haspopup="true"]&[aria-expanded="true"]':{opacity:.7,backfaceVisibility:"hidden",transform:"translateZ(0) scale(0.97)"},...r},...a}},[d,t,v,u]);return{...w,popoverProps:h,state:x,ref:y,onClose:x.close,autoFocus:x.focusStrategy||!0,disableAnimation:l,disableTriggerPressedAnimation:u,menuRef:y,borderWeight:s,menuPopoverRef:b,menuTriggerRef:g,closeOnSelect:o,getMenuTriggerProps:I}}(n),[i,s]=r.Children.toArray(t);return(0,w.jsx)(L,{value:a,children:(0,w.jsxs)(k,{ref:a.menuPopoverRef,...a.popoverProps,borderWeight:a.borderWeight,disableAnimation:a.disableAnimation,isOpen:a.state.isOpen,scrollRef:a.menuRef,triggerRef:a.menuTriggerRef,onClose:a.state.close,children:[i,(0,w.jsx)(k.Content,{children:s})]})})};d.Ts&&(tN.displayName="NextUI.Dropdown"),tN.toString=()=>".nextui-dropdown";var tA=tN;tA.Trigger=W,tA.Button=t$,tA.Menu=tE,tA.Section=i,tA.Item=h;var tD=tA},405:function(e,t,n){"use strict";n.d(t,{ZP:function(){return eu}});var r=n(7294),a=n(3935),i=n(2532),s=n(9644);let o=e=>{let t=document.createElement("div");return t.setAttribute("id",e),t};var l=(e=(0,s.zv)(),t)=>{let n=`nextui-${e}`,{isBrowser:a}=(0,i.Z)(),[l,u]=(0,r.useState)(a?o(n):null);return(0,r.useEffect)(()=>{let e=(t?t():null)||document.body,r=null==e?void 0:e.querySelector(`#${n}`),a=r||o(n);r||e.appendChild(a),u(a)},[]),l},u=n(88),h=n(8327),c=e=>{let[t,n]=(0,r.useState)(()=>"function"==typeof e?e():e),a=(0,r.useRef)(e);return(0,r.useEffect)(()=>{a.current=t},[t]),[t,e=>{let t="function"==typeof e?e(a.current):e;a.current=t,n(t)},a]},d=n(1309),p=n(8738);let f={Unknown:0,Backspace:8,Tab:9,Enter:13,Shift:16,Ctrl:17,Alt:18,PauseBreak:19,CapsLock:20,Escape:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,LeftArrow:37,UpArrow:38,RightArrow:39,DownArrow:40,Insert:45,Delete:46,KEY_0:48,KEY_1:49,KEY_2:50,KEY_3:51,KEY_4:52,KEY_5:53,KEY_6:54,KEY_7:55,KEY_8:56,KEY_9:57,KEY_A:65,KEY_B:66,KEY_C:67,KEY_D:68,KEY_E:69,KEY_F:70,KEY_G:71,KEY_H:72,KEY_I:73,KEY_J:74,KEY_K:75,KEY_L:76,KEY_M:77,KEY_N:78,KEY_O:79,KEY_P:80,KEY_Q:81,KEY_R:82,KEY_S:83,KEY_T:84,KEY_U:85,KEY_V:86,KEY_W:87,KEY_X:88,KEY_Y:89,KEY_Z:90,Meta:91,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NumLock:144,ScrollLock:145,Equal:187,Minus:189,Backquote:192,Backslash:220},m={CtrlCmd:2048,Shift:1024,Alt:512,WinCtrl:256},g=()=>({CtrlCmd:(0,s.V5)()?"metaKey":"ctrlKey",WinCtrl:(0,s.V5)()?"ctrlKey":"metaKey"}),y=e=>{let t=e.filter(e=>!!(0,p.sF)(m,e)),n={CtrlCmd:!1,Shift:!1,Alt:!1,WinCtrl:!1};return t.forEach(e=>{let t=(0,p.sF)(m,e);n[t]=!0}),n};var b=(e,t,n={})=>{let a=Array.isArray(t)?t:[t],{disableGlobalEvent:i=!1,capture:s=!1,stopPropagation:o=!1,preventDefault:l=!1,event:u="keydown"}=n,h=y(a),c=a.filter(e=>!(0,p.sF)(m,e)),{CtrlCmd:d,WinCtrl:f}=g(),b=t=>{h.Shift&&!t.shiftKey||h.Alt&&!t.altKey||h.CtrlCmd&&!t[d]||h.WinCtrl&&!t[f]||c.length>0&&!c.includes(t.keyCode)||(o&&t.stopPropagation(),l&&t.preventDefault(),e&&e(t))};(0,r.useEffect)(()=>(i||document.addEventListener(u,b),()=>{document.removeEventListener(u,b)}),[i]);let x=(e,t=!1)=>e!==u||t!==s?()=>{}:e=>b(e);return{bindings:{onKeyDown:x("keydown"),onKeyDownCapture:x("keydown",!0),onKeyPress:x("keypress"),onKeyPressCapture:x("keypress",!0),onKeyUp:x("keyup"),onKeyUpCapture:x("keyup",!0)}}},x=n(3569),v=n(275);let w=(0,v.F4)({"0%":{opacity:0},"60%":{opacity:.75},"100%":{opacity:1}}),I=(0,v.zo)("div",{position:"relative",display:"inline-block",zIndex:"$max",outline:"none",width:"100%",margin:"$9 auto",verticalAlign:"middle","@sm":{width:"90%",maxWidth:"90%"},variants:{animated:{true:{"&":{animationName:w,animationDuration:"200ms",animationTimingFunction:"ease-in",animationDirection:"normal"}},false:{transition:"none"}}}}),k=(0,v.zo)("div",{position:"fixed",top:0,left:0,right:0,bottom:0,size:"100%",pe:"none",zIndex:"$max","@motion":{transition:"none"},variants:{blur:{true:{bg:"$black",opacity:"$$backdropOpacity",transition:"opacity 0.35s cubic-bezier(0.4, 0, 0.2, 1)","@supports ((-webkit-backdrop-filter: none) or (backdrop-filter: none))":{opacity:1,transition:"background 0.35s cubic-bezier(0.4, 0, 0.2, 1)",backdropFilter:"saturate(180%) blur(20px)",bg:"rgba(0, 0, 0, 0.1)"}},false:{bg:"$black",opacity:"$$backdropOpacity",transition:"opacity 0.35s cubic-bezier(0.4, 0, 0.2, 1)"}},animated:{false:{transition:"none"}}}}),S=(0,v.zo)("div",{position:"fixed",top:0,left:0,right:0,bottom:0,overflow:"auto",zIndex:"$max",WebkitOverflowScrolling:"touch",boxSizing:"border-box",textAlign:"center","&:before":{content:"",display:"inline-block",width:0,height:"100%",verticalAlign:"middle"},".nextui-backdrop-wrapper-enter .nextui-backdrop-layer-default":{opacity:0},".nextui-backdrop-wrapper-enter-active .nextui-backdrop-layer-default":{opacity:"$$backdropOpacity"},".nextui-backdrop-wrapper-leave .nextui-backdrop-layer-default":{opacity:"$$backdropOpacity"},".nextui-backdrop-wrapper-leave-active .nextui-backdrop-layer-default":{opacity:0},".nextui-backdrop-wrapper-enter .nextui-backdrop-layer-blur":{bg:"rgba(0, 0, 0, 0.1)"},".nextui-backdrop-wrapper-enter-active .nextui-backdrop-layer-blur":{bg:"rgba(0, 0, 0, 0.4)"},".nextui-backdrop-wrapper-leave .nextui-backdrop-layer-blur":{bg:"rgba(0, 0, 0, 0.4)"},".nextui-backdrop-wrapper-leave-active .nextui-backdrop-layer-blur":{bg:"rgba(0, 0, 0, 0.1)"},variants:{fullScreen:{true:{display:"inline-flex",overflow:"hidden",[`& ${I}`]:{width:"100vw",maxWidth:"100vw",height:"100vh",margin:0},[`& ${k}`]:{display:"none"}}}},defaultVariants:{fullScreen:!1}});var C=n(5893);let E="nextui-backdrop",T=r.memo(({children:e,onClick:t,onKeyPress:n,visible:a,maxWidth:i,blur:s,animated:o,opacity:l,preventDefault:u,className:p,css:m,...g})=>{let[,y,x]=c(!1),v=e=>{x.current||t&&t(e)},w=(0,r.useCallback)(e=>{e.stopPropagation()},[]),T=()=>{if(!x.current)return;let e=setTimeout(()=>{y(!1),clearTimeout(e)},0)},{bindings:$}=b(e=>{n&&n(e)},[f.Escape,f.Space],{disableGlobalEvent:!0,preventDefault:u}),N=(0,r.useMemo)(()=>a?"open":"closed",[a]),A=(0,r.useMemo)(()=>(0,C.jsxs)(S,{"aria-hidden":!0,className:(0,d.Z)(E,`${E}--${N}`,p),css:{$$backdropOpacity:l,...m},"data-state":N,role:"button",tabIndex:-1,onClick:v,onMouseUp:T,...$,...g,children:[(0,C.jsx)(k,{animated:o,blur:s,className:(0,d.Z)(`${E}-layer`,s?`${E}-layer-blur`:`${E}-layer-default`)}),(0,C.jsx)(I,{animated:o,className:`${E}-content`,css:{maxWidth:i},onClick:w,onMouseDown:()=>y(!0),children:e})]}),[e]);return(0,C.jsx)(C.Fragment,{children:o?(0,C.jsx)(h.Z,{clearTime:150,enterTime:20,leaveTime:20,name:`${E}-wrapper`,visible:a,children:A}):a?A:null})});x.Ts&&(T.displayName="NextUI.Backdrop"),T.toString=()=>".nextui-backdrop";var $=(0,u.Z)(T,{onClick(){},visible:!1,blur:!1,animated:!0,preventDefault:!0,opacity:.5,className:""}),N=n(2355);let A=({size:e,fill:t,plain:n,width:r,height:a,className:i,...s})=>(0,C.jsx)("svg",n?{className:i,fill:"none",height:e||a,stroke:t,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,viewBox:"0 0 24 24",width:e||r,...s,children:(0,C.jsx)("path",{d:"M18 6L6 18M6 6l12 12"})}:{className:i,height:e||a,viewBox:"0 0 24 24",width:e||r,...s,children:(0,C.jsx)("path",{d:"M12 2a10 10 0 1010 10A10.016 10.016 0 0012 2zm3.36 12.3a.754.754 0 010 1.06.748.748 0 01-1.06 0l-2.3-2.3-2.3 2.3a.748.748 0 01-1.06 0 .754.754 0 010-1.06l2.3-2.3-2.3-2.3A.75.75 0 019.7 8.64l2.3 2.3 2.3-2.3a.75.75 0 011.06 1.06l-2.3 2.3z",fill:t})}),D=r.memo(A);var F=(0,u.Z)(D,{width:24,height:24,plain:!1,className:""});let R=(0,v.F4)({"0%":{transform:"scale(0.95)"},"40%":{transform:"scale(1.02)"},"80%":{transform:"scale(0.98)"},"100%":{transform:"scale(1)"}}),_=(0,v.F4)({"0%":{opacity:0,transform:"scale(0.95)"},"60%":{opacity:.75,transform:"scale(1.02)"},"100%":{opacity:1,transform:"scale(1)"}}),O=(0,v.F4)({"0%":{opacity:1,transform:"scale(1)"},"100%":{opacity:0,transform:"scale(0.95)"}});var M=n(9975);let B=(0,v.zo)("div",{outline:"none",overflow:"hidden",width:0,height:0,opacity:0}),P=(0,v.zo)("button",{position:"absolute",background:"transparent",border:"none",zIndex:"$1",top:"$space$3",right:"$space$2",margin:0,d:"inline-flex",ai:"center",height:"auto",cursor:"pointer",boxSizing:"border-box",transition:"$default",padding:"calc($space$sm * 0.5)",color:"$accents4",br:"$space$5",svg:{color:"currentColor"},"&:hover":{svg:{opacity:.8}},variants:{disabled:{true:{cursor:"not-allowed"}}}},M.xg),L=(0,v.zo)("div",{display:"flex",flexShrink:0,ai:"center",ov:"hidden",color:"inherit",padding:"$sm $10",fs:"$xs",variants:{noPadding:{true:{padding:0}},autoMargin:{true:{"> *:first-child":{mt:0},"> *:last-child":{mb:0}}}}}),U=(0,v.zo)("div",{display:"flex",flexDirection:"column",flex:"1 1 auto",padding:"$sm $10",oy:"auto",position:"relative",ta:"left",variants:{noPadding:{true:{flex:1,padding:0}},autoMargin:{true:{"> *:first-child":{mt:0},"> *":{mb:"$8"},"> *:last-child":{mb:0}}}}}),W=(0,v.zo)("div",{d:"flex",flexWrap:"wrap",flexShrink:0,overflow:"hidden",color:"inherit",ai:"center",fs:"$xs",padding:"$sm $lg",variants:{noPadding:{true:{padding:0}},autoMargin:{true:{"> *":{m:"$2"}}}}}),z=(0,v.zo)("section",{maxWidth:"100%",verticalAlign:"middle",overflow:"hidden",height:"fit-content(20em)",maxHeight:"inherit",display:"flex",outline:"none",flexDirection:"column",position:"relative",boxSizing:"border-box",color:"$foreground",br:"$lg",boxShadow:"$lg",bg:"$backgroundContrast",animationFillMode:"forwards","@motion":{transition:"none"},"&.nextui-modal-wrapper-enter:not(.nextui-modal-rendered)":{animationName:_,animationDuration:"200ms",animationTimingFunction:"ease-in",animationDirection:"normal"},"&.nextui-modal-wrapper-leave":{animationName:O,animationDuration:"50ms",animationTimingFunction:"ease-out"},variants:{fullScreen:{true:{size:"100%",maxHeight:"100%"},false:{"&.nextui-modal-rebound":{animationDuration:"250ms",animationName:R,animationTimingFunction:"ease",animationFillMode:"forwards"}}},scroll:{true:{maxHeight:"calc(100vh - 200px)"}},closeButton:{true:{paddingTop:"$lg",[`& ${P}`]:{svg:{size:"$10"}}}}},compoundVariants:[{scroll:!0,fullScreen:!0,css:{maxHeight:"100%"}}]}),V=({onClick:e,...t})=>(0,C.jsx)(P,{"aria-label":"Close",className:"nextui-modal-close-icon",type:"button",onClick(t){t.preventDefault(),t.stopPropagation(),t.nativeEvent.stopImmediatePropagation(),e&&e(t)},...t,children:(0,C.jsx)(F,{plain:!0,"aria-hidden":!0,className:"nextui-modal-close-icon-svg",fill:"currentColor",size:18})});V.toString=()=>".nextui-modal-close-icon";let G=r.memo(V),j="nextui-modal",H=({className:e,children:t,visible:n,fullScreen:a,closeButton:i,rebound:o,animated:l,onCloseButtonClick:u,scroll:c,...p})=>{let m=(0,r.useRef)(null),g=(0,r.useRef)(null),y=(0,r.useRef)(null),[b,x]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=setTimeout(()=>{x(!0),clearTimeout(e)},300);return()=>clearTimeout(e)},[]),(0,r.useEffect)(()=>{if(!n)return;let e=document.activeElement;(0,s.Tv)(m.current,e)||g.current&&g.current.focus()},[n]);let v=e=>{let t=e.keyCode===f.Tab;if(!n||!t)return;let r=document.activeElement;e.shiftKey?r===g.current&&y.current&&y.current.focus():r===y.current&&g.current&&g.current.focus()},w=()=>{u&&u()},I=(0,r.useMemo)(()=>n?"open":"closed",[n]),k=(0,r.useMemo)(()=>(0,C.jsxs)(z,{ref:m,"aria-modal":n,className:(0,d.Z)(j,`${j}--${I}`,{[`${j}-fullscreen`]:a,[`${j}-with-close-button`]:i,[`${j}-rebound`]:o,[`${j}-rendered`]:b},e),closeButton:i,"data-state":I,fullScreen:a,role:"dialog",scroll:c,tabIndex:-1,...p,onKeyDown:v,children:[(0,C.jsx)(B,{ref:g,"aria-hidden":"true",className:`${j}-hide-tab`,role:"button",tabIndex:0}),i&&(0,C.jsx)(G,{onClick:w}),t,(0,C.jsx)(B,{ref:y,"aria-hidden":"true",className:`${j}-hide-tab`,role:"button",tabIndex:0})]}),[o,t]);return(0,C.jsx)(C.Fragment,{children:l?(0,C.jsx)(h.Z,{clearTime:300,enterTime:20,leaveTime:20,name:`${j}-wrapper`,visible:n,children:k}):n?k:null})};H.toString=()=>".nextui-modal-wrapper";var K=(0,u.Z)(H,{className:"",visible:!1,rebound:!1});let X=r.createContext({}),q=({children:e,onClose:t,onOpen:n,open:i,autoMargin:s,width:o,className:u,preventClose:h,blur:d,animated:p,fullScreen:m,noPadding:g,...y})=>{let x=l("modal"),[,v]=(0,N.Z)(null,{scrollLayer:!0}),[w,I,k]=c(!1),[S,E]=(0,r.useState)(!1),T=()=>{t&&t(),I(!1),v(!1)};(0,r.useEffect)(()=>{void 0!==i&&(i&&n&&n(),!i&&k.current&&t&&t(),I(i),v(i))},[i]);let A=()=>{E(!0);let e=setTimeout(()=>{E(!1),clearTimeout(e)},300)},{bindings:D}=b(()=>{h?A():T()},f.Escape,{disableGlobalEvent:!0,preventDefault:!0}),F=(0,r.useMemo)(()=>({close:T,autoMargin:s,noPadding:g}),[]);return x?(0,a.createPortal)((0,C.jsx)(X.Provider,{value:F,children:(0,C.jsx)($,{animated:p,blur:d,fullScreen:m,maxWidth:o,visible:w,onClick(){h?A():T()},...D,children:(0,C.jsx)(K,{animated:p,className:u,fullScreen:m,rebound:S,visible:w,onCloseButtonClick:T,...y,children:e})})}),x):null};x.Ts&&(q.displayName="NextUI.Modal"),q.toString=()=>".nextui-modal",q.defaultProps={width:"400px",className:"",preventClose:!1,fullScreen:!1,closeButton:!1,animated:!0,blur:!1,scroll:!1,noPadding:!1};var Y=q;let Q="nextui-modal-header",Z=({children:e,className:t,justify:n,autoMargin:a,css:i,...s})=>{let{autoMargin:o,noPadding:l}=(0,r.useContext)(X),u=(0,r.useMemo)(()=>void 0!==o?o:a,[a,o]);return(0,C.jsx)(L,{autoMargin:u,className:(0,d.Z)(Q,{[`${Q}-auto-margin`]:u,[`${Q}-no-padding`]:l},t),css:{justifyContent:n,...i},noPadding:l,...s,children:e})};Z.toString=()=>".nextui-modal-header";let J=r.memo(Z);var ee=(0,u.Z)(J,{className:"",justify:"center",autoMargin:!0});let et="nextui-modal-body",en=({className:e,children:t,autoMargin:n,...a})=>{let{autoMargin:i,noPadding:s}=(0,r.useContext)(X),o=(0,r.useMemo)(()=>void 0!==i?i:n,[n,i]);return(0,C.jsx)(U,{autoMargin:o,className:(0,d.Z)(et,{[`${et}-auto-margin`]:o,[`${et}-no-padding`]:s},e),noPadding:s,...a,children:t})};en.toString=()=>".nextui-modal-body";let er=r.memo(en);var ea=(0,u.Z)(er,{className:"",autoMargin:!0});let ei="nextui-modal-footer",es=({children:e,className:t,justify:n,autoMargin:a,css:i,...s})=>{let{autoMargin:o,noPadding:l}=(0,r.useContext)(X),u=(0,r.useMemo)(()=>void 0!==o?o:a,[a,o]);return(0,C.jsx)(W,{autoMargin:u,className:(0,d.Z)(ei,{[`${ei}-auto-margin`]:u,[`${ei}-no-padding`]:l},t),css:{justifyContent:n,...i},noPadding:l,...s,children:e})};es.toString=()=>".nextui-modal-footer";let eo=r.memo(es);var el=(0,u.Z)(eo,{className:"",justify:"flex-end",autoMargin:!0});Y.Header=ee,Y.Body=ea,Y.Footer=el;var eu=Y},8327:function(e,t,n){"use strict";var r=n(7294),a=n(88),i=n(1309);t.Z=(0,a.Z)(({children:e,childrenRef:t,className:n,visible:a,enterTime:s,leaveTime:o,clearTime:l,name:u,onExited:h,onEntered:c,...d})=>{let[p,f]=(0,r.useState)(""),[m,g]=(0,r.useState)(a);return(0,r.useEffect)(()=>{let e=a?"enter":"leave",t=a?s:o;a&&!m&&g(!0),f(`${u}-${e}`);let n=setTimeout(()=>{f(`${u}-${e} ${u}-${e}-active`),"leave"===e?null==h||h():null==c||c(),clearTimeout(n)},t),r=setTimeout(()=>{a||(f(""),g(!1)),clearTimeout(r)},t+l);return()=>{clearTimeout(n),clearTimeout(r)}},[a,m]),(0,r.useEffect)(()=>{if(null==t||!t.current)return;let e=p.split(" "),n=t.current.className.split(" ").filter(e=>!e.includes(u));t.current.className=(0,i.Z)(n,e)},[t,p]),r.isValidElement(e)&&m?r.cloneElement(e,{...d,className:(0,i.Z)(e.props.className,n,null!=t&&t.current?"":p)}):null},{visible:!1,enterTime:60,leaveTime:60,clearTime:60,className:"",name:"transition"})},9327:function(e,t,n){"use strict";n.d(t,{Ue:function(){return F}});var r=n(7671),a=n(9720),i=n(4634),s=n(3780),o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},l=function(){return(l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function u(e,t,n,r){return new(n||(n=Promise))(function(a,i){function s(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?a(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,o)}l((r=r.apply(e,t||[])).next())})}function h(e,t){var n,r,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(n)throw TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){s.label=i[1];break}if(6===i[0]&&s.label<a[1]){s.label=a[1],a=i;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(i);break}a[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(o){i=[6,o],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}}function c(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function d(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(o){a={error:o}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return s}function p(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(d(arguments[t]));return e}var f=null;function m(e){return null==f&&(f=(0,r.y3$)().epsilon()),(0,r.lub)(function(){var t=(0,r.Gi7)(e),n=t.mean,a=t.variance;return(0,r.hiC)((0,r.luU)(e,n),(0,r.IHx)((0,r._b3)(a),f))})}var g=function(){function e(e){var t=this;if(null==e)throw Error("Required configuration object is missing for BrowserFftFeatureExtractor constructor");if(null==e.spectrogramCallback)throw Error("spectrogramCallback cannot be null or undefined");if(!(e.numFramesPerSpectrogram>0))throw Error("Invalid value in numFramesPerSpectrogram: "+e.numFramesPerSpectrogram);if(e.suppressionTimeMillis<0)throw Error("Expected suppressionTimeMillis to be >= 0, but got "+e.suppressionTimeMillis);if(this.suppressionTimeMillis=e.suppressionTimeMillis,this.spectrogramCallback=e.spectrogramCallback,this.numFrames=e.numFramesPerSpectrogram,this.sampleRateHz=e.sampleRateHz||44100,this.fftSize=e.fftSize||1024,this.frameDurationMillis=this.fftSize/this.sampleRateHz*1e3,this.columnTruncateLength=e.columnTruncateLength||this.fftSize,this.overlapFactor=e.overlapFactor,this.includeRawAudio=e.includeRawAudio,r.D5U.assert(this.overlapFactor>=0&&this.overlapFactor<1,function(){return"Expected overlapFactor to be >= 0 and < 1, but got "+t.overlapFactor}),this.columnTruncateLength>this.fftSize)throw Error("columnTruncateLength "+this.columnTruncateLength+" exceeds fftSize ("+this.fftSize+").");this.audioContextConstructor=window.AudioContext||window.webkitAudioContext}return e.prototype.start=function(e){return u(this,void 0,void 0,function(){var t,n,r;return h(this,function(a){switch(a.label){case 0:if(null!=this.frameIntervalTask)throw Error("Cannot start already-started BrowserFftFeatureExtractor");return t=this,[4,function(e){return u(this,void 0,void 0,function(){return h(this,function(t){return[2,navigator.mediaDevices.getUserMedia({audio:null==e||e,video:!1})]})})}(e)];case 1:return t.stream=a.sent(),this.audioContext=new this.audioContextConstructor({sampleRate:this.sampleRateHz}),n=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=0,n.connect(this.analyser),this.freqDataQueue=[],this.freqData=new Float32Array(this.fftSize),this.includeRawAudio&&(this.timeDataQueue=[],this.timeData=new Float32Array(this.fftSize)),r=Math.max(1,Math.round(this.numFrames*(1-this.overlapFactor))),this.tracker=new x(r,Math.round(this.suppressionTimeMillis/this.frameDurationMillis)),this.frameIntervalTask=setInterval(this.onAudioFrame.bind(this),this.fftSize/this.sampleRateHz*1e3),[2]}})})},e.prototype.onAudioFrame=function(){return u(this,void 0,void 0,function(){var e,t;return h(this,function(n){switch(n.label){case 0:return this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0?[2]:(this.freqDataQueue.push(this.freqData.slice(0,this.columnTruncateLength)),this.includeRawAudio&&(this.analyser.getFloatTimeDomainData(this.timeData),this.timeDataQueue.push(this.timeData.slice())),this.freqDataQueue.length>this.numFrames&&this.freqDataQueue.shift(),this.tracker.tick()?(e=b(y(this.freqDataQueue),[1,this.numFrames,this.columnTruncateLength,1]),t=void 0,this.includeRawAudio&&(t=b(y(this.timeDataQueue),[1,this.numFrames*this.fftSize])),[4,this.spectrogramCallback(e,t)]):[3,2]);case 1:n.sent()&&this.tracker.suppress(),(0,r.B90)([e,t]),n.label=2;case 2:return[2]}})})},e.prototype.stop=function(){return u(this,void 0,void 0,function(){return h(this,function(e){if(null==this.frameIntervalTask)throw Error("Cannot stop because there is no ongoing streaming activity.");return clearInterval(this.frameIntervalTask),this.frameIntervalTask=null,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop(),[2]})})},e.prototype.setConfig=function(e){throw Error("setConfig() is not implemented for BrowserFftFeatureExtractor.")},e.prototype.getFeatures=function(){throw Error("getFeatures() is not implemented for BrowserFftFeatureExtractor. Use the spectrogramCallback field of the constructor config instead.")},e}();function y(e){var t=e[0].length,n=new Float32Array(e.length*t);return e.forEach(function(e,r){return n.set(e,r*t)}),n}function b(e,t){var n=new Float32Array(r.D5U.sizeFromShape(t));return n.set(e,n.length-e.length),(0,r.XeE)(n,t)}var x=function(){function e(e,t){var n=this;this.period=e,this.suppressionTime=null==t?0:t,this.counter=0,r.D5U.assert(this.period>0,function(){return"Expected period to be positive, but got "+n.period})}return e.prototype.tick=function(){return this.counter++,this.counter%this.period==0&&(null==this.suppressionOnset||this.counter-this.suppressionOnset>this.suppressionTime)},e.prototype.suppress=function(){this.suppressionOnset=this.counter},e}();function v(e){var t=0;e.forEach(function(e){t+=e.byteLength});var n=new Uint8Array(t),r=0;return e.forEach(function(e){n.set(new Uint8Array(e),r),r+=e.byteLength}),n.buffer}function w(e){if(null==e)throw Error("Received null or undefind string");for(var t=unescape(encodeURIComponent(e)),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return n.buffer}function I(e){if(null==e)throw Error("Received null or undefind buffer");var t=new Uint8Array(e);return decodeURIComponent(escape(String.fromCharCode.apply(String,p(t))))}var k="TFJSSCDS",S="_background_noise_",C=function(){function e(e){if(this.examples={},this.label2Ids={},null!=e)for(var t,n,a,i,s=(r.D5U.assert(null!=e,function(){return"Received null or undefined buffer"}),t=0,n=I(e.slice(t,k.length)),r.D5U.assert(n===k,function(){return"Deserialization error: Invalid descriptor"}),t=k.length+4,a=new Uint32Array(e,t,1),t=(i=t+=4)+a[0],{manifest:JSON.parse(I(e.slice(i,t))),data:e.slice(t)}),o=0,l=0;l<s.manifest.length;++l){var u=s.manifest[l],h=u.spectrogramNumFrames*u.spectrogramFrameSize;null!=u.rawAudioNumSamples&&(h+=u.rawAudioNumSamples),h*=4,this.addExample(function(e){var t={frameSize:e.spec.spectrogramFrameSize,data:new Float32Array(e.data.slice(0,4*e.spec.spectrogramFrameSize*e.spec.spectrogramNumFrames))};null!=e.spec.spectrogramKeyFrameIndex&&(t.keyFrameIndex=e.spec.spectrogramKeyFrameIndex);var n={label:e.spec.label,spectrogram:t};return null!=e.spec.rawAudioNumSamples&&(n.rawAudio={sampleRateHz:e.spec.rawAudioSampleRateHz,data:new Float32Array(e.data.slice(4*e.spec.spectrogramFrameSize*e.spec.spectrogramNumFrames))}),n}({spec:u,data:s.data.slice(o,o+h)})),o+=h}}return e.prototype.addExample=function(e){r.D5U.assert(null!=e,function(){return"Got null or undefined example"}),r.D5U.assert(null!=e.label&&e.label.length>0,function(){return"Expected label to be a non-empty string, but got "+JSON.stringify(e.label)});var t=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}();return this.examples[t]=e,e.label in this.label2Ids||(this.label2Ids[e.label]=[]),this.label2Ids[e.label].push(t),t},e.prototype.merge=function(e){r.D5U.assert(e!==this,function(){return"Cannot merge a dataset into itself"});var t,n,a,i,s=e.getVocabulary();try{for(var o=c(s),l=o.next();!l.done;l=o.next()){var u=l.value,h=e.getExamples(u);try{for(var d=(a=void 0,c(h)),p=d.next();!p.done;p=d.next()){var f=p.value;this.addExample(f.example)}}catch(m){a={error:m}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(a)throw a.error}}}}catch(g){t={error:g}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},e.prototype.getExampleCounts=function(){var e={};for(var t in this.examples){var n=this.examples[t];n.label in e||(e[n.label]=0),e[n.label]++}return e},e.prototype.getExamples=function(e){var t=this;r.D5U.assert(null!=e,function(){return"Expected label to be a string, but got "+JSON.stringify(e)}),r.D5U.assert(e in this.label2Ids,function(){return'No example of label "'+e+'" exists in dataset'});var n=[];return this.label2Ids[e].forEach(function(e){n.push({uid:e,example:t.examples[e]})}),n},e.prototype.getData=function(e,t){var n=this;r.D5U.assert(this.size()>0,function(){return"Cannot get spectrograms as tensors because the dataset is empty"});var a=this.getVocabulary();null!=e?r.D5U.assert(-1!==a.indexOf(e),function(){return"Label "+e+" is not in the vocabulary ("+JSON.stringify(a)+")"}):r.D5U.assert(a.length>1,function(){return"One-hot encoding of labels requires the vocabulary to have at least two words, but it has only "+a.length+" word."}),null==t&&(t={});var s,o,l=this.getSortedUniqueNumFrames();1===l.length?(s=null==t.numFrames?l[0]:t.numFrames,o=null==t.hopFrames?1:t.hopFrames):(s=t.numFrames,r.D5U.assert(null!=s&&Number.isInteger(s)&&s>0,function(){return"There are "+l.length+" unique lengths among the "+n.size()+" examples of this Dataset, hence numFrames is required. But it is not provided."}),r.D5U.assert(s<=l[0],function(){return"numFrames ("+s+") exceeds the minimum numFrames ("+l[0]+") among the examples of the Dataset."}),o=t.hopFrames,r.D5U.assert(null!=o&&Number.isInteger(o)&&o>0,function(){return"There are "+l.length+" unique lengths among the "+n.size()+" examples of this Dataset, hence hopFrames is required. But it is not provided."}));var u=null==t.normalize||t.normalize;return(0,r.lub)(function(){for(var l,h,d,p=[],f=[],g=[],y=0;y<a.length;++y){var b=a[y];if(null==e||b===e){var x=n.label2Ids[b];try{for(var v=(l=void 0,c(x)),w=v.next();!w.done;w=v.next())(function(a){var i,l,h=n.examples[a].spectrogram,x=h.frameSize;null==d?d=x:r.D5U.assert(x===d,function(){return"Mismatch in frameSize  ("+x+" vs "+d+")"});var v=h.data.length/x,w=null;b!==S&&(w=null==h.keyFrameIndex?(function(e){return(0,r.lub)(function(){return(0,r.NqF)((0,r.lub)(function(){var t=e.data.length/e.frameSize,n=(0,r.odF)(e.data,[t,e.frameSize]);return(0,r.J69)(n,-1)}))})})(h).dataSync()[0]:h.keyFrameIndex);var I=(0,r.wOQ)(h.data,[v,x,1]),k=function(e,t,n,a){if(r.D5U.assert(Number.isInteger(e)&&e>0,function(){return"snippetLength must be a positive integer, but got "+e}),null!=t&&r.D5U.assert(Number.isInteger(t)&&t>=0,function(){return"focusIndex must be a non-negative integer, but got "+t}),r.D5U.assert(Number.isInteger(n)&&n>0,function(){return"windowLength must be a positive integer, but got "+n}),r.D5U.assert(Number.isInteger(a)&&a>0,function(){return"windowHop must be a positive integer, but got "+a}),r.D5U.assert(n<=e,function(){return"windowLength ("+n+") exceeds snippetLength ("+e+")"}),r.D5U.assert(t<e,function(){return"focusIndex ("+t+") equals or exceeds snippetLength ("+e+")"}),n===e)return[[0,e]];var i=[];if(null==t){for(var s=0;s+n<=e;)i.push([s,s+n]),s+=a;return i}var o=t-Math.floor(n/2);for(o<0?o=0:o+n>e&&(o=e-n);!(o-a<0||t>=o-a+n);)o-=a;for(;o+n<=e&&!(t<o);)i.push([o,o+n]),o+=a;return i}(v,w,s,o),C=function(n){var a=(0,r.lub)(function(){var e=(0,r.tPi)(I,[n[0],0,0],[n[1]-n[0],-1,-1]);return u?m(e):e});t.getDataset?f.push(a.dataSync()):p.push(a),null==e&&g.push(y)};try{for(var E=(i=void 0,c(k)),T=E.next();!T.done;T=E.next())C(T.value)}catch($){i={error:$}}finally{try{T&&!T.done&&(l=E.return)&&l.call(E)}finally{if(i)throw i.error}}(0,r.B90)(I)})(w.value)}catch(I){l={error:I}}finally{try{w&&!w.done&&(h=v.return)&&h.call(v)}finally{if(l)throw l.error}}}}null!=t.augmentByMixingNoiseRatio&&n.augmentByMixingNoise(t.getDataset?f:p,g,t.augmentByMixingNoiseRatio);var k=null==t.shuffle||t.shuffle;if(t.getDataset){var C=null==t.datasetBatchSize?32:t.datasetBatchSize,E=null==t.datasetValidationSplit?.15:t.datasetValidationSplit;r.D5U.assert(E>0&&E<1,function(){return"Invalid dataset validation split: "+E});var T=f.map(function(e,t){return[e,g[t]]});r.D5U.shuffle(T);var $=function(e,t,n){r.D5U.assert(n>0&&n<1,function(){return"validationSplit is expected to be >0 and <1, but got "+n});for(var a,i,s,o,l,u,h,d,p=!Array.isArray(e[0]),f=[],m=0;m<t.length;++m){var g=t[m];null==f[g]&&(f[g]=[]),f[g].push(m)}var y=f.length,b=[],x=[];for(f.map(function(e){return r.D5U.shuffle(e)}),m=0;m<y;++m)for(var v=f[m],w=Math.round(v.length*(1-n)),I=0;I<v.length;++I)I<w?b.push(v[I]):x.push(v[I]);if(p){var k=[],S=[],C=[],E=[];try{for(var T=c(b),$=T.next();!$.done;$=T.next()){var N=$.value;k.push(e[N]),S.push(t[N])}}catch(A){a={error:A}}finally{try{$&&!$.done&&(i=T.return)&&i.call(T)}finally{if(a)throw a.error}}try{for(var D=c(x),F=D.next();!F.done;F=D.next())N=F.value,C.push(e[N]),E.push(t[N])}catch(R){s={error:R}}finally{try{F&&!F.done&&(o=D.return)&&o.call(D)}finally{if(s)throw s.error}}return{trainXs:k,trainYs:S,valXs:C,valYs:E}}k=[],S=[],C=[],E=[];try{for(var _=c(b),O=_.next();!O.done;O=_.next())N=O.value,k.push(e[N]),S.push(t[N])}catch(M){l={error:M}}finally{try{O&&!O.done&&(u=_.return)&&u.call(_)}finally{if(l)throw l.error}}try{for(var B=c(x),P=B.next();!P.done;P=B.next())N=P.value,C.push(e[N]),E.push(t[N])}catch(L){h={error:L}}finally{try{P&&!P.done&&(d=B.return)&&d.call(B)}finally{if(h)throw h.error}}return{trainXs:k,trainYs:S,valXs:C,valYs:E}}(f=T.map(function(e){return e[0]}),T.map(function(e){return e[1]}),E),N=$.trainXs,A=$.trainYs,D=$.valXs,F=$.valYs,R=(0,i.IX)(N).map(function(e){return(0,r.wOQ)(e,[s,d,1])}),_=(0,i.IX)(A).map(function(e){return(0,r.L9e)((0,r.lfX)([e],a.length),[0])}),O=(0,i.$R)({xs:R,ys:_});k&&(O=O.shuffle(f.length)),O=O.batch(C).prefetch(4);var M=(0,i.IX)(D).map(function(e){return(0,r.wOQ)(e,[s,d,1])}),B=(0,i.IX)(F).map(function(e){return(0,r.L9e)((0,r.lfX)([e],a.length),[0])}),P=(0,i.$R)({xs:M,ys:B});return[O,P=P.batch(C).prefetch(4)]}if(k){var L=[];p.forEach(function(e,t){L.push({x:e,y:g[t]})}),r.D5U.shuffle(L),p=L.map(function(e){return e.x}),g=L.map(function(e){return e.y})}var U=null==e?(0,r.pju)((0,r.lfX)((0,r.RRF)(g,"int32"),a.length),"float32"):void 0;return{xs:(0,r.knu)(p),ys:U}})},e.prototype.augmentByMixingNoise=function(e,t,n){if(null==e||0===e.length)throw Error("Cannot perform augmentation because data is null or empty");for(var a,i,s=e[0]instanceof Float32Array,o=this.getVocabulary(),l=[],u=[],h=0;h<t.length;++h)o[t[h]]===S?l.push(h):u.push(h);if(0===l.length)throw Error("Cannot perform augmentation by mixing with noise when there is no example with label "+S);var d=[],f=[];try{for(var g=c(u),y=g.next();!y.done;y=g.next())(function(a){var i=l[Math.floor((l.length-0)*Math.random())+0],o=s?(0,r.RRF)(e[a]):e[a],u=s?(0,r.RRF)(e[i]):e[i],h=(0,r.lub)(function(){return m((0,r.IHx)(o,(0,r.dC7)(u,n)))});s?d.push(h.dataSync()):d.push(h),f.push(t[a])})(y.value)}catch(b){a={error:b}}finally{try{y&&!y.done&&(i=g.return)&&i.call(g)}finally{if(a)throw a.error}}console.log("Data augmentation: mixing noise: added "+d.length+" examples"),d.forEach(function(t){return e.push(t)}),t.push.apply(t,p(f))},e.prototype.getSortedUniqueNumFrames=function(){for(var e,t,n=new Set,r=this.getVocabulary(),a=0;a<r.length;++a){var i=r[a],s=this.label2Ids[i];try{for(var o=(e=void 0,c(s)),l=o.next();!l.done;l=o.next()){var u=l.value,h=this.examples[u].spectrogram,d=h.data.length/h.frameSize;n.add(d)}}catch(f){e={error:f}}finally{try{l&&!l.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}}var m=p(n);return m.sort(),m},e.prototype.removeExample=function(e){if(!(e in this.examples))throw Error("Nonexistent example UID: "+e);var t=this.examples[e].label;delete this.examples[e];var n=this.label2Ids[t].indexOf(e);this.label2Ids[t].splice(n,1),0===this.label2Ids[t].length&&delete this.label2Ids[t]},e.prototype.setExampleKeyFrameIndex=function(e,t){if(!(e in this.examples))throw Error("Nonexistent example UID: "+e);var n=this.examples[e].spectrogram,a=n.data.length/n.frameSize;r.D5U.assert(t>=0&&t<a&&Number.isInteger(t),function(){return"Invalid keyFrameIndex: "+t+". Must be >= 0, < "+a+", and an integer."}),n.keyFrameIndex=t},e.prototype.size=function(){return Object.keys(this.examples).length},e.prototype.durationMillis=function(){var e=0;for(var t in this.examples){var n=this.examples[t].spectrogram,r=23.22|n.frameDurationMillis;e+=n.data.length/n.frameSize*r}return e},e.prototype.empty=function(){return 0===this.size()},e.prototype.clear=function(){this.examples={}},e.prototype.getVocabulary=function(){var e=new Set;for(var t in this.examples){var n=this.examples[t];e.add(n.label)}var r=p(e);return r.sort(),r},e.prototype.serialize=function(e){var t,n,a,i,s,o,l,u,h,d=this.getVocabulary();r.D5U.assert(!this.empty(),function(){return"Cannot serialize empty Dataset"}),null!=e&&(Array.isArray(e)||(e=[e]),e.forEach(function(e){if(-1===d.indexOf(e))throw Error('Word label "'+e+'" does not exist in the vocabulary of this dataset. The vocabulary is: '+JSON.stringify(d)+".")}));var p=[],f=[];try{for(var m=c(d),g=m.next();!g.done;g=m.next()){var y=g.value;if(null==e||-1!==e.indexOf(y)){var b=this.label2Ids[y];try{for(var x=(u=void 0,c(b)),I=x.next();!I.done;I=x.next()){var S=I.value,C=function(e){var t=null!=e.rawAudio,n={label:e.label,spectrogramNumFrames:e.spectrogram.data.length/e.spectrogram.frameSize,spectrogramFrameSize:e.spectrogram.frameSize};null!=e.spectrogram.keyFrameIndex&&(n.spectrogramKeyFrameIndex=e.spectrogram.keyFrameIndex);var r=e.spectrogram.data.buffer.slice(0);return t&&(n.rawAudioNumSamples=e.rawAudio.data.length,n.rawAudioSampleRateHz=e.rawAudio.sampleRateHz,r=v([r,e.rawAudio.data.buffer])),{spec:n,data:r}}(this.examples[S]);p.push(C.spec),f.push(C.data)}}catch(E){u={error:E}}finally{try{I&&!I.done&&(h=x.return)&&h.call(x)}finally{if(u)throw u.error}}}}}catch(T){o={error:T}}finally{try{g&&!g.done&&(l=m.return)&&l.call(m)}finally{if(o)throw o.error}}return n=w(JSON.stringify((t={manifest:p,data:v(f)}).manifest)),a=w(k),i=new Uint32Array([1]),s=new Uint32Array([n.byteLength]),v([v([a,i.buffer,s.buffer]),n,t.data])},e}(),E="0.5.4",T="tfjs-speech-commands-saved-model-metadata",$={localStorage:"undefined"==typeof window?null:window.localStorage},N=function(){function e(t,n,a){this.MODEL_URL_PREFIX="https://storage.googleapis.com/tfjs-models/tfjs/speech-commands/v"+E.split(".").slice(0,2).join(".")+"/browser_fft",this.SAMPLE_RATE_HZ=44100,this.FFT_SIZE=1024,this.DEFAULT_SUPPRESSION_TIME_MILLIS=0,this.streaming=!1,this.transferRecognizers={},r.D5U.assert(null==n&&null==a||null!=n&&null!=a,function(){return"modelURL and metadataURL must be both provided or both not provided."}),null==n?(null==t?t=e.DEFAULT_VOCABULARY_NAME:r.D5U.assert(-1!==e.VALID_VOCABULARY_NAMES.indexOf(t),function(){return"Invalid vocabulary name: '"+t+"'"}),this.vocabulary=t,this.modelArtifactsOrURL=this.MODEL_URL_PREFIX+"/"+this.vocabulary+"/model.json",this.metadataOrURL=this.MODEL_URL_PREFIX+"/"+this.vocabulary+"/metadata.json"):(r.D5U.assert(null==t,function(){return"vocabulary name must be null or undefined when modelURL is provided"}),this.modelArtifactsOrURL=n,this.metadataOrURL=a),this.parameters={sampleRateHz:this.SAMPLE_RATE_HZ,fftSize:this.FFT_SIZE}}return e.prototype.listen=function(e,t){return u(this,void 0,void 0,function(){var n,a,i,s,o,l=this;return h(this,function(c){switch(c.label){case 0:if(this.streaming)throw Error("Cannot start streaming again when streaming is ongoing.");return[4,this.ensureModelLoaded()];case 1:if(c.sent(),null==t&&(t={}),n=null==t.probabilityThreshold?0:t.probabilityThreshold,t.includeEmbedding&&(n=0),r.D5U.assert(n>=0&&n<=1,function(){return"Invalid probabilityThreshold value: "+n}),a=null!=t.invokeCallbackOnNoiseAndUnknown&&t.invokeCallbackOnNoiseAndUnknown,t.includeEmbedding&&(a=!0),t.suppressionTimeMillis<0)throw Error("suppressionTimeMillis is expected to be >= 0, but got "+t.suppressionTimeMillis);return i=null==t.overlapFactor?.5:t.overlapFactor,r.D5U.assert(i>=0&&i<1,function(){return"Expected overlapFactor to be >= 0 and < 1, but got "+i}),s=function(i,s){return u(l,void 0,void 0,function(){var s,o,l,u,c,f,g,y,b,x,v;return h(this,function(h){switch(h.label){case 0:return s=m(i),t.includeEmbedding?[4,this.ensureModelWithEmbeddingOutputCreated()]:[3,2];case 1:return h.sent(),o=(v=d(this.modelWithEmbeddingOutput.predict(s),2))[0],l=v[1],[3,3];case 2:o=this.model.predict(s),h.label=3;case 3:return[4,o.data()];case 4:return u=h.sent(),[4,(c=o.argMax(-1)).data()];case 5:return f=h.sent()[0],g=Math.max.apply(Math,p(u)),(0,r.B90)([o,c,s]),g<n?[2,!1]:[3,6];case 6:return y=void 0,t.includeSpectrogram?(b={},[4,i.data()]):[3,8];case 7:b.data=h.sent(),b.frameSize=this.nonBatchInputShape[1],y=b,h.label=8;case 8:return x=!0,a||this.words[f]!==S&&"_unknown_"!==this.words[f]||(x=!1),x&&e({scores:u,spectrogram:y,embedding:l}),[2,x]}})})},o=null==t.suppressionTimeMillis?this.DEFAULT_SUPPRESSION_TIME_MILLIS:t.suppressionTimeMillis,this.audioDataExtractor=new g({sampleRateHz:this.parameters.sampleRateHz,numFramesPerSpectrogram:this.nonBatchInputShape[0],columnTruncateLength:this.nonBatchInputShape[1],suppressionTimeMillis:o,spectrogramCallback:s,overlapFactor:i}),[4,this.audioDataExtractor.start(t.audioTrackConstraints)];case 2:return c.sent(),this.streaming=!0,[2]}})})},e.prototype.ensureModelLoaded=function(){return u(this,void 0,void 0,function(){var e,t,n,a,i=this;return h(this,function(o){switch(o.label){case 0:return null!=this.model?[2]:[4,this.ensureMetadataLoaded()];case 1:return o.sent(),"string"!=typeof this.modelArtifactsOrURL?[3,3]:[4,(0,s.FB)(this.modelArtifactsOrURL)];case 2:return e=o.sent(),[3,5];case 3:return[4,(0,s.FB)(r.io.fromMemory(this.modelArtifactsOrURL.modelTopology,this.modelArtifactsOrURL.weightSpecs,this.modelArtifactsOrURL.weightData))];case 4:e=o.sent(),o.label=5;case 5:if(1!==e.inputs.length)throw Error("Expected model to have 1 input, but got a model with "+e.inputs.length+" inputs");if(4!==e.inputs[0].shape.length)throw Error("Expected model to have an input shape of rank 4, but got an input shape of rank "+e.inputs[0].shape.length);if(1!==e.inputs[0].shape[3])throw Error("Expected model to have an input shape with 1 as the last dimension, but got input shape"+JSON.stringify(e.inputs[0].shape[3])+"}");if(2!==(t=e.outputShape).length)throw Error("Expected loaded model to have an output shape of rank 2,but received shape "+JSON.stringify(t));if(t[1]!==this.words.length)throw Error("Mismatch between the last dimension of model's output shape ("+t[1]+") and number of words ("+this.words.length+").");return this.model=e,this.freezeModel(),this.nonBatchInputShape=e.inputs[0].shape.slice(1),this.elementsPerExample=1,e.inputs[0].shape.slice(1).forEach(function(e){return i.elementsPerExample*=e}),this.warmUpModel(),n=this.parameters.fftSize/this.parameters.sampleRateHz*1e3,a=e.inputs[0].shape[1],this.parameters.spectrogramDurationMillis=a*n,[2]}})})},e.prototype.ensureModelWithEmbeddingOutputCreated=function(){return u(this,void 0,void 0,function(){var e,t;return h(this,function(n){switch(n.label){case 0:return null!=this.modelWithEmbeddingOutput?[2]:[4,this.ensureModelLoaded()];case 1:for(n.sent(),t=this.model.layers.length-2;t>=0;--t)if("Dense"===this.model.layers[t].getClassName()){e=this.model.layers[t];break}if(null==e)throw Error("Failed to find second last dense layer in the original model.");return this.modelWithEmbeddingOutput=(0,s.o4)({inputs:this.model.inputs,outputs:[this.model.outputs[0],e.output]}),[2]}})})},e.prototype.warmUpModel=function(){var e=this;(0,r.lub)(function(){for(var t=(0,r.lls)([1].concat(e.nonBatchInputShape)),n=0;n<3;++n)e.model.predict(t)})},e.prototype.ensureMetadataLoaded=function(){return u(this,void 0,void 0,function(){var e,t,r;return h(this,function(i){switch(i.label){case 0:return null!=this.words?[2]:"string"!=typeof this.metadataOrURL?[3,2]:[4,function(e){return u(this,void 0,void 0,function(){var t,r,i,s,o;return h(this,function(l){switch(l.label){case 0:return t="file://",0!==e.indexOf("http://")&&0!==e.indexOf("https://")?[3,3]:[4,fetch(e)];case 1:return[4,l.sent().json()];case 2:return[2,l.sent()];case 3:return 0!==e.indexOf(t)?[3,5]:(r=n(9127),i=(0,a.promisify)(r.readFile),o=(s=JSON).parse,[4,i(e.slice(t.length),{encoding:"utf-8"})]);case 4:return[2,o.apply(s,[l.sent()])];case 5:throw Error("Unsupported URL scheme in metadata URL: "+e+". Supported schemes are: http://, https://, and (node.js-only) file://")}})})}(this.metadataOrURL)];case 1:return t=i.sent(),[3,3];case 2:t=this.metadataOrURL,i.label=3;case 3:if(null==(e=t).wordLabels){if(null==(r=e.words))throw Error('Cannot find field "words" or "wordLabels" in metadata JSON file');this.words=r}else this.words=e.wordLabels;return[2]}})})},e.prototype.stopListening=function(){return u(this,void 0,void 0,function(){return h(this,function(e){switch(e.label){case 0:if(!this.streaming)throw Error("Cannot stop streaming when streaming is not ongoing.");return[4,this.audioDataExtractor.stop()];case 1:return e.sent(),this.streaming=!1,[2]}})})},e.prototype.isListening=function(){return this.streaming},e.prototype.wordLabels=function(){return this.words},e.prototype.params=function(){return this.parameters},e.prototype.modelInputShape=function(){if(null==this.model)throw Error("Model has not been loaded yet. Load model by calling ensureModelLoaded(), recognize(), or listen().");return this.model.inputs[0].shape},e.prototype.recognize=function(e,t){return u(this,void 0,void 0,function(){var n,a,i,s,o,l,u,c,d,p,f,m;return h(this,function(h){switch(h.label){case 0:return null==t&&(t={}),[4,this.ensureModelLoaded()];case 1:return h.sent(),null!=e?[3,3]:[4,this.recognizeOnline()];case 2:e=h.sent().data,h.label=3;case 3:if(e instanceof r.esB)this.checkInputTensorShape(e),a=e,n=e.shape[0];else{if(e.length%this.elementsPerExample)throw Error("The length of the input Float32Array "+e.length+" is not divisible by the number of tensor elements per per example expected by the model "+this.elementsPerExample+".");n=e.length/this.elementsPerExample,a=(0,r.yXz)(e,[n].concat(this.nonBatchInputShape))}return s={scores:null},t.includeEmbedding?[4,this.ensureModelWithEmbeddingOutputCreated()]:[3,5];case 4:return h.sent(),i=(o=this.modelWithEmbeddingOutput.predict(a))[0],s.embedding=o[1],[3,6];case 5:i=this.model.predict(a),h.label=6;case 6:return 1!==n?[3,8]:(l=s,[4,i.data()]);case 7:return l.scores=h.sent(),[3,10];case 8:return c=(u=(0,r.HHK)(i)).map(function(e){return e.data()}),d=s,[4,Promise.all(c)];case 9:d.scores=h.sent(),(0,r.B90)(u),h.label=10;case 10:return t.includeSpectrogram?(p=s,f={},e instanceof r.esB?[4,e.data()]:[3,12]):[3,14];case 11:return m=h.sent(),[3,13];case 12:m=e,h.label=13;case 13:p.spectrogram=(f.data=m,f.frameSize=this.nonBatchInputShape[1],f),h.label=14;case 14:return(0,r.B90)(i),[2,s]}})})},e.prototype.recognizeOnline=function(){return u(this,void 0,void 0,function(){var e=this;return h(this,function(t){return[2,new Promise(function(t,n){e.audioDataExtractor=new g({sampleRateHz:e.parameters.sampleRateHz,numFramesPerSpectrogram:e.nonBatchInputShape[0],columnTruncateLength:e.nonBatchInputShape[1],suppressionTimeMillis:0,spectrogramCallback:function(n){return u(e,void 0,void 0,function(){var e,r,a;return h(this,function(i){switch(i.label){case 0:return e=m(n),[4,this.audioDataExtractor.stop()];case 1:return i.sent(),r=t,a={},[4,e.data()];case 2:return r.apply(void 0,[(a.data=i.sent(),a.frameSize=this.nonBatchInputShape[1],a)]),e.dispose(),[2,!1]}})})},overlapFactor:0}),e.audioDataExtractor.start()})]})})},e.prototype.createTransfer=function(e){if(null==this.model)throw Error("Model has not been loaded yet. Load model by calling ensureModelLoaded(), recognizer(), or listen().");r.D5U.assert(null!=e&&"string"==typeof e&&e.length>1,function(){return"Expected the name for a transfer-learning recognized to be a non-empty string, but got "+JSON.stringify(e)}),r.D5U.assert(null==this.transferRecognizers[e],function(){return"There is already a transfer-learning model named '"+e+"'"});var t=new A(e,this.parameters,this.model);return this.transferRecognizers[e]=t,t},e.prototype.freezeModel=function(){var e,t;try{for(var n=c(this.model.layers),r=n.next();!r.done;r=n.next())r.value.trainable=!1}catch(a){e={error:a}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e.prototype.checkInputTensorShape=function(e){var t=this.model.inputs[0].shape.length;if(e.shape.length!==t)throw Error("Expected input Tensor to have rank "+t+", but got rank "+e.shape.length+" that differs ");var n=e.shape.slice(1),a=this.model.inputs[0].shape.slice(1);if(!r.D5U.arraysEqual(n,a))throw Error("Expected input to have shape [null,"+a+"], but got shape [null,"+n+"]")},e.VALID_VOCABULARY_NAMES=["18w","directional4w"],e.DEFAULT_VOCABULARY_NAME="18w",e}(),A=function(e){function t(t,n,a){var i=e.call(this)||this;return i.name=t,i.parameters=n,i.baseModel=a,r.D5U.assert(null!=t&&"string"==typeof t&&t.length>0,function(){return"The name of a transfer model must be a non-empty string, but got "+JSON.stringify(t)}),i.nonBatchInputShape=i.baseModel.inputs[0].shape.slice(1),i.words=null,i.dataset=new C,i}return function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.collectExample=function(e,t){return u(this,void 0,void 0,function(){var n,a,i,s=this;return h(this,function(o){if(r.D5U.assert(!this.streaming,function(){return"Cannot start collection of transfer-learning example because a streaming recognition or transfer-learning example collection is ongoing"}),r.D5U.assert(null!=e&&"string"==typeof e&&e.length>0,function(){return"Must provide a non-empty string when collecting transfer-learning example"}),null==t&&(t={}),null!=t.durationMultiplier&&null!=t.durationSec)throw Error("durationMultiplier and durationSec are mutually exclusive, but are both specified.");return null!=t.durationSec?(r.D5U.assert(t.durationSec>0,function(){return"Expected durationSec to be > 0, but got "+t.durationSec}),a=this.parameters.fftSize/this.parameters.sampleRateHz,n=Math.ceil(t.durationSec/a)):null!=t.durationMultiplier?(r.D5U.assert(t.durationMultiplier>=1,function(){return"Expected duration multiplier to be >= 1, but got "+t.durationMultiplier}),n=Math.round(this.nonBatchInputShape[0]*t.durationMultiplier)):n=this.nonBatchInputShape[0],null!=t.snippetDurationSec&&(r.D5U.assert(t.snippetDurationSec>0,function(){return"snippetDurationSec is expected to be > 0, but got "+t.snippetDurationSec}),r.D5U.assert(null!=t.onSnippet,function(){return"onSnippet must be provided if snippetDurationSec is provided."})),null!=t.onSnippet&&r.D5U.assert(null!=t.snippetDurationSec,function(){return"snippetDurationSec must be provided if onSnippet is provided."}),i=this.parameters.fftSize/this.parameters.sampleRateHz*n,this.streaming=!0,[2,new Promise(function(a){var o=null==t.snippetDurationSec?1:t.snippetDurationSec/i,l=Math.round(1/o),c=0,d=-1,p=[];s.audioDataExtractor=new g({sampleRateHz:s.parameters.sampleRateHz,numFramesPerSpectrogram:n,columnTruncateLength:s.nonBatchInputShape[1],suppressionTimeMillis:0,spectrogramCallback:function(n,i){return u(s,void 0,void 0,function(){var s,o,u,g,y,b,x,v,w,I,k,S,C,E,T,$,N,A,D;return h(this,function(h){switch(h.label){case 0:return null!=t.onSnippet?[3,7]:(s=m(n),u=(o=this.dataset).addExample,g={label:e},y={},[4,s.data()]);case 1:return g.spectrogram=(y.data=h.sent(),y.frameSize=this.nonBatchInputShape[1],y),t.includeRawAudio?(x={},[4,i.data()]):[3,3];case 2:return x.data=h.sent(),x.sampleRateHz=this.audioDataExtractor.sampleRateHz,b=x,[3,4];case 3:b=void 0,h.label=4;case 4:return u.apply(o,[(g.rawAudio=b,g)]),s.dispose(),[4,this.audioDataExtractor.stop()];case 5:return h.sent(),this.streaming=!1,this.collateTransferWords(),v=a,w={},[4,n.data()];case 6:return v.apply(void 0,[(w.data=h.sent(),w.frameSize=this.nonBatchInputShape[1],w)]),[3,13];case 7:return[4,n.data()];case 8:for(I=h.sent(),-1===d&&(d=I.length),k=d-1;0!==I[k]&&k>=0;)k--;return S=d-k-1,d=k+1,C=I.slice(I.length-S,I.length),p.push(C),null!=t.onSnippet&&t.onSnippet({data:C,frameSize:this.nonBatchInputShape[1]}),c++!==l?[3,13]:[4,this.audioDataExtractor.stop()];case 9:return h.sent(),this.streaming=!1,this.collateTransferWords(),E={data:function(e){if(e.length<2)throw Error("Cannot normalize a Float32Array with fewer than 2 elements.");return null==f&&(f=(0,r.y3$)().epsilon()),(0,r.lub)(function(){var t=(0,r.Gi7)((0,r.RRF)(e)),n=t.mean,a=t.variance,i=n.arraySync(),s=Math.sqrt(a.arraySync()),o=Array.from(e).map(function(e){return(e-i)/(s+f)});return new Float32Array(o)})}(function(e){var t=0;e.forEach(function(e){return t+=e.length});var n=new Float32Array(t),r=0;return e.forEach(function(e){n.set(e,r),r+=e.length}),n}(p)),frameSize:this.nonBatchInputShape[1]},$=(T=this.dataset).addExample,N={label:e,spectrogram:E},t.includeRawAudio?(D={},[4,i.data()]):[3,11];case 10:return D.data=h.sent(),D.sampleRateHz=this.audioDataExtractor.sampleRateHz,A=D,[3,12];case 11:A=void 0,h.label=12;case 12:$.apply(T,[(N.rawAudio=A,N)]),a(E),h.label=13;case 13:return[2,!1]}})})},overlapFactor:1-o,includeRawAudio:t.includeRawAudio}),s.audioDataExtractor.start(t.audioTrackConstraints)})]})})},t.prototype.clearExamples=function(){var e=this;r.D5U.assert(null!=this.words&&this.words.length>0&&!this.dataset.empty(),function(){return"No transfer learning examples exist for model name "+e.name}),this.dataset.clear(),this.words=null},t.prototype.countExamples=function(){if(this.dataset.empty())throw Error("No examples have been collected for transfer-learning model named '"+this.name+"' yet.");return this.dataset.getExampleCounts()},t.prototype.getExamples=function(e){return this.dataset.getExamples(e)},t.prototype.setExampleKeyFrameIndex=function(e,t){this.dataset.setExampleKeyFrameIndex(e,t)},t.prototype.removeExample=function(e){this.dataset.removeExample(e),this.collateTransferWords()},t.prototype.isDatasetEmpty=function(){return this.dataset.empty()},t.prototype.loadExamples=function(e,t){void 0===t&&(t=!1);var n,r,a,i,s=new C(e);t&&this.clearExamples();var o=s.getVocabulary();try{for(var l=c(o),u=l.next();!u.done;u=l.next()){var h=u.value,d=s.getExamples(h);try{for(var p=(a=void 0,c(d)),f=p.next();!f.done;f=p.next()){var m=f.value;this.dataset.addExample(m.example)}}catch(g){a={error:g}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(a)throw a.error}}}}catch(y){n={error:y}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}this.collateTransferWords()},t.prototype.serializeExamples=function(e){return this.dataset.serialize(e)},t.prototype.collateTransferWords=function(){this.words=this.dataset.getVocabulary()},t.prototype.collectTransferDataAsTensors=function(e,t){var n=this.nonBatchInputShape[0],r=Math.round((e=e||.25)*n),a=this.dataset.getData(null,l({numFrames:n,hopFrames:r},t));return{xs:a.xs,ys:a.ys}},t.prototype.collectTransferDataAsTfDataset=function(e,t,n,r){void 0===t&&(t=.15),void 0===n&&(n=32);var a=this.nonBatchInputShape[0],i=Math.round((e=e||.25)*a);return this.dataset.getData(null,l({numFrames:a,hopFrames:i,getDataset:!0,datasetBatchSize:n,datasetValidationSplit:t},r))},t.prototype.train=function(e){return u(this,void 0,void 0,function(){var t,n=this;return h(this,function(a){return r.D5U.assert(null!=this.words&&this.words.length>0,function(){return"Cannot train transfer-learning model '"+n.name+"' because no transfer learning example has been collected."}),r.D5U.assert(this.words.length>1,function(){return"Cannot train transfer-learning model '"+n.name+"' because only 1 word label ('"+JSON.stringify(n.words)+"') has been collected for transfer learning. Requires at least 2."}),null!=e.fineTuningEpochs&&r.D5U.assert(e.fineTuningEpochs>=0&&Number.isInteger(e.fineTuningEpochs),function(){return"If specified, fineTuningEpochs must be a non-negative integer, but received "+e.fineTuningEpochs}),null==e&&(e={}),null==this.model&&this.createTransferModelFromBaseModel(),this.secondLastBaseDenseLayer.trainable=!1,this.model.compile({loss:"categoricalCrossentropy",optimizer:e.optimizer||"sgd",metrics:["acc"]}),t=null==e.fitDatasetDurationMillisThreshold?6e4:e.fitDatasetDurationMillisThreshold,this.dataset.durationMillis()>t?(console.log("Detected large dataset: total duration = "+this.dataset.durationMillis()+" ms > "+t+" ms. Training transfer model using fitDataset() instead of fit()"),[2,this.trainOnDataset(e)]):[2,this.trainOnTensors(e)]})})},t.prototype.trainOnDataset=function(e){return u(this,void 0,void 0,function(){var t,n,a,i,s,o,l,u,c;return h(this,function(h){switch(h.label){case 0:return r.D5U.assert(e.epochs>0,function(){return"Invalid config.epochs"}),t=null==e.batchSize?32:e.batchSize,n=e.windowHopRatio||.25,i=(a=d(this.collectTransferDataAsTfDataset(n,e.validationSplit,t,{augmentByMixingNoiseRatio:e.augmentByMixingNoiseRatio}),2))[0],s=a[1],o=r.D5U.now(),[4,this.model.fitDataset(i,{epochs:e.epochs,validationData:e.validationSplit>0?s:null,callbacks:null==e.callback?null:[e.callback]})];case 1:return l=h.sent(),console.log("fitDataset() took "+(r.D5U.now()-o).toFixed(2)+" ms"),null!=e.fineTuningEpochs&&e.fineTuningEpochs>0?(u=r.D5U.now(),[4,this.fineTuningUsingTfDatasets(e,i,s)]):[3,3];case 2:return c=h.sent(),console.log("fitDataset() (fine-tuning) took "+(r.D5U.now()-u).toFixed(2)+" ms"),[2,[l,c]];case 3:return[2,l]}})})},t.prototype.trainOnTensors=function(e){return u(this,void 0,void 0,function(){var t,n,a,i,s,o,l,u,c;return h(this,function(h){switch(h.label){case 0:t=e.windowHopRatio||.25,a=(n=this.collectTransferDataAsTensors(t,{augmentByMixingNoiseRatio:e.augmentByMixingNoiseRatio})).xs,i=n.ys,console.log("Training data: xs.shape = "+a.shape+", ys.shape = "+i.shape),h.label=1;case 1:var d,p,f;return h.trys.push([1,,6,7]),null!=e.validationSplit?(d=a,p=i,f=e.validationSplit,r.D5U.assert(f>0&&f<1,function(){return"validationSplit is expected to be >0 and <1, but got "+f}),s=(u=(0,r.lub)(function(){for(var e=(0,r.NqF)(p,-1).dataSync(),t=[],n=0;n<e.length;++n){var a=e[n];null==t[a]&&(t[a]=[]),t[a].push(n)}var i=t.length,s=[],o=[];for(t.map(function(e){return r.D5U.shuffle(e)}),n=0;n<i;++n)for(var l=t[n],u=Math.round(l.length*(1-f)),h=0;h<l.length;++h)h<u?s.push(l[h]):o.push(l[h]);return{trainXs:(0,r.Iqj)(d,s),trainYs:(0,r.Iqj)(p,s),valXs:(0,r.Iqj)(d,o),valYs:(0,r.Iqj)(p,o)}})).trainXs,o=u.trainYs,l=[u.valXs,u.valYs]):(s=a,o=i),[4,this.model.fit(s,o,{epochs:null==e.epochs?20:e.epochs,validationData:l,batchSize:e.batchSize,callbacks:null==e.callback?null:[e.callback]})];case 2:return c=h.sent(),null!=e.fineTuningEpochs&&e.fineTuningEpochs>0?[4,this.fineTuningUsingTensors(e,s,o,l)]:[3,4];case 3:return[2,[c,h.sent()]];case 4:return[2,c];case 5:return[3,7];case 6:return(0,r.B90)([a,i,s,o,l]),[7];case 7:return[2]}})})},t.prototype.fineTuningUsingTfDatasets=function(e,t,n){return u(this,void 0,void 0,function(){var r,a,i;return h(this,function(s){switch(s.label){case 0:return r=this.secondLastBaseDenseLayer.trainable,this.secondLastBaseDenseLayer.trainable=!0,a=null==e.fineTuningOptimizer?"sgd":e.fineTuningOptimizer,this.model.compile({loss:"categoricalCrossentropy",optimizer:a,metrics:["acc"]}),[4,this.model.fitDataset(t,{epochs:e.fineTuningEpochs,validationData:n,callbacks:null==e.callback?null:[e.callback]})];case 1:return i=s.sent(),this.secondLastBaseDenseLayer.trainable=r,[2,i]}})})},t.prototype.fineTuningUsingTensors=function(e,t,n,r){return u(this,void 0,void 0,function(){var a,i,s;return h(this,function(o){switch(o.label){case 0:return a=this.secondLastBaseDenseLayer.trainable,this.secondLastBaseDenseLayer.trainable=!0,i=null==e.fineTuningOptimizer?"sgd":e.fineTuningOptimizer,this.model.compile({loss:"categoricalCrossentropy",optimizer:i,metrics:["acc"]}),[4,this.model.fit(t,n,{epochs:e.fineTuningEpochs,validationData:r,batchSize:e.batchSize,callbacks:null==e.fineTuningCallback?null:[e.fineTuningCallback]})];case 1:return s=o.sent(),this.secondLastBaseDenseLayer.trainable=a,[2,s]}})})},t.prototype.evaluate=function(e){return u(this,void 0,void 0,function(){var t=this;return h(this,function(n){return r.D5U.assert(null!=e.wordProbThresholds&&e.wordProbThresholds.length>0,function(){return"Received null or empty wordProbThresholds"}),r.D5U.assert(this.words[0]===S,function(){return"Cannot perform evaluation when the first tag is not "+S}),[2,(0,r.lub)(function(){for(var n=[],a=0,i=t.collectTransferDataAsTensors(e.windowHopRatio),s=i.xs,o=i.ys.argMax(-1).dataSync(),l=t.model.predict(s),u=(0,r.Fp7)((0,r.tPi)(l,[0,1],[l.shape[0],l.shape[1]-1]),-1),h=l.shape[0],c=0;c<e.wordProbThresholds.length;++c){for(var d=e.wordProbThresholds[c],p=u.greater((0,r.iD$)(d)).dataSync(),f=0,m=0,g=0,y=0,b=0;b<h;++b)0===o[b]?(f++,p[b]&&g++):(m++,p[b]&&y++);var x=g/f,v=y/m;n.push({probThreshold:d,fpr:x,tpr:v}),console.log("ROC thresh="+d+": fpr="+x.toFixed(4)+", tpr="+v.toFixed(4)),c>0&&(a+=Math.abs(n[c-1].fpr-n[c].fpr)*(n[c-1].tpr+n[c].tpr)/2)}return{rocCurve:n,auc:a}})]})})},t.prototype.createTransferModelFromBaseModel=function(){var e=this;r.D5U.assert(null!=this.words,function(){return"No word example is available for tranfer-learning model of name "+e.name});for(var t=this.baseModel.layers,n=t.length-2;n>=0&&"dense"!==t[n].getClassName().toLowerCase();)n--;if(n<0)throw Error("Cannot find a hidden dense layer in the base model.");this.secondLastBaseDenseLayer=t[n];var a=this.secondLastBaseDenseLayer.output;this.transferHead=(0,s.Pe)(),this.transferHead.add(s.ug.dense({units:this.words.length,activation:"softmax",inputShape:a.shape.slice(1),name:"NewHeadDense"}));var i=this.transferHead.apply(a);this.model=(0,s.o4)({inputs:this.baseModel.inputs,outputs:i})},t.prototype.modelInputShape=function(){return this.baseModel.inputs[0].shape},t.prototype.getMetadata=function(){return{tfjsSpeechCommandsVersion:E,modelName:this.name,timeStamp:(new Date).toISOString(),wordLabels:this.wordLabels()}},t.prototype.save=function(e){return u(this,void 0,void 0,function(){var t,n,r;return h(this,function(a){return t=null!=e,e=e||D(this.name),t||((r=null==(n=$.localStorage.getItem(T))?{}:JSON.parse(n))[this.name]=this.getMetadata(),$.localStorage.setItem(T,JSON.stringify(r))),console.log("Saving model to "+e),[2,this.model.save(e)]})})},t.prototype.load=function(e){return u(this,void 0,void 0,function(){var t,n,r;return h(this,function(a){switch(a.label){case 0:if(t=null!=e,e=e||D(this.name),!t){if(null==(n=JSON.parse($.localStorage.getItem(T)))||null==n[this.name])throw Error("Cannot find metadata for transfer model named "+this.name+'"');this.words=n[this.name].wordLabels,console.log("Loaded word list for model named "+this.name+": "+this.words)}return r=this,[4,(0,s.FB)(e)];case 1:return r.model=a.sent(),console.log("Loaded model from "+e+":"),this.model.summary(),[2]}})})},t.prototype.createTransfer=function(e){throw Error("Creating transfer-learned recognizer from a transfer-learned recognizer is not supported.")},t}(N);function D(e){return"indexeddb://tfjs-speech-commands-model/"+e}function F(e,t,n,a){if(r.D5U.assert(null==n&&null==a||null!=n&&null!=a,function(){return"customModelURL and customMetadataURL must be both provided or both not provided."}),null!=n&&r.D5U.assert(null==t,function(){return"vocabulary name must be null or undefined when modelURL is provided."}),"BROWSER_FFT"===e)return new N(t,n,a);throw"SOFT_FFT"===e?Error("SOFT_FFT SpeechCommandRecognizer has not been implemented yet."):Error("Invalid fftType: '"+e+"'")}},9610:function(e,t,n){"use strict";n.d(t,{A:function(){return a}});var r=n(7671);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function a(){let e,t,n,a,i,s,o,l,u,h;return 2===(0,r.OBj)().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",a="in",i="texture",s="outputColor",o="out vec4 outputColor;",l=(0,r.OBj)().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",u="",h=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",a="varying",i="texture2D",s="gl_FragColor",o="",l=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,h=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:a,texture2D:i,output:s,defineOutput:o,defineSpecialNaN:l,defineSpecialInf:u,defineRound:h}}},8110:function(e,t,n){"use strict";n.d(t,{Kn:function(){return i},RW:function(){return a},al:function(){return s},ku:function(){return o},nc:function(){return l},ye:function(){return u}});var r=n(7671);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function a(e,t,n="index"){let a=r.D5U.computeStrides(t);return a.map((t,r)=>{let i=`int ${e[r]} = ${n} / ${t}`,s=r===a.length-1?`int ${e[r+1]} = ${n} - ${e[r]} * ${t}`:`index -= ${e[r]} * ${t}`;return`${i}; ${s};`}).join("")}function i(e,t,n="index"){let a=r.D5U.computeStrides(t);return a.map((t,r)=>{let i=`int ${e[r]} = ${n} / outShapeStrides[${r}]`,s=r===a.length-1?`int ${e[r+1]} = ${n} - ${e[r]} * outShapeStrides[${r}]`:`index -= ${e[r]} * outShapeStrides[${r}]`;return`${i}; ${s};`}).join("")}function s(e,t,n="index"){let r=e.map((e,t)=>t),a=function(e,t){let n=e.length,r=e.map(e=>`${t}[${e}]`),a=Array(n-1);a[n-2]=r[n-1];for(let i=n-3;i>=0;--i)a[i]=`(${a[i+1]} * ${r[i+1]})`;return a}(r,t);return a.map((t,r)=>{let i=`int ${e[r]} = ${n} / ${a[r]}`,s=r===a.length-1?`int ${e[r+1]} = ${n} - ${e[r]} * ${a[r]}`:`index -= ${e[r]} * ${a[r]}`;return`${i}; ${s};`}).join("")}function o(e){let t=r.D5U.computeStrides(e).map(e=>e.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}function l(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}let u=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`},8713:function(e,t,n){"use strict";n.d(t,{JL:function(){return r},Zu:function(){return a}});class r{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class a{refCount(e){return i("refCount")}incRef(e){return i("incRef")}timerAvailable(){return!0}time(e){return i("time")}read(e){return i("read")}readSync(e){return i("readSync")}readToGPU(e,t){return i("readToGPU")}numDataIds(){return i("numDataIds")}disposeData(e,t){return i("disposeData")}write(e,t,n){return i("write")}move(e,t,n,r,a){return i("move")}memory(){return i("memory")}floatPrecision(){return i("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return i("dispose")}}function i(e){throw Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}},196:function(e,t,n){"use strict";n.d(t,{BV:function(){return x},wv:function(){return b}});var r=n(8713),a=n(2885),i=n(5938),s=n(9121),o=n(6151),l=n(4706),u=n(3418),h=n(569);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class c{constructor(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new d)}profileKernel(e,t,n){let r,i;let s=()=>{r=n()},o=u.now();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(s);else{for(let l of(s(),r))l.dataSync();i=Promise.resolve({kernelMs:u.now()-o})}if((0,a.OB)().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let h=0;h<r.length;h++){let c=r[h];c.data().then(t=>{!function(e,t,n){if("float32"===t)for(let r=0;r<e.length;r++){let a=e[r];if(isNaN(a)||!isFinite(a))return console.warn(`Found ${a} in the result of '${n}'`),!0}}(t,c.dtype,e)})}let d={kernelName:e,outputs:r,inputs:t,timeMs:i.then(e=>e.kernelMs),extraInfo:i.then(e=>null!=e.getExtraProfileInfo?e.getExtraProfileInfo():"")};return d}logKernelProfile(e){let{kernelName:t,outputs:n,timeMs:r,inputs:a,extraInfo:i}=e;n.forEach(e=>{Promise.all([e.data(),r,i]).then(n=>{this.logger.logKernelProfile(t,e,n[0],n[1],a,n[2])})})}}class d{logKernelProfile(e,t,n,r,a,i){let s="number"==typeof r?h.oj(`${r}ms`,9):r.error,o=h.oj(e,25),l=t.rank,u=t.size,c=h.oj(t.shape.toString(),14),d="";for(let p in a){let f=a[p];if(null!=f){let m=f.shape||t.shape,g=m.length;d+=`${p}: ${g}D ${g>0?m:""} `}}console.log(`%c${o}	%c${s}	%c${l}D ${c}	%c${u}	%c${d}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}var p=n(974),f=n(747);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function m(e){return null!=e.kernelName}class g{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(let e in this.registeredVariables)this.registeredVariables[e].dispose()}}class y{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new g}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then(()=>{});if(null!=this.backendInstance)return;let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t],r=await this.initializeBackend(n).success;if(r){await this.setBackend(n);return}}throw Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){let{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;{let{asyncInit:t}=this.initializeBackend(e);if(t)return null}}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,n=1){return e in this.registryFactory?(l.Z(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(null==this.registryFactory[e])throw Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,null==this.registry[e]){this.backendInstance=null;let{success:t,asyncInit:n}=this.initializeBackend(e),r=n?await t:t;if(!r)return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new c(this.backendInstance),!0}setupRegisteredKernels(){let e=(0,o.tr)(this.backendName);e.forEach(e=>{null!=e.setupFunc&&e.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){let t=(0,o.tr)(e);t.forEach(t=>{null!=t.disposeFunc&&t.disposeFunc(this.registry[e])})}initializeBackend(e){let t=this.registryFactory[e];if(null==t)throw Error(`Cannot initialize backend ${e}, no registration found.`);try{let n=t.factory();if(!n||n instanceof r.Zu||"function"!=typeof n.then)return this.registry[e]=n,{success:!0,asyncInit:!1};{let a=++this.pendingBackendInitId,i=n.then(t=>!(a<this.pendingBackendInitId)&&(this.registry[e]=t,this.pendingBackendInit=null,!0)).catch(t=>!(a<this.pendingBackendInitId)&&(this.pendingBackendInit=null,l.Z(`Initialization of backend ${e} failed`),l.Z(t.stack||t.message),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}}catch(s){return l.Z(`Initialization of backend ${e} failed`),l.Z(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw Error(`${e} backend not found in registry`);this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t],{success:r,asyncInit:a}=this.initializeBackend(n);if(a||r)return{name:n,asyncInit:a}}throw Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){let n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t),i=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n,r=null;if(null==t){if("function"!=typeof e)throw Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}return this.scopedRun(()=>this.startScope(r),()=>this.endScope(n),()=>((n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n))}scopedRun(e,t,n){e();try{let r=n();return t(),r}catch(a){throw t(),a}}nextTensorId(){return y.nextTensorId++}nextVariableId(){return y.nextVariableId++}clone(e){let t=x.runKernel(s.iJz,{x:e}),n=e=>({x:()=>x.runKernel(s.RFZ,{x:e},{dtype:"float32"})});return this.addTapeNode(this.state.activeScope.name,{x:e},[t],n,[],{}),t}runKernel(e,t,n){null==this.backendName&&this.backend;let r=null!=(0,o.pI)(e,this.backendName);if(!r)throw Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){let r=this.backend.numDataIds(),a=0;n.forEach(e=>{a+="complex64"===e.dtype?3:1});let i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=r-t-a-i;if(s>0)throw Error(`Backend '${this.backendName}' has an internal memory leak (${s} data ids) after running '${e}'`)}runKernelFunc(e){let t,n,r,a;let i=[],s=this.isTapeOn(),l=this.state.numBytes,u=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;let c=m(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(m(e)){let{kernelName:d,inputs:p,attrs:f}=e;null==this.backendName&&this.backend;let g=(0,o.pI)(d,this.backendName);h.hu(null!=g,()=>`Cannot find registered kernel '${d}' for backend '${this.backendName}'`),n=()=>{let e=this.backend.numDataIds();r=g.kernelFunc({inputs:p,attrs:f,backend:this.backend});let t=Array.isArray(r)?r:[r];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(d,e,t);let n=t.map(e=>null!=e.rank?e:this.makeTensorFromTensorInfo(e));if(s){let a=this.getTensorsForGradient(d,p,n);i=this.saveTensorsForBackwardMode(a)}return n}}else{let{forwardFunc:y}=e,b=e=>{s&&(i=e.map(e=>this.keep(this.clone(e))))};n=()=>{let e=this.backend.numDataIds();r=this.tidy(()=>y(this.backend,b));let t=Array.isArray(r)?r:[r];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,e,t),t}}let{inputs:x,attrs:v}=e,w=m(e)?null:e.backwardsFunc;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(a=this.profiler.profileKernel(c,x,()=>n()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(a),t=a.outputs):t=n()}),s&&this.addTapeNode(c,x,t,w,i,v),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-l,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-u,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(x).map(e=>null!=x[e]?x[e].shape:null),outputShapes:t.map(e=>e.shape),kernelTimeMs:a.timeMs,extraInfo:a.extraInfo}),Array.isArray(r)?t:t[0]}saveTensorsForBackwardMode(e){let t=e.map(e=>this.keep(this.clone(e)));return t}getTensorsForGradient(e,t,n){let r=(0,o.uk)(e);if(null!=r){let a;let i=r.inputsToSave||[],s=r.outputsToSave||[];r.saveAllInputs?(h.hu(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(t).map(e=>t[e])):a=i.map(e=>t[e]);let l=n.filter((e,t)=>s[t]);return a.concat(l)}return[]}makeTensor(e,t,n,r){if(null==e)throw Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let a=e;"string"===n&&h.HD(e[0])&&(a=e.map(e=>u.encodeString(e)));let i=r.write(a,t,n),s=new p.es(t,n,i,this.nextTensorId());if(this.trackTensor(s,r),"string"===n){let o=this.state.tensorInfo.get(i),l=(0,h.Ub)(a);this.state.numBytes+=l-o.bytes,o.bytes=l}return s}makeTensorFromDataId(e,t,n,r){n=n||"float32";let a={dataId:e,shape:t,dtype:n};return this.makeTensorFromTensorInfo(a,r)}makeTensorFromTensorInfo(e,t){let{dataId:n,shape:r,dtype:a}=e,i=new p.es(r,a,n,this.nextTensorId());return this.trackTensor(i,t),i}makeVariable(e,t=!0,n,r){n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));let a=new p._w(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*h.bT(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof p._w||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;let t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){let n=e.size*h.bT(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(let e in this.state.registeredVariables){let t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){let e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;let t=this.state.numBytes,n=this.state.numTensors;for(let r of(this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(e=>e.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n,this.state.activeProfile.kernels))r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,t,n,r,a,i){let s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},l=(0,o.uk)(e);null!=l&&(r=l.gradFunc),null!=r&&(s.gradient=e=>r((e=e.map((e,t)=>{if(null==e){let r=n[t],a=h.wT(r.size,r.dtype);return this.makeTensor(a,r.shape,r.dtype)}return e})).length>1?e:e[0],a,i)),this.state.activeTape.push(s)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){let t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){let t=(0,f.getTensorsInContainer)(e),n=new Set(t.map(e=>e.id));for(let r=0;r<this.state.activeScope.track.length;r++){let a=this.state.activeScope.track[r];a.kept||n.has(a.id)||a.dispose()}let i=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(e=>{e.kept||e.scopeId!==i.id||this.track(e)})}gradients(e,t,n,r=!1){if(h.hu(t.length>0,()=>"gradients() received an empty list of xs."),null!=n&&"float32"!==n.dtype)throw Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);let a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));h.hu(a instanceof p.es,()=>"The result y returned by f() must be a tensor.");let i=/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){let r={},a={};for(let i=0;i<t.length;i++)r[t[i].id]=!0;for(let s=0;s<e.length;s++){let o=e[s],l=o.inputs;for(let u in l){let h=l[u],c=!1;for(let d=0;d<t.length;d++)if(r[h.id]){o.outputs.forEach(e=>r[e.id]=!0),c=!0,a[o.id]=!0;break}if(c)break}}let p={};p[n.id]=!0;let f={};for(let m=e.length-1;m>=0;m--){let g=e[m],y=g.inputs;for(let b=0;b<g.outputs.length;b++)if(p[g.outputs[b].id]){for(let x in y)p[y[x].id]=!0,f[g.id]=!0;break}}let v=[];for(let w=0;w<e.length;w++){let I=e[w];if(a[I.id]&&f[I.id]){let k={};for(let S in I.inputs){let C=I.inputs[S];r[C.id]&&(k[S]=C)}let E=Object.assign({},I);E.inputs=k,E.outputs=I.outputs,v.push(E)}}return v}(this.state.activeTape,t,a);if(!r&&0===i.length&&t.length>0)throw Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{let e={};e[a.id]=null==n?function(e){let t=(0,h.p8)((0,h.NA)(e),"float32");return x.makeTensor(t,e,"float32")}(a.shape):n,function(e,t,n,r){for(let a=t.length-1;a>=0;a--){let i=t[a],s=[];if(i.outputs.forEach(t=>{let n=e[t.id];null!=n?s.push(n):s.push(null)}),null==i.gradient)throw Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);let o=i.gradient(s);for(let l in i.inputs){if(!(l in o))throw Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);let u=n(()=>o[l]());if("float32"!==u.dtype)throw Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);let c=i.inputs[l];if(!h.cO(u.shape,c.shape))throw Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(null==e[c.id])e[c.id]=u;else{let d=e[c.id];e[c.id]=r(d,u),d.dispose()}}}}(e,i,e=>this.tidy(e),v);let r=t.map(t=>e[t.id]);return 0===this.state.gradientDepth&&(this.state.activeTape.forEach(e=>{for(let t of e.saved)t.dispose()}),this.state.activeTape=null),{value:a,grads:r}})}customGrad(e){return h.hu(h.mf(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{let n;h.hu(t.every(e=>e instanceof p.es),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r={};t.forEach((e,t)=>{r[t]=e});let a=(r,a)=>(n=e(...[...t,a]),h.hu(n.value instanceof p.es,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),h.hu(h.mf(n.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n.value),i=(e,r)=>{let a=n.gradFunc(e,r),i=Array.isArray(a)?a:[a];h.hu(i.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),h.hu(i.every(e=>e instanceof p.es),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");let s={};return i.forEach((e,t)=>{s[t]=()=>e}),s};return this.runKernelFunc({forwardFunc:a,backwardsFunc:i,inputs:r})}}readSync(e){let t=this.state.tensorInfo.get(e);return t.backend.readSync(e)}read(e){let t=this.state.tensorInfo.get(e);return t.backend.read(e)}readToGPU(e,t){let n=this.state.tensorInfo.get(e);return n.backend.readToGPU(e,t)}async time(e){let t=(0,u.now)(),n=await this.backend.time(e);return n.wallMs=(0,u.now)()-t,n}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){for(let e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new g,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function b(){let e=(0,i.D)();if(null==e._tfengine){let t=new a.qA(e);e._tfengine=new y(t)}return(0,a.iG)(e._tfengine.ENV),(0,p.Vi)(()=>e._tfengine),e._tfengine}y.nextTensorId=0,y.nextVariableId=0;let x=b();function v(e,t){return x.runKernel(s.mm_,{a:e,b:t})}},2885:function(e,t,n){"use strict";n.d(t,{OB:function(){return o},iG:function(){return u},qA:function(){return i}});var r=n(569);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let a="tfjsflags";class i{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=s,this.populateURLFlags()}setPlatform(e,t){null==this.platform||l.getBool("IS_TEST")||l.getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){let r=this.urlFlags[e];l.getBool("IS_TEST")||l.getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags||(this.flags[e]=await this.evaluateFlag(e)),this.flags[e]}get(e){if(e in this.flags)return this.flags[e];let t=this.evaluateFlag(e);if((0,r.tI)(t))throw Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(null==this.flagRegistry[e])throw Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(null==this.flagRegistry[e])throw Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(void 0===this.global||void 0===this.global.location||void 0===this.global.location.search)return;let e=this.getQueryParams(this.global.location.search);if(a in e){let t=e[a].split(",");t.forEach(e=>{let[t,n]=e.split(":");this.urlFlags[t]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if(`${+t}`===t)return+t;throw Error(`Could not parse value flag value ${t} for flag ${e}.`)}(t,n)})}}}function s(e){let t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(e,...n)=>{var r,a,i;return r=t,a=n[0],i=n[1],r[decodeURIComponent(a)]=decodeURIComponent(i||""),n.join("=")}),t}function o(){return l}let l=null;function u(e){l=e}},5938:function(e,t,n){"use strict";let r;n.d(t,{D:function(){return i},R:function(){return s}});var a=n(3454);function i(){if(null==r){let e;if("undefined"!=typeof window)e=window;else if(void 0!==n.g)e=n.g;else if(void 0!==a)e=a;else if("undefined"!=typeof self)e=self;else throw Error("Could not find a global object");r=e}return r}function s(e,t){let n=function(){let e=i();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);{let r=t();return n.set(e,r),n.get(e)}}},4368:function(e,t,n){"use strict";n.d(t,{B9:function(){return h},Cn:function(){return c},SR:function(){return o},jq:function(){return d},lu:function(){return u},sq:function(){return l},y3:function(){return p}});var r=n(196),a=n(2885),i=n(974),s=n(747);function o(){return r.BV}function l(){return r.BV.memory()}function u(e,t){return r.BV.tidy(e,t)}function h(e){let t=(0,s.getTensorsInContainer)(e);t.forEach(e=>e.dispose())}function c(e){return r.BV.keep(e)}function d(e,t,n=1){return r.BV.registerBackend(e,t,n)}function p(){return r.BV.backend}(0,i.FZ)(function(e){(0,a.OB)().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")})},633:function(e,t,n){"use strict";n.d(t,{cb:function(){return o},pn:function(){return s}});var r=n(196),a=n(974),i=n(569);function s(e,t){i.hu(i.mf(e),()=>"The f passed in variableGrads(f) must be a function"),i.hu(null==t||Array.isArray(t)&&t.every(e=>e instanceof a._w),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");let n=null!=t;if(!n)for(let s in t=[],r.BV.registeredVariables)t.push(r.BV.registeredVariables[s]);let o=n?t.filter(e=>!e.trainable):null,l=t.length;t=t.filter(e=>e.trainable),i.hu(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${l} variables is trainable.`);let{value:u,grads:h}=r.BV.gradients(e,t,null,!0);i.hu(h.some(e=>null!=e),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),i.hu(0===u.rank,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${u.rank} tensor`);let c={};return t.forEach((e,t)=>{null!=h[t]&&(c[e.name]=h[t])}),null!=o&&o.forEach(e=>c[e.name]=null),{value:u,grads:c}}function o(e){return r.BV.customGrad(e)}},7671:function(e,t,n){"use strict";let r,a;n.d(t,{SYM:function(){return e7.SYM},VGw:function(){return e7.VGw},SpW:function(){return e7.SpW},mm_:function(){return e7.mm_},Xze:function(){return e7.Xze},oT6:function(){return e7.oT6},IKK:function(){return e7.IKK},sJF:function(){return e7.sJF},aJk:function(){return e7.aJk},M2y:function(){return e7.M2y},qw7:function(){return e7.qw7},jMg:function(){return e7.jMg},QCc:function(){return e7.QCc},Oyi:function(){return e7.Oyi},JhU:function(){return e7.JhU},_k9:function(){return e7._k9},IMb:function(){return e7.IMb},ROF:function(){return e7.ROF},XLW:function(){return e7.XLW},zws:function(){return e7.zws},zvY:function(){return e7.zvY},eEB:function(){return e7.eEB},RFZ:function(){return e7.RFZ},gJX:function(){return e7.gJX},xnO:function(){return e7.xnO},Zz9:function(){return e7.Zz9},yj2:function(){return e7.yj2},Eh3:function(){return e7.Eh3},mhS:function(){return e7.mhS},wUP:function(){return e7.wUP},wm:function(){return e7.wm},x12:function(){return e7.x12},o2y:function(){return e7.o2y},ik2:function(){return e7.ik2},mc4:function(){return e7.mc4},TR1:function(){return e7.TR1},VcC:function(){return e7.VcC},Byc:function(){return e7.Byc},iHb:function(){return e7.iHb},JLz:function(){return aE.JL},QRR:function(){return e7.QRR},T0n:function(){return e7.T0n},cie:function(){return e7.cie},sL$:function(){return e7.sL$},y7R:function(){return e7.y7R},$w:function(){return e7.$w},p4S:function(){return e7.p4S},Vn9:function(){return e7.Vn9},ekb:function(){return e7.ekb},$g6:function(){return e7.$g6},SX0:function(){return e7.SX0},HEU:function(){return e7.HEU},hdR:function(){return e7.hdR},Omj:function(){return e7.Omj},NEP:function(){return e7.NEP},YFo:function(){return e7.YFo},Y0y:function(){return e7.Y0y},vwp:function(){return e7.vwp},deh:function(){return e7.deh},Uyb:function(){return e7.Uyb},OR:function(){return e7.OR},jeX:function(){return e7.jeX},eBW:function(){return e7.eBW},sHE:function(){return e7.sHE},_V0:function(){return e7._V0},luS:function(){return e7.luS},q1x:function(){return e7.q1x},qi_:function(){return e7.qi_},iZT:function(){return e7.iZT},Acj:function(){return e7.Acj},Qg5:function(){return e7.Qg5},iJz:function(){return e7.iJz},J_u:function(){return e7.J_u},avt:function(){return e7.avt},iWB:function(){return e7.iWB},r7n:function(){return e7.r7n},Zuw:function(){return aE.Zu},eZ0:function(){return e7.eZ0},Hhh:function(){return e7.Hhh},J$2:function(){return e7.J$2},vtC:function(){return e7.vtC},CAk:function(){return e7.CAk},e7N:function(){return e7.e7N},ZbH:function(){return e7.ZbH},kU:function(){return e7.kU},PYm:function(){return e7.PYm},VfG:function(){return e7.VfG},MZg:function(){return e7.MZg},YoZ:function(){return e7.YoZ},mTV:function(){return e7.mTV},OAf:function(){return e7.OAf},OU7:function(){return e7.OU7},OV7:function(){return e7.OV7},vFR:function(){return e7.vFR},BMI:function(){return e7.BMI},q2K:function(){return e7.q2K},c17:function(){return e7.c17},q8u:function(){return e7.q8u},jQs:function(){return e7.jQs},Vbg:function(){return e7.Vbg},NZg:function(){return e7.NZg},wYn:function(){return e7.wYn},kuV:function(){return e7.kuV},uv1:function(){return e7.uv1},cye:function(){return e7.cye},W0H:function(){return e7.W0H},yQU:function(){return e7.yQU},we_:function(){return e7.we_},qWM:function(){return e7.qWM},gaJ:function(){return eJ},QiL:function(){return e7.QiL},lyA:function(){return e7.lyA},pe_:function(){return e7.pe_},o0g:function(){return e7.o0g},DlI:function(){return e7.DlI},dDz:function(){return e7.dDz},BiW:function(){return e7.BiW},e6w:function(){return e7.e6w},xJR:function(){return e7.xJR},oHH:function(){return e7.oHH},$HU:function(){return e7.$HU},qkr:function(){return e7.qkr},SbG:function(){return e7.SbG},HZH:function(){return e7.HZH},_Yw:function(){return e7._Yw},zbQ:function(){return e7.zbQ},dpD:function(){return e7.dpD},Hmb:function(){return e7.Hmb},mKl:function(){return e7.mKl},b9H:function(){return e7.b9H},e07:function(){return e7.e07},bV0:function(){return e7.bV0},xQA:function(){return e7.xQA},nr8:function(){return e7.nr8},PhF:function(){return e7.PhF},oFR:function(){return e7.oFR},a5O:function(){return e7.a5O},i5y:function(){return e7.i5y},RQH:function(){return e7.RQH},wYB:function(){return e7.wYB},p2w:function(){return e7.p2w},Gcp:function(){return e7.Gcp},MRv:function(){return e7.MRv},TQc:function(){return e7.TQc},O3z:function(){return e7.O3z},nhH:function(){return e7.nhH},w3H:function(){return e7.w3H},ZjV:function(){return e7.ZjV},D2d:function(){return e7.D2d},L8s:function(){return e7.L8s},FKq:function(){return e7.FKq},bK0:function(){return e7.bK0},_tC:function(){return e7._tC},h8e:function(){return e7.h8e},jQk:function(){return e7.jQk},_JP:function(){return e7._JP},s1s:function(){return e7.s1s},XkS:function(){return e7.XkS},Tr8:function(){return e7.Tr8},GBy:function(){return e7.GBy},sEM:function(){return e7.sEM},MIZ:function(){return e7.MIZ},esB:function(){return eg.es},YDk:function(){return eg.YD},n9L:function(){return e7.n9L},cWu:function(){return e7.cWu},wx7:function(){return e7.wx7},G3Y:function(){return e7.G3Y},kpP:function(){return e7.kpP},ToN:function(){return e7.ToN},Qvg:function(){return e7.Qvg},RuY:function(){return e7.RuY},usg:function(){return e7.usg},WnP:function(){return e1.W},IHx:function(){return e2.I},$6P:function(){return e3.$},YjB:function(){return e4.Y},NqF:function(){return e6.N},wS1:function(){return e5.w},uR5:function(){return tt},y3$:function(){return eY.y3},Wap:function(){return f},Dxk:function(){return tr},JY5:function(){return ta},p3b:function(){return ti},UFq:function(){return ts.U},Jyw:function(){return ez},f3b:function(){return ey},pju:function(){return eb.p},iUl:function(){return to.i},d9v:function(){return ex.d},zoF:function(){return tl.z},gME:function(){return tu},Izb:function(){return th},MNy:function(){return tc},ZaL:function(){return td},PAt:function(){return tp.P},Tek:function(){return tf.T},bc:function(){return tm.b},pdZ:function(){return tg},$QV:function(){return tb},B10:function(){return tx.B},C2$:function(){return u},B90:function(){return eY.B9},hiC:function(){return tv.h},rvX:function(){return nE},pyx:function(){return tw.p},SRH:function(){return eY.SR},OBj:function(){return v.OB},DgJ:function(){return tI.D},Qqt:function(){return tk.Q},dt4:function(){return tS.d},iyy:function(){return tE},hlL:function(){return tT.h},GWj:function(){return t$.G},imm:function(){return d},Iqj:function(){return tN.I},pjt:function(){return tA.p},brS:function(){return tD.b},BHj:function(){return rg},io:function(){return h},CnY:function(){return eY.Cn},GDt:function(){return m},hi7:function(){return tF.h},$r2:function(){return ry},cM7:function(){return tR.c},Krr:function(){return t_.K},CmS:function(){return tO.C},HvI:function(){return tM.H},OI3:function(){return tB.O},Fp7:function(){return tP.F},_sB:function(){return tL._},YQQ:function(){return tU},gWQ:function(){return tW.g},J69:function(){return tz.J},sq6:function(){return eY.sq},LTh:function(){return tV.L},Gi7:function(){return tK},dC7:function(){return tX.d},W76:function(){return tq.W},glt:function(){return rA},Quu:function(){return tY.Q},lfX:function(){return tQ.l},iUs:function(){return tZ.i},JpU:function(){return tJ.J},vku:function(){return t0.v},AL3:function(){return t1.A},nGf:function(){return t6},LGj:function(){return t5},jqO:function(){return eY.jq},wCN:function(){return r$.wC},UYe:function(){return t7.U},XLQ:function(){return te.X},GYS:function(){return t8.G},iD$:function(){return eZ.i},U8D:function(){return t9.U},U_I:function(){return ne.U},m7h:function(){return c},XD2:function(){return nt.X},tPi:function(){return nn.t},jZU:function(){return nr},SmN:function(){return na},CnO:function(){return ni},p0P:function(){return ns},kuN:function(){return eV},XAC:function(){return no.X},Wvh:function(){return nl.W},Vl2:function(){return nu.V},_b3:function(){return nh._},L9e:function(){return nc.L},knu:function(){return nd.k},luU:function(){return tH.l},Smz:function(){return np.S},z4k:function(){return e0.z4},AEp:function(){return nf.A},XeE:function(){return E},RRF:function(){return nm},odF:function(){return ng},wOQ:function(){return ny},yXz:function(){return nb},piX:function(){return eK},lub:function(){return eY.lu},Gg6:function(){return tC.G},p_j:function(){return rT},p4s:function(){return nC.p},Xu6:function(){return nx},HHK:function(){return nv.H},x8V:function(){return e0.x8},D5U:function(){return eX},VD$:function(){return nw},jTM:function(){return eq},arb:function(){return nI.a},lls:function(){return nk.l},P84:function(){return nS.P}});var i,s,o,l,u={};n.r(u),n.d(u,{isBrowser:function(){return x},isMobile:function(){return b},mockIsMobile:function(){return y}});var h={};n.r(h),n.d(h,{browserFiles:function(){return eC},browserHTTPRequest:function(){return e_},concatenateArrayBuffers:function(){return _},copyModel:function(){return eh},decodeWeights:function(){return D},encodeWeights:function(){return A},fromMemory:function(){return eP},fromMemorySync:function(){return eL},getLoadHandlers:function(){return j},getModelArtifactsForJSON:function(){return P},getModelArtifactsForJSONSync:function(){return B},getModelArtifactsInfoForJSON:function(){return L},getSaveHandlers:function(){return G},getWeightSpecs:function(){return U},http:function(){return eR},isHTTPScheme:function(){return eD},listModels:function(){return el},loadWeights:function(){return e$},moveModel:function(){return ec},registerLoadRouter:function(){return V},registerSaveRouter:function(){return z},removeModel:function(){return eu},weightsLoaderFactory:function(){return eN},withSaveHandler:function(){return eU},withSaveHandlerSync:function(){return eW}});var c={};n.r(c),n.d(c,{Serializable:function(){return eG},SerializationMap:function(){return ej},registerClass:function(){return eH}});var d={};n.r(d),n.d(d,{conv2d:function(){return nL},depthwiseConv2d:function(){return nz},matMul:function(){return nV}});var p={};n.r(p),n.d(p,{collectGatherOpShapeInfo:function(){return aI},computeOutShape:function(){return aw},segOpComputeOptimalWindowSize:function(){return av}});var f={};n.r(f),n.d(f,{ERF_A1:function(){return rQ},ERF_A2:function(){return rZ},ERF_A3:function(){return rJ},ERF_A4:function(){return r0},ERF_A5:function(){return r1},ERF_P:function(){return rY},PARALLELIZE_THRESHOLD:function(){return rB},RowPartitionType:function(){return l},SELU_SCALE:function(){return rq.$},SELU_SCALEALPHA:function(){return rq.y},applyActivation:function(){return nB},assertAndGetBroadcastShape:function(){return ez.assertAndGetBroadcastShape},assertAxesAreInnerMostDims:function(){return tG.lB},assertParamsConsistent:function(){return rD},assignToTypedArray:function(){return r8},axesAreInnerMostDims:function(){return tG.YB},calculateShapes:function(){return rX},checkEinsumDimSizes:function(){return aa},checkPadOnDimRoundingMode:function(){return e8.m},combineLocations:function(){return tG.Vh},combineRaggedTensorToTensorShapes:function(){return rR},complexWithEvenIndex:function(){return r6},complexWithOddIndex:function(){return r5},computeConv2DInfo:function(){return e8.Ix},computeConv3DInfo:function(){return e8.jw},computeDefaultPad:function(){return e8.aO},computeDilation2DInfo:function(){return e8.Rf},computeOptimalWindowSize:function(){return rP},computeOutAndReduceShapes:function(){return tG.kz},computeOutShape:function(){return rF},computePool2DInfo:function(){return e8.Xw},computePool3DInfo:function(){return e8.pl},convertConv2DDataFormat:function(){return e8.sl},decodeEinsumEquation:function(){return an},eitherStridesOrDilationsAreOne:function(){return e8.jT},expandShapeToKeepDim:function(){return tG.rv},exponent:function(){return ae},exponents:function(){return r9},fromStringArrayToUint8:function(){return aS},fromUint8ToStringArray:function(){return ak},getAxesPermutation:function(){return tG.Q3},getBroadcastDims:function(){return ez.getBroadcastDims},getComplexWithIndex:function(){return r7},getEinsumComputePath:function(){return ai},getEinsumPermutation:function(){return ar},getFusedBiasGradient:function(){return nM},getFusedDyActivation:function(){return nO},getImageCenter:function(){return rL},getInnerMostAxes:function(){return tG.sY},getPermuted:function(){return rW},getRaggedRank:function(){return rO},getReductionAxes:function(){return ez.getReductionAxes},getReshaped:function(){return rU},getReshapedPermuted:function(){return rz},getRowPartitionTypesHelper:function(){return r_},getSliceBeginCoords:function(){return rV},getSliceSize:function(){return rG},getSparseFillEmptyRowsIndicesDenseShapeMismatch:function(){return al},getSparseFillEmptyRowsNegativeIndexErrorMessage:function(){return au},getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:function(){return ah},getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:function(){return ap},getSparseReshapeInputOutputMismatchErrorMessage:function(){return am},getSparseReshapeInputOutputMultipleErrorMessage:function(){return af},getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:function(){return ac},getSparseReshapeNegativeOutputDimErrorMessage:function(){return ad},getSparseSegmentReductionIndicesOutOfRangeErrorMessage:function(){return ax},getSparseSegmentReductionNegativeSegmentIdsErrorMessage:function(){return ag},getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:function(){return ay},getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:function(){return ab},getUndoAxesPermutation:function(){return tG.LJ},isIdentityPermutation:function(){return as},log:function(){return r2.c},mergeRealAndImagArrays:function(){return r3},prepareAndValidate:function(){return rj},prepareSplitSize:function(){return ao},segment_util:function(){return p},shouldFuse:function(){return nP},slice_util:function(){return eV},splitRealAndImagArrays:function(){return r4},tupleValuesAreOne:function(){return e8.I0},upcastType:function(){return e0.x8},validateDefaultValueShape:function(){return rM},validateInput:function(){return rK},validateUpdateShape:function(){return rH},warn:function(){return r2.Z}});var m={};n.r(m),n.d(m,{GP:function(){return n0},qP:function(){return n1},pA:function(){return n2},ZA:function(){return aC}});var g=n(196);function y(e){r=e}function b(e){if(void 0!==r)return r;if(e||"undefined"!=typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;let t=e.userAgent||e.vendor||("undefined"!=typeof window?window.opera:"");if(!t){let n=e;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function x(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var v=n(2885),w=n(3454);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let I=(0,v.OB)();I.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),I.registerFlag("IS_BROWSER",()=>x()),I.registerFlag("IS_NODE",()=>void 0!==w&&void 0!==w.versions&&void 0!==w.versions.node),I.registerFlag("IS_CHROME",()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),I.registerFlag("PROD",()=>!1),I.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>I.getBool("DEBUG")),I.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),I.registerFlag("IS_TEST",()=>!1),I.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0),I.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1),I.registerFlag("ENGINE_COMPILE_ONLY",()=>!1),I.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1),I.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);var k=n(1661),S=n(3740),C=n(7852);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function E(e,t,n){let r=(0,S.C)(e,n);return(0,C.H)(e,t,r,n)}var T=n(569);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let $={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};var N=n(1876).Buffer;async function A(e,t){let n=[],r=[],a=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);for(let i=0;i<a.length;++i){let s=a[i],o=Array.isArray(e)?e[i].tensor:e[s];if("float32"!==o.dtype&&"int32"!==o.dtype&&"bool"!==o.dtype&&"string"!==o.dtype&&"complex64"!==o.dtype)throw Error(`Unsupported dtype in weight '${s}': ${o.dtype}`);let l={name:s,shape:o.shape,dtype:o.dtype};if("string"===o.dtype){let u=new Promise(async e=>{let t=await o.bytes(),n=t.reduce((e,t)=>e+t.length,0)+4*t.length,r=new Uint8Array(n),a=0;for(let i=0;i<t.length;i++){let s=t[i],l=new Uint8Array(new Uint32Array([s.length]).buffer);r.set(l,a),a+=4,r.set(s,a),a+=s.length}e(r)});r.push(u)}else r.push(o.data());null!=t&&(l.group=t),n.push(l)}let h=await Promise.all(r);return{data:function(e){if(null===e)throw Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0,n=[];e.forEach(e=>{if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw Error(`Unsupported TypedArray subtype: ${e.constructor.name}`)});let r=new Uint8Array(t),a=0;return n.forEach(e=>{r.set(new Uint8Array(e.buffer),a),a+=e.byteLength}),r.buffer}(h),specs:n}}function D(e,t){let n;let r={},a=0;for(let i of t){let s;let o=i.name,l=i.dtype,u=i.shape,h=(0,T.NA)(u);if("quantization"in i){let c=i.quantization;if("uint8"===c.dtype||"uint16"===c.dtype){if(!("min"in c&&"scale"in c))throw Error(`Weight ${i.name} with quantization ${c.dtype} doesn't have corresponding metadata min and scale.`)}else if("float16"===c.dtype){if("float32"!==l)throw Error(`Weight ${i.name} is quantized with ${c.dtype} which only supports weights of type float32 not ${l}.`)}else throw Error(`Weight ${i.name} has unknown quantization dtype ${c.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);let d=$[c.dtype],p=e.slice(a,a+h*d),f="uint8"===c.dtype?new Uint8Array(p):new Uint16Array(p);if("float32"===l){if("uint8"===c.dtype||"uint16"===c.dtype){s=new Float32Array(f.length);for(let m=0;m<f.length;m++){let g=f[m];s[m]=g*c.scale+c.min}}else if("float16"===c.dtype)void 0===n&&(n=function(){let e=function(){let e=e=>{let t=e<<13,n=0;for(;(8388608&t)==0;)n-=8388608,t<<=1;return(t&=-8388609)|(n+=947912704)},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let r=1024;r<2048;r++)t[r]=939524096+(r-1024<<13);return t}(),t=function(){let e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let n=33;n<63;n++)e[n]=2147483648+(n-32<<23);return e}(),n=function(){let e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return r=>{let a=new ArrayBuffer(4*r.length),i=new Uint32Array(a);for(let s=0;s<r.length;s++){let o=r[s],l=e[n[o>>10]+(1023&o)]+t[o>>10];i[s]=l}return new Float32Array(a)}}()),s=n(f);else throw Error(`Unsupported quantization type ${c.dtype} for weight type float32.`)}else if("int32"===l){if("uint8"!==c.dtype&&"uint16"!==c.dtype)throw Error(`Unsupported quantization type ${c.dtype} for weight type int32.`);s=new Int32Array(f.length);for(let y=0;y<f.length;y++){let b=f[y];s[y]=Math.round(b*c.scale+c.min)}}else throw Error(`Unsupported dtype in weight '${o}': ${l}`);a+=h*d}else if("string"===l){let x=(0,T.NA)(i.shape);s=[];for(let v=0;v<x;v++){let w=new Uint32Array(e.slice(a,a+4))[0];a+=4;let I=new Uint8Array(e.slice(a,a+w));s.push(I),a+=w}}else{let S=$[l],C=e.slice(a,a+h*S);if("float32"===l)s=new Float32Array(C);else if("int32"===l)s=new Int32Array(C);else if("bool"===l)s=new Uint8Array(C);else if("complex64"===l){s=new Float32Array(C);let N=new Float32Array(s.length/2),A=new Float32Array(s.length/2);for(let D=0;D<N.length;D++)N[D]=s[2*D],A[D]=s[2*D+1];let F=E(N,u,"float32"),R=E(A,u,"float32");r[o]=(0,k.P)(F,R),F.dispose(),R.dispose()}else throw Error(`Unsupported dtype in weight '${o}': ${l}`);a+=h*S}"complex64"!==l&&(r[o]=E(s,u,l))}return r}let F=void 0!==N&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function R(e){return F?N.byteLength(e):new Blob([e]).size}function _(e){if(1===e.length)return e[0];let t=0;e.forEach(e=>{t+=e.byteLength});let n=new Uint8Array(t),r=0;return e.forEach(e=>{n.set(new Uint8Array(e),r),r+=e.byteLength}),n.buffer}function O(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);let t=e.split("/");return t[t.length-1]}function M(e,t){let n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}function B(e,t,n){let r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(r.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return null!=e.signature&&(r.signature=e.signature),null!=e.userDefinedMetadata&&(r.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(r.modelInitializer=e.modelInitializer),r}async function P(e,t){let n,r;return null!=e.weightsManifest&&([n,r]=await t(e.weightsManifest)),B(e,n,r)}function L(e){if(e.modelTopology instanceof ArrayBuffer)throw Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:R(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:R(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}function U(e){let t=[];for(let n of e)t.push(...n.weights);return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class W{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==W.instance&&(W.instance=new W),W.instance}static registerSaveRouter(e){W.getInstance().saveRouters.push(e)}static registerLoadRouter(e){W.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return W.getHandlers(e,"save")}static getLoadHandlers(e,t){return W.getHandlers(e,"load",t)}static getHandlers(e,t,n){let r=[],a="load"===t?W.getInstance().loadRouters:W.getInstance().saveRouters;return a.forEach(t=>{let a=t(e,n);null!==a&&r.push(a)}),r}}let z=e=>W.registerSaveRouter(e),V=e=>W.registerLoadRouter(e),G=e=>W.getSaveHandlers(e),j=(e,t)=>W.getLoadHandlers(e,t),H="tensorflowjs",K="models_store",X="model_info_store";function q(){if(!(0,v.OB)().getBool("IS_BROWSER"))throw Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");let e="undefined"==typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw Error("The current browser does not appear to support IndexedDB.");return t}function Y(e){let t=e.result;t.createObjectStore(K,{keyPath:"modelPath"}),t.createObjectStore(X,{keyPath:"modelPath"})}class Q{constructor(e){if(this.indexedDB=q(),null==e||!e)throw Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((e,n)=>{let r=this.indexedDB.open(H,1);r.onupgradeneeded=()=>Y(r),r.onsuccess=()=>{let a=r.result;if(null==t){let i=a.transaction(K,"readonly"),s=i.objectStore(K),o=s.get(this.modelPath);o.onsuccess=()=>{if(null==o.result)return a.close(),n(Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));e(o.result.modelArtifacts)},o.onerror=e=>(a.close(),n(o.error)),i.oncomplete=()=>a.close()}else{let l;let u=L(t),h=a.transaction(X,"readwrite"),c=h.objectStore(X),d=c.put({modelPath:this.modelPath,modelArtifactsInfo:u});d.onsuccess=()=>{l=a.transaction(K,"readwrite");let r=l.objectStore(K),i=r.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:u});i.onsuccess=()=>e({modelArtifactsInfo:u}),i.onerror=e=>{c=h.objectStore(X);let t=c.delete(this.modelPath);t.onsuccess=()=>(a.close(),n(i.error)),t.onerror=e=>(a.close(),n(i.error))}},d.onerror=e=>(a.close(),n(d.error)),h.oncomplete=()=>{null==l?a.close():l.oncomplete=()=>a.close()}}},r.onerror=e=>n(r.error)})}}Q.URL_SCHEME="indexeddb://";let Z=e=>{var t;return(0,v.OB)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Q.URL_SCHEME)?(t=e.slice(Q.URL_SCHEME.length),new Q(t)):null};W.registerSaveRouter(Z),W.registerLoadRouter(Z);let J="tensorflowjs_models",ee="info";function et(e){return{info:[J,e,ee].join("/"),topology:[J,e,"model_topology"].join("/"),weightSpecs:[J,e,"weight_specs"].join("/"),weightData:[J,e,"weight_data"].join("/"),modelMetadata:[J,e,"model_metadata"].join("/")}}function en(e){for(let t of Object.values(e))window.localStorage.removeItem(t)}class er{constructor(e){if(!(0,v.OB)().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=et(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{let t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=L(e);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(e){if(F)return N.from(e).toString("base64");let t=new Uint8Array(e),n="";for(let r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}(e.weightData));let a={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:r}}catch(i){throw en(this.keys),Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){let e=JSON.parse(this.LS.getItem(this.keys.info));if(null==e)throw Error(`In local storage, there is no model with name '${this.modelPath}'`);if("JSON"!==e.modelTopologyType)throw Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");let t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=n;let r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;let a=this.LS.getItem(this.keys.modelMetadata);if(null!=a){let i=JSON.parse(a);t.format=i.format,t.generatedBy=i.generatedBy,t.convertedBy=i.convertedBy,null!=i.signature&&(t.signature=i.signature),null!=i.userDefinedMetadata&&(t.userDefinedMetadata=i.userDefinedMetadata),null!=i.modelInitializer&&(t.modelInitializer=i.modelInitializer),null!=i.trainingConfig&&(t.trainingConfig=i.trainingConfig)}let s=this.LS.getItem(this.keys.weightData);if(null==s)throw Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=function(e){if(F){let t=N.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}let n=atob(e),r=new Uint8Array(n.length);for(let a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}(s),t}}er.URL_SCHEME="localstorage://";let ea=e=>{var t;return(0,v.OB)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(er.URL_SCHEME)?(t=e.slice(er.URL_SCHEME.length),new er(t)):null};W.registerSaveRouter(ea),W.registerLoadRouter(ea);class ei{constructor(){this.managers={}}static getInstance(){return null==ei.instance&&(ei.instance=new ei),ei.instance}static registerManager(e,t){(0,T.hu)(null!=e,()=>"scheme must not be undefined or null."),e.endsWith("://")&&(e=e.slice(0,e.indexOf("://"))),(0,T.hu)(e.length>0,()=>"scheme must not be an empty string.");let n=ei.getInstance();(0,T.hu)(null==n.managers[e],()=>`A model store manager is already registered for scheme '${e}'.`),n.managers[e]=t}static getManager(e){let t=ei.getInstance().managers[e];if(null==t)throw Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(ei.getInstance().managers)}}function es(e){if(-1===e.indexOf("://"))throw Error(`The url string provided does not contain a scheme. Supported schemes are: ${ei.getSchemes().join(",")}`);return{scheme:e.split("://")[0],path:e.split("://")[1]}}async function eo(e,t,n=!1){(0,T.hu)(e!==t,()=>`Old path and new path are the same: '${e}'`);let r=W.getLoadHandlers(e);(0,T.hu)(r.length>0,()=>`Copying failed because no load handler is found for source URL ${e}.`),(0,T.hu)(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${e}.`);let a=r[0],i=W.getSaveHandlers(t);(0,T.hu)(i.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),(0,T.hu)(i.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${t}.`);let s=i[0],o=es(e).scheme,l=es(e).path,u=o===es(e).scheme,h=await a.load();n&&u&&await ei.getManager(o).removeModel(l);let c=await s.save(h);return n&&!u&&await ei.getManager(o).removeModel(l),c.modelArtifactsInfo}async function el(){let e=ei.getSchemes(),t={};for(let n of e){let r=await ei.getManager(n).listModels();for(let a in r){let i=n+"://"+a;t[i]=r[a]}}return t}async function eu(e){let t=es(e),n=ei.getManager(t.scheme);return n.removeModel(t.path)}async function eh(e,t){return eo(e,t,!1)}async function ec(e,t){return eo(e,t,!0)}if((0,v.OB)().get("IS_BROWSER")){(0,v.OB)().setPlatform("browser",new /**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw Error(`Browser's encoder only supports utf-8, but got ${t}`);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(!window||!(0,v.OB)().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",e=>{if(e.source===window&&e.data.name===this.messageName){e.stopPropagation();let t=this.functionRefs[e.data.index];t(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}});try{ei.registerManager(er.URL_SCHEME,new class{constructor(){(0,T.hu)((0,v.OB)().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),(0,T.hu)("undefined"==typeof window||void 0!==window.localStorage,()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){let e={},t=J+"/",n="/"+ee;for(let r=0;r<this.LS.length;++r){let a=this.LS.key(r);if(a.startsWith(t)&&a.endsWith(n)){let i=function(e){let t=e.split("/");if(t.length<3)throw Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join("/")}(a);e[i]=JSON.parse(this.LS.getItem(a))}}return e}async removeModel(e){var t;e=(t=e).startsWith(er.URL_SCHEME)?t.slice(er.URL_SCHEME.length):t;let n=et(e);if(null==this.LS.getItem(n.info))throw Error(`Cannot find model at path '${e}'`);let r=JSON.parse(this.LS.getItem(n.info));return en(n),r}})}catch(ed){}try{ei.registerManager(Q.URL_SCHEME,new class{constructor(){this.indexedDB=q()}async listModels(){return new Promise((e,t)=>{let n=this.indexedDB.open(H,1);n.onupgradeneeded=()=>Y(n),n.onsuccess=()=>{let r=n.result,a=r.transaction(X,"readonly"),i=a.objectStore(X),s=i.getAll();s.onsuccess=()=>{let t={};for(let n of s.result)t[n.modelPath]=n.modelArtifactsInfo;e(t)},s.onerror=e=>(r.close(),t(s.error)),a.oncomplete=()=>r.close()},n.onerror=e=>t(n.error)})}async removeModel(e){var t;return e=(t=e).startsWith(Q.URL_SCHEME)?t.slice(Q.URL_SCHEME.length):t,new Promise((t,n)=>{let r=this.indexedDB.open(H,1);r.onupgradeneeded=()=>Y(r),r.onsuccess=()=>{let a;let i=r.result,s=i.transaction(X,"readwrite"),o=s.objectStore(X),l=o.get(e);l.onsuccess=()=>{if(null==l.result)return i.close(),n(Error(`Cannot find model with path '${e}' in IndexedDB.`));{let r=o.delete(e),s=()=>{a=i.transaction(K,"readwrite");let r=a.objectStore(K),s=r.delete(e);s.onsuccess=()=>t(l.result.modelArtifactsInfo),s.onerror=e=>n(l.error)};r.onsuccess=s,r.onerror=e=>(s(),i.close(),n(l.error))}},l.onerror=e=>(i.close(),n(l.error)),s.oncomplete=()=>{null==a?i.close():a.oncomplete=()=>i.close()}},r.onerror=e=>n(r.error)})}})}catch(ep){}}var ef=n(3454);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let em={importFetch:()=>n(5410)};(0,v.OB)().get("IS_NODE")&&!(0,v.OB)().get("IS_BROWSER")&&(0,v.OB)().setPlatform("node",new class{constructor(){this.util=n(8628),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return null!=(0,v.OB)().global.fetch?(0,v.OB)().global.fetch(e,t):(null==a&&(a=em.importFetch()),a(e,t))}now(){let e=ef.hrtime();return 1e3*e[0]+e[1]/1e6}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}});var eg=n(974);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function ey(e,t="float32",n){return t=t||"float32",T.Mu(e),new eg.YD(e,t,n)}var eb=n(2271),ex=n(8723);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,g.wv)();let ev={buffer:ey,cast:eb.p,clone:ex.d,print:/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=!1){console.log(e.toString(t))}};function ew(e){return new Promise(e=>setTimeout(e)).then(e)}(0,eg.Vp)(ev);class eI{constructor(e){if(!(0,v.OB)().getBool("IS_BROWSER"))throw Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(eI.URL_SCHEME)&&(e=e.slice(eI.URL_SCHEME.length)),(null==e||0===e.length)&&(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}async save(e){if("undefined"==typeof document)throw Error("Browser downloads are not supported in this environment since `document` is not present");let t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{let n=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],r=M(e,n),a=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),i=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(i.download=this.modelJsonFileName,i.href=a,await ew(()=>i.dispatchEvent(new MouseEvent("click"))),null!=e.weightData){let s=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;s.download=this.weightDataFileName,s.href=t,await ew(()=>s.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:L(e)}}}}eI.URL_SCHEME="downloads://";class ek{constructor(e){if(null==e||e.length<1)throw Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{let n=new FileReader;n.onload=n=>{let r=JSON.parse(n.target.result),a=r.modelTopology;if(null==a){t(Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}let i=r.weightsManifest;if(null==i){t(Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(0===this.weightsFiles.length){e({modelTopology:a});return}let s=P(r,e=>this.loadWeights(e));e(s)},n.onerror=e=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),n.readAsText(this.jsonFile)})}loadWeights(e){let t=[],n=[];for(let r of e)t.push(...r.weights),n.push(...r.paths);let a=this.checkManifestAndWeightFiles(e),i=n.map(e=>this.loadWeightsFile(e,a[e]));return Promise.all(i).then(e=>[t,_(e)])}loadWeightsFile(e,t){return new Promise((n,r)=>{let a=new FileReader;a.onload=e=>{let t=e.target.result;n(t)},a.onerror=t=>r(`Failed to weights data from file of path '${e}'.`),a.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){let t=[],n=this.weightsFiles.map(e=>O(e.name)),r={};for(let a of e)a.paths.forEach(e=>{let a=O(e);if(-1!==t.indexOf(a))throw Error(`Duplicate file basename found in weights manifest: '${a}'`);if(t.push(a),-1===n.indexOf(a))throw Error(`Weight file with basename '${a}' is not provided.`);r[e]=this.weightsFiles[n.indexOf(a)]});if(t.length!==this.weightsFiles.length)throw Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}let eS=e=>(0,v.OB)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(eI.URL_SCHEME)?function(e="model"){return new eI(e)}(e.slice(eI.URL_SCHEME.length)):null;function eC(e){return new ek(e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function eE(e,t,n,r){var a,i;(0,T.hu)(null!=e&&Array.isArray(e)&&e.length>0,()=>"promises must be a none empty array"),a=n=null==n?0:n,i=r=null==r?1:r,(0,T.hu)(a>=0&&a<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${a}`),(0,T.hu)(i>=0&&i<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${i}`),(0,T.hu)(i>=a,()=>`startFraction must be no more than endFraction, but got startFraction ${a} and endFraction ${i}`);let s=0,o=a=>(a.then(a=>{let i=n+ ++s/e.length*(r-n);return t(i),a}),a);return Promise.all(e.map(o))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ async function eT(e,t){null==t&&(t={});let n=null==t.fetchFunc?(0,v.OB)().platform.fetch:t.fetchFunc,r=e.map(e=>n(e,t.requestInit,{isBinary:!0})),a=null==t.onProgress?await Promise.all(r):await eE(r,t.onProgress,0,.5),i=a.map(e=>e.arrayBuffer()),s=null==t.onProgress?await Promise.all(i):await eE(i,t.onProgress,.5,1);return s}async function e$(e,t="",n,r){let a=e=>eT(e,{requestInit:r}),i=eN(a);return i(e,t,n)}function eN(e){return async(t,n="",r)=>{let a=t.map(()=>!1),i={},s=null!=r?r.map(()=>!1):[],o=[];if(t.forEach((e,t)=>{let n=0;e.weights.forEach(e=>{let l="quantization"in e?e.quantization.dtype:e.dtype,u=$[l]*T.NA(e.shape),h=()=>{a[t]=!0,null==i[t]&&(i[t]=[]),i[t].push({manifestEntry:e,groupOffset:n,sizeBytes:u})};null!=r?r.forEach((t,n)=>{t===e.name&&(h(),s[n]=!0)}):h(),o.push(e.name),n+=u})}),!s.every(e=>e)){let l=r.filter((e,t)=>!s[t]);throw Error(`Could not find weights in manifest with names: ${l.join(", ")}. 
Manifest JSON has weights with names: ${o.join(", ")}.`)}let u=a.reduce((e,t,n)=>(t&&e.push(n),e),[]),h=[];u.forEach(e=>{t[e].paths.forEach(e=>{let t=n+(n.endsWith("/")?"":"/")+e;h.push(t)})});let c=await e(h),d={},p=0;return u.forEach(e=>{let n=t[e].paths.length,r=0;for(let a=0;a<n;a++)r+=c[p+a].byteLength;let s=new ArrayBuffer(r),o=new Uint8Array(s),l=0;for(let u=0;u<n;u++){let h=new Uint8Array(c[p+u]);o.set(h,l),l+=h.byteLength}let f=i[e];f.forEach(e=>{let t=s.slice(e.groupOffset,e.groupOffset+e.sizeBytes),n=D(t,[e.manifestEntry]);for(let r in n)d[r]=n[r]}),p+=n}),d}}W.registerSaveRouter(eS);class eA{constructor(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,null!=t.fetchFunc?((0,T.hu)("function"==typeof t.fetchFunc,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=(0,v.OB)().platform.fetch,(0,T.hu)(null!=e&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&(0,T.hu)(2===e.length,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");let t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;let n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=M(e,n);t.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=e.weightData&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin");let a=await this.fetch(this.path,t);if(a.ok)return{modelArtifactsInfo:L(e),responses:[a]};throw Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${a.status}.`)}async load(){let e;let t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw Error(`Request to ${this.path} failed with status code ${t.status}. Please verify this URL points to the model JSON of the model to load.`);try{e=await t.json()}catch(r){let n=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",Error(n)}let a=e.modelTopology,i=e.weightsManifest;if(null==a&&null==i)throw Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return P(e,e=>this.loadWeights(e))}async loadWeights(e){let t=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(e){let t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),r=e.substring(0,t),a=n>t?e.substring(n):"";return[r+"/",a]}(t),a=this.weightPathPrefix||n,i=U(e),s=[],o=[];for(let l of e)for(let u of l.paths)null!=this.weightUrlConverter?o.push(this.weightUrlConverter(u)):s.push(a+u+r);this.weightUrlConverter&&s.push(...await Promise.all(o));let h=await eT(s,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[i,_(h)]}}function eD(e){return null!=e.match(eA.URL_SCHEME_REGEX)}eA.URL_SCHEME_REGEX=/^https?:\/\//;let eF=(e,t)=>{if("undefined"==typeof fetch&&(null==t||null==t.fetchFunc));else if(Array.isArray(e)?e.every(e=>eD(e)):eD(e))return eR(e,t);return null};function eR(e,t){return new eA(e,t)}function e_(e,t){return eR(e,t)}W.registerSaveRouter(eF),W.registerLoadRouter(eF);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class eO{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class eM{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class eB{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function eP(e,t,n,r){let a=arguments;return new eB(eL(...a))}function eL(e,t,n,r){if(1!=arguments.length)return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new eO({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r});{let a=null!=e.modelTopology||null!=e.weightSpecs;return a?new eO(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new eO({modelTopology:e}))}}function eU(e){return new eM(e)}function eW(e){return new eM(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ var ez=n(2200),eV=n(7650);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class eG{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class ej{constructor(){this.classNameMap={}}static getMap(){return null==ej.instance&&(ej.instance=new ej),ej.instance}static register(e){ej.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function eH(e){(0,T.hu)(null!=e.className,()=>"Class being registered does not have the static className property defined."),(0,T.hu)("string"==typeof e.className,()=>"className is required to be a string, but got type "+typeof e.className),(0,T.hu)(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),ej.register(e)}var eK=n(747),eX=n(3418);/** @license See the LICENSE file. */ let eq="3.21.0";var eY=n(4368),eQ=n(633),eZ=n(9494);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class eJ extends eG{minimize(e,t=!1,n){let{value:r,grads:a}=this.computeGradients(e,n);if(null!=n){let i=n.map(e=>({name:e.name,tensor:a[e.name]}));this.applyGradients(i)}else this.applyGradients(a);return((0,eY.B9)(a),t)?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return(0,eQ.pn)(e,t)}dispose(){null!=this.iterations_&&(0,eY.B9)(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:(0,eZ.i)(this.iterations_,"int32")}}async getWeights(){throw Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(eJ,Symbol.hasInstance,{value:e=>null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients});var e0=n(1221),e1=n(6235),e2=n(6407),e3=n(781),e4=n(2998),e6=n(47),e5=n(5176),e7=n(9121),e8=n(2582),e9=n(2668),te=n(4968);let tt=(0,e9.op)({avgPool3d_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r,a,i="NDHWC"){let s=(0,S._1)(e,"x","avgPool3d","float32"),o=s,l=!1;4===s.rank&&(l=!0,o=(0,te.X)(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),T.hu(5===o.rank,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),T.hu("NDHWC"===i,()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),(0,e8.m)("avgPool3d",r,a);let u={x:o},h=g.BV.runKernel(e7._k9,u,{filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i});return(h=(0,eb.p)(h,o.dtype),l)?(0,te.X)(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});var tn=n(94);let tr=(0,e9.op)({batchNorm2d_:function(e,t,n,r,a,i){let s,o;let l=(0,S._1)(e,"x","batchNorm"),u=(0,S._1)(t,"mean","batchNorm"),h=(0,S._1)(n,"variance","batchNorm");return null!=a&&(s=(0,S._1)(a,"scale","batchNorm")),null!=r&&(o=(0,S._1)(r,"offset","batchNorm")),T.hu(2===l.rank,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${l.rank}.`),T.hu(2===u.rank||1===u.rank,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${u.rank}.`),T.hu(2===h.rank||1===h.rank,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${h.rank}.`),null!=s&&T.hu(2===s.rank||1===s.rank,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${s.rank}.`),null!=o&&T.hu(2===o.rank||1===o.rank,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${o.rank}.`),(0,tn.t)(l,u,h,o,s,i)}}),ta=(0,e9.op)({batchNorm3d_:function(e,t,n,r,a,i){let s,o;let l=(0,S._1)(e,"x","batchNorm"),u=(0,S._1)(t,"mean","batchNorm"),h=(0,S._1)(n,"variance","batchNorm");return null!=a&&(s=(0,S._1)(a,"scale","batchNorm")),null!=r&&(o=(0,S._1)(r,"offset","batchNorm")),T.hu(3===l.rank,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${l.rank}.`),T.hu(3===u.rank||1===u.rank,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${u.rank}.`),T.hu(3===h.rank||1===h.rank,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${h.rank}.`),null!=s&&T.hu(3===s.rank||1===s.rank,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${s.rank}.`),null!=o&&T.hu(3===o.rank||1===o.rank,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${o.rank}.`),(0,tn.t)(l,u,h,o,s,i)}}),ti=(0,e9.op)({batchNorm4d_:function(e,t,n,r,a,i){let s,o;let l=(0,S._1)(e,"x","batchNorm"),u=(0,S._1)(t,"mean","batchNorm"),h=(0,S._1)(n,"variance","batchNorm");return null!=a&&(s=(0,S._1)(a,"scale","batchNorm")),null!=r&&(o=(0,S._1)(r,"offset","batchNorm")),T.hu(4===l.rank,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${l.rank}.`),T.hu(4===u.rank||1===u.rank,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${u.rank}.`),T.hu(4===h.rank||1===h.rank,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${h.rank}.`),null!=s&&T.hu(4===s.rank||1===s.rank,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${s.rank}.`),null!=o&&T.hu(4===o.rank||1===o.rank,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${o.rank}.`),(0,tn.t)(l,u,h,o,s,i)}});var ts=n(8247),to=n(2279),tl=n(6884);let tu=(0,e9.op)({concat1d_:function(e){return(0,tl.z)(e,0)}}),th=(0,e9.op)({concat2d_:function(e,t){return(0,tl.z)(e,t)}}),tc=(0,e9.op)({concat3d_:function(e,t){return(0,tl.z)(e,t)}}),td=(0,e9.op)({concat4d_:function(e,t){return(0,tl.z)(e,t)}});var tp=n(1355),tf=n(4794),tm=n(1405);let tg=(0,e9.op)({conv3d_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r,a="NDHWC",i=[1,1,1]){let s=(0,S._1)(e,"x","conv3d"),o=(0,S._1)(t,"filter","conv3d"),l=s,u=!1;4===s.rank&&(u=!0,l=(0,te.X)(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),T.hu(5===l.rank,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),T.hu(5===o.rank,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),T.hu(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),T.hu((0,e8.jT)(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),T.hu("NDHWC"===a,()=>`Error in conv3d: got dataFormat of ${a} but only NDHWC is currently supported.`);let h={x:l,filter:o},c=g.BV.runKernel(e7.x12,h,{strides:n,pad:r,dataFormat:a,dilations:i});return u?(0,te.X)(c,[c.shape[1],c.shape[2],c.shape[3],c.shape[4]]):c}});var ty=n(7594);let tb=(0,e9.op)({conv3dTranspose_:function(e,t,n,r,a){let i=(0,S._1)(e,"x","conv3dTranspose"),s=(0,S._1)(t,"filter","conv3dTranspose");return(0,ty._)(n,i,s,r,a)}});var tx=n(4718),tv=n(1274),tw=n(3233),tI=n(6477),tk=n(4842),tS=n(1300),tC=n(7501);let tE=(0,e9.op)({eye_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r="float32"){null==t&&(t=e);let a=ey([e,t],r),i=e<=t?e:t;for(let s=0;s<i;++s)a.set(1,s,s);let o=(0,te.X)(a.toTensor(),[e,t]);if(null==n)return o;if(1===n.length)return(0,tC.G)((0,tS.d)(o,0),[n[0],1,1]);if(2===n.length)return(0,tC.G)((0,tS.d)((0,tS.d)(o,0),0),[n[0],n[1],1,1]);if(3===n.length)return(0,tC.G)((0,tS.d)((0,tS.d)((0,tS.d)(o,0),0),0),[n[0],n[1],n[2],1,1]);throw Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}});var tT=n(4006),t$=n(6943),tN=n(4926),tA=n(636),tD=n(7630),tF=n(9133),tR=n(2597),t_=n(7474),tO=n(1510),tM=n(2856),tB=n(8687),tP=n(3307),tL=n(1174);let tU=(0,e9.op)({maxPool3d_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=[1,1,1],n,r,a,i="NDHWC"){let s=(0,S._1)(e,"x","maxPool3d"),o=s,l=!1;4===s.rank&&(l=!0,o=(0,te.X)(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),T.hu(5===o.rank,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),T.hu("NDHWC"===i,()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),(0,e8.m)("maxPool3d",r,a);let u={x:o},h=g.BV.runKernel(e7.OAf,u,{filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i});return l?(0,te.X)(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});var tW=n(632),tz=n(5130),tV=n(4513),tG=n(3591),tj=n(248),tH=n(827);let tK=(0,e9.op)({moments_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=null,n=!1){e=(0,S._1)(e,"x","moments");let r=(0,T.EC)(t,e.shape),a=(0,tz.J)(e,r,n),i=a.shape;n||(i=(0,tG.rv)(a.shape,r));let s=(0,tj.h)((0,tH.l)((0,eb.p)(e,"float32"),(0,te.X)(a,i))),o=(0,tz.J)(s,r,n);return{mean:a,variance:o}}});var tX=n(4841),tq=n(7370),tY=n(6500),tQ=n(6708),tZ=n(4917),tJ=n(7846),t0=n(9682),t1=n(8151),t2=n(6377);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class t3{constructor(e,t,n,r,a){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);let i=a||Math.random();this.random=t2.alea(i.toString())}nextValue(){let e,t;if(!isNaN(this.nextVal)){let n=this.nextVal;return this.nextVal=NaN,n}let r=!1;for(;!r;){let a,i,s;do s=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i;while(s>=1||0===s);let o=Math.sqrt(-2*Math.log(s)/s);e=this.mean+this.stdDev*a*o,t=this.mean+this.stdDev*i*o,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class t4{constructor(e=0,t=1,n,r){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=t2.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}let t6=(0,e9.op)({randomNormal_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=0,n=1,r,a){if(null!=r&&"bool"===r)throw Error(`Unsupported data type ${r}`);let i=new t3(t,n,r,!1,a),s=ey(e,r);for(let o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}}),t5=(0,e9.op)({randomUniform_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=0,n=1,r="float32",a){let i=ey(e,r),s=new t4(t,n,null,a);for(let o=0;o<i.values.length;o++)i.values[o]=s.nextValue();return i.toTensor()}});var t7=n(7409),t8=n(7486),t9=n(5503),ne=n(8678),nt=n(625),nn=n(2676);let nr=(0,e9.op)({slice1d_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){let r=(0,S._1)(e,"x","slice1d");return T.hu(1===r.rank,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),(0,nn.t)(r,[t],[n])}}),na=(0,e9.op)({slice2d_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){let r=(0,S._1)(e,"x","slice2d");return T.hu(2===r.rank,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),(0,nn.t)(r,t,n)}}),ni=(0,e9.op)({slice3d_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){let r=(0,S._1)(e,"x","slice3d");return T.hu(3===r.rank,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),(0,nn.t)(r,t,n)}}),ns=(0,e9.op)({slice4d_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){let r=(0,S._1)(e,"x","slice4d");return T.hu(4===r.rank,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),(0,nn.t)(r,t,n)}});var no=n(682),nl=n(3694),nu=n(8644),nh=n(3261),nc=n(9590),nd=n(2991),np=n(5475),nf=n(1869);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function nm(e,t){(0,T.Cq)(e);let n=(0,S.C)(e,t);if(1!==n.length)throw Error("tensor1d() requires values to be a flat/TypedArray");return(0,C.H)(e,null,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function ng(e,t,n){if((0,T.Cq)(e),null!=t&&2!==t.length)throw Error("tensor2d() requires shape to have two numbers");let r=(0,S.C)(e,n);if(2!==r.length&&1!==r.length)throw Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return(0,C.H)(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function ny(e,t,n){if((0,T.Cq)(e),null!=t&&3!==t.length)throw Error("tensor3d() requires shape to have three numbers");let r=(0,S.C)(e,n);if(3!==r.length&&1!==r.length)throw Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw Error("tensor3d() requires shape to be provided when `values` are a flat array");return(0,C.H)(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function nb(e,t,n){if((0,T.Cq)(e),null!=t&&4!==t.length)throw Error("tensor4d() requires shape to have four numbers");let r=(0,S.C)(e,n);if(4!==r.length&&1!==r.length)throw Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw Error("tensor4d() requires shape to be provided when `values` are a flat array");return(0,C.H)(e,t,r,n)}let nx=(0,e9.op)({truncatedNormal_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=0,n=1,r,a){if(null!=r&&"bool"===r)throw Error("Unsupported data type $ { dtype }");let i=new t3(t,n,r,!0,a),s=ey(e,r);for(let o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}});var nv=n(4136);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function nw(e,t=!0,n,r){return g.BV.makeVariable(e,t,n,r)}var nI=n(5912),nk=n(9640),nS=n(6577),nC=n(9065);let nE=(0,e9.op)({dropout_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r){let a=(0,S._1)(e,"x","dropout");if(T.hu("float32"===a.dtype,()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${a.dtype} tensor instead.`),T.hu(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),0===t)return e instanceof eg.es?a.clone():a;let i=/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){if(null==t)return e.shape.slice();if(T.cO(e.shape,t))return t;if(e.shape.length===t.length){let n=[];for(let r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(a,n),s=1-t,o=(0,tv.h)((0,t$.G)((0,e2.I)(t5(i,0,1,"float32",r),s)),s);return(0,tX.d)(a,o)}});var nT=n(3710),n$=n(7020),nN=n(8447),nA=n(4415),nD=n(6013),nF=n(9832),nR=n(3582),n_=n(1901);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function nO(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return(0,tX.d)(e,(0,n_.N)(t));throw Error(`Cannot compute gradient for fused activation ${n}.`)}function nM(e,t){let n=t,r=ez.getReductionAxes(e.shape,t.shape);return r.length>0&&(n=(0,np.S)(n,r)),(0,te.X)(n,e.shape)}function nB(e,t,n,r){if("linear"===t)return e;if("relu"===t)return(0,t7.U)(e);if("elu"===t)return(0,tw.p)(e);if("relu6"===t)return(0,nR.b)(e);if("prelu"===t)return(0,t1.A)(e,n);if("leakyrelu"===t)return(0,tF.h)(e,r);if("sigmoid"===t)return(0,nt.X)(e);throw Error(`Unknown fused activation ${t}.`)}let nP=(e,t)=>!(e>0)||"linear"===t,nL=(0,e9.op)({fusedConv2d_:/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function({x:e,filter:t,strides:n,pad:r,dataFormat:a="NHWC",dilations:i=[1,1],dimRoundingMode:s,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:h}){let c,d;if(l=l||"linear",!1===nP(g.BV.state.gradientDepth,l)){T.hu("NHWC"===a,()=>`Error in fused conv2d: got dataFormat of ${a} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let p=(0,tf.T)(e,t,n,r,a,i,s);return null!=o&&(p=(0,e2.I)(p,o)),nB(p,l,u,h)}let f=(0,S._1)(e,"x","conv2d","float32"),m=(0,S._1)(t,"filter","conv2d","float32"),y=f,b=!1;3===f.rank&&(b=!0,y=(0,te.X)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),T.hu(4===y.rank,()=>`Error in fused conv2d: input must be rank 4, but got rank ${y.rank}.`),T.hu(4===m.rank,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${m.rank}.`),e8.m("fused conv2d",r,s);let x="NHWC"===a?y.shape[3]:y.shape[1];T.hu(m.shape[2]===x,()=>`Error in conv2d: depth of input (${x}) must match input depth for filter ${m.shape[2]}.`),T.hu(e8.jT(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);let v=e8.Ix(y.shape,m.shape,n,i,r,s);if(null!=o&&(c=(0,S._1)(o,"bias","fused conv2d"),[c]=(0,eK.makeTypesMatch)(c,f),"NHWC"===a?ez.assertAndGetBroadcastShape(v.outShape,c.shape):(T.hu(c.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${c.shape.length}.`),T.hu(0===c.shape.length||c.shape[0]===v.outChannels||1===c.shape[0],()=>`Error in fused conv2d: bias shape (${c.shape}) is not compatible with the number of output channels (${v.outChannels})`))),null!=u){let w=u.shape;if(T.hu(w.length<=1||3===w.length,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${w.length}.`),1===w.length)T.hu(1===w[0]||w[0]===v.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${w}) is not compatible with the number of output channels (${v.outChannels}).`);else if(3===w.length)try{ez.assertAndGetBroadcastShape(w,v.outShape)}catch(k){let I=`Error in fused conv2d: PReLU activation weights (${w}) is not compatible with the output shape of the conv2d (${v.outShape}).`;throw Error(I)}d=(0,S._1)(u,"prelu weights","fused conv2d")}let C=(e,t)=>{T.hu("NHWC"===a,()=>`Error in gradient of fused conv2D: got dataFormat of ${a} but only NHWC is currently supported.`);let[s,o,u,h]=t,c=nO(e,u,l);T.hu(e8.I0(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);let d=(0,nF._)(o.shape,c,s,n,r),p=(0,nD.p)(o,c,s.shape,n,r),f=[d,p];if(null!=h){let m=nM(h,c);f.push(m)}return f},E={x:y,filter:m,bias:c,preluActivationWeights:d},$={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:s,activation:l,leakyreluAlpha:h};if(null==o){let N=(0,eQ.cb)((e,t,n)=>{let r=g.BV.runKernel(e7._V0,E,$);return n([t,e,r]),b&&(r=(0,te.X)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:C}});return N(y,m)}{let A=(0,eQ.cb)((e,t,n,r)=>{let a=g.BV.runKernel(e7._V0,E,$);return r([t,e,a,n]),b&&(a=(0,te.X)(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:C}});return A(y,m,c)}}});var nU=n(8098),nW=n(4375);let nz=(0,e9.op)({fusedDepthwiseConv2d_:/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function({x:e,filter:t,strides:n,pad:r,dataFormat:a="NHWC",dilations:i=[1,1],dimRoundingMode:s,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:h}){let c,d;if(!1===nP(g.BV.state.gradientDepth,l)){let p=(0,tx.B)(e,t,n,r,a,i,s);return null!=o&&(p=(0,e2.I)(p,o)),nB(p,l,u,h)}let f=(0,S._1)(e,"x","depthwiseConv2d","float32"),m=(0,S._1)(t,"filter","depthwiseConv2d","float32"),y=f,b=!1;3===f.rank&&(b=!0,y=(0,te.X)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),T.hu(4===y.rank,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${y.rank}.`),T.hu(4===m.rank,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${m.rank}.`),T.hu(y.shape[3]===m.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${y.shape[3]}) must match the inChannels dimension in filter ${m.shape[2]}.`),null==i&&(i=[1,1]),T.hu(e8.jT(n,i),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),e8.m("fused depthwiseConv2d",r,s);let x=e8.Ix(y.shape,m.shape,n,i,r,s,!0);null!=o&&(c=(0,S._1)(o,"bias","fused conv2d"),[c]=(0,eK.makeTypesMatch)(c,f),ez.assertAndGetBroadcastShape(x.outShape,c.shape)),null!=u&&(d=(0,S._1)(u,"prelu weights","fused depthwiseConv2d"));let v=(e,t)=>{T.hu(e8.I0(i),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);let[a,o,u,h]=t,d=nO(e,u,l),p=(0,nW.v)(o.shape,d,a,n,r,i,s),f=(0,nU.z)(o,d,a.shape,n,r,i,s);if(null!=h){let m=nM(c,d);return[p,f,m]}return[p,f]},w={x:y,filter:m,bias:c,preluActivationWeights:d},I={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:s,activation:l,leakyreluAlpha:h};if(null==o){let k=(0,eQ.cb)((e,t,n)=>{let r=g.BV.runKernel(e7.luS,w,I);return n([t,e,r]),b&&(r=(0,te.X)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:v}});return k(y,m)}{let C=(0,eQ.cb)((e,t,n,r)=>{let a=g.BV.runKernel(e7.luS,w,I);return r([t,e,a,n]),b&&(a=(0,te.X)(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:v}});return C(y,m,c)}}}),nV=(0,e9.op)({fusedMatMul_:/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function({a:e,b:t,transposeA:n=!1,transposeB:r=!1,bias:a,activation:i="linear",preluActivationWeights:s,leakyreluAlpha:o=.2}){let l,u;if(!1===nP(g.BV.state.gradientDepth,i)){let h=(0,tB.O)(e,t,n,r);return null!=a&&(h=(0,e2.I)(h,a)),nB(h,i,s,o)}let c=(0,S._1)(e,"a","fused matMul"),d=(0,S._1)(t,"b","fused matMul");[c,d]=(0,eK.makeTypesMatch)(c,d);let p=n?c.shape[c.rank-2]:c.shape[c.rank-1],f=r?d.shape[d.rank-1]:d.shape[d.rank-2],m=n?c.shape[c.rank-1]:c.shape[c.rank-2],y=r?d.shape[d.rank-2]:d.shape[d.rank-1],b=c.shape.slice(0,-2),x=d.shape.slice(0,-2),v=T.NA(b),w=T.NA(x);T.hu(p===f,()=>`Error in fused matMul: inner shapes (${p}) and (${f}) of Tensors with shapes ${c.shape} and ${d.shape} and transposeA=${n} and transposeB=${r} must match.`);let I=ez.assertAndGetBroadcastShape(c.shape.slice(0,-2),d.shape.slice(0,-2)),k=I.concat([m,y]),C=n?(0,te.X)(c,[v,p,m]):(0,te.X)(c,[v,m,p]),E=r?(0,te.X)(d,[w,y,f]):(0,te.X)(d,[w,f,y]);null!=a&&(l=(0,S._1)(a,"bias","fused matMul"),[l]=(0,eK.makeTypesMatch)(l,c),ez.assertAndGetBroadcastShape(k,l.shape)),null!=s&&(u=(0,S._1)(s,"prelu weights","fused matMul"));let $=(e,t)=>{let s,o;let[l,u,h,c]=t,d=nO((0,te.X)(e,h.shape),h,i);if(n||r?!n&&r?(s=(0,tB.O)(d,u,!1,!1),o=(0,tB.O)(d,l,!0,!1)):n&&!r?(s=(0,tB.O)(u,d,!1,!0),o=(0,tB.O)(l,d,!1,!1)):(s=(0,tB.O)(u,d,!0,!0),o=(0,tB.O)(d,l,!0,!0)):(s=(0,tB.O)(d,u,!1,!0),o=(0,tB.O)(l,d,!0,!1)),null==a)return[s,o];{let p=nM(c,d);return[s,o,p]}},N={a:C,b:E,bias:l,preluActivationWeights:u},A={transposeA:n,transposeB:r,activation:i,leakyreluAlpha:o};if(null==a){let D=(0,eQ.cb)((e,t,n)=>{let r=g.BV.runKernel(e7.usg,N,A);return n([e,t,r]),{value:(0,te.X)(r,k),gradFunc:$}});return D(C,E)}{let F=(0,eQ.cb)((e,t,n,r)=>{let a=g.BV.runKernel(e7.usg,N,A);return r([e,t,a,n]),{value:(0,te.X)(a,k),gradFunc:$}});return F(C,E,l)}}});function nG(e,t,n){let r=1-e%2,a=new Float32Array(e);for(let i=0;i<e;++i){let s=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(s)}return nm(a,"float32")}(0,e9.op)({hammingWindow_:/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){return nG(e,.54,.46)}});let nj=(0,e9.op)({hannWindow_:/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){return nG(e,.5,.5)}}),nH=(0,e9.op)({frame_:/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r=!1,a=0){let i=0,s=[];for(;i+t<=e.size;)s.push((0,nn.t)(e,i,t)),i+=n;if(r)for(;i<e.size;){let o=i+t-e.size,l=(0,tl.z)([(0,nn.t)(e,i,t-o),(0,tT.h)([o],a)]);s.push(l),i+=n}return 0===s.length?ng([],[0,t]):(0,te.X)((0,tl.z)(s),[s.length,t])}});(0,e9.op)({stft_:/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r,a=nj){null==r&&(r=Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2)))));let i=nH(e,t,n),s=(0,tX.d)(i,a(t));return(0,nT.Q)(s,r)}});let nK=(0,e9.op)({cropAndResize_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r,a="bilinear",i=0){let s=(0,S._1)(e,"image","cropAndResize"),o=(0,S._1)(t,"boxes","cropAndResize","float32"),l=(0,S._1)(n,"boxInd","cropAndResize","int32"),u=o.shape[0];T.hu(4===s.rank,()=>`Error in cropAndResize: image must be rank 4,but got rank ${s.rank}.`),T.hu(2===o.rank&&4===o.shape[1],()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${o.shape}.`),T.hu(1===l.rank&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${o.shape}.`),T.hu(2===r.length,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),T.hu(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),T.hu("bilinear"===a||"nearest"===a,()=>`method must be bilinear or nearest, but was ${a}`);let h=g.BV.runKernel(e7.VcC,{image:s,boxes:o,boxInd:l},{method:a,extrapolationValue:i,cropSize:r});return h}}),nX=(0,e9.op)({flipLeftRight_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,S._1)(e,"image","flipLeftRight","float32");T.hu(4===t.rank,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);let n=g.BV.runKernel(e7.Uyb,{image:t},{});return n}}),nq=(0,e9.op)({grayscaleToRGB_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,S._1)(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];T.hu(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),T.hu(1===r,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);let a=Array(t.rank);return a.fill(1,0,n),a[n]=3,(0,tC.G)(t,a)}}),nY=(0,e9.op)({rotateWithOffset_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n=0,r=.5){let a=(0,S._1)(e,"image","rotateWithOffset","float32");T.hu(4===a.rank,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${a.rank}.`);let i=g.BV.runKernel(e7.b9H,{image:a},{radians:t,fillValue:n,center:r});return i}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function nQ(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);let s=e.shape[0];return n=Math.min(n,s),T.hu(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),T.hu(2===e.rank,()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`),T.hu(4===e.shape[1],()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`),T.hu(1===t.rank,()=>"scores must be a 1D tensor"),T.hu(t.shape[0]===s,()=>`scores has incompatible shape with boxes. Expected ${s}, but was ${t.shape[0]}`),T.hu(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}let nZ=(0,e9.op)({nonMaxSuppression_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY){let i=(0,S._1)(e,"boxes","nonMaxSuppression","float32"),s=(0,S._1)(t,"scores","nonMaxSuppression","float32"),o=nQ(i,s,n,r,a);n=o.maxOutputSize,r=o.iouThreshold,a=o.scoreThreshold;let l={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return g.BV.runKernel(e7.uv1,{boxes:i,scores:s},l)}});function nJ(e,t){return e>t?1:e<t?-1:0}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function n0(e,t,n,r,a){return n3(e,t,n,r,a,0)}function n1(e,t,n,r,a,i){return n3(e,t,n,r,a,0,!1,i,!0)}function n2(e,t,n,r,a,i){return n3(e,t,n,r,a,i,!0)}function n3(e,t,n,r,a,i,s=!1,o=!1,l=!1){let u=[];for(let h=0;h<t.length;h++)t[h]>a&&u.push({score:t[h],boxIndex:h,suppressBeginIndex:0});u.sort(n4);let c=i>0?-.5/i:0,d=[],p=[];for(;d.length<n&&u.length>0;){let f=u.pop(),{score:m,boxIndex:g,suppressBeginIndex:y}=f;if(m<a)break;let b=!1;for(let x=d.length-1;x>=y;--x){let v=function(e,t,n){let r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),o=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(a[0],a[2]),h=Math.min(a[1],a[3]),c=Math.max(a[0],a[2]),d=Math.max(a[1],a[3]),p=(o-i)*(l-s),f=(c-u)*(d-h);if(p<=0||f<=0)return 0;let m=Math.max(i,u),g=Math.max(s,h),y=Math.min(o,c),b=Math.min(l,d),x=Math.max(y-m,0)*Math.max(b-g,0);return x/(p+f-x)}(e,g,d[x]);if(v>=r){b=!0;break}if(f.score=f.score*function(e,t,n){let r=Math.exp(t*n*n);return n<=e?r:0}(r,c,v),f.score<=a)break}f.suppressBeginIndex=d.length,!b&&(f.score===m?(d.push(g),p.push(f.score)):f.score>a&&/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){let r=function(e,t,n){let r=0,a=e.length,i=0,s=!1;for(;r<a;){i=r+(a-r>>>1);let o=n(t,e[i]);o>0?r=i+1:(a=i,s=!o)}return s?r:-r-1}(e,t,n||nJ);e.splice(r<0?-(r+1):r,0,t)}(u,f,n4))}let w=d.length,I=n-w;o&&I>0&&(d.push(...Array(I).fill(0)),p.push(...Array(I).fill(0)));let k={selectedIndices:d};return s&&(k.selectedScores=p),l&&(k.validOutputs=w),k}function n4(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ async function n6(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY){let i=(0,S._1)(e,"boxes","nonMaxSuppressionAsync"),s=(0,S._1)(t,"scores","nonMaxSuppressionAsync"),o=nQ(i,s,n,r,a);n=o.maxOutputSize,r=o.iouThreshold,a=o.scoreThreshold;let l=await Promise.all([i.data(),s.data()]),u=l[0],h=l[1],{selectedIndices:c}=n0(u,h,n,r,a);return i!==e&&i.dispose(),s!==t&&s.dispose(),nm(c,"int32")}let n5=(0,e9.op)({nonMaxSuppressionWithScore_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,i=0){let s=(0,S._1)(e,"boxes","nonMaxSuppression"),o=(0,S._1)(t,"scores","nonMaxSuppression"),l=nQ(s,o,n,r,a,i);n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,i=l.softNmsSigma;let u={maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i},h=g.BV.runKernel(e7.W0H,{boxes:s,scores:o},u);return{selectedIndices:h[0],selectedScores:h[1]}}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ async function n7(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,i=0){let s=(0,S._1)(e,"boxes","nonMaxSuppressionAsync"),o=(0,S._1)(t,"scores","nonMaxSuppressionAsync"),l=nQ(s,o,n,r,a,i);n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,i=l.softNmsSigma;let u=await Promise.all([s.data(),o.data()]),h=u[0],c=u[1],{selectedIndices:d,selectedScores:p}=n2(h,c,n,r,a,i);return s!==e&&s.dispose(),o!==t&&o.dispose(),{selectedIndices:nm(d,"int32"),selectedScores:nm(p)}}let n8=(0,e9.op)({nonMaxSuppressionPadded_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,i=!1){let s=(0,S._1)(e,"boxes","nonMaxSuppression"),o=(0,S._1)(t,"scores","nonMaxSuppression"),l=nQ(s,o,n,r,a,null),u=l.maxOutputSize,h=l.iouThreshold,c=l.scoreThreshold,d=g.BV.runKernel(e7.cye,{boxes:s,scores:o},{maxOutputSize:u,iouThreshold:h,scoreThreshold:c,padToMaxOutputSize:i});return{selectedIndices:d[0],validOutputs:d[1]}}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ async function n9(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,i=!1){let s=(0,S._1)(e,"boxes","nonMaxSuppressionAsync"),o=(0,S._1)(t,"scores","nonMaxSuppressionAsync"),l=nQ(s,o,n,r,a,null),u=l.maxOutputSize,h=l.iouThreshold,c=l.scoreThreshold,[d,p]=await Promise.all([s.data(),o.data()]),{selectedIndices:f,validOutputs:m}=n1(d,p,u,h,c,i);return s!==e&&s.dispose(),o!==t&&o.dispose(),{selectedIndices:nm(f,"int32"),validOutputs:(0,eZ.i)(m,"int32")}}var re=n(3305),rt=n(5098);let rn=(0,e9.op)({bincount_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){let r=(0,S._1)(e,"x","bincount"),a=(0,S._1)(t,"weights","bincount");return T.hu("int32"===r.dtype,()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),T.hu(n>=0,()=>`size must be non-negative, but got ${n}.`),T.hu(a.size===r.size||0===a.size,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${a.shape}.`),g.BV.runKernel(e7.zvY,{x:r,weights:a},{size:n})}});var rr=n(624),ra=n(7809);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function ri(e,t,n=1,r="float32"){if(0===n)throw Error("Cannot have a step of zero");return g.BV.runKernel(e7.e6w,{},{start:e,stop:t,step:n,dtype:r})}let rs=(0,e9.op)({threshold_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t="binary",n=!1,r=.5){let a,i,s,o;let l=(0,S._1)(e,"image","threshold"),u=l.shape[0]*l.shape[1],h=(0,tX.d)(nm([r]),255);if(T.hu(3===l.rank,()=>`Error in threshold: image must be rank 3,but got rank ${l.rank}.`),T.hu(3===l.shape[2]||1===l.shape[2],()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${l.shape[2]}.`),T.hu("int32"===l.dtype||"float32"===l.dtype,()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${l.dtype}.`),T.hu("otsu"===t||"binary"===t,()=>`Method must be binary or otsu, but was ${t}`),3===l.shape[2]){[a,i,s]=(0,nu.V)(l,[1,1,1],-1);let c=(0,tX.d)(a,.2989),d=(0,tX.d)(i,.587),p=(0,tX.d)(s,.114);o=(0,e2.I)((0,e2.I)(c,d),p)}else o=e;if("otsu"===t){let f=rn((0,eb.p)((0,ra.N)(o),"int32"),E([]),256);h=function(e,t){let n,r,a,i,s,o,l=nm([-1]),u=nm([0]),h=nm([0]);for(let c=0;c<e.size-1;c++){n=(0,nn.t)(e,0,c+1),r=(0,nn.t)(e,c+1),s=(0,tv.h)((0,np.S)(n),t),o=(0,tv.h)((0,np.S)(r),t);let d=(0,np.S)((0,tX.d)(n,ri(0,n.size)));a=(0,tv.h)(d,(0,np.S)(n));let p=(0,tT.h)(r.shape,n.size),f=(0,e2.I)(ri(0,r.size),p),m=(0,tX.d)(r,f);i=(0,tv.h)((0,np.S)(m),(0,np.S)(r));let g=(0,tH.l)(a,i),y=(0,tH.l)(a,i),b=(0,tX.d)(s,o);h=(0,tX.d)((0,tX.d)(b,g),y);let x=(0,tA.p)(h,u);u=(0,nI.a)(x,h,u),l=(0,nI.a)(x,nm([c]),l)}return l}(f,u)}let m=n?(0,rr.z)(o,h):(0,tA.p)(o,h),g=(0,eb.p)((0,tX.d)(m,255),"int32");return g}}),ro=(0,e9.op)({transform_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n="nearest",r="constant",a=0,i){let s=(0,S._1)(e,"image","transform","float32"),o=(0,S._1)(t,"transforms","transform","float32");return T.hu(4===s.rank,()=>`Error in transform: image must be rank 4,but got rank ${s.rank}.`),T.hu(2===o.rank&&(o.shape[0]===s.shape[0]||1===o.shape[0])&&8===o.shape[1],()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),T.hu(null==i||2===i.length,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`),g.BV.runKernel(e7.wx7,{image:s,transforms:o},{interpolation:n,fillMode:r,fillValue:a,outputShape:i})}}),rl=(0,e9.op)({bandPart_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){(0,T.hu)(t%1==0,()=>`bandPart(): numLower must be an integer, got ${t}.`),(0,T.hu)(n%1==0,()=>`bandPart(): numUpper must be an integer, got ${n}.`);let r=(0,S._1)(e,"a","bandPart");(0,T.hu)(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);let a=r.shape,[i,s]=r.shape.slice(-2);if(!(t<=i))throw Error(`bandPart(): numLower (${t}) must not be greater than the number of rows (${i}).`);if(!(n<=s))throw Error(`bandPart(): numUpper (${n}) must not be greater than the number of columns (${s}).`);t<0&&(t=i),n<0&&(n=s);let o=(0,te.X)(ri(0,i,1,"int32"),[-1,1]),l=ri(0,s,1,"int32"),u=(0,tH.l)(o,l),h=(0,tM.H)((0,rr.z)(u,(0,eZ.i)(+t,"int32")),(0,tD.b)(u,(0,eZ.i)(-n,"int32"))),c=(0,nk.l)([i,s],r.dtype);return(0,te.X)((0,nd.k)((0,nv.H)((0,te.X)(r,[-1,i,s])).map(e=>(0,nI.a)(h,e,c))),a)}});var ru=n(3561);let rh=(0,e9.op)({gramSchmidt_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t;if(Array.isArray(e)){t=!1,(0,T.hu)(null!=e&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");let n=e[0].shape[0];for(let r=1;r<e.length;++r)(0,T.hu)(e[r].shape[0]===n,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[r].shape[0]} vs. ${n})`)}else t=!0,e=(0,nu.V)(e,e.shape[0],0).map(e=>(0,nc.L)(e,[0]));(0,T.hu)(e.length<=e[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`);let a=[],i=e;for(let s=0;s<e.length;++s)a.push(g.BV.tidy(()=>{let e=i[s];if(s>0)for(let t=0;t<s;++t){let n=(0,tX.d)((0,np.S)((0,tX.d)(a[t],e)),a[t]);e=(0,tH.l)(e,n)}return(0,tv.h)(e,(0,ru.K)(e,"euclidean"))}));return t?(0,nd.k)(a,0):a}});function rc(e,t=!1){return g.BV.tidy(()=>{(0,T.hu)(2===e.shape.length,()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`);let n=e.shape[0],r=e.shape[1],a=tE(n),i=(0,ex.d)(e),s=ng([[1]],[1,1]),o=(0,ex.d)(s),l=n>=r?r:n;for(let u=0;u<l;++u){let h=i,c=o,d=a;[o,i,a]=g.BV.tidy(()=>{let e=(0,nn.t)(i,[u,u],[n-u,1]),t=(0,ru.K)(e),l=(0,nn.t)(i,[u,u],[1,1]),h=(0,nI.a)((0,tA.p)(l,0),ng([[-1]]),ng([[1]])),c=(0,tH.l)(l,(0,tX.d)(h,t)),d=(0,tv.h)(e,c);o=1===d.shape[0]?(0,ex.d)(s):(0,tl.z)([s,(0,nn.t)(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);let p=(0,tq.W)((0,tv.h)((0,tB.O)(h,c),t)),f=(0,nn.t)(i,[u,0],[n-u,r]),m=(0,tX.d)(p,o),g=(0,nC.p)(o);if(0===u)i=(0,tH.l)(f,(0,tB.O)(m,(0,tB.O)(g,f)));else{let y=(0,tH.l)(f,(0,tB.O)(m,(0,tB.O)(g,f)));i=(0,tl.z)([(0,nn.t)(i,[0,0],[u,r]),y],0)}let b=(0,nC.p)(m),x=(0,nn.t)(a,[0,u],[n,a.shape[1]-u]);if(0===u)a=(0,tH.l)(x,(0,tB.O)((0,tB.O)(x,o),b));else{let v=(0,tH.l)(x,(0,tB.O)((0,tB.O)(x,o),b));a=(0,tl.z)([(0,nn.t)(a,[0,0],[n,u]),v],1)}return[o,i,a]}),(0,eY.B9)([h,c,d])}return!t&&n>r&&(a=(0,nn.t)(a,[0,0],[n,r]),i=(0,nn.t)(i,[0,0],[r,r])),[a,i]})}let rd=(0,e9.op)({qr_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=!1){if((0,T.hu)(e.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`),2===e.rank)return rc(e,t);{let n=e.shape.slice(0,e.shape.length-2).reduce((e,t)=>e*t),r=(0,nv.H)((0,te.X)(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];r.forEach(e=>{let[n,r]=rc(e,t);a.push(n),i.push(r)});let s=(0,te.X)((0,nd.k)(a,0),e.shape),o=(0,te.X)((0,nd.k)(i,0),e.shape);return[s,o]}}});(i=o||(o={}))[i.NONE=0]="NONE",i[i.MEAN=1]="MEAN",i[i.SUM=2]="SUM",i[i.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS";let rp=(0,e9.op)({computeWeightedLoss_:function(e,t,n=o.SUM_BY_NONZERO_WEIGHTS){let r=(0,S._1)(e,"losses","computeWeightedLoss"),a=null;null!=t&&(a=(0,S._1)(t,"weights","computeWeightedLoss"));let i=null==a?r:(0,tX.d)(r,a);if(n===o.NONE)return i;if(n===o.SUM)return(0,np.S)(i);if(n===o.MEAN){if(null==a)return(0,tz.J)(i);{let s=r.size/a.size,l=(0,tv.h)((0,np.S)(i),(0,np.S)(a));return s>1?(0,tv.h)(l,(0,eZ.i)(s)):l}}if(n===o.SUM_BY_NONZERO_WEIGHTS){if(null==a)return(0,tv.h)((0,np.S)(i),(0,eZ.i)(r.size));{let u=(0,tX.d)(a,(0,tZ.i)(r.shape)),h=(0,eb.p)((0,np.S)((0,tY.Q)(u,(0,eZ.i)(0))),"float32");return(0,tv.h)((0,np.S)(i),h)}}throw Error(`Unknown reduction: ${n}`)}});(0,e9.op)({absoluteDifference_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r=o.SUM_BY_NONZERO_WEIGHTS){let a=(0,S._1)(e,"labels","absoluteDifference"),i=(0,S._1)(t,"predictions","absoluteDifference"),s=null;null!=n&&(s=(0,S._1)(n,"weights","absoluteDifference")),(0,T.k5)(a.shape,i.shape,"Error in absoluteDifference: ");let l=(0,e1.W)((0,tH.l)(a,i));return rp(l,s,r)}}),(0,e9.op)({cosineDistance_:function(e,t,n,r,a=o.SUM_BY_NONZERO_WEIGHTS){let i=(0,S._1)(e,"labels","cosineDistance"),s=(0,S._1)(t,"predictions","cosineDistance"),l=null;null!=r&&(l=(0,S._1)(r,"weights","cosineDistance")),(0,T.k5)(i.shape,s.shape,"Error in cosineDistance: ");let u=(0,eZ.i)(1),h=(0,tH.l)(u,(0,np.S)((0,tX.d)(i,s),n,!0));return rp(h,l,a)}}),(0,e9.op)({hingeLoss_:function(e,t,n,r=o.SUM_BY_NONZERO_WEIGHTS){let a=(0,S._1)(e,"labels","hingeLoss"),i=(0,S._1)(t,"predictions","hingeLoss"),s=null;null!=n&&(s=(0,S._1)(n,"weights","hingeLoss")),(0,T.k5)(a.shape,i.shape,"Error in hingeLoss: ");let l=(0,eZ.i)(1);a=(0,tH.l)((0,tX.d)((0,eZ.i)(2),a),l);let u=(0,t7.U)((0,tH.l)(l,(0,tX.d)(a,i)));return rp(u,s,r)}}),(0,e9.op)({huberLoss_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r=1,a=o.SUM_BY_NONZERO_WEIGHTS){let i=(0,S._1)(e,"labels","huberLoss"),s=(0,S._1)(t,"predictions","huberLoss"),l=null;null!=n&&(l=(0,S._1)(n,"weights","huberLoss")),(0,T.k5)(i.shape,s.shape,"Error in huberLoss: ");let u=(0,eZ.i)(r),h=(0,e1.W)((0,tH.l)(s,i)),c=(0,tV.L)(h,u),d=(0,tH.l)(h,c),p=(0,e2.I)((0,tX.d)((0,eZ.i)(.5),(0,tj.h)(c)),(0,tX.d)(u,d));return rp(p,l,a)}}),(0,e9.op)({logLoss_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r=1e-7,a=o.SUM_BY_NONZERO_WEIGHTS){let i=(0,S._1)(e,"labels","logLoss"),s=(0,S._1)(t,"predictions","logLoss"),l=null;null!=n&&(l=(0,S._1)(n,"weights","logLoss")),(0,T.k5)(i.shape,s.shape,"Error in logLoss: ");let u=(0,eZ.i)(1),h=(0,eZ.i)(r),c=(0,tq.W)((0,tX.d)(i,(0,tR.c)((0,e2.I)(s,h)))),d=(0,tX.d)((0,tH.l)(u,i),(0,tR.c)((0,e2.I)((0,tH.l)(u,s),h))),p=(0,tH.l)(c,d);return rp(p,l,a)}});var rf=n(5265);(0,e9.op)({meanSquaredError_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r=o.SUM_BY_NONZERO_WEIGHTS){let a=(0,S._1)(e,"labels","meanSquaredError"),i=(0,S._1)(t,"predictions","meanSquaredError"),s=null;null!=n&&(s=(0,S._1)(n,"weights","meanSquaredError")),(0,T.k5)(a.shape,i.shape,"Error in meanSquaredError: ");let l=(0,rf.$)(a,i);return rp(l,s,r)}}),(0,e9.op)({sigmoidCrossEntropy_:function(e,t,n,r=0,a=o.SUM_BY_NONZERO_WEIGHTS){let i=(0,S._1)(e,"multiClassLabels","sigmoidCrossEntropy"),s=(0,S._1)(t,"logits","sigmoidCrossEntropy"),l=null;if(null!=n&&(l=(0,S._1)(n,"weights","sigmoidCrossEntropy")),(0,T.k5)(i.shape,s.shape,"Error in sigmoidCrossEntropy: "),r>0){let u=(0,eZ.i)(r),h=(0,eZ.i)(1),c=(0,eZ.i)(.5);i=(0,e2.I)((0,tX.d)(i,(0,tH.l)(h,u)),(0,tX.d)(c,u))}let d=/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,S._1)(e,"labels","sigmoidCrossEntropyWithLogits"),r=(0,S._1)(t,"logits","sigmoidCrossEntropyWithLogits");(0,T.k5)(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");let a=(0,t7.U)(r),i=(0,tX.d)(r,n),s=(0,t_.K)((0,tk.Q)((0,tq.W)((0,e1.W)(r))));return(0,e2.I)((0,tH.l)(a,i),s)}(i,s);return rp(d,l,a)}});var rm=n(1391);(0,e9.op)({softmaxCrossEntropy_:function(e,t,n,r=0,a=o.SUM_BY_NONZERO_WEIGHTS){let i=(0,S._1)(e,"onehotLabels","softmaxCrossEntropy"),s=(0,S._1)(t,"logits","softmaxCrossEntropy"),l=null;if(null!=n&&(l=(0,S._1)(n,"weights","softmaxCrossEntropy")),(0,T.k5)(i.shape,s.shape,"Error in softmaxCrossEntropy: "),r>0){let u=(0,eZ.i)(r),h=(0,eZ.i)(1),c=(0,eZ.i)(i.shape[1]);i=(0,e2.I)((0,tX.d)(i,(0,tH.l)(h,u)),(0,tv.h)(u,c))}let d=/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n=-1){if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);let r=(0,eQ.cb)((e,t,r)=>{let a=(0,rm.l)(t,[n],!0),i=(0,tH.l)((0,eb.p)(t,"float32"),a);r([e,i]);let s=(0,tq.W)((0,tX.d)(i,e)),o=(0,np.S)(s,[n]),l=(e,t)=>{let[r,a]=t,i=(0,tG.rv)(e.shape,[n]);return[(0,tX.d)((0,te.X)(e,i),(0,tH.l)((0,eb.p)(r,"float32"),(0,tk.Q)(a))),(0,tX.d)((0,te.X)(e,i),(0,tH.l)((0,tk.Q)(a),(0,eb.p)(r,"float32")))]};return{value:o,gradFunc:l}});return r(e,t)}(i,s);return rp(d,l,a)}}),(0,e9.op)({sparseFillEmptyRows_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r){let a=(0,S._1)(e,"indices","sparseFillEmptyRows","int32"),i=(0,S._1)(t,"values","sparseFillEmptyRows"),s=(0,S._1)(n,"denseShape","sparseFillEmptyRows","int32"),o=(0,S._1)(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(2!==a.rank)throw Error(`Indices should be Tensor2D but received shape
        ${a.shape}`);if(1!==i.rank)throw Error(`Values should be Tensor1D but received shape ${i.shape}`);if(1!==s.rank)throw Error(`Dense shape should be Tensor1D but received shape ${s.shape}`);if(0!==o.rank)throw Error(`Default value should be a scalar but received shape ${o.shape}`);let l=g.BV.runKernel(e7.O3z,{indices:a,values:i,denseShape:s,defaultValue:o});return{outputIndices:l[0],outputValues:l[1],emptyRowIndicator:l[2],reverseIndexMap:l[3]}}}),(0,e9.op)({sparseReshape_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){let r=(0,S._1)(e,"inputIndices","sparseReshape","int32"),a=(0,S._1)(t,"inputShape","sparseReshape","int32"),i=(0,S._1)(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(1!==a.rank)throw Error(`Input shape should be Tensor1D but received shape ${a.shape}`);if(1!==i.rank)throw Error(`New shape should be Tensor1D but received shape ${i.shape}`);let s=g.BV.runKernel(e7.nhH,{inputIndices:r,inputShape:a,newShape:i});return{outputIndices:s[0],outputShape:s[1]}}}),(0,e9.op)({sparseSegmentMean_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){let r=(0,S._1)(e,"data","sparseSegmentMean"),a=(0,S._1)(t,"indices","sparseSegmentMean","int32"),i=(0,S._1)(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw Error(`Indices should be Tensor1D but received shape
          ${a.shape}`);if(1!==i.rank)throw Error(`Segment ids should be Tensor1D but received shape
          ${i.shape}`);return g.BV.runKernel(e7.w3H,{data:r,indices:a,segmentIds:i})}}),(0,e9.op)({sparseSegmentSum_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){let r=(0,S._1)(e,"data","sparseSegmentSum"),a=(0,S._1)(t,"indices","sparseSegmentSum","int32"),i=(0,S._1)(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw Error(`Indices should be Tensor1D but received shape
         ${a.shape}`);if(1!==i.rank)throw Error(`Segment ids should be Tensor1D but received shape
         ${i.shape}`);return g.BV.runKernel(e7.ZjV,{data:r,indices:a,segmentIds:i})}}),(0,e9.op)({stringNGrams_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r,a,i,s,o){let l=(0,S._1)(e,"data","stringNGrams","string");if("string"!==l.dtype)throw Error("Data must be of datatype string");if(1!==l.shape.length)throw Error(`Data must be a vector, saw: ${l.shape}`);let u=(0,S._1)(t,"dataSplits","stringNGrams");if("int32"!==u.dtype)throw Error("Data splits must be of datatype int32");let h=g.BV.runKernel(e7._JP,{data:l,dataSplits:u},{separator:n,nGramWidths:r,leftPad:a,rightPad:i,padWidth:s,preserveShortSequences:o});return{nGrams:h[0],nGramsSplits:h[1]}}}),(0,e9.op)({stringSplit_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n=!0){let r=(0,S._1)(e,"input","stringSplit","string"),a=(0,S._1)(t,"delimiter","stringSplit","string");if(1!==r.rank)throw Error(`Input should be Tensor1D but received shape ${r.shape}`);if(0!==a.rank)throw Error(`Delimiter should be a scalar but received shape ${a.shape}`);let i=g.BV.runKernel(e7.s1s,{input:r,delimiter:a},{skipEmpty:n});return{indices:i[0],values:i[1],shape:i[2]}}}),(0,e9.op)({stringToHashBucketFast_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,S._1)(e,"input","stringToHashBucketFast","string");if(t<=0)throw Error("Number of buckets must be at least 1");return g.BV.runKernel(e7.XkS,{input:n},{numBuckets:t})}}),n$.k,nN.S,nT.Q,nA.w;let rg={flipLeftRight:nX,grayscaleToRGB:nq,resizeNearestNeighbor:rt.j,resizeBilinear:re.I,rotateWithOffset:nY,cropAndResize:nK,nonMaxSuppression:nZ,nonMaxSuppressionAsync:n6,nonMaxSuppressionWithScore:n5,nonMaxSuppressionWithScoreAsync:n7,nonMaxSuppressionPadded:n8,nonMaxSuppressionPaddedAsync:n9,threshold:rs,transform:ro},ry={bandPart:rl,gramSchmidt:rh,qr:rd};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class rb extends eJ{constructor(e,t,n=null){super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=g.BV.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);t.forEach((t,n)=>{let r=g.BV.registeredVariables[t];null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:`${t}/accum_grad`,variable:(0,eY.lu)(()=>(0,nS.P)(r).variable(!1))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:`${t}/accum_var`,variable:(0,eY.lu)(()=>(0,nS.P)(r).variable(!1))});let a=Array.isArray(e)?e[n].tensor:e[t];if(null==a)return;let i=this.accumulatedGrads[n].variable,s=this.accumulatedUpdates[n].variable;(0,eY.lu)(()=>{let e=(0,e2.I)((0,tX.d)(i,this.rho),(0,tX.d)((0,tj.h)(a),1-this.rho)),t=(0,tX.d)((0,tv.h)((0,nh._)((0,e2.I)(s,this.epsilon)),(0,nh._)((0,e2.I)(i,this.epsilon))),a),n=(0,e2.I)((0,tX.d)(s,this.rho),(0,tX.d)((0,tj.h)(t),1-this.rho));i.assign(e),s.assign(n);let o=(0,e2.I)((0,tX.d)(t,-this.learningRate),r);r.assign(o)})}),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&((0,eY.B9)(this.accumulatedGrads.map(e=>e.variable)),(0,eY.B9)(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){let e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=e.length/2;this.accumulatedGrads=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})),this.accumulatedUpdates=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}rb.className="Adadelta",eH(rb);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class rx extends eJ{constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){let t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);t.forEach((t,n)=>{let r=g.BV.registeredVariables[t];null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:`${t}/accumulator`,variable:(0,eY.lu)(()=>(0,tT.h)(r.shape,this.initialAccumulatorValue).variable(!1))});let a=Array.isArray(e)?e[n].tensor:e[t];if(null==a)return;let i=this.accumulatedGrads[n].variable;(0,eY.lu)(()=>{let e=(0,e2.I)(i,(0,tj.h)(a));i.assign(e);let t=(0,e2.I)((0,tX.d)((0,tv.h)(a,(0,nh._)((0,e2.I)(e,g.BV.backend.epsilon()))),-this.learningRate),r);r.assign(t)})}),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&(0,eY.B9)(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e),this.accumulatedGrads=e.map(e=>({originalName:e.name,variable:e.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}rx.className="Adagrad",eH(rx);var rv=n(3453);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class rw extends eJ{constructor(e,t,n,r=null){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],(0,eY.lu)(()=>{this.accBeta1=(0,eZ.i)(t).variable(),this.accBeta2=(0,eZ.i)(n).variable()}),null==r&&(this.epsilon=g.BV.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);(0,eY.lu)(()=>{let n=(0,tH.l)(1,this.accBeta1),r=(0,tH.l)(1,this.accBeta2);t.forEach((t,a)=>{let i=g.BV.registeredVariables[t];null==this.accumulatedFirstMoment[a]&&(this.accumulatedFirstMoment[a]={originalName:`${t}/m`,variable:(0,eY.lu)(()=>(0,nS.P)(i).variable(!1))}),null==this.accumulatedSecondMoment[a]&&(this.accumulatedSecondMoment[a]={originalName:`${t}/v`,variable:(0,eY.lu)(()=>(0,nS.P)(i).variable(!1))});let s=Array.isArray(e)?e[a].tensor:e[t];if(null==s)return;let o=this.accumulatedFirstMoment[a].variable,l=this.accumulatedSecondMoment[a].variable,u=(0,e2.I)((0,tX.d)(o,this.beta1),(0,tX.d)(s,1-this.beta1)),h=(0,e2.I)((0,tX.d)(l,this.beta2),(0,tX.d)((0,tj.h)(s),1-this.beta2)),c=(0,tv.h)(u,n),d=(0,tv.h)(h,r);o.assign(u),l.assign(h);let p=(0,e2.I)((0,tX.d)((0,tv.h)(c,(0,e2.I)((0,nh._)(d),this.epsilon)),-this.learningRate),i);i.assign(p)}),this.accBeta1.assign((0,tX.d)(this.accBeta1,this.beta1)),this.accBeta2.assign((0,tX.d)(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&(0,eY.B9)(this.accumulatedFirstMoment.map(e=>e.variable)),null!=this.accumulatedSecondMoment&&(0,eY.B9)(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e),(0,eY.lu)(()=>{this.accBeta1.assign((0,rv.s)(this.beta1,this.iterations_+1)),this.accBeta2.assign((0,rv.s)(this.beta2,this.iterations_+1))});let t=e.length/2;this.accumulatedFirstMoment=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})),this.accumulatedSecondMoment=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}rw.className="Adam",eH(rw);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class rI extends eJ{constructor(e,t,n,r=null,a=0){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],(0,eY.lu)(()=>{this.iteration=(0,eZ.i)(0).variable(),this.accBeta1=(0,eZ.i)(t).variable()}),null==r&&(this.epsilon=g.BV.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);(0,eY.lu)(()=>{let n=(0,tH.l)(1,this.accBeta1),r=(0,tv.h)(-this.learningRate,(0,e2.I)((0,tX.d)(this.iteration,this.decay),1));t.forEach((t,a)=>{let i=g.BV.registeredVariables[t];null==this.accumulatedFirstMoment[a]&&(this.accumulatedFirstMoment[a]={originalName:`${t}/m`,variable:(0,nS.P)(i).variable(!1)}),null==this.accumulatedWeightedInfNorm[a]&&(this.accumulatedWeightedInfNorm[a]={originalName:`${t}/v`,variable:(0,nS.P)(i).variable(!1)});let s=Array.isArray(e)?e[a].tensor:e[t];if(null==s)return;let o=this.accumulatedFirstMoment[a].variable,l=this.accumulatedWeightedInfNorm[a].variable,u=(0,e2.I)((0,tX.d)(o,this.beta1),(0,tX.d)(s,1-this.beta1)),h=(0,tX.d)(l,this.beta2),c=(0,e1.W)(s),d=(0,tW.g)(h,c);o.assign(u),l.assign(d);let p=(0,e2.I)((0,tX.d)((0,tv.h)(r,n),(0,tv.h)(u,(0,e2.I)(d,this.epsilon))),i);i.assign(p)}),this.iteration.assign((0,e2.I)(this.iteration,1)),this.accBeta1.assign((0,tX.d)(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&(0,eY.B9)(this.accumulatedFirstMoment.map(e=>e.variable)),null!=this.accumulatedWeightedInfNorm&&(0,eY.B9)(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}rI.className="Adamax",eH(rI);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class rk extends eJ{constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){let t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);t.forEach((t,n)=>{let r=Array.isArray(e)?e[n].tensor:e[t];if(null==r)return;let a=g.BV.registeredVariables[t];(0,eY.lu)(()=>{let e=(0,e2.I)((0,tX.d)(this.c,r),a);a.assign(e)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=(0,eY.Cn)((0,eZ.i)(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(0!==(e=await this.extractIterations(e)).length)throw Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}rk.className="SGD",eH(rk);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class rS extends rk{constructor(e,t,n=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=(0,eZ.i)(this.momentum)}applyGradients(e){let t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);t.forEach((t,n)=>{let r=g.BV.registeredVariables[t];null==this.accumulations[n]&&(this.accumulations[n]={originalName:`${t}/momentum`,variable:(0,eY.lu)(()=>(0,nS.P)(r).variable(!1))});let a=this.accumulations[n].variable,i=Array.isArray(e)?e[n].tensor:e[t];null!=i&&(0,eY.lu)(()=>{let e;let t=(0,e2.I)((0,tX.d)(this.m,a),i);e=this.useNesterov?(0,e2.I)((0,tX.d)(this.c,(0,e2.I)(i,(0,tX.d)(t,this.m))),r):(0,e2.I)((0,tX.d)(this.c,t),r),a.assign(t),r.assign(e)})}),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&(0,eY.B9)(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e),this.accumulations=e.map(e=>({originalName:e.name,variable:e.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}rS.className="Momentum",eH(rS);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class rC extends eJ{constructor(e,t=.9,n=0,r=null,a=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,null==r&&(this.epsilon=g.BV.backend.epsilon()),null==e)throw Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){let t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);t.forEach((t,n)=>{let r=g.BV.registeredVariables[t];null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:`${t}/rms`,variable:(0,eY.lu)(()=>(0,nS.P)(r).variable(!1))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:`${t}/momentum`,variable:(0,eY.lu)(()=>(0,nS.P)(r).variable(!1))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:`${t}/mg`,variable:(0,eY.lu)(()=>(0,nS.P)(r).variable(!1))});let a=Array.isArray(e)?e[n].tensor:e[t];if(null==a)return;let i=this.accumulatedMeanSquares[n].variable,s=this.accumulatedMoments[n].variable;(0,eY.lu)(()=>{let e=(0,e2.I)((0,tX.d)(i,this.decay),(0,tX.d)((0,tj.h)(a),1-this.decay));if(this.centered){let t=this.accumulatedMeanGrads[n].variable,o=(0,e2.I)((0,tX.d)(t,this.decay),(0,tX.d)(a,1-this.decay)),l=(0,tv.h)((0,tX.d)(a,this.learningRate),(0,nh._)((0,tH.l)(e,(0,e2.I)((0,tj.h)(o),this.epsilon)))),u=(0,e2.I)((0,tX.d)(s,this.momentum),l);i.assign(e),t.assign(o),s.assign(u);let h=(0,tH.l)(r,u);r.assign(h)}else{let c=(0,e2.I)((0,tX.d)(i,this.decay),(0,tX.d)((0,tj.h)(a),1-this.decay)),d=(0,e2.I)((0,tX.d)(s,this.momentum),(0,tv.h)((0,tX.d)(a,this.learningRate),(0,nh._)((0,e2.I)(c,this.epsilon))));i.assign(c),s.assign(d);let p=(0,tH.l)(r,d);r.assign(p)}})}),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&(0,eY.B9)(this.accumulatedMeanSquares.map(e=>e.variable)),null!=this.accumulatedMeanGrads&&this.centered&&(0,eY.B9)(this.accumulatedMeanGrads.map(e=>e.variable)),null!=this.accumulatedMoments&&(0,eY.B9)(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=this.centered?e.length/3:e.length/2;this.accumulatedMeanSquares=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})),this.accumulatedMoments=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}rC.className="RMSProp",eH(rC);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class rE{static sgd(e){return new rk(e)}static momentum(e,t,n=!1){return new rS(e,t,n)}static rmsprop(e,t=.9,n=0,r=null,a=!1){return new rC(e,t,n,r,a)}static adam(e=.001,t=.9,n=.999,r=null){return new rw(e,t,n,r)}static adadelta(e=.001,t=.95,n=null){return new rb(e,t,n)}static adamax(e=.002,t=.9,n=.999,r=null,a=0){return new rI(e,t,n,r,a)}static adagrad(e,t=.1){return new rx(e,t)}}let rT={sgd:rE.sgd,momentum:rE.momentum,adadelta:rE.adadelta,adagrad:rE.adagrad,rmsprop:rE.rmsprop,adamax:rE.adamax,adam:rE.adam};var r$=n(6151);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let rN="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:e=>e();function rA(){return new Promise(e=>rN(()=>e()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function rD(e,t){let n=e[0].length;e.forEach((e,t)=>{T.hu(e.length===n,()=>`Error in concat${n}D: rank of tensors[${t}] must be the same as the rank of the rest (${n})`)}),T.hu(t>=0&&t<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);let r=e[0];e.forEach((e,a)=>{for(let i=0;i<n;i++)T.hu(i===t||e[i]===r[i],()=>`Error in concat${n}D: Shape of tensors[${a}] (${e}) does not match the shape of the rest (${r}) along the non-concatenated axis ${a}.`)})}function rF(e,t){let n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}function rR(e,t,n){let r=[];if(null==n&&null==t)return r;if(null==t)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(null==n)return r;if(e+n.length!==r.length)throw Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${r.length}`);for(let a=1;a<n.length;++a){let i=n[a],s=r[r.length-n.length+a],o=r[s];if(i>=0){if(o>=0){if(o!==i)throw Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${a+e}] = ${i} but shape[${a+e}] = ${o}`)}else r[s]=i}}return r}function r_(e){let t={FIRST_DIM_SIZE:l.FIRST_DIM_SIZE,VALUE_ROWIDS:l.VALUE_ROWIDS,ROW_LENGTHS:l.ROW_LENGTHS,ROW_SPLITS:l.ROW_SPLITS,ROW_LIMITS:l.ROW_LIMITS,ROW_STARTS:l.ROW_STARTS},n=[];for(let r of e)if(r in t)n.push(t[r]);else break;return n}function rO(e){return 0===e.length?0:e[0]===l.FIRST_DIM_SIZE?e.length-1:e.length}function rM(e,t){if(null==e||null==t)return;let n=e.length,r=t.length;if(n>=r)throw Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let a=0;a<Math.min(n,r-1);++a){let i=e[a],s=t[a+1];if(i>=0&&s>=0&&1!==i&&i!==s)throw Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${a-e.length}] = ${i} but ragged tensor input.flatValues.shape[${a-e.length}] = ${s}`)}}(s=l||(l={}))[s.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",s[s.VALUE_ROWIDS=1]="VALUE_ROWIDS",s[s.ROW_LENGTHS=2]="ROW_LENGTHS",s[s.ROW_SPLITS=3]="ROW_SPLITS",s[s.ROW_LIMITS=4]="ROW_LIMITS",s[s.ROW_STARTS=5]="ROW_STARTS";/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let rB=30;function rP(e){return e<=rB?e:(0,T.jP)(e,Math.floor(Math.sqrt(e)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function rL(e,t,n){let r=n*("number"==typeof e?e:e[0]),a=t*("number"==typeof e?e:e[1]);return[r,a]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function rU(e,t,n,r=!0){let a=[];if(r)(a=a.concat(t.slice(0))).push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);let i=t.length;for(let s=0;s<i;++s)a=a.concat([e[s+1]/t[s],t[s]]);a=a.concat(e.slice(i+1))}return a}function rW(e,t,n=!0){let r=[];if(n){r.push(t);for(let a=t+1;a<e;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{let i=[],s=[];for(let o=1;o<e;++o)o>=2*t+1||o%2==1?s.push(o):i.push(o);r.push(...i),r.push(0),r.push(...s)}return r}function rz(e,t,n,r=!0){let a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(let i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function rV(e,t){let n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function rG(e,t,n){let r=e.slice(0,1);for(let a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}function rj(e,t){let n=e.shape.length,r=t.shape.length;if(n<1)throw Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if("int32"!==t.dtype)throw Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>n)throw Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${n}`);if(0===(0,T.NA)(e.shape))throw Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);let a=t.shape,i=a[a.length-1],s=1;for(let o=0;o<a.length-1;++o)s*=a[o];let l=e.shape,u=a.slice();u.pop();let h=1;for(let c=i;c<n;++c)h*=l[c],u.push(l[c]);let d=[...(0,T.e3)(e.shape).map(e=>e/h),1].slice(0,i);return[u,s,h,d]}function rH(e,t,n){let r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${r}, and batchDim: ${a}.`;if(n.rank<a)throw Error(i+` update.rank < ${a}. `);if(e.length<r+(n.rank-a))throw Error(i+` Output shape length < ${r+(n.rank-a)}`);if(n.rank!==a+e.length-r)throw Error(i+` update.rank != ${a+e.length-r}`);for(let s=0;s<a;++s)if(n.shape[s]!==t.shape[s])throw Error(i+` updates.shape[${s}] (${n.shape[s]}) != indices.shape[${s}] (${t.shape[s]}).`);for(let o=0;o<n.rank-a;++o)if(n.shape[o+a]!==e[o+r])throw Error(i+` updates.shape[${o+a}] (${n.shape[o+a]}) != shape[${o+a}] (${e[o+a]})`)}function rK(e,t,n){if(t.rank<1)throw Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if("int32"!==t.dtype)throw Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(0===n.length){if(0===t.size)throw Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(0===e.size)throw Error(`Updates specified for empty output. updates shape: ${e.shape}`)}rH(n,t,e)}function rX(e,t,n){let r=t.shape.length,a=r>1?t.shape[r-1]:1,i=n.length,s=1;for(let o=a;o<i;++o)s*=n[o];let l=(0,T.NA)(t.shape)/(a<1?1:a),u=[...(0,T.e3)(n.slice(0,a)),1],h=(0,T.NA)(n);return{sliceRank:a,numUpdates:l,sliceSize:s,strides:u,outputSize:h}}var rq=n(3179);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let rY=.3275911,rQ=.254829592,rZ=-.284496736,rJ=1.421413741,r0=-1.453152027,r1=1.061405429;var r2=n(4706);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function r3(e,t){if(e.length!==t.length)throw Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);let n=new Float32Array(2*e.length);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function r4(e){let t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function r6(e){let t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function r5(e){let t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function r7(e,t){let n=e[2*t],r=e[2*t+1];return{real:n,imag:r}}function r8(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function r9(e,t){let n=new Float32Array(e/2),r=new Float32Array(e/2);for(let a=0;a<Math.ceil(e/2);a++){let i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}function ae(e,t,n){let r=(n?2:-2)*Math.PI*(e/t),a=Math.cos(r),i=Math.sin(r);return{real:a,imag:i}}let at=/->/g;function an(e,t){e=e.replace(/\s/g,"");let n=(e.length-e.replace(at,"").length)/2;if(n<1)throw Error("Equations without an arrow are not supported.");if(n>1)throw Error('Equation must contain exactly one arrow ("->").');let[r,a]=e.split("->");(0,T.hu)(-1===r.indexOf("..."),()=>'The ellipsis notation ("...") is not supported yet.');let i=r.split(","),s=i.length;if(t!==s)throw Error(`Expected ${s} input tensors, received ${t}`);if(s>2)throw Error("Support for more than 2 input tensors is not implemented yet.");let o=[];for(let l=0;l<a.length;++l){let u=a[l];if(!i.some(e=>-1!==e.indexOf(u)))throw Error(`Output subscripts contain the label ${u} not present in the input subscripts.`);-1===o.indexOf(u)&&o.push(u)}for(let h=0;h<r.length;++h){let c=r[h];-1===o.indexOf(c)&&","!==c&&o.push(c)}let d=Array(i.length);for(let p=0;p<s;++p){if(new Set(i[p].split("")).size!==i[p].length)throw Error(`Found duplicate axes in input component ${i[p]}. Support for duplicate axes in input is not implemented yet.`);d[p]=[];for(let f=0;f<i[p].length;++f)d[p].push(o.indexOf(i[p][f]))}let m=o.length,g=a.length,y=[];for(let b=g;b<m;++b)y.push(b);return{allDims:o,summedDims:y,idDims:d}}function ar(e,t){let n=Array(e);n.fill(-1);for(let r=0;r<t.length;++r)n[t[r]]=r;let a=[];for(let i=0;i<e;++i)-1===n[i]&&a.push(i);return n=n.filter(e=>-1!==e),{permutationIndices:n,expandDims:a}}function aa(e,t,n){let r=Array(e);for(let a=0;a<n.length;++a){let i=n[a].shape;for(let s=0;s<t[a].length;++s)void 0===r[t[a][s]]?r[t[a][s]]=i[s]:(0,T.hu)(r[t[a][s]]===i[s],()=>`Expected dimension ${r[t[a][s]]} at axis ${s} of input shaped ${JSON.stringify(i)}, but got dimension ${i[s]}`)}}function ai(e,t){let n=[],r=0;0===e.length&&e.push(-1),r=e.length+1;for(let a=0;a<r;++a)n.push([]);let i=[];for(let s=0;s<e.length;++s){let o=e[s],l=function(e,t){let n=[];for(let r=0;r<e.length;++r)(0===e[r].length||-1!==e[r].indexOf(t)||-1===t)&&n.push(r);return n}(t,o);for(let u of l)-1===i.indexOf(u)&&(n[s].push(u),i.push(u))}return{path:e,steps:n}}function as(e){return e.every((e,t)=>e===t)}function ao(e,t,n=0){let r=[];if("number"==typeof t)(0,T.hu)(e.shape[n]%t==0,()=>"Number of splits must evenly divide the axis."),r=Array(t).fill(e.shape[n]/t);else{let a=t.reduce((e,t)=>(-1===t&&(e+=1),e),0);(0,T.hu)(a<=1,()=>"There should be only one negative value in split array.");let i=t.indexOf(-1);if(-1!==i){let s=t.reduce((e,t)=>t>0?e+t:e);t[i]=e.shape[n]-s}(0,T.hu)(e.shape[n]===t.reduce((e,t)=>e+t),()=>"The sum of sizes must match the size of the axis dimension."),r=t}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function al(e){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${e}`}function au(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function ah(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function ac(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function ad(e,t){return`size ${e} must be non-negative, not ${t}`}function ap(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function af(e,t){let n=(0,T.NA)(e),r=(0,T.NA)(t);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${e} outputShape= ${t}`}function am(e,t){let n=(0,T.NA)(e),r=(0,T.NA)(t);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${e} outputShape=${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function ag(){return"segment ids must be >= 0"}function ay(){return"segment ids are not increasing"}function ab(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function ax(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function av(e,t){let n,r=!1;for(e<=rB?(n=e,r=!0):n=(0,T.jP)(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=(0,T.jP)(e,n+1);return n}function aw(e,t,n){let r=[],a=e.length;for(let i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}function aI(e,t,n,r){let a=t.shape.length,i=e.shape.length;if(0!==r&&(r<-a||r>a))throw Error(`Expect batchDims in the range of [-${a}, ${a}], but got ${r}`);if(r<0&&(r+=a),r>i)throw Error(`batchDims (${r}) must be less than rank(x) (
    ${i}).`);if(n<r)throw Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let s=0;s<r;++s)if(e.shape[s]!==t.shape[s])throw Error(`x.shape[${s}]: ${e.shape[s]} should be equal to indices.shape[${s}]: ${t.shape[s]}.`);let o=e.shape[n],l=[],u=1,h=1,c=1;for(let d=0;d<r;++d)l.push(e.shape[d]),u*=e.shape[d];for(let p=r;p<n;p++)l.push(e.shape[p]),h*=e.shape[p];for(let f=r;f<a;f++)l.push(t.shape[f]);for(let m=n+1;m<i;m++)l.push(e.shape[m]),c*=e.shape[m];return{batchSize:u,sliceSize:c,outerSize:h,dimSize:o,outputShape:l}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function ak(e){try{return e.map(e=>(0,eX.decodeString)(e))}catch(t){throw Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function aS(e){return e.map(e=>(0,eX.encodeString)(e))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function aC(e,t){let n=[];for(let r=0;r<t.length;r++)t[r]&&n.push(r);let a=ey(e,"int32"),i=ey([n.length,e.length],"int32");for(let s=0;s<n.length;s++){let o=a.indexToLoc(n[s]),l=s*e.length;i.values.set(o,l)}return i.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ var aE=n(8713);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ },9121:function(e,t,n){"use strict";n.d(t,{$HU:function(){return tt},$g6:function(){return J},$w:function(){return X},Acj:function(){return eg},BMI:function(){return eM},BiW:function(){return e8},Byc:function(){return U},CAk:function(){return eC},D2d:function(){return tD},DlI:function(){return e5},Eh3:function(){return D},FKq:function(){return tI},G3Y:function(){return tG},GBy:function(){return tk},Gcp:function(){return tE},HEU:function(){return et},HZH:function(){return tr},Hhh:function(){return e_},Hmb:function(){return ti},IKK:function(){return u},IMb:function(){return v},J$2:function(){return ek},J_u:function(){return ex},JhU:function(){return y},L8s:function(){return tC},Ly9:function(){return S},M2y:function(){return d},MIZ:function(){return tU},MRv:function(){return tw},MZg:function(){return eD},NEP:function(){return ea},NZg:function(){return eK},O3z:function(){return tT},OAf:function(){return eL},OR:function(){return eh},OU7:function(){return eU},OV7:function(){return eP},Omj:function(){return en},Oyi:function(){return m},PYm:function(){return eN},PhF:function(){return tf},QCc:function(){return g},QRR:function(){return V},Qg5:function(){return eb},QiL:function(){return e2},Qvg:function(){return tK},RFZ:function(){return E},ROF:function(){return b},RQH:function(){return ty},RuY:function(){return tX},SX0:function(){return ee},SYM:function(){return r},SbG:function(){return tl},SpW:function(){return i},T0n:function(){return G},TQc:function(){return tS},TR1:function(){return L},ToN:function(){return tH},Tr8:function(){return tP},Uyb:function(){return eu},VGw:function(){return a},Vbg:function(){return eH},VcC:function(){return z},VfG:function(){return eA},Vn9:function(){return Q},W0H:function(){return eJ},XLW:function(){return w},XkS:function(){return tB},Xze:function(){return o},Y0y:function(){return es},YFo:function(){return ei},YoZ:function(){return eO},ZbH:function(){return eT},ZjV:function(){return tA},Zz9:function(){return N},_JP:function(){return tO},_V0:function(){return tJ},_Yw:function(){return ts},_k9:function(){return x},_tC:function(){return tF},a5O:function(){return tv},aJk:function(){return c},avt:function(){return ev},b9H:function(){return tQ},bK0:function(){return tR},bV0:function(){return tc},c17:function(){return eV},cWu:function(){return tz},cie:function(){return j},cye:function(){return eZ},dDz:function(){return e7},deh:function(){return el},dpD:function(){return ta},e07:function(){return th},e6w:function(){return e9},e7N:function(){return eE},eBW:function(){return tY},eEB:function(){return C},eZ0:function(){return eR},ekb:function(){return Y},gJX:function(){return T},h8e:function(){return tq},hdR:function(){return er},i5y:function(){return tx},iHb:function(){return W},iJz:function(){return ey},iWB:function(){return ew},iZT:function(){return em},ik2:function(){return B},jMg:function(){return f},jQk:function(){return t_},jQs:function(){return ej},jeX:function(){return ec},kU:function(){return e$},kpP:function(){return tj},kuV:function(){return eq},luS:function(){return t0},lyA:function(){return e3},mKl:function(){return tu},mTV:function(){return eB},mc4:function(){return P},mhS:function(){return F},mm_:function(){return s},n9L:function(){return tW},nhH:function(){return t$},nr8:function(){return tp},o0g:function(){return e6},o2y:function(){return M},oFR:function(){return tm},oHH:function(){return Z},oT6:function(){return l},p2w:function(){return tg},p4S:function(){return q},pe_:function(){return e4},q1x:function(){return ef},q2K:function(){return ez},q8u:function(){return eG},qCd:function(){return eF},qWM:function(){return e0},qi_:function(){return ep},qkr:function(){return tn},qw7:function(){return p},r7n:function(){return eI},s1s:function(){return tM},sEM:function(){return tL},sHE:function(){return ed},sJF:function(){return h},sL$:function(){return H},usg:function(){return tZ},uv1:function(){return eQ},vFR:function(){return eW},vtC:function(){return eS},vwp:function(){return eo},w3H:function(){return tN},wUP:function(){return R},wYB:function(){return tb},wYn:function(){return eX},we_:function(){return e1},wm:function(){return _},wx7:function(){return tV},x12:function(){return O},xJR:function(){return te},xQA:function(){return td},xnO:function(){return $},y7R:function(){return K},yQU:function(){return eY},yj2:function(){return A},zbQ:function(){return to},zvY:function(){return k},zws:function(){return I}});let r="Abs",a="Acos",i="Acosh",s="Add",o="AddN",l="All",u="Any",h="ArgMax",c="ArgMin",d="Asin",p="Asinh",f="Atan",m="Atanh",g="Atan2",y="AvgPool",b="AvgPoolGrad",x="AvgPool3D",v="AvgPool3DGrad",w="BatchMatMul",I="BatchToSpaceND",k="Bincount",S="BroadcastTo",C="BroadcastArgs",E="Cast",T="Ceil",$="ClipByValue",N="Complex",A="ComplexAbs",D="Concat",F="Conv2D",R="Conv2DBackpropFilter",_="Conv2DBackpropInput",O="Conv3D",M="Conv3DBackpropFilterV2",B="Conv3DBackpropInputV2",P="Cos",L="Cosh",U="Cumprod",W="Cumsum",z="CropAndResize",V="DenseBincount",G="DepthToSpace",j="DepthwiseConv2dNative",H="DepthwiseConv2dNativeBackpropFilter",K="DepthwiseConv2dNativeBackpropInput",X="Diag",q="Dilation2D",Y="Dilation2DBackpropInput",Q="Dilation2DBackpropFilter",Z="RealDiv",J="Einsum",ee="Elu",et="EluGrad",en="Erf",er="Equal",ea="Exp",ei="ExpandDims",es="Expm1",eo="FFT",el="Fill",eu="FlipLeftRight",eh="Floor",ec="FloorDiv",ed="FusedBatchNorm",ep="GatherV2",ef="GatherNd",em="Greater",eg="GreaterEqual",ey="Identity",eb="IFFT",ex="Imag",ev="IsFinite",ew="IsInf",eI="IsNan",ek="LeakyRelu",eS="Less",eC="LessEqual",eE="LinSpace",eT="Log",e$="Log1p",eN="LogicalAnd",eA="LogicalNot",eD="LogicalOr",eF="LogSoftmax",eR="LRN",e_="LRNGrad",eO="Max",eM="Maximum",eB="MaxPool",eP="MaxPoolGrad",eL="MaxPool3D",eU="MaxPool3DGrad",eW="MaxPoolWithArgmax",ez="Mean",eV="Min",eG="Minimum",ej="MirrorPad",eH="Mod",eK="Multinomial",eX="Multiply",eq="Neg",eY="NotEqual",eQ="NonMaxSuppressionV3",eZ="NonMaxSuppressionV4",eJ="NonMaxSuppressionV5",e0="OnesLike",e1="OneHot",e2="Pack",e3="PadV2",e4="Pow",e6="Prelu",e5="Prod",e7="RaggedGather",e8="RaggedTensorToTensor",e9="Range",te="Real",tt="Reciprocal",tn="Relu",tr="Reshape",ta="ResizeNearestNeighbor",ti="ResizeNearestNeighborGrad",ts="ResizeBilinear",to="ResizeBilinearGrad",tl="Relu6",tu="Reverse",th="Round",tc="Rsqrt",td="ScatterNd",tp="SearchSorted",tf="Select",tm="Selu",tg="Slice",ty="Sin",tb="Sinh",tx="Sign",tv="Sigmoid",tw="Softplus",tI="Sqrt",tk="Sum",tS="SpaceToBatchND",tC="SplitV",tE="Softmax",tT="SparseFillEmptyRows",t$="SparseReshape",tN="SparseSegmentMean",tA="SparseSegmentSum",tD="SparseToDense",tF="SquaredDifference",tR="Square",t_="StridedSlice",tO="StringNGrams",tM="StringSplit",tB="StringToHashBucketFast",tP="Sub",tL="Tan",tU="Tanh",tW="Tile",tz="TopK",tV="Transform",tG="Transpose",tj="Unique",tH="Unpack",tK="UnsortedSegmentSum",tX="ZerosLike",tq="Step",tY="FromPixels",tQ="RotateWithOffset",tZ="_FusedMatMul",tJ="FusedConv2D",t0="FusedDepthwiseConv2D"},6151:function(e,t,n){"use strict";n.d(t,{Li:function(){return d},pI:function(){return l},tr:function(){return h},uk:function(){return u},wC:function(){return c}});var r=n(2885),a=n(5938),i=n(4706);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let s=(0,a.R)("kernelRegistry",()=>new Map),o=(0,a.R)("gradRegistry",()=>new Map);function l(e,t){let n=`${t}_${e}`;return s.get(n)}function u(e){return o.get(e)}function h(e){let t=s.entries(),n=[];for(;;){let{done:r,value:a}=t.next();if(r)break;let[i,o]=a,[l]=i.split("_");l===e&&n.push(o)}return n}function c(e){let{kernelName:t,backendName:n}=e,r=`${n}_${t}`;s.has(r)&&i.Z(`The kernel '${t}' for backend '${n}' is already registered`),s.set(r,e)}function d(e){let{kernelName:t}=e;o.has(t)&&(0,r.OB)().getBool("DEBUG")&&i.Z(`Overriding the gradient for '${t}'`),o.set(t,e)}},4706:function(e,t,n){"use strict";n.d(t,{Z:function(){return a},c:function(){return i}});var r=n(2885);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function a(...e){(0,r.OB)().getBool("IS_TEST")||(0,r.OB)().getBool("PROD")||console.warn(...e)}function i(...e){(0,r.OB)().getBool("IS_TEST")||(0,r.OB)().getBool("PROD")||console.log(...e)}},6235:function(e,t,n){"use strict";n.d(t,{W:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({abs_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","abs");return"complex64"===t.dtype?r.BV.runKernel(a.yj2,{x:t}):r.BV.runKernel(a.SYM,{x:t})}})},6407:function(e,t,n){"use strict";n.d(t,{I:function(){return l}});var r=n(196),a=n(9121),i=n(747),s=n(3740),o=n(2668);let l=(0,o.op)({add_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,s._1)(e,"a","add"),o=(0,s._1)(t,"b","add");[n,o]=(0,i.makeTypesMatch)(n,o);let l={a:n,b:o};return r.BV.runKernel(a.mm_,l)}})},781:function(e,t,n){"use strict";n.d(t,{$:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({all_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=null,n=!1){let s=(0,i._1)(e,"x","all","bool");return r.BV.runKernel(a.oT6,{x:s},{axis:t,keepDims:n})}})},2998:function(e,t,n){"use strict";n.d(t,{Y:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({any_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=null,n=!1){let s=(0,i._1)(e,"x","any","bool");return r.BV.runKernel(a.IKK,{x:s},{axis:t,keepDims:n})}})},47:function(e,t,n){"use strict";n.d(t,{N:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({argMax_:/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=0){let n=(0,i._1)(e,"x","argMax");return r.BV.runKernel(a.sJF,{x:n},{axis:t})}})},5176:function(e,t,n){"use strict";n.d(t,{w:function(){return c}});var r=n(196),a=n(9121),i=n(3740),s=n(569),o=n(2271),l=n(2582),u=n(2668),h=n(4968);let c=(0,u.op)({avgPool_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,u,c){let d=(0,i._1)(e,"x","avgPool","float32");s.hu(l.jT(n,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`);let p=d,f=!1;3===d.rank&&(f=!0,p=(0,h.X)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),s.hu(4===p.rank,()=>`Error in avgPool: x must be rank 4 but got rank ${p.rank}.`),l.m("avgPool",u,c);let m={x:p},g=r.BV.runKernel(a.JhU,m,{filterSize:t,strides:n,pad:u,dimRoundingMode:c});return(g=(0,o.p)(g,d.dtype),f)?(0,h.X)(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})},3591:function(e,t,n){"use strict";n.d(t,{LJ:function(){return h},Q3:function(){return u},Vh:function(){return i},YB:function(){return a},kz:function(){return s},lB:function(){return l},rv:function(){return o},sY:function(){return c}});var r=n(569);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function a(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function i(e,t,n){let r=e.length+t.length,a=[],i=0,s=0;for(let o=0;o<r;o++)-1===n.indexOf(o)?a.push(e[i++]):a.push(t[s++]);return a}function s(e,t){let n=[],r=e.length;for(let a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);let i=t.map(t=>e[t]);return[n,i]}function o(e,t){let n=t.map(e=>1);return i(e,n,t)}function l(e,t,n){r.hu(a(t,n),()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`)}function u(e,t){if(a(e,t))return null;let n=[];for(let r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach(e=>n.push(e)),n}function h(e){return e.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function c(e,t){let n=[];for(let r=t-e;r<t;++r)n.push(r);return n}},8441:function(e,t,n){"use strict";n.d(t,{E:function(){return l}});var r=n(196),a=n(9121),i=n(3740),s=n(569),o=n(2668);let l=(0,o.op)({batchToSpaceND_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){let o=(0,i._1)(e,"x","batchToSpaceND"),l=t.reduce((e,t)=>e*t);return s.hu(o.rank>=1+t.length,()=>`input rank is ${o.rank} but should be > than blockShape.length ${t.length}`),s.hu(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),s.hu(o.shape[0]%l==0,()=>`input tensor batch is ${o.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${l}`),r.BV.runKernel(a.zws,{x:o},{blockShape:t,crops:n})}})},94:function(e,t,n){"use strict";n.d(t,{t:function(){return u}});var r=n(196),a=n(9121),i=n(3740),s=n(569),o=n(4968),l=n(2668);let u=(0,l.op)({batchNorm_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,l,u,h){let c,d;null==h&&(h=.001);let p=(0,i._1)(e,"x","batchNorm"),f=(0,i._1)(t,"mean","batchNorm"),m=(0,i._1)(n,"variance","batchNorm");null!=u&&(c=(0,i._1)(u,"scale","batchNorm")),null!=l&&(d=(0,i._1)(l,"offset","batchNorm")),s.hu(f.rank===m.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),s.hu(null==d||f.rank===d.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),s.hu(null==c||f.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let g=0===p.rank||1===p.rank?(0,o.X)(p,[1,1,1,p.size]):2===p.rank?(0,o.X)(p,[1,1,p.shape[0],p.shape[1]]):3===p.rank?(0,o.X)(p,[1,p.shape[0],p.shape[1],p.shape[2]]):p,y={x:g,scale:c,offset:d,mean:f,variance:m},b={varianceEpsilon:h},x=r.BV.runKernel(a.sHE,y,b);return(0,o.X)(x,p.shape)}})},8247:function(e,t,n){"use strict";n.d(t,{U:function(){return u}});var r=n(196),a=n(9121),i=n(3740),s=n(8723),o=n(2668),l=n(4968);let u=(0,o.op)({broadcastTo_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,i._1)(e,"broadcastTo","x"),o=n.shape;if(t.some(e=>!(e>0)||e%1!=0))throw Error(`broadcastTo(): Invalid broadcast shape [${t}].`);if(t.length<n.rank)throw Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){let u=n.shape.slice();for(;u.length<t.length;)u.unshift(1);n=(0,l.X)(n,u)}let h=n.shape,c=Array.from(t);for(let d=t.length-1;d>=0;d--)if(h[d]===t[d])c[d]=1;else if(1!==n.shape[d])throw Error(`broadcastTo(): [${o}] cannot be broadcast to [${t}].`);let p=c.map((e,t)=>e>1?t:-1).filter(e=>e>=0);if(0===p.length)return(0,s.d)(n);let f={x:n};return r.BV.runKernel(a.n9L,f,{reps:c})}})},2200:function(e,t,n){"use strict";/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function r(e,t){let n=e.length,r=[];for(let a=0;a<n;a++){let i=n-1-a,s=e[i]||1,o=t[t.length-1-a]||1;o>1&&1===s&&r.unshift(i)}return r}function a(e,t){let n=[];for(let r=0;r<t.length;r++){let a=e[e.length-r-1],i=t.length-r-1,s=t[i];(null==a||1===a&&s>1)&&n.unshift(i)}return n}function i(e,t){let n=[],r=Math.max(e.length,t.length);for(let a=0;a<r;a++){let i=e[e.length-a-1];null==i&&(i=1);let s=t[t.length-a-1];if(null==s&&(s=1),1===i)n.unshift(s);else if(1===s)n.unshift(i);else if(i!==s){let o=`Operands could not be broadcast together with shapes ${e} and ${t}.`;throw Error(o)}else n.unshift(i)}return n}n.r(t),n.d(t,{assertAndGetBroadcastShape:function(){return i},getBroadcastDims:function(){return r},getReductionAxes:function(){return a}})},2271:function(e,t,n){"use strict";n.d(t,{p:function(){return l}});var r=n(196),a=n(9121),i=n(3740),s=n(569),o=n(2668);let l=(0,o.op)({cast_:/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,i._1)(e,"x","cast");if(!s.LP(t))throw Error(`Failed to cast to unknown dtype ${t}`);if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw Error("Only strings can be casted to strings");return r.BV.runKernel(a.RFZ,{x:n},{dtype:t})}})},2279:function(e,t,n){"use strict";n.d(t,{i:function(){return u}});var r=n(196),a=n(9121),i=n(3740),s=n(569),o=n(4006),l=n(2668);let u=(0,l.op)({clipByValue_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){let l=(0,i._1)(e,"x","clipByValue");return(s.hu(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`),t===n)?(0,o.h)(l.shape,t,l.dtype):r.BV.runKernel(a.xnO,{x:l},{clipValueMin:t,clipValueMax:n})}})},8723:function(e,t,n){"use strict";n.d(t,{d:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({clone_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","clone","string_or_numeric");return r.BV.runKernel(a.iJz,{x:t})}})},1661:function(e,t,n){"use strict";n.d(t,{P:function(){return l}});var r=n(196),a=n(9121),i=n(3740),s=n(569),o=n(2668);let l=(0,o.op)({complex_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,i._1)(e,"real","complex"),o=(0,i._1)(t,"imag","complex");return s.k5(n.shape,o.shape,`real and imag shapes, ${n.shape} and ${o.shape}, must match in call to tf.complex().`),r.BV.runKernel(a.Zz9,{real:n,imag:o})}})},6884:function(e,t,n){"use strict";n.d(t,{z:function(){return u}});var r=n(196),a=n(9121),i=n(3740),s=n(569),o=n(8723),l=n(2668);let u=(0,l.op)({concat_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=0){(0,s.hu)(e.length>=1,()=>"Pass at least one tensor to concat");let n=(0,i.sI)(e,"tensors","concat","string_or_numeric");return("complex64"===n[0].dtype&&n.forEach(e=>{if("complex64"!==e.dtype)throw Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${e.dtype}. `)}),1===n.length)?(0,o.d)(n[0]):r.BV.runKernel(a.Eh3,n,{axis:t})}})},1355:function(e,t,n){"use strict";n.d(t,{P:function(){return u}});var r=n(3740),a=n(569),i=n(4794),s=n(2582),o=n(2668),l=n(4968);let u=(0,o.op)({conv1d_:function(e,t,n,o,u="NWC",h=1,c){let d=(0,r._1)(e,"x","conv1d"),p=(0,r._1)(t,"filter","conv1d"),f=d,m=!1;2===d.rank&&(m=!0,f=(0,l.X)(d,[1,d.shape[0],d.shape[1]])),a.hu(3===f.rank,()=>`Error in conv1d: input must be rank 3, but got rank ${f.rank}.`),a.hu(3===p.rank,()=>`Error in conv1d: filter must be rank 3, but got rank ${p.rank}.`),s.m("conv1d",o,c),a.hu(f.shape[2]===p.shape[1],()=>`Error in conv1d: depth of input (${f.shape[2]}) must match input depth for filter ${p.shape[1]}.`),a.hu(s.jT(n,h),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${h}'`),a.hu("NWC"===u,()=>`Error in conv1d: got dataFormat of ${u} but only NWC is currently supported.`);let g=(0,l.X)(p,[1,p.shape[0],p.shape[1],p.shape[2]]),y=(0,l.X)(f,[f.shape[0],1,f.shape[1],f.shape[2]]),b=(0,i.T)(y,g,[1,n],o,"NHWC",[1,h],c);return m?(0,l.X)(b,[b.shape[2],b.shape[3]]):(0,l.X)(b,[b.shape[0],b.shape[2],b.shape[3]])}})},4794:function(e,t,n){"use strict";n.d(t,{T:function(){return h}});var r=n(196),a=n(9121),i=n(3740),s=n(569),o=n(2582),l=n(2668),u=n(4968);let h=(0,l.op)({conv2d_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,l,h="NHWC",c=[1,1],d){let p=(0,i._1)(e,"x","conv2d","float32"),f=(0,i._1)(t,"filter","conv2d","float32"),m=p,g=!1;3===p.rank&&(g=!0,m=(0,u.X)(p,[1,p.shape[0],p.shape[1],p.shape[2]])),s.hu(4===m.rank,()=>`Error in conv2d: input must be rank 4, but got rank ${m.rank}.`),s.hu(4===f.rank,()=>`Error in conv2d: filter must be rank 4, but got rank ${f.rank}.`),o.m("conv2d",l,d);let y="NHWC"===h?m.shape[3]:m.shape[1];s.hu(y===f.shape[2],()=>`Error in conv2d: depth of input (${y}) must match input depth for filter ${f.shape[2]}.`),s.hu(o.jT(n,c),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${c}'`);let b={x:m,filter:f},x=r.BV.runKernel(a.mhS,b,{strides:n,pad:l,dataFormat:h,dilations:c,dimRoundingMode:d});return g?(0,u.X)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},6013:function(e,t,n){"use strict";n.d(t,{p:function(){return u}});var r=n(196),a=n(9121),i=n(569),s=n(2582),o=n(2668),l=n(4968);let u=(0,o.op)({conv2DBackpropFilter_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,o,u,h="NHWC",c){let d=e;3===e.rank&&(d=(0,l.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let p=t;3===p.rank&&(p=(0,l.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]])),i.hu(4===d.rank,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${d.shape}.`),i.hu(4===p.rank,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${p.shape}.`),i.hu(4===n.length,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);let f="NHWC"===h?d.shape[3]:d.shape[1],m="NHWC"===h?p.shape[3]:p.shape[1];i.hu(f===n[2],()=>`Error in conv2dDerFilter: depth of input ${f}) must match input depth in filter (${n[2]}.`),i.hu(m===n[3],()=>`Error in conv2dDerFilter: depth of dy (${m}) must match output depth for filter (${n[3]}).`),s.m("conv2dDerFilter",u,c);let g={x:d,dy:p};return r.BV.runKernel(a.wUP,g,{strides:o,pad:u,dataFormat:h,dimRoundingMode:c,filterShape:n})}})},9832:function(e,t,n){"use strict";n.d(t,{_:function(){return u}});var r=n(196),a=n(9121),i=n(569),s=n(2582),o=n(2668),l=n(4968);let u=(0,o.op)({conv2DBackpropInput_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,o,u,h="NHWC",c){i.hu(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let d=e,p=t,f=!1;3===t.rank&&(f=!0,p=(0,l.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]),d=[1,e[0],e[1],e[2]]),i.hu(4===d.length,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${d.length}.`),i.hu(4===p.rank,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${p.rank}`),i.hu(4===n.rank,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);let m="NHWC"===h?d[3]:d[1],g="NHWC"===h?p.shape[3]:p.shape[1];i.hu(m===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${m}) must match input depth for filter ${n.shape[2]}.`),i.hu(g===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${g}) must match output depth for filter ${n.shape[3]}.`),s.m("conv2dDerInput",u,c);let y={dy:p,filter:n},b={strides:o,pad:u,dataFormat:h,dimRoundingMode:c,inputShape:d},x=r.BV.runKernel(a.wm,y,b);return f?(0,l.X)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},1405:function(e,t,n){"use strict";n.d(t,{b:function(){return s}});var r=n(3740),a=n(9832),i=n(2668);let s=(0,i.op)({conv2dTranspose_:function(e,t,n,i,s,o){let l=(0,r._1)(e,"x","conv2dTranspose"),u=(0,r._1)(t,"filter","conv2dTranspose");return(0,a._)(n,l,u,i,s,"NHWC",o)}})},7594:function(e,t,n){"use strict";n.d(t,{_:function(){return l}});var r=n(196),a=n(9121),i=n(569),s=n(2668),o=n(4968);let l=(0,s.op)({conv3DBackpropInput_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,s,l){i.hu(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let u=e,h=t,c=!1;4===t.rank&&(c=!0,h=(0,o.X)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),u=[1,e[0],e[1],e[2],e[3]]);let d=u[4],p=h.shape[4];i.hu(5===u.length,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${u.length}.`),i.hu(5===h.rank,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${h.rank}`),i.hu(5===n.rank,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),i.hu(d===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${d}) must match input depth for filter ${n.shape[3]}.`),i.hu(p===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${p}) must match output depth for filter ${n.shape[4]}.`);let f={dy:h,filter:n},m={pad:l,strides:s,inputShape:u},g=r.BV.runKernel(a.ik2,f,m);return c?(0,o.X)(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}})},2582:function(e,t,n){"use strict";n.d(t,{I0:function(){return f},Ix:function(){return o},Rf:function(){return a},Xw:function(){return i},aO:function(){return u},jT:function(){return m},jw:function(){return l},m:function(){return y},pl:function(){return s},sl:function(){return g}});var r=n(569);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function a(e,t,n,r,a="NHWC",i){let s=e[3],l=[...t,s],u=g(a);return o(e,l,n,i,r,null,null,u)}function i(e,t,n,r,a,i,s="channelsLast"){let l;let[u,c]=h(t);if("channelsLast"===s)l=[u,c,e[3],e[3]];else if("channelsFirst"===s)l=[u,c,e[1],e[1]];else throw Error(`Unknown dataFormat ${s}`);return o(e,l,n,r,a,i,!1,s)}function s(e,t,n,r,a,i,s="NDHWC"){let o,u;let[h,d,p]=c(t);if("NDHWC"===s)u="channelsLast",o=[h,d,p,e[4],e[4]];else if("NCDHW"===s)u="channelsFirst",o=[h,d,p,e[1],e[1]];else throw Error(`Unknown dataFormat ${s}`);return l(e,o,n,r,a,!1,u,i)}function o(e,t,n,r,a,i,s=!1,o="channelsLast"){let l,[c,f,m,g]=[-1,-1,-1,-1];if("channelsLast"===o)[c,f,m,g]=e;else if("channelsFirst"===o)[c,g,f,m]=e;else throw Error(`Unknown dataFormat ${o}`);let[y,b,,x]=t,[v,w]=h(n),[I,k]=h(r),S=d(y,I),C=d(b,k),{padInfo:E,outHeight:T,outWidth:$}=function(e,t,n,r,a,i,s,o,l){let h,c,d;if("number"==typeof e){h={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};let f=function(e,t,n,r,a){null==r&&(r=u(e,t,n));let i=e[0],s=e[1],o=p((i-t+2*r)/n+1,a),l=p((s-t+2*r)/n+1,a);return[o,l]}([t,n],i,r,e,o);c=f[0],d=f[1]}else if("same"===e){c=Math.ceil(t/r),d=Math.ceil(n/a);let m=Math.max(0,(c-1)*r+i-t),g=Math.max(0,(d-1)*a+s-n),y=Math.floor(m/2),b=Math.floor(g/2);h={top:y,bottom:m-y,left:b,right:g-b,type:"SAME"}}else if("valid"===e)h={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-i+1)/r),d=Math.ceil((n-s+1)/a);else if("object"==typeof e){let x="channelsLast"===l?e[1][0]:e[2][0],v="channelsLast"===l?e[1][1]:e[2][1],w="channelsLast"===l?e[2][0]:e[3][0],I="channelsLast"===l?e[2][1]:e[3][1];h={top:x,bottom:v,left:w,right:I,type:0===x&&0===v&&0===w&&0===I?"VALID":"EXPLICIT"},c=p((t-i+x+v)/r+1,o),d=p((n-s+w+I)/a+1,o)}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:h,outHeight:c,outWidth:d}}(a,f,m,v,w,S,C,i,o),N=s?x*g:x;return"channelsFirst"===o?l=[c,N,T,$]:"channelsLast"===o&&(l=[c,T,$,N]),{batchSize:c,dataFormat:o,inHeight:f,inWidth:m,inChannels:g,outHeight:T,outWidth:$,outChannels:N,padInfo:E,strideHeight:v,strideWidth:w,filterHeight:y,filterWidth:b,effectiveFilterHeight:S,effectiveFilterWidth:C,dilationHeight:I,dilationWidth:k,inShape:e,outShape:l,filterShape:t}}function l(e,t,n,r,a,i=!1,s="channelsLast",o){let l,[h,f,m,g,y]=[-1,-1,-1,-1,-1];if("channelsLast"===s)[h,f,m,g,y]=e;else if("channelsFirst"===s)[h,y,f,m,g]=e;else throw Error(`Unknown dataFormat ${s}`);let[b,x,v,,w]=t,[I,k,S]=c(n),[C,E,T]=c(r),$=d(b,C),N=d(x,E),A=d(v,T),{padInfo:D,outDepth:F,outHeight:R,outWidth:_}=function(e,t,n,r,a,i,s,o,l,h,c){let d,f,m,g;if("number"==typeof e){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};let y=function(e,t,n,r,a,i){null==a&&(a=u(e,t,r));let s=e[0],o=e[1],l=e[2],h=p((s-t+2*a)/r+1,i),c=p((o-t+2*a)/r+1,i),d=p((l-t+2*a)/r+1,i);return[h,c,d,1]}([t,n,r,1],o,0,a,e,c);f=y[0],m=y[1],g=y[2]}else if("same"===e){f=Math.ceil(t/a),m=Math.ceil(n/i),g=Math.ceil(r/s);let b=(f-1)*a+o-t,x=(m-1)*i+l-n,v=(g-1)*s+h-r,w=Math.floor(b/2),I=Math.floor(x/2),k=Math.floor(v/2);d={top:I,bottom:x-I,left:k,right:v-k,front:w,back:b-w,type:"SAME"}}else if("valid"===e)d={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},f=Math.ceil((t-o+1)/a),m=Math.ceil((n-l+1)/i),g=Math.ceil((r-h+1)/s);else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:d,outDepth:f,outHeight:m,outWidth:g}}(a,f,m,g,I,k,S,$,N,A,o),O=i?w*y:w;return"channelsFirst"===s?l=[h,O,F,R,_]:"channelsLast"===s&&(l=[h,F,R,_,O]),{batchSize:h,dataFormat:s,inDepth:f,inHeight:m,inWidth:g,inChannels:y,outDepth:F,outHeight:R,outWidth:_,outChannels:O,padInfo:D,strideDepth:I,strideHeight:k,strideWidth:S,filterDepth:b,filterHeight:x,filterWidth:v,effectiveFilterDepth:$,effectiveFilterHeight:N,effectiveFilterWidth:A,dilationDepth:C,dilationHeight:E,dilationWidth:T,inShape:e,outShape:l,filterShape:t}}function u(e,t,n,r=1){let a=d(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function h(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function c(e){return"number"==typeof e?[e,e,e]:e}function d(e,t){return t<=1?e:e+(e-1)*(t-1)}function p(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw Error(`Unknown roundingMode ${t}`)}}function f(e){let[t,n,r]=h(e);return 1===t&&1===n&&1===r}function m(e,t){return f(e)||f(t)}function g(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw Error(`Unknown dataFormat ${e}`)}function y(e,t,n){if(null!=n){if("string"==typeof t)throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if("number"==typeof t)r.hu(r.GN(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);else if("object"==typeof t)t.forEach(t=>{t.forEach(t=>{r.hu(r.GN(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`)})});else throw Error(`Error in ${e}: Unknown padding parameter: ${t}`)}}},173:function(e,t,n){"use strict";n.d(t,{m:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({cos_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","cos","float32");return r.BV.runKernel(a.mc4,{x:t})}})},2699:function(e,t,n){"use strict";n.d(t,{f:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({cosh_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","cosh","float32");return r.BV.runKernel(a.TR1,{x:t})}})},5510:function(e,t,n){"use strict";n.d(t,{$:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({cumprod_:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=0,n=!1,s=!1){let o=(0,i._1)(e,"x","cumprod");return r.BV.runKernel(a.Byc,{x:o},{axis:t,exclusive:n,reverse:s})}})},7405:function(e,t,n){"use strict";n.d(t,{z:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({cumsum_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=0,n=!1,s=!1){let o=(0,i._1)(e,"x","cumsum");return r.BV.runKernel(a.iHb,{x:o},{axis:t,exclusive:n,reverse:s})}})},4718:function(e,t,n){"use strict";n.d(t,{B:function(){return h}});var r=n(196),a=n(9121),i=n(3740),s=n(569),o=n(2582),l=n(2668),u=n(4968);let h=(0,l.op)({depthwiseConv2d_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,l,h="NHWC",c=[1,1],d){let p=(0,i._1)(e,"x","depthwiseConv2d","float32"),f=(0,i._1)(t,"filter","depthwiseConv2d","float32"),m=p,g=!1;3===p.rank&&(g=!0,m=(0,u.X)(p,[1,p.shape[0],p.shape[1],p.shape[2]])),s.hu(4===m.rank,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${m.rank}.`),s.hu(4===f.rank,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${f.rank}.`);let y="NHWC"===h?m.shape[3]:m.shape[1];s.hu(y===f.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${y}) must match the inChannels dimension in filter ${f.shape[2]}.`),o.m("depthwiseConv2d",l,d);let b={x:m,filter:f},x=r.BV.runKernel(a.cie,b,{strides:n,pad:l,dataFormat:h,dilations:c,dimRoundingMode:d});return g?(0,u.X)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},8098:function(e,t,n){"use strict";n.d(t,{z:function(){return o}});var r=n(196),a=n(9121),i=n(2668),s=n(4968);let o=(0,i.op)({depthwiseConv2dNativeBackpropFilter_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,i,o,l=[1,1],u){let h=e;3===e.rank&&(h=(0,s.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let c=t;3===c.rank&&(c=(0,s.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let d={x:h,dy:c};return r.BV.runKernel(a.sL$,d,{strides:i,pad:o,dimRoundingMode:u,dilations:l,filterShape:n})}})},4375:function(e,t,n){"use strict";n.d(t,{v:function(){return o}});var r=n(196),a=n(9121),i=n(2668),s=n(4968);let o=(0,i.op)({depthwiseConv2dNativeBackpropInput_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,i,o,l=[1,1],u){let h=t,c=!1;3===t.rank&&(c=!0,h=(0,s.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let d={dy:h,filter:n},p=r.BV.runKernel(a.y7R,d,{strides:i,pad:o,dimRoundingMode:u,dilations:l,inputShape:e});return c?(0,s.X)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},1274:function(e,t,n){"use strict";n.d(t,{h:function(){return u}});var r=n(196),a=n(9121),i=n(747),s=n(3740),o=n(9165),l=n(2668);let u=(0,l.op)({div_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,s._1)(e,"a","div"),l=(0,s._1)(t,"b","div");if([n,l]=(0,i.makeTypesMatch)(n,l),"int32"===n.dtype&&"int32"===l.dtype)return(0,o.q)(n,l);let u={a:n,b:l};return r.BV.runKernel(a.oHH,u,{})}})},3233:function(e,t,n){"use strict";n.d(t,{p:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({elu_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","elu","float32");return r.BV.runKernel(a.SX0,{x:t})}})},6477:function(e,t,n){"use strict";n.d(t,{D:function(){return u}});var r=n(196),a=n(9121),i=n(747),s=n(3740),o=n(2200),l=n(2668);let u=(0,l.op)({equal_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,s._1)(e,"a","equal","string_or_numeric"),l=(0,s._1)(t,"b","equal","string_or_numeric");[n,l]=(0,i.makeTypesMatch)(n,l),(0,o.assertAndGetBroadcastShape)(n.shape,l.shape);let u={a:n,b:l};return r.BV.runKernel(a.hdR,u)}})},4842:function(e,t,n){"use strict";n.d(t,{Q:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({exp_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","exp");return r.BV.runKernel(a.NEP,{x:t})}})},1300:function(e,t,n){"use strict";n.d(t,{d:function(){return l}});var r=n(196),a=n(9121),i=n(3740),s=n(569),o=n(2668);let l=(0,o.op)({expandDims_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=0){let n=(0,i._1)(e,"x","expandDims","string_or_numeric");return s.hu(t<=n.rank,()=>"Axis must be <= rank of the tensor"),r.BV.runKernel(a.YFo,{input:n},{dim:t})}})},4006:function(e,t,n){"use strict";n.d(t,{h:function(){return i}});var r=n(196),a=n(9121);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function i(e,t,n){return r.BV.runKernel(a.deh,{},{shape:e,value:t,dtype:n})}},6943:function(e,t,n){"use strict";n.d(t,{G:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({floor_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","floor","float32");return r.BV.runKernel(a.OR,{x:t})}})},9165:function(e,t,n){"use strict";n.d(t,{q:function(){return l}});var r=n(196),a=n(9121),i=n(747),s=n(3740),o=n(2668);let l=(0,o.op)({floorDiv_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,s._1)(e,"a","floorDiv"),o=(0,s._1)(t,"b","floorDiv");[n,o]=(0,i.makeTypesMatch)(n,o);let l={a:n,b:o};return r.BV.runKernel(a.jeX,l)}})},4926:function(e,t,n){"use strict";n.d(t,{I:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({gather_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n=0,s=0){let o=(0,i._1)(e,"x","gather"),l=(0,i._1)(t,"indices","gather","int32");return r.BV.runKernel(a.qi_,{x:o,indices:l},{axis:n,batchDims:s})}})},636:function(e,t,n){"use strict";n.d(t,{p:function(){return u}});var r=n(196),a=n(9121),i=n(747),s=n(3740),o=n(2200),l=n(2668);let u=(0,l.op)({greater_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,s._1)(e,"a","greater","string_or_numeric"),l=(0,s._1)(t,"b","greater","string_or_numeric");[n,l]=(0,i.makeTypesMatch)(n,l),(0,o.assertAndGetBroadcastShape)(n.shape,l.shape);let u={a:n,b:l};return r.BV.runKernel(a.iZT,u)}})},7630:function(e,t,n){"use strict";n.d(t,{b:function(){return u}});var r=n(196),a=n(9121),i=n(747),s=n(3740),o=n(2200),l=n(2668);let u=(0,l.op)({greaterEqual_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,s._1)(e,"a","greaterEqual","string_or_numeric"),l=(0,s._1)(t,"b","greaterEqual","string_or_numeric");[n,l]=(0,i.makeTypesMatch)(n,l),(0,o.assertAndGetBroadcastShape)(n.shape,l.shape);let u={a:n,b:l};return r.BV.runKernel(a.Acj,u)}})},4386:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({imag_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"input","imag");return r.BV.runKernel(a.J_u,{input:t})}})},3305:function(e,t,n){"use strict";n.d(t,{I:function(){return u}});var r=n(196),a=n(9121),i=n(3740),s=n(569),o=n(2668),l=n(4968);let u=(0,o.op)({resizeBilinear_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n=!1,o=!1){let u=(0,i._1)(e,"images","resizeBilinear");s.hu(3===u.rank||4===u.rank,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${u.rank}.`),s.hu(2===t.length,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),s.hu(!1===o||!1===n,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let h=u,c=!1;3===u.rank&&(c=!0,h=(0,l.X)(u,[1,u.shape[0],u.shape[1],u.shape[2]]));let[]=t,d={images:h},p=r.BV.runKernel(a._Yw,d,{alignCorners:n,halfPixelCenters:o,size:t});return c?(0,l.X)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},5098:function(e,t,n){"use strict";n.d(t,{j:function(){return u}});var r=n(196),a=n(9121),i=n(3740),s=n(569),o=n(2668),l=n(4968);let u=(0,o.op)({resizeNearestNeighbor_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n=!1,o=!1){let u=(0,i._1)(e,"images","resizeNearestNeighbor");s.hu(3===u.rank||4===u.rank,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${u.rank}.`),s.hu(2===t.length,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),s.hu("float32"===u.dtype||"int32"===u.dtype,()=>"`images` must have `int32` or `float32` as dtype"),s.hu(!1===o||!1===n,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let h=u,c=!1;3===u.rank&&(c=!0,h=(0,l.X)(u,[1,u.shape[0],u.shape[1],u.shape[2]]));let[]=t,d={images:h},p=r.BV.runKernel(a.dpD,d,{alignCorners:n,halfPixelCenters:o,size:t});return c?(0,l.X)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},9133:function(e,t,n){"use strict";n.d(t,{h:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({leakyRelu_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=.2){let n=(0,i._1)(e,"x","leakyRelu");return r.BV.runKernel(a.J$2,{x:n},{alpha:t})}})},6573:function(e,t,n){"use strict";n.d(t,{d:function(){return u}});var r=n(196),a=n(9121),i=n(747),s=n(3740),o=n(2200),l=n(2668);let u=(0,l.op)({less_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,s._1)(e,"a","less","string_or_numeric"),l=(0,s._1)(t,"b","less","string_or_numeric");[n,l]=(0,i.makeTypesMatch)(n,l),(0,o.assertAndGetBroadcastShape)(n.shape,l.shape);let u={a:n,b:l};return r.BV.runKernel(a.vtC,u)}})},624:function(e,t,n){"use strict";n.d(t,{z:function(){return u}});var r=n(196),a=n(9121),i=n(747),s=n(3740),o=n(2200),l=n(2668);let u=(0,l.op)({lessEqual_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,s._1)(e,"a","lessEqual","string_or_numeric"),l=(0,s._1)(t,"b","lessEqual","string_or_numeric");[n,l]=(0,i.makeTypesMatch)(n,l),(0,o.assertAndGetBroadcastShape)(n.shape,l.shape);let u={a:n,b:l};return r.BV.runKernel(a.CAk,u)}})},2597:function(e,t,n){"use strict";n.d(t,{c:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({log_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","log","float32");return r.BV.runKernel(a.ZbH,{x:t})}})},7474:function(e,t,n){"use strict";n.d(t,{K:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({log1p_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","log1p");return r.BV.runKernel(a.kU,{x:t})}})},1510:function(e,t,n){"use strict";n.d(t,{C:function(){return p}});var r=n(633),a=n(3740),i=n(2271),s=n(4842),o=n(2597),l=n(3307),u=n(4841),h=n(2668),c=n(827),d=n(5475);let p=(0,h.op)({logSoftmax_:/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=-1){let n=(0,a._1)(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);let h=(0,r.cb)((e,n)=>{let r=(0,l.F)(e,t,!0),a=(0,c.l)(e,r),h=(0,c.l)((0,i.p)(a,"float32"),(0,o.c)((0,d.S)((0,s.Q)(a),t,!0)));n([h]);let p=(e,n)=>{let[r]=n,a=(0,s.Q)(r);return(0,c.l)(e,(0,u.d)((0,d.S)(e,t,!0),a))};return{value:h,gradFunc:p}});return h(n)}})},1391:function(e,t,n){"use strict";n.d(t,{l:function(){return f}});var r=n(3740),a=n(569),i=n(6407),s=n(3591),o=n(4842),l=n(2597),u=n(3307),h=n(2668),c=n(4968),d=n(827),p=n(5475);let f=(0,h.op)({logSumExp_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=null,n=!1){let h=(0,r._1)(e,"x","logSumExp"),f=(0,a.EC)(t,h.shape),m=(0,u.F)(h,f,!0),g=(0,d.l)(h,m),y=(0,o.Q)(g),b=(0,p.S)(y,f),x=(0,l.c)(b),v=(0,i.I)((0,c.X)(m,x.shape),x);if(n){let w=(0,s.rv)(v.shape,f);return(0,c.X)(v,w)}return v}})},2856:function(e,t,n){"use strict";n.d(t,{H:function(){return l}});var r=n(196),a=n(9121),i=n(3740),s=n(2200),o=n(2668);let l=(0,o.op)({logicalAnd_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,i._1)(e,"a","logicalAnd","bool"),o=(0,i._1)(t,"b","logicalAnd","bool");return(0,s.assertAndGetBroadcastShape)(n.shape,o.shape),r.BV.runKernel(a.PYm,{a:n,b:o})}})},8651:function(e,t,n){"use strict";n.d(t,{h:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({logicalNot_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","logicalNot","bool");return r.BV.runKernel(a.VfG,{x:t})}})},8687:function(e,t,n){"use strict";n.d(t,{O:function(){return l}});var r=n(196),a=n(9121),i=n(747),s=n(3740),o=n(2668);let l=(0,o.op)({matMul_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n=!1,o=!1){let l=(0,s._1)(e,"a","matMul"),u=(0,s._1)(t,"b","matMul");[l,u]=(0,i.makeTypesMatch)(l,u);let h={a:l,b:u};return r.BV.runKernel(a.XLW,h,{transposeA:n,transposeB:o})}})},3307:function(e,t,n){"use strict";n.d(t,{F:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({max_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=null,n=!1){let s=(0,i._1)(e,"x","max");return r.BV.runKernel(a.YoZ,{x:s},{reductionIndices:t,keepDims:n})}})},1174:function(e,t,n){"use strict";n.d(t,{_:function(){return h}});var r=n(196),a=n(9121),i=n(3740),s=n(569),o=n(2582),l=n(2668),u=n(4968);let h=(0,l.op)({maxPool_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,l,h){let c=(0,i._1)(e,"x","maxPool"),d=c,p=!1;3===c.rank&&(p=!0,d=(0,u.X)(c,[1,c.shape[0],c.shape[1],c.shape[2]])),s.hu(4===d.rank,()=>`Error in maxPool: input must be rank 4 but got rank ${d.rank}.`),s.hu(o.jT(n,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`),o.m("maxPool",l,h);let f={x:d},m=r.BV.runKernel(a.mTV,f,{filterSize:t,strides:n,pad:l,dimRoundingMode:h});return p?(0,u.X)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})},632:function(e,t,n){"use strict";n.d(t,{g:function(){return h}});var r=n(196),a=n(9121),i=n(747),s=n(3740),o=n(2200),l=n(2271),u=n(2668);let h=(0,u.op)({maximum_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,s._1)(e,"a","maximum"),u=(0,s._1)(t,"b","maximum");[n,u]=(0,i.makeTypesMatch)(n,u),"bool"===n.dtype&&(n=(0,l.p)(n,"int32"),u=(0,l.p)(u,"int32")),(0,o.assertAndGetBroadcastShape)(n.shape,u.shape);let h={a:n,b:u};return r.BV.runKernel(a.BMI,h)}})},5130:function(e,t,n){"use strict";n.d(t,{J:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({mean_:/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=null,n=!1){let s=(0,i._1)(e,"x","mean");return r.BV.runKernel(a.q2K,{x:s},{axis:t,keepDims:n})}})},5735:function(e,t,n){"use strict";n.d(t,{V:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({min_:/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=null,n=!1){let s=(0,i._1)(e,"x","min");return r.BV.runKernel(a.c17,{x:s},{axis:t,keepDims:n})}})},4513:function(e,t,n){"use strict";n.d(t,{L:function(){return h}});var r=n(196),a=n(9121),i=n(747),s=n(3740),o=n(2200),l=n(2271),u=n(2668);let h=(0,u.op)({minimum_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,s._1)(e,"a","minimum"),u=(0,s._1)(t,"b","minimum");[n,u]=(0,i.makeTypesMatch)(n,u),"bool"===n.dtype&&(n=(0,l.p)(n,"int32"),u=(0,l.p)(u,"int32")),(0,o.assertAndGetBroadcastShape)(n.shape,u.shape);let h={a:n,b:u};return r.BV.runKernel(a.q8u,h)}})},4841:function(e,t,n){"use strict";n.d(t,{d:function(){return l}});var r=n(196),a=n(9121),i=n(747),s=n(3740),o=n(2668);let l=(0,o.op)({mul_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,s._1)(e,"a","mul"),o=(0,s._1)(t,"b","mul");[n,o]=(0,i.makeTypesMatch)(n,o);let l={a:n,b:o};return r.BV.runKernel(a.wYn,l)}})},7370:function(e,t,n){"use strict";n.d(t,{W:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({neg_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","neg");return r.BV.runKernel(a.kuV,{x:t})}})},3561:function(e,t,n){"use strict";n.d(t,{K:function(){return g}});var r=n(3740),a=n(569),i=n(6235),s=n(3591),o=n(3307),l=n(5735),u=n(2668),h=n(3453),c=n(4968),d=n(9494),p=n(3261),f=n(248),m=n(5475);let g=(0,u.op)({norm_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t="euclidean",n=null,u=!1){e=(0,r._1)(e,"x","norm");let g=function e(t,n,r=null){if(0===t.rank)return(0,i.W)(t);if(1!==t.rank&&null===r)return e((0,c.X)(t,[-1]),n,r);if(1===t.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return(0,m.S)((0,i.W)(t),r);if(n===1/0)return(0,o.F)((0,i.W)(t),r);if(n===-1/0)return(0,l.V)((0,i.W)(t),r);if("euclidean"===n||2===n)return(0,p._)((0,m.S)((0,h.s)((0,i.W)(t),(0,d.i)(2,"int32")),r));throw Error(`Error in norm: invalid ord value: ${n}`)}if(Array.isArray(r)&&2===r.length){if(1===n)return(0,o.F)((0,m.S)((0,i.W)(t),r[0]),r[1]-1);if(n===1/0)return(0,o.F)((0,m.S)((0,i.W)(t),r[1]),r[0]);if(n===-1/0)return(0,l.V)((0,m.S)((0,i.W)(t),r[1]),r[0]);if("fro"===n||"euclidean"===n)return(0,p._)((0,m.S)((0,f.h)(t),r));throw Error(`Error in norm: invalid ord value: ${n}`)}throw Error(`Error in norm: invalid axis: ${r}`)}(e,t,n),y=g.shape;if(u){let b=(0,a.EC)(n,e.shape);y=s.rv(g.shape,b)}return(0,c.X)(g,y)}})},6500:function(e,t,n){"use strict";n.d(t,{Q:function(){return u}});var r=n(196),a=n(9121),i=n(747),s=n(3740),o=n(2200),l=n(2668);let u=(0,l.op)({notEqual_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,s._1)(e,"a","notEqual","string_or_numeric"),l=(0,s._1)(t,"b","notEqual","string_or_numeric");[n,l]=(0,i.makeTypesMatch)(n,l),(0,o.assertAndGetBroadcastShape)(n.shape,l.shape);let u={a:n,b:l};return r.BV.runKernel(a.yQU,u)}})},6708:function(e,t,n){"use strict";n.d(t,{l:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({oneHot_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n=1,s=0,o="int32"){if(t<2)throw Error(`Error in oneHot: depth must be >=2, but it is ${t}`);let l=(0,i._1)(e,"indices","oneHot","int32");return r.BV.runKernel(a.we_,{indices:l},{dtype:o,depth:t,onValue:n,offValue:s})}})},4917:function(e,t,n){"use strict";n.d(t,{i:function(){return(/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function e(t,n="float32"){if("complex64"===n){let o=e(t,"float32"),l=(0,s.l)(t,"float32");return(0,i.P)(o,l)}let u=(0,a.p8)((0,a.NA)(t),n);return r.BV.makeTensor(u,t,n)})}});var r=n(196),a=n(569),i=n(1661),s=n(9640)},7846:function(e,t,n){"use strict";n.d(t,{J:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({onesLike_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","onesLike");return r.BV.runKernel(a.qWM,{x:t})}})},2668:function(e,t,n){"use strict";n.d(t,{op:function(){return i}});var r=n(196),a=n(569);function i(e){let t=Object.keys(e);if(1!==t.length)throw Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0],i=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+="__op";let s=(...e)=>{r.BV.startScope(n);try{let t=i(...e);return(0,a.tI)(t)&&console.error("Cannot return a Promise inside of tidy."),r.BV.endScope(t),t}catch(s){throw r.BV.endScope(null),s}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}},9682:function(e,t,n){"use strict";n.d(t,{v:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({pad_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n=0){let s=(0,i._1)(e,"x","pad");if(0===s.rank)throw Error("pad(scalar) is not defined. Pass non-scalar to pad");return r.BV.runKernel(a.lyA,{x:s},{paddings:t,constantValue:n})}})},3453:function(e,t,n){"use strict";n.d(t,{s:function(){return l}});var r=n(196),a=n(9121),i=n(747),s=n(3740),o=n(2668);let l=(0,o.op)({pow_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,s._1)(e,"base","pow"),o=(0,s._1)(t,"exp","pow");[n,o]=(0,i.makeTypesMatch)(n,o);let l={a:n,b:o};return r.BV.runKernel(a.pe_,l)}})},8151:function(e,t,n){"use strict";n.d(t,{A:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({prelu_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,i._1)(e,"x","prelu"),s=(0,i._1)(t,"alpha","prelu");return r.BV.runKernel(a.o0g,{x:n,alpha:s})}})},766:function(e,t,n){"use strict";n.d(t,{k:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({real_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"input","real");return r.BV.runKernel(a.xJR,{input:t})}})},7409:function(e,t,n){"use strict";n.d(t,{U:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({relu_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","relu");return r.BV.runKernel(a.qkr,{x:t})}})},3582:function(e,t,n){"use strict";n.d(t,{b:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({relu6_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","relu6");return r.BV.runKernel(a.SbG,{x:t})}})},4968:function(e,t,n){"use strict";n.d(t,{X:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({reshape_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,i._1)(e,"x","reshape","string_or_numeric");return r.BV.runKernel(a.HZH,{x:n},{shape:t})}})},7486:function(e,t,n){"use strict";n.d(t,{G:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({reverse_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,i._1)(e,"x","reverse");return r.BV.runKernel(a.mKl,{x:n},{dims:t})}})},7809:function(e,t,n){"use strict";n.d(t,{N:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({round_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","round");return r.BV.runKernel(a.e07,{x:t})}})},2634:function(e,t,n){"use strict";n.d(t,{b:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({rsqrt_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","rsqrt","float32");return r.BV.runKernel(a.bV0,{x:t})}})},9494:function(e,t,n){"use strict";n.d(t,{i:function(){return i}});var r=n(569),a=n(7852);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function i(e,t){if(((0,r.fU)(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&(0,r.fU)(e)&&!(e instanceof Uint8Array))throw Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return(0,a.H)(e,[],[],t)}},5503:function(e,t,n){"use strict";n.d(t,{U:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({selu_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","selu");return r.BV.runKernel(a.oFR,{x:t})}})},3179:function(e,t,n){"use strict";n.d(t,{$:function(){return a},y:function(){return r}});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let r=1.7580993408473768,a=1.0507009873554805},8678:function(e,t,n){"use strict";n.d(t,{U:function(){return u}});var r=n(3740),a=n(569),i=n(4794),s=n(4718),o=n(2668),l=n(4968);let u=(0,o.op)({separableConv2d_:function(e,t,n,o,u,h=[1,1],c="NHWC"){let d=(0,r._1)(e,"x","separableConv2d"),p=(0,r._1)(t,"depthwiseFilter","separableConv2d"),f=(0,r._1)(n,"pointwiseFilter","separableConv2d"),m=d,g=!1;if(3===d.rank&&(g=!0,m=(0,l.X)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),"NCHW"===c)throw Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");a.hu(4===m.rank,()=>`Error in separableConv2d: input must be rank 4, but got rank ${m.rank}.`),a.hu(4===p.rank,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${p.rank}.`),a.hu(4===f.rank,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${p.rank}.`),a.hu(1===f.shape[0],()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${f.shape[0]}.`),a.hu(1===f.shape[1],()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${f.shape[1]}.`);let y=p.shape[2],b=p.shape[3];a.hu(f.shape[2]===y*b,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${y*b}, but got ${f.shape[2]}.`);let x=(0,s.B)(m,p,o,u,c,h),v=(0,i.T)(x,f,1,"valid",c);return g?(0,l.X)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},625:function(e,t,n){"use strict";n.d(t,{X:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({sigmoid_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","sigmoid","float32");return r.BV.runKernel(a.a5O,{x:t})}})},9331:function(e,t,n){"use strict";n.d(t,{O:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({sin_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","sin","float32");return r.BV.runKernel(a.RQH,{x:t})}})},3254:function(e,t,n){"use strict";n.d(t,{R:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({sinh_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","sinh");return r.BV.runKernel(a.wYB,{x:t})}})},2676:function(e,t,n){"use strict";n.d(t,{t:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({slice_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){let s=(0,i._1)(e,"x","slice","string_or_numeric");if(0===s.rank)throw Error("Slicing scalar is not possible");return r.BV.runKernel(a.p2w,{x:s},{begin:t,size:n})}})},7650:function(e,t,n){"use strict";n.r(t),n.d(t,{assertParamsValid:function(){return a},computeFlatOffset:function(){return g},computeOutShape:function(){return s},getNormalizedAxes:function(){return u},isSliceContinous:function(){return m},maskToAxes:function(){return i},parseSliceParams:function(){return y},sliceInfo:function(){return b},startForAxis:function(){return p},startIndicesWithElidedDims:function(){return h},stopForAxis:function(){return f},stopIndicesWithElidedDims:function(){return c},stridesForAxis:function(){return d},stridesWithElidedDims:function(){return o}});var r=n(569);function a(e,t,n){let a=e.shape.length;r.hu(a===t.length,()=>`Error in slice${a}D: Length of begin ${t} must match the rank of the array (${a}).`),r.hu(a===n.length,()=>`Error in slice${a}D: Length of size ${n} must match the rank of the array (${a}).`);for(let i=0;i<a;++i)r.hu(t[i]+n[i]<=e.shape[i],()=>`Error in slice${a}D: begin[${i}] + size[${i}] (${t[i]+n[i]}) would overflow input.shape[${i}] (${e.shape[i]})`)}function i(e){let t=[],n=0;for(;e>0;)1&e&&t.push(n),e/=2,n++;return t}function s(e,t,n){let r=[];for(let a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function o(e,t,n,r){let a=[...e];for(let i=a.length;i<r.length;i++)a.push(1);for(let s=0;s<n;s++)0===s?a[t]=1:(a.splice(t,0,1),a.pop());return a}function l(e,t){let n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function u(e,t,n,r,a,i,s,l,u){let m=e.length,g=Array(m),y=Array(m),b=Array(m);if(t.length&&n>0){let x=t[0],v=n+1;g=h(s,x,v,r,e),y=c(l,x,v,a,e),b=o(i,x,v,e)}else for(let w=0;w<m;w++)g[w]=p(s,r,i,e,w,u),y[w]=f(l,a,i,e,w,u),b[w]=d(i,w,u);return{begin:g,end:y,strides:b}}function h(e,t,n,r,a){let i=[...a],s=l(n,t);for(let o=0;o<i.length;o++)if(s.indexOf(o)>-1)i[o]=0;else{var u;let h=(u=o)<=t?u:u-(n-1),c=r[h];e&1<<h&&(c=0),i[o]=c}return i}function c(e,t,n,a,i){let s=[...i],o=l(n,t);for(let u=0;u<s.length;u++)if(o.indexOf(u)>-1)s[u]=Number.MAX_SAFE_INTEGER;else{var h;let c=(h=u)<=t?h:h-(n-1),d=a[c];e&1<<c&&(d=Number.MAX_SAFE_INTEGER),s[u]=d}for(let p=0;p<s.length;p++){let f=i[p];s[p]<0&&(s[p]+=f),s[p]=r.uZ(0,s[p],i[p])}return s}function d(e,t,n){let r=e[t];return(n&1<<t||null==r)&&(r=1),r}function p(e,t,n,a,i,s){let o=t[i],l=n[i]||1;(e&1<<i||s&1<<i||null==o)&&(o=l>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);let u=a[i];return o<0&&(o+=u),o=r.uZ(0,o,u-1)}function f(e,t,n,a,i,s){let o=t[i],l=n[i]||1;(e&1<<i||s&1<<i||null==o)&&(o=l>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);let u=a[i];return o<0&&(o+=u),o=l>0?r.uZ(0,o,u):r.uZ(-1,o,u-1)}function m(e,t,n){let r=n.length;for(let a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(let i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function g(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function y(e,t,n){let a,i;let s=e.shape.length;return(a="number"==typeof t?[t,...Array(s-1).fill(0)]:t.length<s?t.concat(Array(s-t.length).fill(0)):t.slice()).forEach(e=>{r.hu(-1!==e,()=>"slice() does not support negative begin indexing.")}),i=(i=null==n?Array(s).fill(-1):"number"==typeof n?[n,...Array(s-1).fill(-1)]:n.length<s?n.concat(Array(s-n.length).fill(-1)):n).map((t,n)=>t>=0?t:(r.hu(-1===t,()=>`Negative size values should be exactly -1 but got ${t} for the slice() size at index ${n}.`),e.shape[n]-a[n])),[a,i]}function b(e,t,n,r,a,i,s,o,l){let u;if(null==r?(u=Array(t.length)).fill(1):u=r,null!=s&&(s&s-1)!=0)throw Error("Multiple ellipses in slice is not allowed.");let h=!1,c={dims:u.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:u.slice(),beginMask:a,endMask:i,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l};for(let d=0;d<c.dims;d++)h&&(1<<d&o)!=0&&c.numAddAxisAfterEllipsis++,1<<d&s&&(h=!0);!h&&(c.ellipsisMask|=1<<c.dims,c.dims++);let p={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=Array(t.dims),t.end=Array(t.dims),t.strides=Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){let a=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<a;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(-2),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);null!=e.begin&&(t.begin[n]=e.begin[r]),null!=e.end&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(-1),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}(c,p);let f=!0,m=!0,g=!0,y=[],b=[];for(let v=0;v<e.length;++v){let w;if(0===p.strides[v])throw Error(`strides[${v}] must be non-zero`);let I=!!(p.shrinkAxisMask&1<<v),k=e[v];if(-1===k){y.push(I?1:-1);continue}let S=[p.beginMask&1<<v,p.endMask&1<<v],C=[p.strides[v]>0?0:-1,p.strides[v]>0?k:k-1];if(I&&p.strides[v]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&1===p.strides[v];let E=!!(p.beginMask&1<<v&&p.endMask&1<<v);if(p.beginValid&&p.endValid){if(I){let T=p.begin[v]<0?k+p.begin[v]:p.begin[v];if(p.begin[v]=T,p.end[v]=p.begin[v]+1,T<0||T>=k)throw Error(`slice index ${p.begin[v]} of dimension ${v} out of bounds.`)}else p.begin[v]=x(p.begin[v],0,p.strides[v],k,S,C),p.end[v]=x(p.end[v],1,p.strides[v],k,S,C);let $=1===p.strides[v]&&0===p.begin[v]&&p.end[v]===k;f=f&&$,m=m&&(0===v&&1===p.strides[v]||$)}else f=f&&1===p.strides[v]&&E,m=m&&(0===v&&1===p.strides[v]||E);let N=!1;if(p.beginValid&&p.endValid?(w=p.end[v]-p.begin[v],N=!0):I?(w=1,N=!0):E&&k>=0&&(w=p.strides[v]<0?-k:k,N=!0),N){let A;A=0===w||w<0!=p.strides[v]<0?0:Math.trunc(w/p.strides[v])+(w%p.strides[v]!=0?1:0),y.push(A)}else y.push(-1)}for(let D=0;D<p.finalShapeGatherIndices.length;++D){let F=p.finalShapeGatherIndices[D];F>=0?b.push(y[F]):-2===F&&b.push(1)}let R=b.filter((e,t)=>-2!==p.finalShapeGatherIndices[t]);return{finalShapeSparse:R,finalShape:b,isIdentity:f,sliceDim0:m,isSimpleSlice:g,begin:p.begin,end:p.end,strides:p.strides}}function x(e,t,n,r,a,i){if(a[t])return n>0?i[t]:i[t+1&1];{let s=e<0?r+e:e;return s<i[0]?i[0]:s>i[1]?i[1]:s}}},682:function(e,t,n){"use strict";n.d(t,{X:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({softmax_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=-1){let n=(0,i._1)(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);let s={dim:t};return r.BV.runKernel(a.Gcp,{logits:n},s)}})},3694:function(e,t,n){"use strict";n.d(t,{W:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({softplus_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","softplus");return r.BV.runKernel(a.MRv,{x:t})}})},7918:function(e,t,n){"use strict";n.d(t,{f:function(){return l}});var r=n(196),a=n(9121),i=n(3740),s=n(569),o=n(2668);let l=(0,o.op)({spaceToBatchND_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){let o=(0,i._1)(e,"x","spaceToBatchND");return s.hu(o.rank>=1+t.length,()=>`input rank ${o.rank} should be > than [blockShape] ${t.length}`),s.hu(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),s.hu(o.shape.reduce((e,r,a)=>a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]==0:e,!0),()=>`input spatial dimensions ${o.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`),r.BV.runKernel(a.TQc,{x:o},{blockShape:t,paddings:n})}})},7020:function(e,t,n){"use strict";n.d(t,{k:function(){return o}});var r=n(196),a=n(9121),i=n(569),s=n(2668);let o=(0,s.op)({fft_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){return(0,i.hu)("complex64"===e.dtype,()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`),r.BV.runKernel(a.vwp,{input:e})}})},8447:function(e,t,n){"use strict";n.d(t,{S:function(){return o}});var r=n(196),a=n(9121),i=n(569),s=n(2668);let o=(0,s.op)({ifft_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){return(0,i.hu)("complex64"===e.dtype,()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`),r.BV.runKernel(a.Qg5,{input:e})}})},4415:function(e,t,n){"use strict";n.d(t,{w:function(){return f}});var r=n(1661),a=n(6884),i=n(4386),s=n(4841),o=n(2668),l=n(766),u=n(4968),h=n(7486),c=n(9494),d=n(2676),p=n(8447);let f=(0,o.op)({irfft_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t;let n=e.shape[e.shape.length-1],o=e.size/n;if(n<=2){let f=(0,u.X)(e,[o,n]);t=(0,p.S)(f)}else{let m=[o,2*(n-1)],g=(0,u.X)((0,l.k)(e),[o,n]),y=(0,u.X)((0,i.a)(e),[o,n]),b=(0,h.G)((0,d.t)(g,[0,1],[o,n-2]),1),x=(0,s.d)((0,h.G)((0,d.t)(y,[0,1],[o,n-2]),1),(0,c.i)(-1)),v=(0,a.z)([g,b],1),w=(0,a.z)([y,x],1),I=(0,u.X)((0,r.P)(v,w),[m[0],m[1]]);t=(0,p.S)(I)}if(t=(0,l.k)(t),3===e.rank&&0!==e.shape[0]){let k=t,S=e.shape[0];t=(0,u.X)(t,[S,t.shape[0]/S,t.shape[1]]),k.dispose()}return t}})},3710:function(e,t,n){"use strict";n.d(t,{Q:function(){return m}});var r=n(569),a=n(1661),i=n(6884),s=n(4386),o=n(2668),l=n(766),u=n(4968),h=n(2676),c=n(8644),d=n(9640),p=n(6577),f=n(7020);let m=(0,o.op)({rfft_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n;(0,r.hu)("float32"===e.dtype,()=>`The dtype for rfft() must be real value but got ${e.dtype}`);let o=e.shape[e.shape.length-1],m=e.size/o;if(null!=t&&t<o){let g=e.shape.map(e=>0),y=e.shape.map(e=>e);y[e.shape.length-1]=t,n=(0,h.t)(e,g,y),o=t}else if(null!=t&&t>o){let b=e.shape.map(e=>e);b[e.shape.length-1]=t-o,n=(0,i.z)([e,(0,d.l)(b)],e.shape.length-1),o=t}else n=e;let x=(0,p.P)(n),v=(0,u.X)((0,a.P)(n,x),[m,o]),w=(0,f.k)(v),I=Math.floor(o/2)+1,k=(0,l.k)(w),S=(0,s.a)(w),C=(0,c.V)(k,[I,o-I],k.shape.length-1),E=(0,c.V)(S,[I,o-I],S.shape.length-1),T=n.shape.slice();return T[n.shape.length-1]=I,(0,u.X)((0,a.P)(C[0],E[0]),T)}})},8644:function(e,t,n){"use strict";n.d(t,{V:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({split_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n=0){let s=(0,i._1)(e,"x","split");return r.BV.runKernel(a.L8s,{x:s},{numOrSizeSplits:t,axis:n})}})},3261:function(e,t,n){"use strict";n.d(t,{_:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({sqrt_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","sqrt","float32");return r.BV.runKernel(a.FKq,{x:t})}})},248:function(e,t,n){"use strict";n.d(t,{h:function(){return s}});var r=n(196),a=n(3740),i=n(2668);let s=(0,i.op)({square_:/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,a._1)(e,"x","square");return r.BV.runKernel("Square",{x:t},{})}})},5265:function(e,t,n){"use strict";n.d(t,{$:function(){return u}});var r=n(196),a=n(9121),i=n(747),s=n(3740),o=n(2200),l=n(2668);let u=(0,l.op)({squaredDifference_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,s._1)(e,"a","squaredDifference"),l=(0,s._1)(t,"b","squaredDifference");[n,l]=(0,i.makeTypesMatch)(n,l),(0,o.assertAndGetBroadcastShape)(n.shape,l.shape);let u={a:n,b:l};return r.BV.runKernel(a._tC,u,{})}})},9590:function(e,t,n){"use strict";n.d(t,{L:function(){return o}});var r=n(3740),a=n(569),i=n(2668),s=n(4968);let o=(0,i.op)({squeeze_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,r._1)(e,"x","squeeze","string_or_numeric");return(0,s.X)(n,(0,a.bp)(n.shape,t).newShape)}})},2991:function(e,t,n){"use strict";n.d(t,{k:function(){return l}});var r=n(196),a=n(9121),i=n(3740),s=n(569),o=n(2668);let l=(0,o.op)({stack_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=0){let n=(0,i.sI)(e,"tensors","stack","string_or_numeric");return s.hu(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&s.hu(t<=n[0].rank,()=>"Axis must be <= rank of the tensor"),r.BV.runKernel(a.QiL,n,{axis:t})}})},1901:function(e,t,n){"use strict";n.d(t,{N:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({step_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=0){let n=(0,i._1)(e,"x","step");return r.BV.runKernel(a.h8e,{x:n},{alpha:t})}})},827:function(e,t,n){"use strict";n.d(t,{l:function(){return l}});var r=n(196),a=n(9121),i=n(747),s=n(3740),o=n(2668);let l=(0,o.op)({sub_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,s._1)(e,"a","sub"),o=(0,s._1)(t,"b","sub");[n,o]=(0,i.makeTypesMatch)(n,o);let l={a:n,b:o};return r.BV.runKernel(a.Tr8,l)}})},5475:function(e,t,n){"use strict";n.d(t,{S:function(){return l}});var r=n(196),a=n(9121),i=n(3740),s=n(2271),o=n(2668);let l=(0,o.op)({sum_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=null,n=!1){let o=(0,i._1)(e,"x","sum");"bool"===o.dtype&&(o=(0,s.p)(o,"int32"));let l={x:o};return r.BV.runKernel(a.GBy,l,{axis:t,keepDims:n})}})},1869:function(e,t,n){"use strict";n.d(t,{A:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({tanh_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","tanh","float32");return r.BV.runKernel(a.MIZ,{x:t})}})},7852:function(e,t,n){"use strict";n.d(t,{H:function(){return s}});var r=n(196),a=n(569),i=n(3418);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function s(e,t,n,s){if(null==s&&(s=(0,a.D2)(e)),"complex64"===s)throw Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!(0,a.fU)(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){(0,a.Mu)(t);let o=(0,a.NA)(t),l=(0,a.NA)(n);(0,a.hu)(o===l,()=>`Based on the provided shape, [${t}], the tensor should have ${o} values but has ${l}`);for(let u=0;u<n.length;++u){let h=n[u],c=u!==n.length-1||h!==(0,a.NA)(t.slice(u));(0,a.hu)(n[u]===t[u]||!c,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return(0,a.fU)(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==s?(0,i.toTypedArray)(e,s):(0,a.xH)(e,[],!0),r.BV.makeTensor(e,t,s)}},7501:function(e,t,n){"use strict";n.d(t,{G:function(){return l}});var r=n(196),a=n(9121),i=n(3740),s=n(569),o=n(2668);let l=(0,o.op)({tile_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,i._1)(e,"x","tile","string_or_numeric");return s.hu(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`),r.BV.runKernel(a.n9L,{x:n},{reps:t})}})},9065:function(e,t,n){"use strict";n.d(t,{p:function(){return p}});var r=n(196),a=n(4368),i=n(9121),s=n(3740),o=n(569),l=n(1661),u=n(4386),h=n(7370),c=n(2668),d=n(766);let p=(0,c.op)({transpose_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){let c=(0,s._1)(e,"x","transpose");if(null==t&&(t=c.shape.map((e,t)=>t).reverse()),o.hu(c.rank===t.length,()=>`Error in transpose: rank of input ${c.rank} must match length of perm ${t}.`),t.forEach(e=>{o.hu(e>=0&&e<c.rank,()=>`All entries in 'perm' must be between 0 and ${c.rank-1} but got ${t}`)}),c.rank<=1)return c.clone();let p={perm:t};return"complex64"===c.dtype?(0,a.lu)(()=>{let e=(0,d.k)(c),t=(0,u.a)(c);return e=r.BV.runKernel(i.G3Y,{x:e},p),t=r.BV.runKernel(i.G3Y,{x:t},p),n&&(t=(0,h.W)(t)),(0,l.P)(e,t)}):r.BV.runKernel(i.G3Y,{x:c},p)}})},8749:function(e,t,n){"use strict";n.d(t,{p:function(){return l}});var r=n(196),a=n(9121),i=n(3740),s=n(569),o=n(2668);let l=(0,o.op)({unsortedSegmentSum_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){let o=(0,i._1)(e,"x","unsortedSegmentSum"),l=(0,i._1)(t,"segmentIds","unsortedSegmentSum","int32");return(0,s.hu)((0,s.GN)(n),()=>"numSegments must be of dtype int"),r.BV.runKernel(a.Qvg,{x:o,segmentIds:l},{numSegments:n})}})},4136:function(e,t,n){"use strict";n.d(t,{H:function(){return l}});var r=n(196),a=n(9121),i=n(3740),s=n(569),o=n(2668);let l=(0,o.op)({unstack_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=0){let n=(0,i._1)(e,"x","unstack","string_or_numeric");return s.hu(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`),r.BV.runKernel(a.ToN,{value:n},{axis:t})}})},5912:function(e,t,n){"use strict";n.d(t,{a:function(){return u}});var r=n(196),a=n(9121),i=n(3740),s=n(8247),o=n(2200),l=n(2668);let u=(0,l.op)({where_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){let l=(0,i._1)(t,"a","where"),u=(0,i._1)(n,"b","where"),h=(0,i._1)(e,"condition","where","bool"),c=(0,o.assertAndGetBroadcastShape)((0,o.assertAndGetBroadcastShape)(h.shape,l.shape),u.shape),d=(0,s.U)(h,c),p=(0,s.U)(l,c),f=(0,s.U)(u,c);return r.BV.runKernel(a.PhF,{condition:d,t:p,e:f})}})},9640:function(e,t,n){"use strict";n.d(t,{l:function(){return(/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function e(t,n="float32"){if("complex64"===n){let s=e(t,"float32"),o=e(t,"float32");return(0,i.P)(s,o)}let l=(0,a.wT)((0,a.NA)(t),n);return r.BV.makeTensor(l,t,n)})}});var r=n(196),a=n(569),i=n(1661)},6577:function(e,t,n){"use strict";n.d(t,{P:function(){return o}});var r=n(196),a=n(9121),i=n(3740),s=n(2668);let o=(0,s.op)({zerosLike_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,i._1)(e,"x","zerosLike");return r.BV.runKernel(a.RuY,{x:t})}})},2904:function(e,t,n){"use strict";var r=n(9121),a=n(2271),i=n(4841),s=n(1901);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let o={kernelName:r.SYM,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,i.d)(e,(0,s.N)((0,a.p)(n,"float32"),-1))}}};var l=n(1274),u=n(7370),h=n(9494),c=n(3261),d=n(248),p=n(827);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let f={kernelName:r.VGw,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x(){let t=(0,d.h)((0,a.p)(n,"float32")),r=(0,c._)((0,p.l)((0,h.i)(1),t));return(0,u.W)((0,l.h)(e,r))}}}},m={kernelName:r.SpW,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x(){let t=(0,c._)((0,p.l)((0,d.h)((0,a.p)(n,"float32")),1));return(0,l.h)(e,t)}}}};var g=n(2200),y=n(4968),b=n(5475);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let x={kernelName:r.mm_,inputsToSave:["a","b"],gradFunc(e,t){let[n,r]=t,a=g.assertAndGetBroadcastShape(n.shape,r.shape),i=()=>{let t=e,r=g.getReductionAxes(n.shape,a);return r.length>0&&(t=(0,b.S)(t,r)),(0,y.X)(t,n.shape)},s=()=>{let t=e,n=g.getReductionAxes(r.shape,a);return n.length>0&&(t=(0,b.S)(t,n)),(0,y.X)(t,r.shape)};return{a:i,b:s}}},v={kernelName:r.Xze,saveAllInputs:!0,gradFunc(e,t){let n={};return t.forEach((t,r)=>{n[r]=()=>e.clone()}),n}};var w=n(6577);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let I={kernelName:r.sJF,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,w.P)(n)}}},k={kernelName:r.aJk,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,w.P)(n)}}},S={kernelName:r.M2y,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,l.h)(e,(0,c._)((0,p.l)((0,h.i)(1),(0,d.h)((0,a.p)(n,"float32")))))}}};var C=n(6407);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let E={kernelName:r.qw7,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x(){let t=(0,c._)((0,C.I)((0,h.i)(1),(0,d.h)((0,a.p)(n,"float32"))));return(0,l.h)(e,t)}}}},T={kernelName:r.QCc,inputsToSave:["a","b"],gradFunc(e,t){let[n,r]=t,a=(0,g.assertAndGetBroadcastShape)(n.shape,r.shape),s=()=>{let t=(0,C.I)((0,d.h)(n),(0,d.h)(r)),s=(0,i.d)(e,(0,l.h)(r,t)),o=(0,g.getReductionAxes)(n.shape,a);return o.length>0&&(s=(0,b.S)(s,o)),(0,y.X)(s,n.shape)},o=()=>{let t=(0,C.I)((0,d.h)(n),(0,d.h)(r)),s=(0,u.W)((0,i.d)(e,(0,l.h)(n,t))),o=(0,g.getReductionAxes)(r.shape,a);return o.length>0&&(s=(0,b.S)(s,o)),(0,y.X)(s,r.shape)};return{a:s,b:o}}},$={kernelName:r.jMg,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,l.h)(e,(0,C.I)((0,d.h)((0,a.p)(n,"float32")),1))}}},N={kernelName:r.Oyi,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,l.h)(e,(0,p.l)((0,h.i)(1),(0,d.h)((0,a.p)(n,"float32"))))}}};var A=n(196),D=n(3740),F=n(569),R=n(2582),_=n(2668);let O=(0,_.op)({avgPool3dGrad_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,a,i,s){let o=(0,D._1)(e,"dy","avgPool3dGrad"),l=(0,D._1)(t,"input","avgPool3dGrad"),u=o,h=l,c=!1;4===l.rank&&(c=!0,u=(0,y.X)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),h=(0,y.X)(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),F.hu(5===u.rank,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),F.hu(5===h.rank,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${h.rank}.`),(0,R.m)("avgPool3dGrad",i,s);let d={dy:u,input:h},p=A.BV.runKernel(r.IMb,d,{filterSize:n,strides:a,pad:i,dimRoundingMode:s});return c?(0,y.X)(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),M={kernelName:r._k9,inputsToSave:["x"],gradFunc(e,t,n){let[r]=t,{filterSize:a,strides:i,pad:s,dimRoundingMode:o}=n;return{x:()=>O(e,r,a,i,s,o)}}},B=(0,_.op)({avgPoolGrad_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,a,i){let s=(0,D._1)(e,"dy","avgPoolGrad"),o=(0,D._1)(t,"input","avgPoolGrad");F.hu(o.rank===s.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${s.rank})`);let l=o,u=s,h=!1;3===o.rank&&(h=!0,l=(0,y.X)(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=(0,y.X)(s,[1,s.shape[0],s.shape[1],s.shape[2]])),F.hu(4===u.rank,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${u.rank}.`),F.hu(4===l.rank,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${l.rank}.`);let c={dy:u,input:l},d=A.BV.runKernel(r.ROF,c,{filterSize:n,strides:a,pad:i});return h?(0,y.X)(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),P={kernelName:r.JhU,inputsToSave:["x"],gradFunc(e,t,n){let[r]=t,{filterSize:a,strides:i,pad:s}=n;return{x:()=>B(e,r,a,i,s)}}};var L=n(8687);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let U={kernelName:r.XLW,inputsToSave:["a","b"],gradFunc(e,t,n){let[r,a]=t,{transposeA:i,transposeB:s}=n;return i||s?!i&&s?{a:()=>(0,L.O)(e,a,!1,!1),b:()=>(0,L.O)(e,r,!0,!1)}:i&&!s?{a:()=>(0,L.O)(a,e,!1,!0),b:()=>(0,L.O)(r,e,!1,!1)}:{a:()=>(0,L.O)(a,e,!0,!0),b:()=>(0,L.O)(e,r,!0,!0)}:{a:()=>(0,L.O)(e,a,!1,!0),b:()=>(0,L.O)(r,e,!0,!1)}}};var W=n(7918);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let z={kernelName:r.zws,gradFunc(e,t,n){let{blockShape:r,crops:a}=n;return{x:()=>(0,W.f)(e,r,a)}}},V={kernelName:r.Ly9,gradFunc(e,t,n){let r=n.inputShape,a=n.shape,i=Array.from(a);for(let s=r.length-1;s>=0;s--)if(r[s]===a[s])i[s]=1;else if(1!==r[s])throw Error(`broadcastTo(): [${r}] cannot be broadcast to [${a}].`);let o=[];for(let l=0;l<i.length;l++)i[l]>1&&o.push(l);return{x:()=>(0,b.S)(e,o,!0)}}},G={kernelName:r.RFZ,gradFunc:e=>({x:()=>e.clone()})},j={kernelName:r.gJX,gradFunc:e=>({x:()=>(0,w.P)(e)})};var H=n(7630),K=n(624),X=n(2856),q=n(5912);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let Y={kernelName:r.xnO,inputsToSave:["x"],gradFunc(e,t,n){let[r]=t,{clipValueMin:a,clipValueMax:i}=n;return{x:()=>(0,q.a)((0,X.H)((0,H.b)(r,a),(0,K.z)(r,i)),e,(0,w.P)(e))}}},Q={kernelName:r.yj2,inputsToSave:["x"],gradFunc:o.gradFunc};var Z=n(8644);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let J={kernelName:r.Eh3,saveAllInputs:!0,gradFunc(e,t,n){let r=t.map(e=>e.shape),{axis:a}=n,i=(0,F.EC)(a,t[0].shape)[0],s=r.map(e=>e[i]),o=(0,Z.V)(e,s,i);return o.map(e=>()=>e)}};var ee=n(6013),et=n(9832);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let en={kernelName:r.mhS,inputsToSave:["x","filter"],gradFunc(e,t,n){let[r,a]=t,{dilations:i,strides:s,pad:o,dataFormat:l}=n;return F.hu(R.I0(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>(0,et._)(r.shape,e,a,s,o,l),filter:()=>(0,ee.p)(r,e,a.shape,s,o,l)}}};var er=n(4794);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let ea={kernelName:r.wm,inputsToSave:["dy","filter"],gradFunc(e,t,n){let[r,a]=t,{strides:i,pad:s,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>(0,er.T)(e,a,i,s,o,1,l),filter:()=>(0,ee.p)(e,r,a.shape,i,s,o,l)}}},ei=(0,_.op)({conv3DBackpropFilter_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,a,i){let s=e;4===e.rank&&(s=(0,y.X)(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let o=t;4===o.rank&&(o=(0,y.X)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),F.hu(5===s.rank,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${s.shape}.`),F.hu(5===o.rank,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),F.hu(5===n.length,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),F.hu(s.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${s.shape[4]}) must match input depth in filter (${n[3]}.`),F.hu(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);let l={x:s,dy:o};return A.BV.runKernel(r.o2y,l,{strides:a,pad:i,filterShape:n})}});var es=n(7594);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let eo={kernelName:r.x12,inputsToSave:["x","filter"],gradFunc(e,t,n){let{dilations:r,strides:a,pad:i}=n;F.hu((0,R.I0)(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);let[s,o]=t;return{x:()=>(0,es._)(s.shape,e,o,a,i),filter:()=>ei(s,e,o.shape,a,i)}}};var el=n(9331);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let eu={kernelName:r.mc4,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,i.d)((0,u.W)((0,el.O)((0,a.p)(n,"float32"))),e)}}};var eh=n(3254);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let ec={kernelName:r.TR1,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,i.d)((0,eh.R)((0,a.p)(n,"float32")),e)}}};var ed=n(3591),ep=n(7405),ef=n(9065);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let em={kernelName:r.iHb,inputsToSave:["x"],gradFunc(e,t,n){let[r]=t,{axis:a,exclusive:i,reverse:s}=n;return{x(){let t=(0,ed.Q3)([a],r.rank),n=(0,ep.z)(e,a,i,!s);return null!=t&&(n=(0,ef.p)(n,t)),n}}}};var eg=n(8098),ey=n(4375);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let eb={kernelName:r.cie,inputsToSave:["x","filter"],gradFunc(e,t,n){let{dilations:r,strides:a,pad:i,dimRoundingMode:s}=n,o=null==r?[1,1]:r;F.hu(R.I0(o),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);let[l,u]=t;return F.hu(4===l.rank,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),F.hu(4===u.rank,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),F.hu(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),F.hu(R.jT(a,o),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${a} and dilations '${o}'.`),R.m("depthwiseConv2d",i,s),{x:()=>(0,ey.v)(l.shape,e,u,a,i,o,s),filter:()=>(0,eg.z)(l,e,u.shape,a,i,o,s)}}},ex={kernelName:r.p4S,inputsToSave:["x","filter"],gradFunc(e,t,n){let[a,i]=t,s={x:a,filter:i,dy:e},o={x:a,filter:i,dy:e};return{x:()=>A.BV.runKernel(r.ekb,s,n),filter:()=>A.BV.runKernel(r.Vn9,o,n)}}},ev={kernelName:r.SX0,outputsToSave:[!0],gradFunc(e,t){let[n]=t,a={dy:e,y:n};return{x:()=>A.BV.runKernel(r.HEU,a)}}};var ew=n(4842);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let eI={kernelName:r.Omj,inputsToSave:["x"],gradFunc(e,t){let[n]=t,r=(0,i.d)((0,ew.Q)((0,u.W)((0,d.h)(n))),2/Math.sqrt(Math.PI));return{x:()=>(0,i.d)(e,r)}}},ek={kernelName:r.NEP,outputsToSave:[!0],gradFunc(e,t){let[n]=t;return{x:()=>(0,i.d)(e,n)}}},eS={kernelName:r.YFo,inputsToSave:["input"],gradFunc(e,t){let[n]=t;return{input:()=>(0,y.X)(e,n.shape)}}},eC={kernelName:r.Y0y,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,i.d)(e,(0,ew.Q)(n))}}},eE={kernelName:r.OR,gradFunc:e=>({x:()=>(0,w.P)(e)})},eT={kernelName:r.jeX,inputsToSave:["a","b"],gradFunc(e,t){let[n,r]=t,s=(0,g.assertAndGetBroadcastShape)(n.shape,r.shape),o=()=>{let t=(0,l.h)(e,(0,a.p)(r,"float32")),i=(0,g.getReductionAxes)(n.shape,s);return i.length>0?(0,y.X)((0,b.S)(t,i),n.shape):t},h=()=>{let t=(0,i.d)(e,(0,a.p)(n,"float32")),o=(0,g.getReductionAxes)(r.shape,s);o.length>0&&(t=(0,y.X)((0,b.S)(t,o),r.shape));let h=(0,d.h)(r);return(0,u.W)((0,l.h)(t,(0,a.p)(h,"float32")))};return{a:o,b:h}}};var e$=n(2634),eN=n(7501);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let eA={kernelName:r.sHE,inputsToSave:["x","mean","variance","scale"],gradFunc(e,t,n){let{varianceEpsilon:r}=n,[a,s,o,l]=t,u=null==l?(0,h.i)(1):l,c=(0,g.getReductionAxes)(s.shape,a.shape),d=[];if(1===s.rank){for(let f=0;f<a.shape.length-1;++f)d.push(a.shape[f]);d.push(1)}let m=(0,p.l)(a,s),x=(0,i.d)(e,u),v=(0,e$.b)((0,C.I)(o,(0,h.i)(r))),w=(0,i.d)((0,i.d)((0,i.d)(v,v),v),(0,h.i)(-.5)),I=()=>1===s.rank?(0,y.X)((0,i.d)((0,i.d)(e,(0,eN.G)((0,y.X)(v,[1,1,1,s.shape[0]]),d)),u),a.shape):(0,y.X)((0,i.d)((0,i.d)(e,v),u),a.shape),k=()=>{let e=(0,i.d)((0,i.d)(v,(0,h.i)(-1)),x);return 1===s.rank&&(e=(0,b.S)(e,c)),(0,y.X)(e,s.shape)},S=()=>{let e=(0,i.d)((0,i.d)(w,m),x);return 1===s.rank&&(e=(0,b.S)(e,c)),(0,y.X)(e,s.shape)},E=()=>{let t=(0,i.d)(m,v),n=(0,i.d)(e,t);return 1===s.rank&&(n=(0,b.S)(n,c)),(0,y.X)(n,s.shape)},T=()=>{let t=e;return 1===s.rank&&(t=(0,b.S)(t,c)),(0,y.X)(t,s.shape)};return{x:I,mean:k,variance:S,scale:E,offset:T}}};var eD=n(8749);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let eF={kernelName:r.qi_,inputsToSave:["x","indices"],gradFunc(e,t,n){let[r,a]=t,{axis:i}=n,s=(0,F.EC)(i,r.shape)[0],o=()=>{let t=r.shape,n=a.size,o=t.slice(0,s),l=o.length,u=t.slice(i,t.length).slice(1),h=u.length,c=eR(0,l),d=eR(l+1,l+1+h),p=e_([o,[n],u]),f=(0,y.X)(e,p),m=(0,y.X)(a,[n]),g=e_([[l],c,d]),b=(0,ef.p)(f,g),x=(0,eD.p)(b,m,r.shape[s]),v=(0,ed.LJ)(g);return(0,ef.p)(x,v)};return{x:o,indices:()=>a}}};function eR(e,t){let n=[];for(let r=e;r<t;++r)n.push(r);return n}function e_(e){let t=[];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)t.push(e[n][r]);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let eO={kernelName:r.Acj,inputsToSave:["a","b"],gradFunc(e,t){let[n,r]=t;return{a:()=>(0,w.P)(n),b:()=>(0,w.P)(r)}}},eM={kernelName:r.iJz,gradFunc:e=>({x:()=>(0,a.p)(e,"float32")})},eB={kernelName:r.avt,gradFunc:e=>({x:()=>(0,w.P)(e)})},eP={kernelName:r.iWB,gradFunc:e=>({x:()=>(0,w.P)(e)})},eL={kernelName:r.r7n,gradFunc:e=>({x:()=>(0,w.P)(e)})};var eU=n(636);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let eW={kernelName:r.J$2,inputsToSave:["x"],gradFunc(e,t,n){let[r]=t,{alpha:a}=n,s=(0,eU.p)(r,0);return{x:()=>(0,q.a)(s,e,(0,i.d)(e,a))}}},ez={kernelName:r.kU,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,l.h)(e,(0,C.I)(n,1))}}},eV={kernelName:r.ZbH,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,l.h)(e,(0,a.p)(n,"float32"))}}},eG={kernelName:r.qCd,inputsToSave:[],outputsToSave:[!0],gradFunc(e,t,n){let[r]=t,{axis:a}=n;return{logits(){let t=(0,ew.Q)(r);return(0,p.l)(e,(0,i.d)((0,b.S)(e,a,!0),t))}}}},ej=(0,_.op)({localResponseNormalizationBackprop_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,a=5,i=1,s=1,o=.5){return A.BV.runKernel(r.Hhh,{x:e,y:t,dy:n},{depthRadius:a,bias:i,alpha:s,beta:o})}}),eH={kernelName:r.eZ0,inputsToSave:["x"],outputsToSave:[!0],gradFunc(e,t,n){let[r,a]=t,{depthRadius:i,bias:s,alpha:o,beta:l}=n;return{x:()=>ej(r,a,e,i,s,o,l)}}};var eK=n(6477);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function eX(e,t,n,r){return t.rank<n.rank&&(t=(0,y.X)(t,ed.rv(t.shape,r))),e.rank<n.rank&&(e=(0,y.X)(e,ed.rv(e.shape,r))),{x(){let r=(0,i.d)(e,(0,a.p)((0,eK.D)(n,t),e.dtype));return r}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let eq={kernelName:r.YoZ,inputsToSave:["x"],outputsToSave:[!0],gradFunc(e,t,n){let{reductionIndices:r}=n,a=t[0],i=t[1],s=F.EC(r,a.shape),o=eX(e,i,a,s);return{x:()=>o.x()}}};var eY=n(6573);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let eQ={kernelName:r.BMI,inputsToSave:["a","b"],gradFunc(e,t){let[n,r]=t,s=()=>(0,i.d)(e,(0,a.p)((0,H.b)(n,r),"float32")),o=()=>(0,i.d)(e,(0,a.p)((0,eY.d)(n,r),"float32"));return{a:s,b:o}}},eZ=(0,_.op)({maxPool3dGrad_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,a,i,s,o){let l=(0,D._1)(e,"dy","maxPool3dGrad"),u=(0,D._1)(t,"input","maxPool3dGrad"),h=(0,D._1)(n,"output","maxPool3dGrad"),c=l,d=u,p=h,f=!1;4===u.rank&&(f=!0,c=(0,y.X)(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),d=(0,y.X)(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),p=(0,y.X)(h,[1,h.shape[0],h.shape[1],h.shape[2],h.shape[3]])),F.hu(5===c.rank,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),F.hu(5===d.rank,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),F.hu(5===p.rank,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${p.rank}.`),(0,R.m)("maxPool3dGrad",s,o);let m={dy:c,input:d,output:p},g=A.BV.runKernel(r.OU7,m,{filterSize:a,strides:i,pad:s,dimRoundingMode:o});return f?(0,y.X)(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}}),eJ={kernelName:r.OAf,inputsToSave:["x"],outputsToSave:[!0],gradFunc(e,t,n){let[r,a]=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=n;return{x:()=>eZ(e,r,a,i,s,o,l)}}},e0=(0,_.op)({maxPoolGrad_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,a,i,s,o){let l=(0,D._1)(e,"dy","maxPoolGrad"),u=(0,D._1)(t,"input","maxPoolGrad"),h=(0,D._1)(n,"output","maxPoolGrad");return F.hu(u.rank===l.rank,()=>`Rank of input (${u.rank}) does not match rank of dy (${l.rank})`),F.hu(4===l.rank,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),F.hu(4===u.rank,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${u.rank}.`),R.m("maxPoolGrad",s,o),A.BV.runKernel(r.OV7,{dy:l,input:u,output:h},{filterSize:a,strides:i,pad:s,dimRoundingMode:o})}}),e1={kernelName:r.mTV,inputsToSave:["x"],outputsToSave:[!0],gradFunc(e,t,n){let[r,a]=t,{filterSize:i,strides:s,pad:o}=n;return{x:()=>e0(e,r,a,i,s,o)}}};var e2=n(4917);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let e3={kernelName:r.q2K,inputsToSave:["x"],gradFunc(e,t,n){let[r]=t,{axis:a}=n,s=F.EC(a,r.shape),o=(0,ed.kz)(r.shape,s),u=o[1],h=F.NA(u),c=()=>{let t=r.shape.slice();s.forEach(e=>{t[e]=1});let n=(0,y.X)(e,t),a=(0,l.h)((0,i.d)(n,(0,e2.i)(r.shape,"float32")),h);return a};return{x:c}}},e4={kernelName:r.c17,inputsToSave:["x"],outputsToSave:[!0],gradFunc(e,t,n){let{axis:r}=n,[a,i]=t,s=F.EC(r,a.shape),o=eX(e,i,a,s);return{x:()=>o.x()}}},e6={kernelName:r.q8u,inputsToSave:["a","b"],gradFunc(e,t){let[n,r]=t,s=()=>(0,i.d)(e,(0,a.p)((0,K.z)(n,r),"float32")),o=()=>(0,i.d)(e,(0,a.p)((0,eU.p)(n,r),"float32"));return{a:s,b:o}}};var e5=n(2676);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let e7={kernelName:r.jQs,inputsToSave:["x"],gradFunc(e,t,n){let r=t[0],{paddings:a}=n,i=a.map(e=>e[0]);return{x:()=>(0,e5.t)(e,i,r.shape)}}};var e8=n(6943);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let e9={kernelName:r.Vbg,inputsToSave:["a","b"],gradFunc(e,t){let[n,r]=t,a=(0,g.assertAndGetBroadcastShape)(n.shape,r.shape),s=()=>{let t=(0,g.getReductionAxes)(n.shape,a);return t.length>0?(0,y.X)((0,b.S)(e,t),n.shape):e},o=()=>{let t=(0,i.d)(e,(0,u.W)((0,e8.G)((0,l.h)(n,r)))),s=(0,g.getReductionAxes)(r.shape,a);return s.length>0?(0,y.X)((0,b.S)(t,s),r.shape):t};return{a:s,b:o}}},te={kernelName:r.wYn,inputsToSave:["a","b"],gradFunc(e,t){let[n,r]=t,s=(0,g.assertAndGetBroadcastShape)(n.shape,r.shape),o=()=>{let t=(0,i.d)(e,(0,a.p)(r,"float32")),o=(0,g.getReductionAxes)(n.shape,s);return o.length>0?(0,y.X)((0,b.S)(t,o),n.shape):t},l=()=>{let t=(0,i.d)(e,(0,a.p)(n,"float32")),o=(0,g.getReductionAxes)(r.shape,s);return o.length>0?(0,y.X)((0,b.S)(t,o),r.shape):t};return{a:o,b:l}}},tt={kernelName:r.kuV,gradFunc:e=>({x:()=>(0,u.W)(e)})};var tn=n(9640);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let tr={kernelName:r.we_,inputsToSave:["indices"],gradFunc(e,t){let n=t[0];return{indices:()=>(0,tn.l)(n.shape,"float32")}}},ta={kernelName:r.qWM,gradFunc:e=>({x:()=>(0,w.P)(e)})};var ti=n(4136);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let ts={kernelName:r.QiL,saveAllInputs:!0,gradFunc(e,t,n){let{axis:r}=n,a=(0,ti.H)(e,r);return a.map(e=>()=>e)}},to={kernelName:r.lyA,inputsToSave:["x"],gradFunc(e,t,n){let r=t[0],{paddings:a}=n,i=a.map(e=>e[0]);return{x:()=>(0,e5.t)(e,i,r.shape)}}};var tl=n(2597),tu=n(3453);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let th={kernelName:r.pe_,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc(e,t){let[n,r,s]=t,o=g.assertAndGetBroadcastShape(n.shape,r.shape),l=()=>{let t=(0,a.p)(r,"float32"),s=(0,i.d)(e,(0,i.d)(t,(0,tu.s)(n,(0,p.l)(t,(0,h.i)(1))))),l=g.getReductionAxes(n.shape,o);return l.length>0&&(s=(0,b.S)(s,l)),(0,y.X)(s,n.shape)},u=()=>{let t=(0,eU.p)(n,0),a=(0,q.a)(t,(0,tl.c)(n),(0,w.P)(n)),l=(0,i.d)(e,(0,i.d)(s,a)),u=g.getReductionAxes(r.shape,o);return u.length>0&&(l=(0,b.S)(l,u)),(0,y.X)(l,r.shape)};return{a:l,b:u}}},tc={kernelName:r.o0g,inputsToSave:["x","alpha"],gradFunc(e,t){let[n,r]=t,a=(0,eU.p)(n,0);return{x:()=>(0,q.a)(a,e,(0,i.d)(e,r)),alpha(){let t=(0,q.a)(a,(0,w.P)(e),(0,i.d)(e,n)),s=(0,g.getReductionAxes)(r.shape,e.shape);return s.length>0&&(t=(0,b.S)(t,s)),(0,y.X)(t,r.shape)}}}};var td=n(5510);let tp={kernelName:r.DlI,inputsToSave:["x"],gradFunc(e,t,n){let[r]=t,{axis:a}=n,s=[];return s=null==a?r.shape.map((e,t)=>t):"number"==typeof a?[a]:a,{x:()=>(function(e,t,n){let r=e.shape.length,a=r-n.length,s=ed.Q3(n,r),o=e;null!=s&&(o=(0,ef.p)(e,s));let l=o.shape.slice(),u=l.splice(r-n.length,n.length),h=u.reduce((e,t)=>e*t,1);l.push(h);let c=o.reshape(l),d=/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){let r=e.shape.slice();r[n]=1;let a=(0,y.X)(t,r),s=(0,td.$)(e,n,!0,!1),o=(0,td.$)(e,n,!0,!0),l=(0,i.d)(s,o);return(0,i.d)(a,l)}(c,t,a);if(d=d.reshape(o.shape),null!=s){let p=ed.LJ(s);d=(0,ef.p)(d,p)}return d})(r,e,s)}}},tf={kernelName:r.oHH,inputsToSave:["a","b"],gradFunc(e,t){let[n,r]=t,s=g.assertAndGetBroadcastShape(n.shape,r.shape),o=()=>{let t=(0,l.h)(e,(0,a.p)(r,"float32")),i=g.getReductionAxes(n.shape,s);return i.length>0?(0,y.X)((0,b.S)(t,i),n.shape):t},h=()=>{let t=(0,i.d)(e,(0,a.p)(n,"float32")),o=g.getReductionAxes(r.shape,s);o.length>0&&(t=(0,y.X)((0,b.S)(t,o),r.shape));let h=(0,d.h)(r);return(0,u.W)((0,l.h)(t,(0,a.p)(h,"float32")))};return{a:o,b:h}}},tm={kernelName:r.$HU,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,l.h)(e,(0,u.W)((0,d.h)(n)))}}},tg={kernelName:r.SbG,inputsToSave:["x"],gradFunc(e,t){let[n]=t,r=(0,i.d)((0,K.z)(n,6),(0,s.N)(n));return{x:()=>(0,i.d)(e,(0,a.p)(r,"float32"))}}},ty={kernelName:r.qkr,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,i.d)(e,(0,a.p)((0,s.N)(n),"float32"))}}},tb={kernelName:r.HZH,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,y.X)(e,n.shape)}}},tx={kernelName:r._Yw,inputsToSave:["images"],gradFunc(e,t,n){let[a]=t,i={dy:e,images:a},s=()=>A.BV.runKernel(r.zbQ,i,n);return{images:s}}},tv={kernelName:r.dpD,inputsToSave:["images"],gradFunc(e,t,n){let[a]=t,i={dy:e,images:a},s=()=>A.BV.runKernel(r.Hmb,i,n);return{images:s}}};var tw=n(7486);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let tI={kernelName:r.mKl,gradFunc(e,t,n){let{dims:r}=n,a=(0,F.EC)(r,e.shape);return{x:()=>(0,tw.G)(e,a)}}},tk={kernelName:r.e07,gradFunc:e=>({x:()=>(0,w.P)(e)})},tS={kernelName:r.bV0,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,u.W)((0,l.h)(e,(0,i.d)((0,tu.s)(n,1.5),2)))}}};var tC=n(8651);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let tE={kernelName:r.PhF,inputsToSave:["condition"],gradFunc(e,t){let[n]=t;return{condition:()=>(0,a.p)((0,w.P)(n),"float32"),t:()=>(0,i.d)(e,(0,a.p)(n,e.dtype)),e:()=>(0,i.d)(e,(0,a.p)((0,tC.h)(n),e.dtype))}}};var tT=n(3179);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let t$={kernelName:r.oFR,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x(){let t=(0,eU.p)(n,(0,h.i)(0)),r=(0,h.i)(tT.y),s=(0,h.i)(tT.$),o=(0,i.d)(e,s),l=(0,i.d)((0,i.d)(e,r),(0,ew.Q)((0,a.p)(n,"float32")));return(0,q.a)(t,o,l)}}}},tN={kernelName:r.a5O,outputsToSave:[!0],gradFunc(e,t){let[n]=t;return{x:()=>(0,i.d)(e,(0,i.d)(n,(0,p.l)((0,h.i)(1),n)))}}},tA={kernelName:r.i5y,gradFunc:e=>({x:()=>(0,w.P)(e)})};var tD=n(173);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let tF={kernelName:r.RQH,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,i.d)((0,tD.m)((0,a.p)(n,"float32")),e)}}};var tR=n(2699);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let t_={kernelName:r.wYB,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,i.d)((0,tR.f)((0,a.p)(n,"float32")),e)}}};var tO=n(9682),tM=n(7650);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let tB={kernelName:r.p2w,inputsToSave:["x"],gradFunc(e,t,n){let[r]=t,{begin:a,size:i}=n,s=r.shape,[o,l]=(0,tM.parseSliceParams)(r,a,i),u=[];for(let h=0;h<e.rank;h++)u.push([o[h],s[h]-o[h]-l[h]]);return{x:()=>(0,tO.v)(e,u)}}},tP={kernelName:r.Gcp,outputsToSave:[!0],gradFunc(e,t,n){let[r]=t,{dim:a}=n,s=(0,i.d)(e,r);return{logits:()=>(0,p.l)(s,(0,i.d)((0,b.S)(s,[a],!0),r))}}};var tL=n(625);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let tU={kernelName:r.MRv,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,i.d)(e,(0,tL.X)(n))}}};var tW=n(8441);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let tz={kernelName:r.TQc,gradFunc(e,t,n){let{blockShape:r,paddings:a}=n;return{x:()=>(0,tW.E)(e,r,a)}}};var tV=n(6884);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let tG={kernelName:r.L8s,gradFunc(e,t,n){let{axis:r}=n;return{x:()=>(0,tV.z)(e,r)}}},tj={kernelName:r.FKq,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,l.h)(e,(0,i.d)((0,c._)((0,a.p)(n,"float32")),2))}}},tH={kernelName:r.bK0,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,i.d)(e,(0,i.d)((0,a.p)(n,"float32"),2))}}},tK={kernelName:r._tC,inputsToSave:["a","b"],gradFunc(e,t){let[n,r]=t,a=(0,h.i)(2),s=()=>(0,i.d)(e,(0,i.d)(a,(0,p.l)(n,r))),o=()=>(0,i.d)(e,(0,i.d)(a,(0,p.l)(r,n)));return{a:s,b:o}}},tX={kernelName:r.h8e,gradFunc:e=>({x:()=>(0,w.P)(e)})},tq={kernelName:r.Tr8,inputsToSave:["a","b"],gradFunc(e,t){let[n,r]=t,a=g.assertAndGetBroadcastShape(n.shape,r.shape),i=()=>{let t=e,r=g.getReductionAxes(n.shape,a);return r.length>0&&(t=(0,b.S)(t,r)),(0,y.X)(t,n.shape)},s=()=>{let t=e,n=g.getReductionAxes(r.shape,a);return n.length>0&&(t=(0,b.S)(t,n)),(0,y.X)((0,u.W)(t),r.shape)};return{a:i,b:s}}},tY={kernelName:r.GBy,inputsToSave:["x"],gradFunc(e,t,n){let[r]=t,a=r.shape.slice(),{axis:s}=n,o=(0,F.EC)(s,r.shape);o.forEach(e=>{a[e]=1});let l=(0,y.X)(e,a),u=(0,i.d)(l,(0,e2.i)(r.shape,"float32"));return{x:()=>u}}},tQ={kernelName:r.sEM,inputsToSave:["x"],gradFunc(e,t){let[n]=t;return{x:()=>(0,l.h)(e,(0,d.h)((0,tD.m)(n)))}}},tZ={kernelName:r.MIZ,outputsToSave:[!0],gradFunc(e,t){let[n]=t;return{x:()=>(0,i.d)((0,p.l)((0,h.i)(1),(0,d.h)(n)),e)}}},tJ={kernelName:r.n9L,inputsToSave:["x"],gradFunc(e,t,n){let[r]=t,{reps:a}=n,i=()=>{let t=(0,w.P)(r);if(1===r.rank)for(let n=0;n<a[0];++n)t=(0,C.I)(t,(0,e5.t)(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let i=0;i<a[0];++i)for(let s=0;s<a[1];++s)t=(0,C.I)(t,(0,e5.t)(e,[i*r.shape[0],s*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let o=0;o<a[0];++o)for(let l=0;l<a[1];++l)for(let u=0;u<a[2];++u)t=(0,C.I)(t,(0,e5.t)(e,[o*r.shape[0],l*r.shape[1],u*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(4===r.rank)for(let h=0;h<a[0];++h)for(let c=0;c<a[1];++c)for(let d=0;d<a[2];++d)for(let p=0;p<a[3];++p)t=(0,C.I)(t,(0,e5.t)(e,[h*r.shape[0],c*r.shape[1],d*r.shape[2],p*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return t};return{x:i}}},t0={kernelName:r.G3Y,gradFunc(e,t,n){let{perm:r}=n,a=ed.LJ(r);return{x:()=>(0,ef.p)(e,a)}}};var t1=n(2991);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let t2={kernelName:r.ToN,gradFunc(e,t,n){let{axis:r}=n;return{value:()=>(0,t1.k)(e,r)}}};var t3=n(1300),t4=n(4926),t6=n(632);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let t5={kernelName:r.Qvg,inputsToSave:["segmentIds"],gradFunc(e,t){let[n]=t,r=()=>(function(e,t){let n=(0,t6.g)(t,(0,w.P)(t)),r=(0,t4.I)(e,n),a=(0,H.b)(t,(0,h.i)(0,"int32")),i=r.rank-a.rank;for(let s=0;s<i;++s)a=(0,t3.d)(a,s+1);a=(0,X.H)(a,(0,e2.i)(r.shape,"bool"));let o=(0,w.P)(r);return(0,q.a)(a,r,o)})(e,n);return{x:r}}},t7={kernelName:r.RuY,gradFunc:e=>({x:()=>(0,w.P)(e)})};var t8=n(6151);for(let t9 of[o,f,m,x,v,I,k,S,E,T,$,N,M,P,U,z,V,G,j,Y,Q,J,ea,en,eo,eu,ec,em,eb,ex,tf,ev,eI,ek,eS,eC,eT,eE,eA,eF,eO,eM,eB,eP,eL,eW,ez,eV,eG,eH,eq,eq,eQ,eJ,e1,e3,e4,e6,e7,e9,te,tt,tr,ta,ts,to,to,th,tc,tp,tm,tg,ty,tb,tx,tv,tI,tk,tS,tE,t$,tN,tA,tF,t_,tB,tP,tU,tz,tz,tG,tG,tj,tK,tH,tX,tq,tY,tQ,tZ,tJ,t0,t2,t5,t7])(0,t8.Li)(t9)},974:function(e,t,n){"use strict";n.d(t,{es:function(){return m},YD:function(){return u},_w:function(){return y},t3:function(){return g},FZ:function(){return f},Vp:function(){return p},Vi:function(){return d}});var r=n(5938),a=n(569);function i(e,t,n){let r;return r=Array.isArray(e)?`${parseFloat(e[0].toFixed(7))} + ${parseFloat(e[1].toFixed(7))}j`:(0,a.HD)(e)?`'${e}'`:"bool"===n?s(e):parseFloat(e.toFixed(7)).toString(),(0,a.oj)(r,t)}function s(e){return 0===e?"false":"true"}function o(e){let t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var l=n(3418);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class u{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=a.NA(e),null!=n){let r=n.length;a.hu(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if("complex64"===t)throw Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||a.rQ(t,this.size),this.strides=(0,a.e3)(e)}set(e,...t){0===t.length&&(t=[0]),a.hu(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);let n=this.locToIndex(t);this.values[n]=e}get(...e){0===e.length&&(e=[0]);let t=0;for(let n of e){if(n<0||n>=this.shape[t]){let r=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw Error(r)}t++}let a=e[e.length-1];for(let i=0;i<e.length-1;++i)a+=this.strides[i]*e[i];return this.values[a]}locToIndex(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(0===this.rank)return[];if(1===this.rank)return[e];let t=Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return h().makeTensor(this.values,this.shape,this.dtype)}}let h=null,c=null;function d(e){h=e}function p(e){c=e}function f(e){}class m{constructor(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=a.NA(e),this.strides=(0,a.e3)(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){let e=await this.data();return c.buffer(this.shape,this.dtype,e)}bufferSync(){return c.buffer(this.shape,this.dtype,this.dataSync())}async array(){let e=await this.data();return(0,a.GX)(this.shape,e,"complex64"===this.dtype)}arraySync(){return(0,a.GX)(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();let e=h().read(this.dataId);if("string"===this.dtype){let t=await e;try{return t.map(e=>l.decodeString(e))}catch(n){throw Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),h().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();let e=h().readSync(this.dataId);if("string"===this.dtype)try{return e.map(e=>l.decodeString(e))}catch(t){throw Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();let e=await h().read(this.dataId);return"string"===this.dtype?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(h().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw Error("Tensor is disposed.")}print(e=!1){return c.print(this,e)}clone(){return this.throwIfDisposed(),c.clone(this)}toString(e=!1){let t=this.dataSync();return function(e,t,n,r){let l=(0,a.e3)(t),u=function(e,t,n,r){let s=(0,a.NA)(t),l=r[r.length-1],u=Array(l).fill(0),h=t.length,c="complex64"===n?o(e):e;if(h>1)for(let d=0;d<s/l;d++){let p=d*l;for(let f=0;f<l;f++)u[f]=Math.max(u[f],i(c[p+f],0,n).length)}return u}(e,t,n,l),h=t.length,c=function e(t,n,r,a,l,u=!0){let h="complex64"===r?2:1,c=n[0],d=n.length;if(0===d){if("complex64"===r){let p=o(t);return[i(p[0],0,r)]}return"bool"===r?[s(t[0])]:[t[0].toString()]}if(1===d){if(c>20){let f=Array.from(t.slice(0,3*h)),m=Array.from(t.slice((c-3)*h,c*h));return"complex64"===r&&(f=o(f),m=o(m)),["["+f.map((e,t)=>i(e,l[t],r)).join(", ")+", ..., "+m.map((e,t)=>i(e,l[c-3+t],r)).join(", ")+"]"]}let g="complex64"===r?o(t):Array.from(t);return["["+g.map((e,t)=>i(e,l[t],r)).join(", ")+"]"]}let y=n.slice(1),b=a.slice(1),x=a[0]*h,v=[];if(c>20){for(let w=0;w<3;w++){let I=w*x,k=I+x;v.push(...e(t.slice(I,k),y,r,b,l,!1))}v.push("...");for(let S=c-3;S<c;S++){let C=S*x,E=C+x;v.push(...e(t.slice(C,E),y,r,b,l,S===c-1))}}else for(let T=0;T<c;T++){let $=T*x,N=$+x;v.push(...e(t.slice($,N),y,r,b,l,T===c-1))}let A=2===d?",":"";v[0]="["+v[0]+A;for(let D=1;D<v.length-1;D++)v[D]=" "+v[D]+A;let F=",\n";for(let R=2;R<d;R++)F+="\n";return v[v.length-1]=" "+v[v.length-1]+"]"+(u?"":F),v}(e,t,n,l,u),d=["Tensor"];return r&&(d.push(`  dtype: ${n}`),d.push(`  rank: ${h}`),d.push(`  shape: [${t}]`),d.push("  values:")),d.push(c.map(e=>"    "+e).join("\n")),d.join("\n")}(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),c.cast(this,e)}variable(e=!0,t,n){return this.throwIfDisposed(),h().makeVariable(this,e,t,n)}}function g(){return(0,r.R)("Tensor",()=>m)}Object.defineProperty(m,Symbol.hasInstance,{value:e=>!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}),g();class y extends m{constructor(e,t,n,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!a.cO(e.shape,this.shape))throw Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);h().disposeTensor(this),this.dataId=e.dataId,h().incRef(this,null)}dispose(){h().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(y,Symbol.hasInstance,{value:e=>e instanceof m&&null!=e.assign&&e.assign instanceof Function})},747:function(e,t,n){"use strict";n.r(t),n.d(t,{assertTypesMatch:function(){return o},getTensorsInContainer:function(){return u},isTensorInList:function(){return l},makeTypesMatch:function(){return s}});var r=n(974),a=n(1221),i=n(569);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function s(e,t){if(e.dtype===t.dtype)return[e,t];let n=(0,a.x8)(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function o(e,t){(0,i.hu)(e.dtype===t.dtype,()=>`The dtypes of the first(${e.dtype}) and second(${t.dtype}) input must match`)}function l(e,t){return t.some(t=>t.id===e.id)}function u(e){let t=[],n=new Set;return function e(t,n,a){if(null!=t){if(t instanceof r.es){n.push(t);return}if(Array.isArray(t)||"object"==typeof t)for(let i in t){let s=t[i];a.has(s)||(a.add(s),e(s,n,a))}}}(e,t,n),t}},3740:function(e,t,n){"use strict";n.d(t,{C:function(){return l},_1:function(){return h},sI:function(){return c}});var r=n(196),a=n(2885),i=n(974),s=n(569),o=n(3418);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function l(e,t){let n=e;if((0,s.fU)(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];let r=[];for(;Array.isArray(n)||(0,s.fU)(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&(0,a.OB)().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function e(t,n,r){if(r=r||[],!Array.isArray(t)&&!(0,s.fU)(t)){(0,s.hu)(0===n.length,()=>`Element arr[${r.join("][")}] is a primitive, but should be an array/TypedArray of ${n[0]} elements`);return}(0,s.hu)(n.length>0,()=>`Element arr[${r.join("][")}] should be a primitive, but is an array of ${t.length} elements`),(0,s.hu)(t.length===n[0],()=>`Element arr[${r.join("][")}] should have ${n[0]} elements, but has ${t.length} elements`);let a=n.slice(1);for(let i=0;i<t.length;++i)e(t[i],a,r.concat(i))}(e,r,[]),r}function u(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw Error(`Argument '${n}' passed to '${r}' must be ${e} tensor, but got ${t} tensor`)}}function h(e,t,n,a="numeric"){if(e instanceof i.es)return u(a,e.dtype,t,n),e;let h=(0,s.D2)(e);if("string"!==h&&["bool","int32","float32"].indexOf(a)>=0&&(h=a),u(a,h,t,n),null==e||!(0,s.fU)(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){let c=null==e?"null":e.constructor.name;throw Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${c}'`)}let d=l(e,h);(0,s.fU)(e)||Array.isArray(e)||(e=[e]);let p="string"!==h?(0,o.toTypedArray)(e,h):(0,s.xH)(e,[],!0);return r.BV.makeTensor(p,d,h)}function c(e,t,n,r="numeric"){if(!Array.isArray(e))throw Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map((e,a)=>h(e,`${t}[${a}]`,n,r))}},1221:function(e,t,n){"use strict";var r,a,i,s,o,l,u,h,c,d;n.d(t,{x8:function(){return f},z4:function(){return m}}),(l=r||(r={})).R0="R0",l.R1="R1",l.R2="R2",l.R3="R3",l.R4="R4",l.R5="R5",l.R6="R6",(u=a||(a={})).float32="float32",u.int32="int32",u.bool="int32",u.complex64="complex64",(h=i||(i={})).float32="float32",h.int32="int32",h.bool="bool",h.complex64="complex64",(c=s||(s={})).float32="float32",c.int32="float32",c.bool="float32",c.complex64="complex64",(d=o||(o={})).float32="complex64",d.int32="complex64",d.bool="complex64",d.complex64="complex64";let p={float32:s,int32:a,bool:i,complex64:o};function f(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw Error(`Can not upcast ${e} with ${t}`)}return p[e][t]}function m(e){return f(e,"int32")}},3418:function(e,t,n){"use strict";n.r(t),n.d(t,{arraysEqual:function(){return a.cO},assert:function(){return a.hu},assertNonNegativeIntegerDimensions:function(){return a.Mu},assertNonNull:function(){return a.Cq},assertShapesMatch:function(){return a.k5},bytesFromStringArray:function(){return a.Ub},bytesPerElement:function(){return a.bT},checkConversionForErrors:function(){return a.D5},clamp:function(){return a.uZ},computeStrides:function(){return a.e3},createScalarValue:function(){return x},createShuffledIndices:function(){return a.U$},decodeString:function(){return S},distSquared:function(){return a.E7},encodeString:function(){return k},fetch:function(){return I},fingerPrint64:function(){return b},flatten:function(){return a.xH},getArrayFromDType:function(){return a.rQ},getTypedArrayFromDType:function(){return a.WP},hasEncodingLoss:function(){return a.QB},hexToLong:function(){return l},indexToLoc:function(){return a.NE},inferDtype:function(){return a.D2},inferFromImplicitShape:function(){return a.JZ},isBoolean:function(){return a.jn},isFunction:function(){return a.mf},isInt:function(){return a.GN},isNumber:function(){return a.hj},isPromise:function(){return a.tI},isScalarShape:function(){return a.N9},isString:function(){return a.HD},isTypedArray:function(){return a.fU},isValidDtype:function(){return a.LP},locToIndex:function(){return a.qy},makeOnesTypedArray:function(){return a.p8},makeZerosNestedTypedArray:function(){return a.l6},makeZerosTypedArray:function(){return a.wT},nearestDivisor:function(){return a.jP},nearestLargerEven:function(){return a.nY},now:function(){return w},parseAxisParam:function(){return a.EC},randUniform:function(){return a.bj},repeatedTry:function(){return a.WD},rightPad:function(){return a.oj},shuffle:function(){return a.TV},shuffleCombo:function(){return a.d7},sizeFromShape:function(){return a.NA},sizeToSquarishShape:function(){return a.YP},squeezeShape:function(){return a.bp},sum:function(){return a.Sm},swap:function(){return a.LF},tanh:function(){return a.AE},toNestedArray:function(){return a.GX},toTypedArray:function(){return v}});var r=n(2885),a=n(569),i=n(3720),s=n.n(i);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let o=s()||i;function l(e){return o.fromString(e,!0,16)}let u=l("c3a5c85c97cb3127"),h=l("b492b66fbe98f273"),c=l("9ae16a3b2f90404f");function d(e){return e.xor(e.shru(47))}function p(e,t,n){let r=e.slice(t,t+n);return o.fromBytes(Array.from(r),!0,!0)}function f(e,t){return p(e,t,8)}function m(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function g(e,t,n=l("9ddfea08eb382d69")){let r=e.xor(t).mul(n);r=r.xor(r.shru(47));let a=t.xor(r).mul(n);return(a=a.xor(a.shru(47))).mul(n)}function y(e,t,n,r){return function(e,t,n,r,a,i){a=a.add(e),i=m(i.add(a).add(r),21);let s=a;return a=(a=a.add(t)).add(n),i=i.add(m(a,44)),[a.add(r),i.add(s)]}(f(e,t),f(e,t+8),f(e,t+16),f(e,t+24),n,r)}function b(e,t=e.length){let n=o.fromNumber(81,!0);if(t<=32)return t<=16?function(e,t=e.length){if(t>=8){let n=c.add(2*t),r=f(e,0).add(c),a=f(e,t-8),i=m(a,37).mul(n).add(r),s=m(r,25).add(a).mul(n);return g(i,s,n)}if(t>=4){let o=c.add(2*t),l=p(e,0,4);return g(l.shl(3).add(t),p(e,t-4,4),o)}if(t>0){let h=e[0],y=e[t>>1],b=e[t-1];return d(c.mul(h+(y<<8)).xor(u.mul(t+(b<<2)))).mul(c)}return c}(e,t):function(e,t=e.length){let n=c.add(2*t),r=f(e,0).mul(h),a=f(e,8),i=f(e,t-8).mul(n),s=f(e,t-16).mul(c);return g(m(r.add(a),43).add(m(i,30)).add(s),r.add(m(a.add(c),18)).add(i),n)}(e,t);if(t<=64)return function(e,t=e.length){let n=c.add(2*t),r=f(e,0).mul(c),a=f(e,8),i=f(e,t-8).mul(n),s=f(e,t-16).mul(c),o=m(r.add(a),43).add(m(i,30)).add(s),l=g(o,r.add(m(a.add(c),18)).add(i),n),u=f(e,16).mul(n),h=f(e,24),d=o.add(f(e,t-32)).mul(n),p=l.add(f(e,t-24)).mul(n);return g(m(u.add(h),43).add(m(d,30)).add(p),u.add(m(h.add(r),18)).add(d),n)}(e,t);let r=n,a=n.mul(h).add(113),i=d(a.mul(c).add(113)).mul(c),s=[o.UZERO,o.UZERO],l=[o.UZERO,o.UZERO];r=r.mul(c).add(f(e,0));let b=0,x=(t-1>>6)*64;do r=m(r.add(a).add(s[0]).add(f(e,b+8)),37).mul(h),a=m(a.add(s[1]).add(f(e,b+48)),42).mul(h),r=r.xor(l[1]),a=a.add(s[0]).add(f(e,b+40)),i=m(i.add(l[0]),33).mul(h),s=y(e,b,s[1].mul(h),r.add(l[0])),l=y(e,b+32,i.add(l[1]),a.add(f(e,b+16))),[i,r]=[r,i],b+=64;while(b!==x);let v=h.add(i.and(255).shl(1));return b=x+(t-1&63)-63,l[0]=l[0].add(t-1&63),s[0]=s[0].add(l[0]),l[0]=l[0].add(s[0]),r=m(r.add(a).add(s[0]).add(f(e,b+8)),37).mul(v),a=m(a.add(s[1]).add(f(e,b+48)),42).mul(v),r=r.xor(l[1].mul(9)),a=a.add(s[0].mul(9).add(f(e,b+40))),i=m(i.add(l[0]),33).mul(v),s=y(e,b,s[1].mul(v),r.add(l[0])),l=y(e,b+32,i.add(l[1]),a.add(f(e,b+16))),[i,r]=[r,i],g(g(s[0],l[0],v).add(d(a).mul(u)).add(i),g(s[1],l[1],v).add(r),v)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function x(e,t){return"string"===t?k(e):v([e],t)}function v(e,t){var n;if("string"===t)throw Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=a.xH(e)),(0,r.OB)().getBool("DEBUG")&&a.D5(e,t),(n=e)instanceof Float32Array&&"float32"===t||n instanceof Int32Array&&"int32"===t||n instanceof Uint8Array&&"bool"===t)return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){let i=new Uint8Array(e.length);for(let s=0;s<i.length;++s)0!==Math.round(e[s])&&(i[s]=1);return i}throw Error(`Unknown data type ${t}`)}function w(){return(0,r.OB)().platform.now()}function I(e,t){return(0,r.OB)().platform.fetch(e,t)}function k(e,t="utf-8"){return t=t||"utf-8",(0,r.OB)().platform.encode(e,t)}function S(e,t="utf-8"){return t=t||"utf-8",(0,r.OB)().platform.decode(e,t)}},569:function(e,t,n){"use strict";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function r(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,o(e,--t,n)}function a(e,t){if(e.length!==t.length)throw Error(`Array sizes must match to be shuffled together First array length was ${e.length}Second array length was ${t.length}`);let n=e.length,r=0;for(;n>0;)r=Math.random()*n|0,o(e,--n,r),o(t,n,r)}function i(e,t,n){return Math.max(e,Math.min(t,n))}function s(e){return e%2==0?e:e+1}function o(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function l(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function u(e,t){let n=Math.random();return t*n+(1-n)*e}function h(e,t){let n=0;for(let r=0;r<e.length;r++){let a=Number(e[r])-Number(t[r]);n+=a*a}return n}function c(e,t){if(!e)throw Error("string"==typeof t?t:t())}function d(e,t,n=""){c(g(e,t),()=>n+` Shapes ${e} and ${t} must match`)}function p(e){c(null!=e,()=>"The input to the tensor constructor must be a non-null value.")}function f(e){if(0===e.length)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function m(e){return 0===e.length}function g(e,t){if(e===t)return!0;if(null==e||null==t||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function y(e){return e%1==0}function b(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return -1;{let t=Math.exp(2*e);return(t-1)/(t+1)}}function x(e){let t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function v(e){let t=new Uint32Array(e);for(let n=0;n<e;++n)t[n]=n;return r(t),t}function w(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function I(e,t=e=>0,n,r=setTimeout){return new Promise((a,i)=>{let s=0,o=()=>{if(e()){a();return}s++;let l=t(s);if(null!=n&&s>=n){i();return}r(o,l)};o()})}function k(e,t){let n=1,r=-1;for(let a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${a}`);r=a}else if(e[a]<0)throw Error(`Shapes can not be < 0. Found ${e[a]} at dim ${a}`);if(-1===r){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(0===n)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!=0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);let i=e.slice();return i[r]=t/n,i}function S(e,t){let n=t.length;return c((e=null==e?t.map((e,t)=>t):[].concat(e)).every(e=>e>=-n&&e<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`),c(e.every(e=>y(e)),()=>`All values in axis param must be integers but got axis ${e}`),e.map(e=>e<0?n+e:e)}function C(e,t){let n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:S(t,e).sort(),s=0;for(let o=0;o<e.length;++o){if(null!=i){if(i[s]===o&&1!==e[o])throw Error(`Can't squeeze axis ${o} since its dim '${e[o]}' is not 1`);(null==i[s]||i[s]>o)&&1===e[o]&&(n.push(e[o]),r.push(o)),i[s]<=o&&s++}1!==e[o]&&(n.push(e[o]),r.push(o))}return{newShape:n,keptDims:r}}function E(e,t){let n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else throw Error(`Unknown data type ${e}`);return n}function T(e,t){let n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else if("string"===e)n=Array(t);else throw Error(`Unknown data type ${e}`);return n}function $(e,t){for(let n=0;n<e.length;n++){let r=e[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}function N(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function A(e,t){return"complex64"!==t&&("float32"!==t||"complex64"===e)&&("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)}function D(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}function F(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw Error(`Unknown dtype ${e}`)}function R(e){if(null==e)return 0;let t=0;return e.forEach(e=>t+=e.length),t}function _(e){return"string"==typeof e||e instanceof String}function O(e){return"boolean"==typeof e}function M(e){return"number"==typeof e}function B(e){return!!(e&&e.constructor&&e.call&&e.apply)}function P(e,t){for(let n=t;n<e;++n)if(e%n==0)return n;return e}function L(e){let t=e.length;if(t<2)return[];let n=Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function U(e,t,n=!1){if(0===e.length)return t[0];let r=e.reduce((e,t)=>e*t)*(n?2:1);if(0===r)return[];if(r!==t.length)throw Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return function e(t,n,r,a=!1){let i=[];if(1===n.length){let s=n[0]*(a?2:1);for(let o=0;o<s;o++)i[o]=r[t+o]}else{let l=n[0],u=n.slice(1),h=u.reduce((e,t)=>e*t)*(a?2:1);for(let c=0;c<l;c++)i[c]=e(t+c*h,u,r,a)}return i}(0,e,t,n)}function W(e,t){let n=z(e,t);for(let r=0;r<n.length;r++)n[r]=1;return n}function z(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw Error(`Unknown data type ${t}`)}function V(e,t){let n=e.reduce((e,t)=>e*t,1);if(null==t||"float32"===t)return U(e,new Float32Array(n));if("int32"===t)return U(e,new Int32Array(n));if("bool"===t)return U(e,new Uint8Array(n));throw Error(`Unknown data type ${t}`)}function G(e){e.forEach(t=>{c(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`)})}function j(e,t,n){if(0===t)return 0;if(1===t)return e[0];let r=e[e.length-1];for(let a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function H(e,t,n){if(0===t)return[];if(1===t)return[e];let r=Array(t);for(let a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function K(e){return e&&e.then&&"function"==typeof e.then}n.d(t,{AE:function(){return b},Cq:function(){return p},D2:function(){return function e(t){if(Array.isArray(t))return e(t[0]);if(t instanceof Float32Array);else if(t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray)return"int32";else if(M(t));else if(_(t))return"string";else if(O(t))return"bool";return"float32"}},D5:function(){return $},E7:function(){return h},EC:function(){return S},GN:function(){return y},GX:function(){return U},HD:function(){return _},JZ:function(){return k},LF:function(){return o},LP:function(){return N},Mu:function(){return G},N9:function(){return m},NA:function(){return f},NE:function(){return H},QB:function(){return A},Sm:function(){return l},TV:function(){return r},U$:function(){return v},Ub:function(){return R},WD:function(){return I},WP:function(){return E},YP:function(){return x},bT:function(){return F},bj:function(){return u},bp:function(){return C},cO:function(){return g},d7:function(){return a},e3:function(){return L},fU:function(){return D},hj:function(){return M},hu:function(){return c},jP:function(){return P},jn:function(){return O},k5:function(){return d},l6:function(){return V},mf:function(){return B},nY:function(){return s},oj:function(){return w},p8:function(){return W},qy:function(){return j},rQ:function(){return T},tI:function(){return K},uZ:function(){return i},wT:function(){return z},xH:function(){return function e(t,n=[],r=!1){if(null==n&&(n=[]),Array.isArray(t)||D(t)&&!r)for(let a=0;a<t.length;++a)e(t[a],n,r);else n.push(t);return n}}})},4634:function(e,t,n){"use strict";n.d(t,{IX:function(){return R},$7:function(){return M},$R:function(){return _}});var r,a,i=n(7671),s=n(6377);function o(e,t,n=new Map,r=new Set){if(null==e)return null;if("function"==typeof Blob&&e instanceof Blob)return e.slice();if(r.has(e))throw Error("Circular references are not supported.");if(n.has(e))return n.get(e);let a=t(e);if(a.recurse&&null!==a.value)throw Error("A deep map function may not return both a value and recurse=true.");if(!a.recurse)return n.set(e,a.value),a.value;if(h(e)){let i=Array.isArray(e)?[]:{};for(let s in r.add(e),e){let l=e[s],u=o(l,t,n,r);i[s]=u}return r.delete(e),e.__proto__&&(i.__proto__=e.__proto__),i}throw Error(`Can't recurse into non-iterable type: ${e}`)}function l(e){return null===e?null:h(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}async function u(e,t){let n=new Map;for(let r of(o(e,t,n),Array.from(n.keys()))){let a=n.get(r);if(i.D5U.isPromise(a)){let s=await a;n.set(r,s)}}let l=o(e,t,n);return l}function h(e){let t=!1;if(i.OBj().get("IS_BROWSER"))t=e instanceof TextDecoder;else{let{StringDecoder:r}=n(4977);t=e instanceof r}return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"==typeof e&&!(e instanceof i.esB)&&!(e instanceof Promise)&&!t)}function c(e){return e instanceof i.esB?{value:e.clone(),recurse:!1}:h(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */ class d{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,null==e)throw RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw RangeError("Can't create ring buffer of capacity < 1.");this.data=Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,t){if(e<0)throw RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(e){if(this.isFull())throw RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(let t of e)this.push(t)}pop(){if(this.isEmpty())throw RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);let e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw RangeError("Ring buffer is empty.");let e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw RangeError("Ring buffer is empty.");let t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */ class p extends d{constructor(){super(p.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){let e=2*this.capacity,t=Array(e),n=this.length();for(let r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}p.INITIAL_CAPACITY=32;class f{async toArray(){let e=[],t=await this.next();for(;!t.done;)e.push(t.value),t=await this.next();return e}async toArrayForTest(){let e=this.prefetch(100),t=[],n=await e.next();for(;!n.done;)t.push(n.value),n=await e.next();return t}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let t=await this.next(),n=e(t.value);for(;!t.done&&n;)n=e((t=await this.next()).value)}handleErrors(e){return new k(this,e)}filter(e){return new w(this,e)}map(e){return new I(this,e)}mapAsync(e){return new S(this,e)}serialMapAsync(e){return new S(this,e).serial()}flatmap(e){return new E(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile(e=>!0===e)}rowMajorBatch(e,t=!0){return new v(this,e,t)}columnMajorBatch(e,t=!0,n=l){let r=this.rowMajorBatch(e,t);return r.map(e=>(function(e,t=l){return function e(t,n,r=new Set){let a=t[0];if(r.has(a))throw Error("Circular references are not supported.");let i=n(t);if(i.recurse&&null!==i.value)throw Error("A deep zip function may not return both a value and recurse=true.");if(!i.recurse)return i.value;if(h(a)){let s=Array.isArray(a)?[]:{};for(let o in r.add(a),a){let l=t.map(e=>e[o]),u=e(l,n,r);s[o]=u}return r.delete(a),s}throw Error(`Can't recurse into non-iterable type: ${a}`)}(e,t)})(e,n))}concatenate(e,t){return new T(new m([this,e]),t)}take(e){return e<0||null==e?this:new x(this,e)}skip(e){return e<0||null==e?this:new b(this,e)}prefetch(e){return new N(this,e)}shuffle(e,t){return new A(this,e,t)}serial(){return new y(this)}}class m extends f{constructor(e){super(),this.items=e,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};let e=this.items[this.trav];return this.trav++,{value:o(e,c),done:!1}}}class g extends f{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(e){throw e.message=`Error thrown while iterating through a dataset: ${e.message}`,e}}}class y extends f{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}}class b extends f{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){let e=await this.upstream.next();if(e.done)return e;i.B90(e.value)}return this.upstream.next()}}class x extends f{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class v extends f{constructor(e,t,n=!0){super(),this.upstream=e,this.batchSize=t,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){let e=[];for(;e.length<this.batchSize;){let t=await this.upstream.next();if(t.done){if(this.enableSmallLastBatch&&e.length>0)return{value:e,done:!1};return{value:null,done:!0}}e.push(t.value)}return{value:e,done:!1}}}class w extends f{constructor(e,t){super(),this.upstream=e,this.predicate=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){let e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;i.B90(e.value)}}}class I extends f{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Map`}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=i.piX.getTensorsInContainer(e.value),n=this.transform(e.value),r=i.piX.getTensorsInContainer(n);for(let a of t)i.piX.isTensorInList(a,r)||a.dispose();return{value:n,done:!1}}}class k extends f{constructor(e,t){super(),this.upstream=e,this.handler=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(e){if(!this.handler(e))return{value:null,done:!0}}}}class S extends f{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=i.piX.getTensorsInContainer(e.value),n=await this.transform(e.value),r=i.piX.getTensorsInContainer(n);for(let a of t)i.piX.isTensorInList(a,r)||a.dispose();return{value:n,done:!1}}}class C extends f{constructor(){super(),this.outputQueue=new p,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class E extends C{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){let e=await this.upstream.next();if(e.done)return!1;let t=i.piX.getTensorsInContainer(e.value),n=this.transform(e.value),r=i.piX.getTensorsInContainer(n);for(let a of(this.outputQueue.pushAll(n),t))i.piX.isTensorInList(a,r)||a.dispose();return!0}}class T extends f{constructor(e,t){super(),this.baseErrorHandler=t,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,null==this.iterator){let t=await this.moreIterators.next();if(t.done)return{value:null,done:!0};this.iterator=t.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}let n=await this.iterator.next();return n.done?(this.iterator=null,this.readFromChain(e)):n}}(r=a||(a={}))[r.FAIL=0]="FAIL",r[r.SHORTEST=1]="SHORTEST",r[r.LONGEST=2]="LONGEST";class $ extends f{constructor(e,t=a.FAIL){super(),this.iterators=e,this.mismatchMode=t,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(e){await e;let t=0,n=0,r=await u(this.iterators,function(e){if(!(e instanceof f))return{value:null,recurse:!0};{let r=e.next();return{value:r.then(e=>(t++,e.done&&n++,e.value)),recurse:!1}}});if(t===n)return{value:null,done:!0};if(n>0)switch(this.mismatchMode){case a.FAIL:throw Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case a.SHORTEST:return{value:null,done:!0};case a.LONGEST:}return this.count++,{value:r,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}}class N extends f{constructor(e,t){super(),this.upstream=e,this.bufferSize=t,this.buffer=new d(t)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){let e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}}class A extends N{constructor(e,t,n){super(e,t),this.upstream=e,this.windowSize=t,this.upstreamExhausted=!1,this.random=s.alea(n||i.D5U.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){let e=this.chooseIndex(),t=await this.buffer.shuffleExcise(e);if(!t.done)return this.refill(),t;this.upstreamExhausted=!0}return{value:null,done:!0}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */ class D{constructor(){this.size=null}batch(e,t=!0){let n=this;return i.D5U.assert(e>0,()=>`batchSize needs to be positive, but it is
      ${e}`),F(async()=>(await n.iterator()).columnMajorBatch(e,t,O),this.size===1/0||null==this.size?this.size:t?Math.ceil(this.size/e):Math.floor(this.size/e))}concatenate(e){let t=this;return F(async()=>(await t.iterator()).concatenate(await e.iterator()),this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null)}filter(e){let t=this;return F(async()=>(await t.iterator()).filter(t=>i.lub(()=>e(t))),this.size===1/0?1/0:null)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){let t=this;return F(async()=>(await t.iterator()).map(t=>i.lub(()=>e(t))),this.size)}mapAsync(e){let t=this;return F(async()=>(await t.iterator()).mapAsync(e),this.size)}prefetch(e){if(null==e)throw RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");let t=this;return F(async()=>(await t.iterator()).prefetch(e),this.size)}repeat(e){let t=this;return F(async()=>{var n,r;let a=(n=async()=>({value:await t.iterator(),done:!1}),new g(n));return r=a.take(e),new T(r,void 0)},null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null)}skip(e){let t=this;return F(async()=>(await t.iterator()).skip(e),null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null)}shuffle(e,t,n=!0){if(null==e||e<0){if(null==this.size)throw RangeError("`Dataset.shuffle()` requires bufferSize to be specified.");throw RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`)}let r=this,a=s.alea(t||i.D5U.now().toString());return F(async()=>{let t=a.int32();return n&&(t+=a.int32()),(await r.iterator()).shuffle(e,t.toString())},this.size)}take(e){let t=this;return F(async()=>(await t.iterator()).take(e),null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null)}async toArray(){if(this.size===1/0)throw Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}function F(e,t=null){return new class extends D{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function R(e){return F(async()=>new m(e),e.length)}function _(e){let t;if(!h(e))throw Error("The argument to zip() must be an object or array.");if(Array.isArray(e))for(let n=0;n<e.length;n++)t=null==t?e[n].size:Math.min(t,e[n].size);else if(e instanceof Object)for(let r in e)t=null==t?e[r].size:Math.min(t,e[r].size);return F(async()=>{let t=await u(e,e=>{if(e instanceof D)return{value:e.iterator(),recurse:!1};if(h(e))return{value:null,recurse:!0};throw Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return function(e,t=a.FAIL){return new $(e,t)}(t,a.SHORTEST)},t)}function O(e){var t;if(null===e)return null;let n=e[0];if(null==n||null===(t=n)||"object"!=typeof t&&"function"!=typeof t||Array.isArray(n)||"object"==typeof n&&n instanceof i.esB||i.D5U.isTypedArray(n)){let r=function(e){if(0===e.length)throw Error("Can't make a batch of zero elements.");return e[0]instanceof i.esB?i.knu(e):i.XeE(e)}(e);return{value:r,recurse:!1}}return{value:null,recurse:!0}}D.MAX_BUFFER_SIZE=1e4,Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote"),n(1876).Buffer;/** @license See the LICENSE file. */ let M="3.21.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ },8819:function(e,t,n){"use strict";n.d(t,{GD:function(){return w},Gc:function(){return y},aI:function(){return k}});var r=n(7671),a=n(9840),i=n(2931);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ class s extends r.m7h.Serializable{getConfig(){return{}}}class o extends s{apply(e,t=1){return a.py(e,t)}}o.className="elu",r.m7h.registerClass(o);class l extends s{apply(e){return r.U8D(e)}}l.className="selu",r.m7h.registerClass(l);class u extends s{apply(e){return r.UYe(e)}}u.className="relu",r.m7h.registerClass(u);class h extends s{apply(e){return(0,r.lub)(()=>r.LTh(6,r.UYe(e)))}}h.className="relu6",r.m7h.registerClass(h);class c extends s{apply(e){return e}}c.className="linear",r.m7h.registerClass(c);class d extends s{apply(e){return r.XD2(e)}}d.className="sigmoid",r.m7h.registerClass(d);class p extends s{apply(e){return a.HX(e)}}p.className="hardSigmoid",r.m7h.registerClass(p);class f extends s{apply(e){return r.Wvh(e)}}f.className="softplus",r.m7h.registerClass(f);class m extends s{apply(e){return a.O(e)}}m.className="softsign",r.m7h.registerClass(m);class g extends s{apply(e){return r.AEp(e)}}g.className="tanh",r.m7h.registerClass(g);class y extends s{apply(e,t=-1){return r.XAC(e,t)}}y.className="softmax",r.m7h.registerClass(y);class b extends s{apply(e,t=-1){return r.CmS(e,t)}}b.className="logSoftmax",r.m7h.registerClass(b);class x extends s{apply(e,t=1){return(0,r.lub)(()=>r.dC7(r.XD2(r.dC7(e,t)),e))}}x.className="swish",r.m7h.registerClass(x);class v extends s{apply(e){return(0,r.lub)(()=>r.dC7(e,r.AEp(r.Wvh(e))))}}function w(e){return e.getClassName()}function I(e,t={}){return(0,i.tU)(e,r.m7h.SerializationMap.getMap().classNameMap,t,"activation")}function k(e){if(null==e){let t={};return t.className="linear",t.config={},I(t)}if("string"==typeof e){let n={};return n.className=e,n.config={},I(n)}return e instanceof s?e:I(e)}v.className="mish",r.m7h.registerClass(v)},2012:function(e,t,n){"use strict";let r;n.d(t,{Ho:function(){return i},rf:function(){return s}});var a=n(7671);function i(){return null==r&&(r=(0,a.y3$)().epsilon()),r}function s(){return"channelsLast"}},9608:function(e,t,n){"use strict";n.d(t,{L:function(){return a},s:function(){return s}});/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ let r=0;function a(){return r++}let i={};function s(e=""){return e in i||(i[e]=0),i[e]+=1,e+i[e].toString()}},9840:function(e,t,n){"use strict";n.d(t,{AK:function(){return v},GZ:function(){return y},Gg:function(){return b},HX:function(){return $},Iq:function(){return w},KC:function(){return N},O:function(){return E},Uz:function(){return d},a2:function(){return S},c9:function(){return p},dt:function(){return u},h6:function(){return I},mV:function(){return g},nG:function(){return x},pj:function(){return l},py:function(){return C},rv:function(){return T},rx:function(){return h},uI:function(){return m},xH:function(){return c}});var r=n(7671),a=n(8090),i=n(588),s=n(6040),o=n(2012);function l(e,t){return r.pju(e,t)}function u(e,t=-1){let n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),r.XLQ(e,n)}function h(e,t){return(0,r.lub)(()=>{if(2!==e.shape.length)throw new i.nu(`repeat() expects a rank-2 tensor, but received a rank-${e.shape.length} tensor.`);let n=u(e,1);return b(n,[1,t,1])})}function c(e){let t=[s.NS(e.shape)];return r.XLQ(e,t)}function d(e){if(e.rank<=1)throw new i.nu(`batchFlatten requires a minimum rank of 2. Got rank: ${e.rank}.`);let t=[e.shape[0],s.NS(e.shape,1)];return r.XLQ(e,t)}function p(e,t,n){return(0,r.lub)(()=>{switch(e.rank){case 1:return r.jZU(e,t,n);case 2:return r.SmN(e,[t,0],[n,e.shape[1]]);case 3:return r.CnO(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return r.p0P(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return r.tPi(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return r.tPi(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new i.nu(`sliceAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}})}function f(e,t,n){return(0,r.lub)(()=>{switch(e.rank){case 1:return r.jZU(e,t,n);case 2:return r.SmN(e,[0,t],[e.shape[0],n]);case 3:return r.CnO(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return r.p0P(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new i.nu(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function m(e,t,n,a){return(0,r.lub)(()=>{switch(e.rank){case 1:return r.jZU(e,t,n);case 2:switch(a){case 1:return p(e,t,n);case 2:return f(e,t,n);default:throw new i.nu(`The axis is not within the rank of the tensor ${a}`)}case 3:switch(a){case 1:return p(e,t,n);case 2:return r.CnO(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return f(e,t,n);default:throw new i.nu(`The axis is not within the rank of the tensor ${a}`)}case 4:switch(a){case 1:return p(e,t,n);case 2:return r.p0P(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return r.p0P(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return f(e,t,n);default:throw new i.nu(`The axis is not within the rank of the tensor ${a}`)}default:throw new i.nu(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function g(e,t=-1){let n;return t<0&&(t=0!==(n=e[0].rank)?n:0),t===e[0].rank&&(t=-1),r.zoF(e,t)}function y(e,t){switch(e.rank){case 1:return r.gME([e,t]);case 2:return r.Izb([e,t],0);case 3:return r.MNy([e,t],0);case 4:return r.ZaL([e,t],0);default:throw new i.nu(`concatAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}function b(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new i.nu(`The length of input n (${t.length}) does not match the number of dimensions in input x (${e.rank})`);return r.Gg6(e,t)}function x(e,t=0,n=1,a,i){return r.nGf(e,t,n,a,i)}function v(e,t,n,a){if(e.rank<2||t.rank<2)throw new i.nj(`dot requires both inputs to be rank >= 2 but got x shape = ${e.shape} and y shape = ${t.shape}`);if(t.rank>=3){let s=e.shape.slice(-1)[0],l=t.shape.slice(-2)[0];if(s!==l)throw new i.nj(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${e.shape} and  y shape = ${t.shape}`)}if(2===e.rank&&2===t.rank)return r.imm.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:a?k(e.rank,a,(0,o.rf)()):null,activation:n});{let u=e.shape.slice(),h=u.pop();e=r.XLQ(e,[-1,h]);let c=t.shape.slice(),d=c.pop(),p=c.pop(),f=[...c,d],m=Array.from({length:t.rank},(e,n)=>0===n?t.rank-2:n<=t.rank-2?n-1:n);t=r.XLQ(r.p4s(t,m),[p,-1]);let g=[...u,...f];return r.XLQ(r.imm.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:a?k(e.rank,a,(0,o.rf)()):null,activation:n}),g)}}function w(e,t,n){return(0,r.lub)(()=>(t=Array.isArray(t)?(0,r.RRF)(t,"int32"):r.pju(t,"int32"),r.Iqj(e,t,n)))}function I(e){return r.dC7(e,e)}function k(e,t,n){let a=t.shape;if(1!==t.rank&&t.rank!==e)throw new i.nu(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${e}`);if(5===e){if("channelsFirst"===n)return 1===a.length?r.XLQ(t,[1,a[0],1,1,1]):r.XLQ(t,[1,a[3],a[0],a[1],a[2]]);if("channelsLast"===n)return 1===a.length?r.XLQ(t,[1,1,1,1,a[0]]):r.XLQ(t,[1].concat(a))}else if(4===e){if("channelsFirst"===n)return 1===a.length?r.XLQ(t,[1,a[0],1,1]):r.XLQ(t,[1,a[2],a[0],a[1]]);if("channelsLast"===n)return 1===a.length?r.XLQ(t,[1,1,1,a[0]]):r.XLQ(t,[1].concat(a))}else if(3===e){if("channelsFirst"===n)return 1===a.length?r.XLQ(t,[1,a[0],1]):r.XLQ(t,[1,a[1],a[0]]);if("channelsLast"===n)return 1===a.length?r.XLQ(t,[1,1,a[0]]):r.XLQ(t,[1].concat(a))}else if(e<3)return t;throw new i.nu(`Unsupported input rank by biasAdd: ${t.rank}`)}function S(e,t,n){return(0,r.lub)(()=>(null==n&&(n=(0,o.rf)()),(0,a.cj)(n),r.IHx(e,k(e.rank,t,n))))}function C(e,t=1){if(1!==t)throw new i.nj(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return r.pyx(e)}function E(e){return(0,r.lub)(()=>r.hiC(e,r.IHx(r.WnP(e),1)))}function T(e,t,n,a){return(0,r.lub)(()=>r.rvX(e,t,n,a))}function $(e){return(0,r.lub)(()=>{let t=r.IHx(.5,r.dC7(.2,e));return r.iUl(t,0,1)})}function N(e,t,n=!1){return n?e():t()}},8891:function(e,t,n){"use strict";n.d(t,{CZ:function(){return f},ex:function(){return u},m$:function(){return g}});var r,a,i=n(7671),s=n(588),o=n(3146),l=n(2931);(r=a||(a={}))[r.SILENT=0]="SILENT",r[r.VERBOSE=1]="VERBOSE";class u{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class h{constructor(e,t=10){null==e&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(let t of this.callbacks)t.setParams(e)}setModel(e){for(let t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){for(let n of(null==t&&(t={}),this.callbacks))await n.onEpochBegin(e,t)}async onEpochEnd(e,t){for(let n of(null==t&&(t={}),this.callbacks))await n.onEpochEnd(e,t)}async onBatchBegin(e,t){for(let n of(null==t&&(t={}),this.callbacks))await n.onBatchBegin(e,t)}async onBatchEnd(e,t){for(let n of(null==t&&(t={}),this.callbacks))await n.onBatchEnd(e,t)}async onTrainBegin(e){for(let t of(null==e&&(e={}),this.callbacks))await t.onTrainBegin(e)}async onTrainEnd(e){for(let t of(null==e&&(e={}),this.callbacks))await t.onTrainEnd(e)}}class c extends u{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){null==t&&(t={});let n=null==t.size?0:t.size;for(let r in this.seen+=n,t){let a=t[r];if("number"==typeof a)this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+a*n;else{let s;r in this.totals?s=this.totals[r]:this.totals[r]=0;let o=(0,i.lub)(()=>(0,i.IHx)(this.totals[r],(0,i.dC7)(a,n)));this.totals[r]=o,null!=s&&s.dispose()}}}async onEpochEnd(e,t){if(null!=t)for(let n of this.params.metrics)null!=this.totals[n]&&("number"==typeof this.totals[n]?t[n]=this.totals[n]/this.seen:(0,i.lub)(()=>{let e=(0,i.dC7)((0,i.hiC)(1,this.seen),this.totals[n]);t[n]=e,this.totals[n].dispose(),(0,i.CnY)(t[n])}))}}class d extends u{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){for(let n in null==t&&(t={}),this.epoch.push(e),t)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(t[n])}async syncData(){let e=[],t=[],n=[];for(let r in this.history){let a=this.history[r];for(let i=0;i<a.length;++i)if("number"!=typeof a[i]){let s=a[i];e.push(s.data()),t.push(r),n.push(i)}}let o=await Promise.all(e);for(let l=0;l<o.length;++l){let u=this.history[t[l]][n[l]];u.dispose(),this.history[t[l]][n[l]]=o[l][0]}}}class p extends u{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||i.glt,this.yieldEvery=t||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=e.onYield)throw Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");i.D5U.isNumber(this.yieldEvery)&&(this.maybeWait=l.Ds(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,n){let r=[];null!=this.yield&&(await (0,o.Z)(n),r.push(this.yield(e,t,n))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,t){this.currentEpoch=e,null!=this.epochBegin&&(await (0,o.Z)(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){let n=[];null!=this.epochEnd&&(await (0,o.Z)(t),n.push(this.epochEnd(e,t))),"epoch"===this.yieldEvery&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){null!=this.batchBegin&&(await (0,o.Z)(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){let n=[];null!=this.batchEnd&&(await (0,o.Z)(t),n.push(this.batchEnd(e,t))),"batch"===this.yieldEvery?n.push(this.nextFrameFunc()):i.D5U.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){null!=this.trainBegin&&(await (0,o.Z)(e),await this.trainBegin(e))}async onTrainEnd(e){null!=this.trainEnd&&(await (0,o.Z)(e),await this.trainEnd(e))}}function f(e,t){if(null==e&&(e={}),e instanceof u)return[e];if(Array.isArray(e)&&e[0]instanceof u)return e;let n=l.zZ(e);return n.map(e=>new p(e,t))}class m{constructor(){}static registerCallbackConstructor(e,t){i.D5U.assert(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),m.checkForDuplicate(t),null==m.constructors[e]&&(m.constructors[e]=[]),m.constructors[e].push(t)}static checkForDuplicate(e){for(let t in m.constructors){let n=m.constructors[+t];n.forEach(t=>{if(t===e)throw new s.nu("Duplicate callback constructor.")})}}static clear(){m.constructors={}}static createCallbacks(e){let t=[];for(let n in m.constructors){let r=+n;e>=r&&t.push(...m.constructors[r])}return t.map(e=>new e)}}function g(e,t,n,r,a,i,s,o,l){let u=new d,p=[new c,...m.createCallbacks(t)];null!=e&&p.push(...e),p.push(u);let f=new h(p);return f.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:s,verbose:t,doValidation:o,metrics:l}),{callbackList:f,history:u}}m.constructors={}},8090:function(e,t,n){"use strict";n.d(t,{Lp:function(){return u},MU:function(){return d},cj:function(){return s},f4:function(){return c},w8:function(){return p},wU:function(){return o},zb:function(){return l}});var r=n(4685),a=n(2931);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ let i=new Map;function s(e){(0,a.xn)(r.PS,"DataFormat",e)}function o(e){(0,a.xn)(r.Mz,"InterpolationFormat",e)}function l(e){(0,a.xn)(r.zx,"PaddingMode",e)}function u(e){(0,a.xn)(r.MK,"PoolMode",e)}let h=[];function c(e,t){h.push(e);try{let n=t();return h.pop(),n}catch(r){throw h.pop(),r}}function d(e){if(!m(e))throw Error("Not a valid tensor name: '"+e+"'");return(0===h.length?"":h.join("/")+"/")+e}function p(e){if(!m(e))throw Error("Not a valid tensor name: '"+e+"'");i.has(e)||i.set(e,0);let t=i.get(e);if(i.set(e,i.get(e)+1),!(t>0))return e;{let n=`${e}_${t}`;return i.set(n,1),n}}let f=RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function m(e){return!!e.match(f)}},4079:function(e,t,n){"use strict";n.d(t,{Ad:function(){return m},xF:function(){return p}});var r=n(7671),a=n(2012),i=n(2931);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function s(e,t){return(0,r.lub)(()=>r._b3(r.Smz(r.dC7(e,e),t,!0)))}class o extends r.m7h.Serializable{getConfig(){return{}}}class l extends o{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return(0,r.lub)(()=>{let t=s(e,this.axis),n=r.iUl(t,0,this.maxValue);return r.dC7(e,r.hiC(n,r.IHx((0,a.Ho)(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}l.className="MaxNorm",r.m7h.registerClass(l);class u extends o{constructor(e){super(),this.defaultAxis=0,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return(0,r.lub)(()=>r.hiC(e,r.IHx((0,a.Ho)(),s(e,this.axis))))}getConfig(){return{axis:this.axis}}}u.className="UnitNorm",r.m7h.registerClass(u);class h extends o{apply(e){return r.UYe(e)}}h.className="NonNeg",r.m7h.registerClass(h);class c extends o{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=e.minValue?e.minValue:this.defaultMinValue,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.rate=null!=e.rate?e.rate:this.defaultRate,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return(0,r.lub)(()=>{let t=s(e,this.axis),n=r.IHx(r.dC7(this.rate,r.iUl(t,this.minValue,this.maxValue)),r.dC7(1-this.rate,t));return r.dC7(e,r.hiC(n,r.IHx((0,a.Ho)(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}c.className="MinMaxNorm",r.m7h.registerClass(c);let d={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function p(e){return(0,i.Kj)(e)}function f(e,t={}){return(0,i.tU)(e,r.m7h.SerializationMap.getMap().classNameMap,t,"constraint")}function m(e){if(null==e)return null;if("string"==typeof e){let t=e in d?d[e]:e;return f({className:t,config:{}})}return e instanceof o?e:f(e)}},1111:function(e,t,n){"use strict";n.d(t,{l2:function(){return u},ht:function(){return p},kS:function(){return d}});var r=n(7671),a=n(588);/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ class i{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){let n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){let n=this.cache.keys().next().value;this.cache.delete(n)}this.maxEntries=e}}var s=n(2931),o=n(4396),l=n(163);class u{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof u)for(let t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(null==e)return;for(let n of e)this.add(n.key,n.value)}}add(e,t,n){if(null==this.id2Value[e.id])this.id2Value[e.id]=/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return(0,r.pju)(t,e.dtype)}catch(n){throw new a.nu(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${e.name}' (${e.dtype}).`)}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n);else throw new a.nu(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return null!=this.id2Value[e.id]}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof l.Iy){if(null!=this.id2Value[e.id])return this.id2Value[e.id];throw new a.nu(`Nonexistent key: ${e.name}`)}{let t=this.name2Id[e];if(null==t)throw new a.nu(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof l.Iy){if(null!=this.id2Value[e.id])return this.id2Mask[e.id];throw new a.nu(`Nonexistent key: ${e.name}`)}{let t=this.name2Id[e];if(null==t)throw new a.nu(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){null!=this.id2Mask&&(0,r.B90)(this.id2Mask)}}let h=new i,c=new i;function d(e){null!=h&&h.setMaxEntries(e),null!=c&&c.setMaxEntries(e)}function p(e,t,n,a){let i;let l=null!=n&&n.training,d=Array.isArray(e),p=d?e:[e],m=p.map(e=>e.name),g=[],y=t.names();for(let b of m)-1!==y.indexOf(b)?g.push(t.getValue(b)):g.push(null);null!=a&&(a.maxNumTensors=-1/0,a.minNumTensors=1/0);let x=m.join(",")+"|"+t.names().sort().join(","),v=h.get(x);if(null==v){let w=function(e,t){r.D5U.assert(null!=e&&e.length>0,()=>"Expected at least one fetch, got none");let n=[],a={};if(1===e.length){let i=f(e[0],t);n=i.sorted,a=i.recipientMap}else{let s=new Set;for(let o of e){let{sorted:l,recipientMap:u}=f(o,t);for(let h of l)s.has(h.name)||(n.push(h),s.add(h.name));for(let c in u)null==a[c]&&(a[c]=new Set),u[c].forEach(e=>a[c].add(e))}}return{sorted:n,recipientCounts:function(e){let t={};for(let n in e)t[n]=e[n].size;return t}(a)}}(p,t);v=w.sorted,i=w.recipientCounts,h.put(x,v),c.put(x,i)}i={},l||Object.assign(i,c.get(x));let I=new u(t);for(let k=0;k<v.length;++k){if(null!=a){let S=(0,r.sq6)().numTensors;S>a.maxNumTensors&&(a.maxNumTensors=S),S<a.minNumTensors&&(a.minNumTensors=S)}let C=v[k],E=C.sourceLayer;if(E instanceof o.l)continue;let T=[],$=[],N=[],A=!1;for(let D of C.inputs){let F=I.getValue(D),R=I.getMask(D);T.push(F),$.push(R),null!=R&&(A=!0),l||(i[D.name]--,0!==i[D.name]||t.hasKey(D)||-1!==m.indexOf(D.name)||F.isDisposed||!0===D.sourceLayer.stateful||N.push(F))}A&&((n=n||{}).mask=$[0]);let _=(0,s.zZ)(E.apply(T,n)),O=null;E.supportsMasking&&(O=E.computeMask(T,$));let M=function(e){let t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{let n=null;for(let r=0;r<e.sourceLayer.inboundNodes.length;++r)for(let a of e.sourceLayer.inboundNodes[r].outputTensors)if(a.id===e.id){n=r;break}t=e.sourceLayer.getOutputAt(n)}return t}(C),B=Array.isArray(M)?M:[M];for(let P=0;P<B.length;++P){I.hasKey(B[P])||I.add(B[P],_[P],Array.isArray(O)?O[0]:O);let L=m.indexOf(B[P].name);-1!==L&&(g[L]=_[P])}l||(0,r.B90)(N)}return I.disposeMasks(),d?g:g[0]}function f(e,t){let n=new Set,r=[],a={};for(let i of t.names())n.add(i);let s=[],o=[];for(s.push(e);s.length>0;){let l=s[s.length-1];if(n.has(l.name)){s.pop();continue}let u=o[o.length-1]===s.length-1;if(0===l.inputs.length||u)s.pop(),r.push(l),n.add(l.name),u&&o.pop();else for(let h of(o.push(s.length-1),l.inputs))null==a[h.name]&&(a[h.name]=new Set),a[h.name].add(l.name),n.has(h.name)||s.push(h)}return{sorted:r,recipientMap:a}}},4396:function(e,t,n){"use strict";n.d(t,{I:function(){return l},l:function(){return o}});var r=n(7671),a=n(9608),i=n(588),s=n(163);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ class o extends s.mh{constructor(e){if(super({dtype:e.dtype,name:null!=e.name?e.name:(0,a.s)("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new i.nu("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(null==t){if(null==e.inputShape)throw new i.nu("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new i.nu("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");let n=e.dtype||"float32";this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];let r=new s.Iy(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new s.NB({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new i.nu(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}function l(e){if(null==e.batchShape&&null==e.shape)throw Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new i.nu("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));let n=e.dtype;null==n&&(n="float32");let r=new o({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}),a=r.inboundNodes[0].outputTensors;return a[0]}o.className="InputLayer",r.m7h.registerClass(o)},163:function(e,t,n){"use strict";n.d(t,{Iy:function(){return p},NB:function(){return m},Zg:function(){return d},hA:function(){return function e(t,n,r){if((null==n||null!=r&&r>0)&&(n=t.sourceLayer,r=t.nodeIndex),0===n.inboundNodes.length)return[t];{let a=n.inboundNodes[r];if(0===a.inboundLayers.length)return a.inputTensors;{let i=[];for(let s=0;s<a.inboundLayers.length;s++){let o=a.inputTensors[s],l=a.inboundLayers[s],u=a.nodeIndices[s],h=e(o,l,u);for(let c of h)-1===i.indexOf(c)&&i.push(c)}return i}}}},mh:function(){return y}});var r=n(7671),a=n(9608),i=n(8090),s=n(588),o=n(2599),l=n(2931),u=n(7538),h=n(3013),c=n(1653);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ class d{constructor(e){this.dtype=e.dtype,this.shape=e.shape,null!=e.shape?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class p{constructor(e,t,n,r,s,o,l){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=s,this.outputTensorIndex=l,this.id=(0,a.L)(),null!=o&&(this.originalName=(0,i.MU)(o),this.name=(0,i.w8)(this.originalName)),this.rank=t.length}}let f=0;class m{constructor(e,t){for(let n of(this.callArgs=t,this.id=f++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes,e.inboundLayers))null!=n&&n.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){let e=[];for(let t of this.inboundLayers)null!=t?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let g=0;class y extends r.m7h.Serializable{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=g++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){let n=this.getClassName();t=l.D1(n)+"_"+(0,a.s)(n)}if(this.name=t,this.trainable_=null==e.trainable||e.trainable,null!=e.inputShape||null!=e.batchInputShape){let r;if(null!=e.batchInputShape)r=e.batchInputShape;else if(null!=e.inputShape){let i=null;null!=e.batchSize&&(i=e.batchSize),r=[i].concat(e.inputShape)}this.batchInputShape=r;let s=e.dtype;null==s&&(s=e.inputDType),null==s&&(s="float32"),this.dtype=s}null!=e.weights?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(0===this.inboundNodes.length)throw new s.LH(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new s.nu(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return l.Bq(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return l.Bq(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new s.j1(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(0===this.inboundNodes.length)throw new s.j1(`Layer ${this.name} is not connected, no input to return.`);return l.Bq(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new s.j1(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new s.j1(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return l.Bq(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){if(e=l.zZ(e),null==this.inputSpec||0===this.inputSpec.length)return;let t=l.zZ(this.inputSpec);if(e.length!==t.length)throw new s.nu(`Layer ${this.name} expects ${t.length} inputs, but it received ${e.length} input tensors. Input received: ${e}`);for(let n=0;n<e.length;n++){let r=e[n],a=t[n];if(null==a)continue;let i=r.rank;if(null!=a.ndim&&i!==a.ndim)throw new s.nu(`Input ${n} is incompatible with layer ${this.name}: expected ndim=${a.ndim}, found ndim=${i}`);if(null!=a.maxNDim&&i>a.maxNDim)throw new s.nu(`Input ${n} is incompatible with layer ${this.name}: expected max_ndim=${a.maxNDim}, found ndim=${i}`);if(null!=a.minNDim&&i<a.minNDim)throw new s.nu(`Input ${n} is incompatible with layer ${this.name}: expected min_ndim=${a.minNDim}, found ndim=${i}.`);if(null!=a.dtype&&r.dtype!==a.dtype)throw new s.nu(`Input ${n} is incompatible with layer ${this.name} : expected dtype=${a.dtype}, found dtype=${r.dtype}.`);if(a.axes){let o=r.shape;for(let u in a.axes){let h=Number(u),c=a.axes[u],d=h>=0?o[h]:o[o.length+h];if(null!=c&&-1===[c,null].indexOf(d))throw new s.nu(`Input ${n} is incompatible with layer ${this.name}: expected axis ${h} of input shape to have value ${c} but got shape ${o}.`)}}if(null!=a.shape)for(let p=0;p<a.shape.length;++p){let f=a.shape[p],m=r.shape[p];if(null!=f&&null!=m&&f!==m)throw new s.nu(`Input ${n} is incompatible with layer ${this.name}: expected shape=${a.shape}, found shape=${r.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){null!=this._callHook&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();let n=l.zZ(e),r=!0;for(let a of n)if(!(a instanceof p)){r=!1;break}let o=!0;for(let u of n)if(u instanceof p){o=!1;break}if(r===o)throw new s.nu("Arguments to apply() must be all SymbolicTensors or all Tensors");return(0,i.f4)(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);let r=[];for(let a of l.zZ(e))r.push(a.shape);this.build(l.Bq(r)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&o&&(this._refCount=1)}if(this.assertInputCompatibility(e),o){let i=this.call(e,t),u=l.zZ(i),h=[];for(let c of u)-1!==n.indexOf(c)&&(c=c.clone()),h.push(c);if(i=l.Bq(h),null!=this.activityRegularizer)throw new s.nj("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}{let d;let f=function(e){e=l.zZ(e);let t=[];for(let n of e)t.push(n.shape);return l.Bq(t)}(e),m=this.computeOutputShape(f),g="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(e)?f[0]:f),d=null!=m&&m.length>0&&Array.isArray(m[0])?m.map((n,r)=>new p(g,n,this,l.zZ(e),t,this.name,r)):new p(g,m,this,l.zZ(e),t,this.name),this.addInboundNode(e,d,null,null,f,m,t),this._refCount++,null!=this.activityRegularizer)throw new s.nj("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return d}})}warnOnIncompatibleInputShape(e){if(null!=this.batchInputShape){if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach((n,r)=>{null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)}),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new s.j1(`The layer ${this.name} has never been called and thus has no defined output shape.`);let e=[];for(let t of this.inboundNodes){let n=JSON.stringify(t.outputShapes);-1===e.indexOf(n)&&e.push(n)}if(1===e.length){let r=this.inboundNodes[0].outputShapes;return Array.isArray(r)&&Array.isArray(r[0])&&1===r.length?r[0]:r}throw new s.j1(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new s.LH(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return h.t(this.weights)}build(e){this.built=!0}getWeights(e=!1){return(0,c.FQ)(e?this.trainableWeights:this.weights)}setWeights(e){(0,r.lub)(()=>{let t=this.weights;if(t.length!==e.length)throw new s.nu(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(0===t.length)return;let n=[],a=(0,c.FQ)(t);for(let i=0;i<a.length;++i){let o=a[i],l=t[i],u=e[i];if(!r.D5U.arraysEqual(o.shape,u.shape))throw new s.nu(`Layer weight shape ${o.shape} not compatible with provided weight shape ${u.shape}`);n.push([l,u])}(0,c.zb)(n)})}addWeight(e,t,n,r,a,i,l,u){if(-1!==this._addedWeightNames.indexOf(e))throw new s.nu(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=u?u():(0,o.L5)("zeros"));let h=r.apply(t,n),d=new c.fU(h,n,e,i,l);return h.dispose(),null!=a&&this.addLoss(()=>a.apply(d.read())),null==i&&(i=!0),i?this._trainableWeights.push(d):this._nonTrainableWeights.push(d),d}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){null==e||Array.isArray(e)&&0===e.length||(e=l.zZ(e),void 0!==this._losses&&null!==this._losses&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(null!=t){if(Array.isArray(t))t.forEach(e=>{if(null!=e)throw TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)}return null}return t}addInboundNode(e,t,n,r,a,i,s=null){let o=l.zZ(e);t=l.zZ(t),n=l.zZ(n),r=l.zZ(r),a=u.x6(a),i=u.x6(i);let h=[],c=[],d=[];for(let p of o)h.push(p.sourceLayer),c.push(p.nodeIndex),d.push(p.tensorIndex);new m({outboundLayer:this,inboundLayers:h,nodeIndices:c,tensorIndices:d,inputTensors:o,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},s);for(let f=0;f<t.length;f++)t[f].sourceLayer=this,t[f].nodeIndex=this.inboundNodes.length-1,t[f].tensorIndex=f}getConfig(){let e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(null===this._refCount)throw Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return 0==--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}},8913:function(e,t,n){"use strict";n.d(t,{D:function(){return p},y:function(){return c}});var r=n(7671),a=n(8891),i=n(588),s=n(3146),o=n(2931),l=n(6529);function u(e,t){let n,a;n=t.xs,a=t.ys,r.D5U.assert(null!=n&&null!=a,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);let i=h("input",e.inputNames,n),s=h("output",e.outputNames,a),o=i[0].shape[0];r.D5U.assert(i.length===e.inputs.length,()=>`LayersModel has ${e.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(e.inputNames)})`),r.D5U.assert(s.length===e.outputs.length,()=>`LayersModel has ${e.outputs.length} outputs, but the dataset provides ${s.length} outputs.  (Expected output keys: ${JSON.stringify(e.outputNames)})`);for(let l=0;l<i.length;l++)r.D5U.assert(i[l].shape[0]===o,()=>`Batch size mismatch: input ${e.inputNames[l]} has ${i[l].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`);for(let u=0;u<s.length;u++)r.D5U.assert(s[u].shape[0]===o,()=>`Batch size mismatch: output ${e.outputNames[u]} has ${s[u].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`);return{xs:i,ys:s}}function h(e,t,n){if(n instanceof r.esB)return[n];if(Array.isArray(n))return r.D5U.assert(n.length===t.length,()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${e} keys ${t}.`),n;{let a=[];for(let s of t){if(null==n[s])throw new i.nu(`The feature data generated by the dataset lacks the required ${e} key '${s}'.`);a.push(n[s])}return a}}async function c(e,t,n){let h=null!=n.batchesPerEpoch;if(r.D5U.assert(null!=e.optimizer,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),r.D5U.assert(null!=n,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),r.D5U.assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),r.D5U.assert(!h||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),r.D5U.assert(null==n.validationSplit,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{let c,p,f,m;let g=null!=n.validationData;if(g){if(d(n.validationData))r.D5U.assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{let y=function(e){if(3===e.length)throw new i.nj("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}(n.validationData);c=y.xs,p=y.ys}}let b=e.makeTrainFunction(),x=e.getDedupedMetricsNames();f=g?x.slice().concat(x.map(e=>"val_"+e)):x.slice();let v=(0,a.CZ)(n.callbacks,n.yieldEvery),w=null==n.verbose?1:n.verbose,{callbackList:I,history:k}=(0,a.m$)(v,w,n.epochs,null,null,(m=null,null!=n.batchesPerEpoch?m=n.batchesPerEpoch:Number.isFinite(t.size)&&(m=t.size),m),null,g,f);I.setModel(e),e.history=k,await I.onTrainBegin(),e.stopTraining_=!1;let S=null==n.initialEpoch?0:n.initialEpoch,C=await t.iterator();for(;S<n.epochs;){let E={};await I.onEpochBegin(S);let T=0,$=0;for(h||(C=await t.iterator());!h||T<n.batchesPerEpoch;){let N=await C.next();if(h&&N.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${T} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(null!=N.value){let{xs:A,ys:D}=u(e,N.value),F={};F.batch=$,F.size=A[0].shape[0],await I.onBatchBegin($,F);let R=[];if(null!=n.classWeight){let _=(0,l.Vf)(n.classWeight,e.outputNames);for(let O=0;O<_.length;++O)R.push(await (0,l.tl)(D[O],null,_[O]))}let M=A.concat(D).concat(R),B=b(M);r.B90(M);for(let P=0;P<x.length;++P){let L=x[P],U=B[P];F[L]=U,r.CnY(U)}await I.onBatchEnd($,F),(0,s.i)(F),$++,T++}if(h?T>=n.batchesPerEpoch:N.done){if(g){let W;W=d(n.validationData)?(0,o.zZ)(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):(0,o.zZ)(e.evaluate(c,p,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let z=0;z<e.metricsNames.length;++z)E[`val_${e.metricsNames[z]}`]=W[z]}break}if(e.stopTraining_)break}if(await I.onEpochEnd(S,E),S++,e.stopTraining_)break}return await I.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function d(e){return"function"==typeof e.iterator}async function p(e,t,n){n=n||{};let a=null!=n.batches,s=e.testFunction,l=[];if(n.verbose>0)throw new i.nj("Verbose mode is not implemented yet.");r.D5U.assert(!a||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);let h="function"==typeof t.next?t:await t.iterator(),c=0,d=0;for(;!a||d<n.batches;){let p=await h.next();if(l=r.lub(()=>{if(p.value){let{xs:t,ys:n}=u(e,p.value),a=t.concat(n),i=r.lub(()=>s(a));if(r.B90(a),0===d)for(let o=0;o<i.length;++o)l.push((0,r.iD$)(0));let h=a[0].shape[0];for(let f=0;f<i.length;++f){let m=i[f],g=l[f];l[f]=r.lub(()=>r.IHx(l[f],r.dC7(h,m))),d>0&&r.B90(g)}r.B90(i),c+=h,++d}return l}),p.done){a&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let f=0;f<l.length;++f){let m=l[f];l[f]=r.hiC(l[f],c),r.B90(m)}return(0,o.Bq)(l)}},6347:function(e,t,n){"use strict";n.d(t,{R_:function(){return d},YV:function(){return m},YX:function(){return c},fQ:function(){return u},kS:function(){return g},sf:function(){return h},uU:function(){return f}});var r=n(7671),a=n(9840),i=n(8891),s=n(588),o=n(3146),l=n(6040);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function u(e){r.D5U.assert(e>0&&Number.isInteger(e),()=>`batchSize is required to be a positive integer, but got ${e}`)}function h(e,t,n){return null==e?[null]:Array.isArray(e)?e.map(e=>(0,a.c9)(e,t,n-t)):(0,a.c9)(e,t,n-t)}function c(e,t){return r.lub(()=>null==e?null:Array.isArray(e)?e.map(e=>c(e,t)):(0,a.Iq)(e,"int32"===t.dtype?t:r.pju(t,"int32")))}function d(e,t){let n=[],r=0,a=null;for(;r<e;)(a=r+t)>=e&&(a=e),n.push([r,a]),r=a;return n}async function p(e,t,n,u,h,p,f,m,g,y,b,x,v,w,I){let k;null==h&&(h=32),null==p&&(p=1),null==b&&(b=!0),null==v&&(v=0);let S=!1;if(null!=g&&null!=y&&(S=!0),null!=I&&(S=!0,null==w))throw new s.nu("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");let C=e.checkNumSamples(n,h,w,"steps_per_epoch");null!=C&&(k=(0,l.w6)(0,C)),null==f&&(f=1);let{callbackList:E,history:T}=(0,i.m$)(m,f,p,v,C,w,h,S,x);E.setModel(e),e.history=T,await E.onTrainBegin(),e.stopTraining_=!1;for(let $=v;$<p;++$){await E.onEpochBegin($);let N={};if(null!=w)throw new s.nj("stepsPerEpoch mode is not implemented yet.");{if("batch"===b)throw new s.nj("batch shuffling is not implemneted yet");b&&r.D5U.shuffle(k);let A=(0,r.RRF)(k),D=d(C,h);for(let F=0;F<D.length;++F){let R={};if(await E.onBatchBegin(F,R),r.lub(()=>{let i=D[F][0],s=D[F][1],o=(0,a.c9)(A,i,s-i);R.batch=F,R.size=s-i;let l=c(n,o),d=t(l);for(let p=0;p<u.length;++p){let f=u[p],m=d[p];R[f]=m,r.CnY(m)}if(F===D.length-1&&S){let b=e.testLoop(g,y,h);for(let x=0;x<u.length;++x){let v=u[x],w=b[x];r.CnY(w),N["val_"+v]=w}}}),await E.onBatchEnd(F,R),(0,o.i)(R),e.stopTraining_)break}A.dispose()}if(await E.onEpochEnd($,N),e.stopTraining_)break}return await E.onTrainEnd(),await e.history.syncData(),e.history}async function f(e,t,n,a={}){let o,l,c,d,f,m,y,b,x;if(e.isTraining)throw Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{let v,w,I;let k=null==a.batchSize?32:a.batchSize;u(k);let S=await e.standardizeUserData(t,n,a.sampleWeight,a.classWeight,!1,k);o=S[0],l=S[1],x=S[2];let C=!1;if(null!=a.validationData&&a.validationData.length>0){if(C=!0,2===a.validationData.length)f=a.validationData[0],m=a.validationData[1];else if(3===a.validationData.length)throw new s.nj("validationData including sample weights is not supported yet.");else throw new s.nu(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${a.validationData} is invalid.`);let E=await e.standardizeUserData(f,m,null,null,!0,k);y=E[0],b=E[1],v=y.concat(b)}else if(null!=a.validationSplit&&a.validationSplit>0&&a.validationSplit<1){C=!0;let T=Math.floor(o[0].shape[0]*(1-a.validationSplit)),$=o[0].shape[0];y=h(o,T,$),c=o,o=h(o,0,T),b=h(l,T,$),d=l,l=h(l,0,T),v=y.concat(b)}else null!=a.validationSteps&&(C=!0);let N=o.concat(l).concat(x);e.checkTrainableWeightsConsistency();let A=e.makeTrainFunction(),D=e.getDedupedMetricsNames();C?(e.makeTestFunction(),w=e.testFunction,I=D.slice().concat(D.map(e=>"val_"+e))):(w=null,v=[],I=D.slice());let F=(0,i.CZ)(a.callbacks,a.yieldEvery),R=await p(e,A,N,D,k,a.epochs,a.verbose,F,w,v,a.shuffle,I,a.initialEpoch,null,null);return R}finally{e.isTraining=!1,g(o,t),g(l,n),g(c,t),g(d,n),g(y,f),g(b,m),null!=x&&r.B90(x)}}function m(e){let t=[];e instanceof r.esB&&(e=[e]);for(let n=0;n<e.length;++n){let i=e[n];if(1===i.rank)t.push((0,a.dt)(i,1));else if(0===i.rank)throw Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");else t.push(i)}return t}function g(e,t){if(null==e)return;let n=[];if(t instanceof r.esB)n.push(t.id);else if(Array.isArray(t))t.forEach(e=>n.push(e.id));else if(null!=t)for(let a in t){let i=t[a];n.push(i.id)}let s=[];if(e instanceof r.esB)-1===n.indexOf(e.id)&&s.push(e);else if(Array.isArray(e))e.forEach(e=>{-1===n.indexOf(e.id)&&s.push(e)});else if(null!=e)for(let o in e){let l=e[o];-1===n.indexOf(l.id)&&s.push(l)}s.forEach(e=>{e.isDisposed||e.dispose()})}},6529:function(e,t,n){"use strict";n.d(t,{Vf:function(){return a},mo:function(){return s},tl:function(){return i}});var r=n(7671);function a(e,t){return(/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function(e,t,n){let r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map(e=>null);if(1===r)return Array.isArray(e)&&1===e.length?e:"object"==typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw Error(`Provided ${n} is an array of ${e.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return e}if("object"==typeof e&&Object.keys(e).length>0&&"object"==typeof e[Object.keys(e)[0]]){let a=[];return t.forEach(t=>{t in e?a.push(e[t]):a.push(null)}),a}throw Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(e)}`)}(e,t,"classWeight"))}async function i(e,t,n,a){if(null!=t||null!=a)throw Error("Support sampleWeight is not implemented yet");if(null==n)return null;{let i=(0,r.lub)(()=>{if(1===e.shape.length)return(0,r.d9v)(e);if(2===e.shape.length){if(e.shape[1]>1)return(0,r.NqF)(e,1);if(1===e.shape[1])return(0,r.XLQ)(e,[e.shape[0]]);throw Error(`Encountered unexpected last-dimension size (${e.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}throw Error(`Unexpected rank of target (y) tensor (${e.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),s=Array.from(await i.data());(0,r.B90)(i);let o=[];return s.forEach(e=>{if(null==n[e])throw Error(`classWeight must contain all classes in the training data. The class ${e} exists in the data but not in classWeight`);o.push(n[e])}),(0,r.RRF)(o,"float32")}}function s(e,t){return(0,r.dC7)(e,t)}},588:function(e,t,n){"use strict";n.d(t,{LH:function(){return a},j1:function(){return r},nj:function(){return s},nu:function(){return i},ps:function(){return o}});/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ class r extends Error{constructor(e){super(e),Object.setPrototypeOf(this,r.prototype)}}class a extends Error{constructor(e){super(e),Object.setPrototypeOf(this,a.prototype)}}class i extends Error{constructor(e){super(e),Object.setPrototypeOf(this,i.prototype)}}class s extends Error{constructor(e){super(e),Object.setPrototypeOf(this,s.prototype)}}class o extends Error{constructor(e){super(e),Object.setPrototypeOf(this,o.prototype)}}},3780:function(e,t,n){"use strict";n.d(t,{ug:function(){return r},FB:function(){return k},o4:function(){return w},Pe:function(){return I},H6:function(){return tX.i}});var r={};n.r(r),n.d(r,{Layer:function(){return h.mh},RNN:function(){return L.$p},RNNCell:function(){return L.ki},activation:function(){return e2},add:function(){return tt},alphaDropout:function(){return tj},average:function(){return tn},averagePooling1d:function(){return tc},averagePooling2d:function(){return tf},averagePooling3d:function(){return ty},avgPool1d:function(){return td},avgPool2d:function(){return tm},avgPool3d:function(){return tb},avgPooling1d:function(){return tp},avgPooling2d:function(){return tg},avgPooling3d:function(){return tx},batchNormalization:function(){return tl},bidirectional:function(){return tB},concatenate:function(){return tr},conv1d:function(){return eK},conv2d:function(){return eX},conv2dTranspose:function(){return eq},conv3d:function(){return eY},conv3dTranspose:function(){return eQ},convLstm2d:function(){return tR},convLstm2dCell:function(){return t_},cropping2D:function(){return eJ},dense:function(){return e3},depthwiseConv2d:function(){return e1},dot:function(){return to},dropout:function(){return e4},elu:function(){return eW},embedding:function(){return te},flatten:function(){return e5},gaussianDropout:function(){return tG},gaussianNoise:function(){return tV},globalAveragePooling1d:function(){return tv},globalAveragePooling2d:function(){return tw},globalMaxPool1d:function(){return tL},globalMaxPool2d:function(){return tU},globalMaxPooling1d:function(){return tI},globalMaxPooling2d:function(){return tk},gru:function(){return tT},gruCell:function(){return t$},input:function(){return S},inputLayer:function(){return eU},layerNormalization:function(){return tu},leakyReLU:function(){return eV},lstm:function(){return tN},lstmCell:function(){return tA},masking:function(){return tH},maxPool1d:function(){return tW},maxPool2d:function(){return tz},maxPooling1d:function(){return tS},maxPooling2d:function(){return tC},maxPooling3d:function(){return tE},maximum:function(){return ta},minimum:function(){return ti},multiply:function(){return ts},permute:function(){return e9},prelu:function(){return eG},reLU:function(){return ez},repeatVector:function(){return e7},rescaling:function(){return tK},reshape:function(){return e8},rnn:function(){return tO},separableConv2d:function(){return eZ},simpleRNN:function(){return tD},simpleRNNCell:function(){return tF},softmax:function(){return ej},spatialDropout1d:function(){return e6},stackedRNNCells:function(){return tM},thresholdedReLU:function(){return eH},timeDistributed:function(){return tP},upSampling2d:function(){return e0},zeroPadding2d:function(){return th}});var a=n(7671),i=n(1111);/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let s=(0,a.OBj)();s.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,i.kS),n(2904);var o=n(4079),l=n(2599),u=n(4396),h=n(163);n(8891);var c=n(5337),d=n(9608),p=n(588),f=n(9897),m=n(2931),g=n(1977),y=n(7538);async function b(e,t){if(null==t&&(t={}),"string"==typeof e){let n=a.io.getLoadHandlers(e,t);if(0===n.length)n.push(a.io.browserHTTPRequest(e,t));else if(n.length>1)throw new p.nu(`Found more than one (${n.length}) load handlers for URL '${e}'`);e=n[0]}return x(e,void 0,t)}async function x(e,t,n){if(null==n&&(n={}),null==e.load)throw new p.nu("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let r=await e.load(),i=r.modelTopology;null!=i.model_config&&(i=i.model_config);let s=null==n.strict||n.strict,o=null!=r.weightData&&null!=r.weightSpecs&&s,l=(0,f.v)((0,g.a)(i),t,o),u=r.trainingConfig;if(null!=u&&l.loadTrainingConfig(u),null!=r.userDefinedMetadata&&l.setUserDefinedMetadata(r.userDefinedMetadata),null!=r.weightData){if(null==r.weightSpecs)throw new p.nu("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");let{modelWeights:h,optimizerWeights:c}=function(e,t){let n=a.io.decodeWeights(e,t),r={},i=[];return t.forEach(e=>{"optimizer"===e.group?i.push({name:e.name,tensor:n[e.name]}):r[e.name]=n[e.name]}),{modelWeights:r,optimizerWeights:i}}(r.weightData,r.weightSpecs);l.loadWeights(h,s),null!=l.optimizer&&c.length>0&&await l.optimizer.setWeights(c),(0,a.B90)(h),(0,a.B90)(c.map(e=>e.tensor))}return l}class v extends c.QV{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=null!=e.name?e.name:(0,d.s)("sequential_"),null!=e.layers)for(let t of e.layers)this.add(t)}checkShape(e){let t=e.inboundNodes[0].outputTensors[0].shape;if(t.some(e=>e<0))throw new p.nu(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){let t;let n=e instanceof v||e instanceof c.QV;if(n){if(1!==(t=e).outputs.length)throw new p.nu("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==t.inputs.length)throw new p.nu("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new p.nu("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");let r=(0,u.I)({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(n)this.outputs=t.outputs,this.inputs=t.inputs;else{if(1!==e.inboundNodes.length)throw new p.nu(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(1!==e.inboundNodes[0].outputTensors.length)throw new p.nu("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=(0,h.hA)(this.outputs[0])}this.inboundNodes=[],new h.NB({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:m.JE(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(e=>e.shape),outputShapes:this.outputs[0].shape})}else{let a=e.apply(this.outputs[0]);if(Array.isArray(a))throw TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[a],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(0===this.layers.length)throw TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{let e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return null==this.model&&this.build(),this.model.call(e,t)}build(e){if((0,y.Wf)(e),0===this.inputs.length||0===this.outputs.length)throw TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new c.QV({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,n=console.log){this.built||this.build(),super.summary(e,t,n)}setWeights(e){null==this.model&&this.build(),this.model.setWeights(e)}evaluate(e,t,n={}){if(!this.built)throw new p.LH("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}async evaluateDataset(e,t){if(!this.built)throw new p.LH("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return null==this.model&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,n={}){if(!this.built)throw new p.LH("The model needs to be compiled before being used.");return this.model.fit(e,t,n)}async fitDataset(e,t){if(!this.built)throw new p.LH("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,n={},r=!1){let i;let s={};if(t instanceof Array){if(!(null!=t[0].className)||"Merge"===t[0].className)throw new p.nu("Legacy serialization format not supported yet.");i=t}else a.D5U.assert(null!=t.layers,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=t.layers,delete t.layers,s=t;let o=new e(s);if(!(o instanceof v))throw new p.nj(`Sequential.fromConfig called on non-Sequential input: ${o}`);for(let l of i){let u=void 0,h=(0,f.v)(l,u,r);r&&h.setFastWeightInitDuringBuild(!0),o.add(h)}return o}set stopTraining(e){if(null==this.model)throw new p.nu("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(null==this.model)throw new p.nu("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){let e=[];for(let t of this.layers){let n={};n.className=t.getClassName(),n.config=t.getConfig(),e.push(n)}return{name:this.name,layers:e}}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function w(e){return new c.QV(e)}function I(e){return new v(e)}function k(e,t){return null==t&&(t={}),b(e,t)}function S(e){return(0,u.I)(e)}v.className="Sequential",a.m7h.registerClass(v);var C=n(8819),E=n(539);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ class T extends h.mh{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,null!=e&&(this.maxValue=e.maxValue)}call(e,t){e=(0,y.nQ)(e);let n=(0,a.UYe)(e);return null!=this.maxValue&&(n=(0,a.iUl)(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){let e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}T.className="ReLU",a.m7h.registerClass(T);class $ extends h.mh{constructor(e){super(null==e?{}:e),this.DEFAULT_ALPHA=.3,null==e&&(e={}),this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){let n=(0,y.nQ)(e);return(0,a.hi7)(n,this.alpha)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}$.className="LeakyReLU",a.m7h.registerClass($);class N extends h.mh{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),this.supportsMasking=!0,this.alphaInitializer=(0,l.L5)(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=(0,E.EC)(e.alphaRegularizer),this.alphaConstraint=(0,o.Ad)(e.alphaConstraint),null==e.sharedAxes)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if("number"==typeof e.sharedAxes)this.sharedAxes=[e.sharedAxes];else throw new p.nu(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=(0,y.Wf)(e);let t=e.slice(1);if(null!=this.sharedAxes)for(let n of this.sharedAxes)t[n-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);let r={};if(null!=this.sharedAxes)for(let a=1;a<e.length;++a)r[a]=e[a];this.inputSpec=[new h.Zg({ndim:e.length,axes:r})],this.built=!0}call(e,t){return e=(0,y.nQ)(e),(0,a.AL3)(e,this.alpha.read())}getConfig(){let e={alphaInitializer:(0,l.Cx)(this.alphaInitializer),alphaRegularizer:(0,E.SG)(this.alphaRegularizer),alphaConstraint:(0,o.xF)(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}N.className="PReLU",a.m7h.registerClass(N);class A extends h.mh{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==this.DEFAULT_ALPHA)throw new p.nj(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){let n=(0,y.nQ)(e);return(0,a.pyx)(n)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}A.className="ELU",a.m7h.registerClass(A);class D extends h.mh{constructor(e){super(null==e?{}:e),this.DEFAULT_THETA=1,null==e&&(e={}),this.theta=null==e.theta?this.DEFAULT_THETA:e.theta}call(e,t){let n=(0,y.nQ)(e);return(0,a.dC7)(n,(0,a.pju)((0,a.pjt)(n,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){let e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}D.className="ThresholdedReLU",a.m7h.registerClass(D);class F extends h.mh{constructor(e){super(null==e?{}:e),this.DEFAULT_AXIS=1,null==e&&(e={}),this.softmax=new C.Gc().apply,this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis}call(e,t){let n=(0,y.nQ)(e);return this.softmax(n,this.axis)}computeOutputShape(e){return e}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}F.className="Softmax",a.m7h.registerClass(F);var R=n(5650),_=n(2012),O=n(9840),M=n(8090),B=n(6517);class P extends R.nx{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=(0,l.L5)(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=(0,o.Ad)(e.depthwiseConstraint),this.depthwiseRegularizer=(0,E.EC)(e.depthwiseRegularizer)}build(e){if((e=(0,y.Wf)(e)).length<4)throw new p.nu(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);let t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new p.nu(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);let n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return(0,a.lub)(()=>{let t=/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function(e,t,n=[1,1],r="valid",i,s){return(0,a.lub)(()=>{null==i&&(i=(0,_.rf)()),(0,M.cj)(i);let s=(0,R.aP)(e,i);if(4!==e.rank)throw new p.nu(`Input for depthwiseConv2d is required to be 4-D, but is instead ${e.rank}-D`);if(4!==t.rank)throw new p.nu(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return s=a.B10(s,t,n,"same"===r?"same":"valid","NHWC",null),"channelsFirst"===i&&(s=a.p4s(s,[0,3,1,2])),s})}(e=(0,y.nQ)(e),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,0);return this.useBias&&(t=O.a2(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),t})}computeOutputShape(e){e=(0,y.Wf)(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=(0,B.kt)(t,this.kernelSize[0],this.padding,this.strides[0]),i=(0,B.kt)(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,a,i]:[e[0],a,i,r]}getConfig(){let e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=(0,l.Cx)(this.depthwiseInitializer),e.depthwiseRegularizer=(0,E.SG)(this.depthwiseRegularizer),e.depthwiseConstraint=(0,o.xF)(this.depthwiseRegularizer),e}}P.className="DepthwiseConv2D",a.m7h.registerClass(P);var L=n(6014),U=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)0>t.indexOf(r[a])&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n};class W extends L.$p{constructor(e){if(e.unroll)throw new p.nj("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new p.nj("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new h.Zg({ndim:5})]}call(e,t){return a.lub(()=>{if(null!=this.cell.dropoutMask&&(a.B90(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(a.B90(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new p.nu("ConvRNN2D cell does not support constants");let n=null==t?null:t.mask,r=null==t?null:t.training,i=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:i})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...[,,].fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return a.lub(()=>{let{stateSize:t}=this.cell,n=e.shape,r=this.computeSingleOutputShape(n),i=[r[0],...r.slice(2)],s=a.lls(i);return Array.isArray(t)?Array(t.length).fill(s):[s]})}resetStates(e,t=!1){a.lub(()=>{if(!this.stateful)throw new p.j1("Cannot call resetStates() on an RNN Layer that is not stateful.");let n=this.inputSpec[0].shape,r=this.computeSingleOutputShape(n),i=[r[0],...r.slice(2)],s=n[0];if(null==s)throw new p.nu("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>a.lls(i)):this.states_=[a.lls(i)];else if(null==e)a.B90(this.states_),null!=this.keptStates&&(a.B90(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>a.lls(i)):this.states_[0]=a.lls(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new p.nu(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):a.B90(this.states_);for(let o=0;o<this.states_.length;++o){let l=e[o];if(!a.D5U.arraysEqual(l.shape,i))throw new p.nu(`State ${o} is incompatible with layer ${this.name}: expected shape=${i}, received shape=${l.shape}`);this.states_[o]=l}}this.states_=this.states_.map(e=>a.CnY(e.clone()))})}computeSingleOutputShape(e){let{dataFormat:t,filters:n,kernelSize:r,padding:a,strides:i,dilationRate:s}=this.cell,o="channelsFirst"===t,l=e[o?3:2],u=e[o?4:3],h=(0,B.kt)(l,r[0],a,i[0],s[0]),c=(0,B.kt)(u,r[1],a,i[1],s[1]),d=[...e.slice(0,2),...o?[n,h,c]:[h,c,n]];return d}}W.className="ConvRNN2D";class z extends L.U7{constructor(e){let{filters:t,kernelSize:n,strides:r,padding:a,dataFormat:i,dilationRate:s}=e;super(Object.assign({},e,{units:t})),this.filters=t,(0,m.iQ)(this.filters,"filters"),this.kernelSize=(0,B.AF)(n,2,"kernelSize"),this.kernelSize.forEach(e=>(0,m.iQ)(e,"kernelSize")),this.strides=(0,B.AF)(r||1,2,"strides"),this.strides.forEach(e=>(0,m.iQ)(e,"strides")),this.padding=a||"valid",(0,M.zb)(this.padding),this.dataFormat=i||"channelsLast",(0,M.cj)(this.dataFormat),this.dilationRate=(0,B.AF)(s||1,2,"dilationRate"),this.dilationRate.forEach(e=>(0,m.iQ)(e,"dilationRate"))}build(e){var t;e=(0,y.Wf)(e);let n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new p.nu(`The channel dimension of the input should be defined. Found ${e[n]}`);let r=e[n],i=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);let s=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",s,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let o;if(this.unitForgetBias){let u=this.biasInitializer,h=this.filters;o=new((t=class extends l.m7{apply(e,t){let n=u.apply([h]),r=a.iUs([h]),i=u.apply([2*h]);return O.mV([n,r,i])}}).className="CustomInit",t)}else o=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,o,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return a.lub(()=>{if(3!==e.length)throw new p.nu(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let n=t.training||!1,r=e[0],i=e[1],s=e[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=(0,L._0)({ones:()=>a.JpU(r),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let o=this.dropoutMask,l=(e,t,n)=>t&&t[n]?a.dC7(t[n],e):e,u=l(r,o,0),h=l(r,o,1),c=l(r,o,2),d=l(r,o,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=(0,L._0)({ones:()=>a.JpU(i),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let f=this.recurrentDropoutMask,m=l(i,f,0),g=l(i,f,1),y=l(i,f,2),b=l(i,f,3),[x,v,w,I]=a.Vl2(this.kernel.read(),4,3),[k,S,C,E]=this.useBias?a.Vl2(this.bias.read(),4):[null,null,null,null];u=this.inputConv(u,x,k,this.padding),h=this.inputConv(h,v,S,this.padding),c=this.inputConv(c,w,C,this.padding),d=this.inputConv(d,I,E,this.padding);let[T,$,N,A]=a.Vl2(this.recurrentKernel.read(),4,3);m=this.recurrentConv(m,T),g=this.recurrentConv(g,$),y=this.recurrentConv(y,N),b=this.recurrentConv(b,A);let D=this.recurrentActivation.apply(a.IHx(u,m)),F=this.recurrentActivation.apply(a.IHx(h,g)),R=a.IHx(a.dC7(F,s),a.dC7(D,this.activation.apply(a.IHx(c,y)))),_=a.dC7(this.recurrentActivation.apply(a.IHx(d,b)),this.activation.apply(R));return[_,_,R]})}getConfig(){let e=super.getConfig(),{units:t}=e,n=U(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign({},n,r)}inputConv(e,t,n,r){let i=a.Tek(e,t,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?O.a2(i,n,this.dataFormat):i}recurrentConv(e,t){return a.Tek(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}z.className="ConvLSTM2DCell",a.m7h.registerClass(z);class V extends W{constructor(e){let t=new z(e);super(Object.assign({},e,{cell:t}))}static fromConfig(e,t){return new e(t)}}V.className="ConvLSTM2D",a.m7h.registerClass(V);var G=n(6040);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ class j extends h.mh{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(null==this.noiseShape)return this.noiseShape;let t=e.shape,n=[];for(let r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n}call(e,t){return(0,a.lub)(()=>{this.invokeCallHook(e,t);let n=(0,y.nQ)(e);if(0<this.rate&&this.rate<1){let r=null!=t.training&&t.training,a=this.getNoiseShape(n),i=O.KC(()=>O.rv(n,this.rate,a,this.seed),()=>n,r);return i}return e})}getConfig(){let e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}j.className="Dropout",a.m7h.registerClass(j);class H extends j{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){let t=e.shape;return[t[0],1,t[2]]}}H.className="SpatialDropout1D",a.m7h.registerClass(H);class K extends h.mh{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){let t=null;null!=e.batchSize&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,(0,m.iQ)(this.units,"units"),this.activation=(0,C.aI)(e.activation),null!=e.useBias&&(this.useBias=e.useBias),this.kernelInitializer=(0,l.L5)(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=(0,l.L5)(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=(0,o.Ad)(e.kernelConstraint),this.biasConstraint=(0,o.Ad)(e.biasConstraint),this.kernelRegularizer=(0,E.EC)(e.kernelRegularizer),this.biasRegularizer=(0,E.EC)(e.biasRegularizer),this.activityRegularizer=(0,E.EC)(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=(0,y.Wf)(e);let t=e[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=(0,y.Wf)(e);let t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return(0,a.lub)(()=>{let n;this.invokeCallHook(e,t);let r=(0,y.nQ)(e),a=(0,m.WT)(this.activation.getClassName());return null!=a?n=O.AK(r,this.kernel.read(),a,this.bias?this.bias.read():null):(n=O.AK(r,this.kernel.read()),null!=this.bias&&(n=O.a2(n,this.bias.read())),null!=this.activation&&(n=this.activation.apply(n))),n})}getConfig(){let e={units:this.units,activation:(0,C.GD)(this.activation),useBias:this.useBias,kernelInitializer:(0,l.Cx)(this.kernelInitializer),biasInitializer:(0,l.Cx)(this.biasInitializer),kernelRegularizer:(0,E.SG)(this.kernelRegularizer),biasRegularizer:(0,E.SG)(this.biasRegularizer),activityRegularizer:(0,E.SG)(this.activityRegularizer),kernelConstraint:(0,o.xF)(this.kernelConstraint),biasConstraint:(0,o.xF)(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}K.className="Dense",a.m7h.registerClass(K);class X extends h.mh{constructor(e){super(e=e||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){for(let t of(e=(0,y.Wf)(e)).slice(1))if(null==t)throw new p.nu(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],(0,G.NS)(e,1)]}call(e,t){return(0,a.lub)(()=>{this.invokeCallHook(e,t);let n=(0,y.nQ)(e);if("channelsFirst"===this.dataFormat&&n.rank>1){let r=[0];for(let i=2;i<n.rank;++i)r.push(i);r.push(1),n=(0,a.p4s)(n,r)}return O.Uz(n)})}getConfig(){let e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);let t=super.getConfig();return Object.assign(e,t),e}}X.className="Flatten",a.m7h.registerClass(X);class q extends h.mh{constructor(e){super(e),this.supportsMasking=!0,this.activation=(0,C.aI)(e.activation)}call(e,t){return(0,a.lub)(()=>{this.invokeCallHook(e,t);let n=(0,y.nQ)(e);return this.activation.apply(n)})}getConfig(){let e={activation:(0,C.GD)(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}q.className="Activation",a.m7h.registerClass(q);class Y extends h.mh{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return(0,a.lub)(()=>(e=(0,y.nQ)(e),O.rx(e,this.n)))}getConfig(){let e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}Y.className="RepeatVector",a.m7h.registerClass(Y);class Q extends h.mh{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||null==e}fixUnknownDimension(e,t){let n="Total size of new array must be unchanged.",r=t.slice(),a=1,i=null;for(let s=0;s<r.length;++s){let o=r[s];if(this.isUnknown(o)){if(null===i)i=s;else throw new p.nu("Can only specifiy one unknown dimension.")}else a*=o}let l=(0,G.NS)(e);if(null!==i){if(0===a||l%a!=0)throw new p.nu(n);r[i]=l/a}else if(l!==a)throw new p.nu(n);return r}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return(0,a.lub)(()=>{this.invokeCallHook(e,t);let n=(0,y.nQ)(e),r=n.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return(0,a.XLQ)(n,i)})}getConfig(){let e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}Q.className="Reshape",a.m7h.registerClass(Q);class Z extends h.mh{constructor(e){if(super(e),null==e.dims)throw Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);let t=(0,G.w6)(1,e.dims.length+1);if(!a.D5U.arraysEqual(e.dims.slice().sort(),t))throw Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new h.Zg({ndim:this.dims.length+1})]}computeOutputShape(e){e=(0,y.Wf)(e);let t=e.slice();return this.dims.forEach((n,r)=>{t[r+1]=e[n]}),t}call(e,t){return(0,a.p4s)((0,y.nQ)(e),this.dimsIncludingBatch)}getConfig(){let e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}Z.className="Permute",a.m7h.registerClass(Z);class J extends h.mh{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,null!=e?this.maskValue=null==e.maskValue?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){let n=(0,y.nQ)(e);return(0,a.YjB)((0,a.Quu)(n,this.maskValue),-1)}call(e,t){return(0,a.lub)(()=>{this.invokeCallHook(e,t);let n=(0,y.nQ)(e),r=(0,a.YjB)((0,a.Quu)(n,this.maskValue),-1,!0),i=(0,a.dC7)(n,(0,a.pju)(r,n.dtype));return i})}}J.className="Masking",a.m7h.registerClass(J);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ class ee extends h.mh{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){let t=null;null!=e.batchSize&&(t=e.batchSize),null==e.inputLength?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(m.zZ(e.inputLength))}this.inputDim=e.inputDim,m.iQ(this.inputDim,"inputDim"),this.outputDim=e.outputDim,m.iQ(this.outputDim,"outputDim"),this.embeddingsInitializer=(0,l.L5)(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=(0,E.EC)(e.embeddingsRegularizer),this.activityRegularizer=(0,E.EC)(e.activityRegularizer),this.embeddingsConstraint=(0,o.Ad)(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return(0,a.lub)(()=>this.maskZero?(e=(0,y.nQ)(e),(0,a.Quu)(e,(0,a.P84)(e))):null)}computeOutputShape(e){if(e=(0,y.Wf)(e),null==this.inputLength)return[...e,this.outputDim];let t=m.zZ(this.inputLength);if(t.length!==e.length-1)throw new p.nu(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let n=0;for(let r=0;r<t.length;++r){let a=t[r],i=e[r+1];if(null!=a&&null!=i&&a!==i)throw new p.nu(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);null==a&&(t[n]=i),n++}}return[e[0],...t,this.outputDim]}call(e,t){return(0,a.lub)(()=>{this.invokeCallHook(e,t);let n=(0,y.nQ)(e);"int32"!==n.dtype&&(n=O.pj(n,"int32"));let r=O.Iq(this.embeddings.read(),(0,a.XLQ)(n,[n.size]));return(0,a.XLQ)(r,(0,y.Wf)(this.computeOutputShape(n.shape)))})}getConfig(){let e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:(0,l.Cx)(this.embeddingsInitializer),embeddingsRegularizer:(0,E.SG)(this.embeddingsRegularizer),activityRegularizer:(0,E.SG)(this.activityRegularizer),embeddingsConstraint:(0,o.xF)(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}ee.className="Embedding",a.m7h.registerClass(ee);var et=n(6275);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ class en extends h.mh{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new p.nj}computeElementwiseOpOutputShape(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;let n=e.slice(0,e.length-t.length);for(let r=0;r<t.length;++r){let a=e[e.length-t.length+r],i=t[r];if(null==a||null==i||a<0||i<0)n.push(null);else if(1===a)n.push(i);else if(1===i)n.push(a);else{if(a!==i)throw new p.nu("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(a)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[(0,y.Wf)(e)]),e.length<2)throw new p.nu(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(let n of e)null!=n&&null!==n[0]&&t.push(n[0]);if((t=m.Tw(t)).length>1)throw new p.nu(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let r=null==e[0]?null:e[0].slice(1);for(let a=1;a<e.length;++a){let i=null==e[a]?null:e[a].slice(1);r=this.computeElementwiseOpOutputShape(r,i)}let s=e.map(e=>e.length);-1===e.indexOf(null)&&1===m.Tw(s).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return(0,a.lub)(()=>{if(!this.reshapeRequired)return this.mergeFunction(e);{let t=[],n=e.map(e=>e.rank);if(-1===n.indexOf(null)){let r=G.Fp(n);for(let i of e){let s=i.rank;for(let o=0;o<r-s;++o)i=O.dt(i,1);t.push(i)}return this.mergeFunction(t)}{let l=!1;for(let u of e){let h=u.rank;if(null==h){let c=u.shape,d=c[0],p=c.slice(1).concat([d]),f=a.XLQ(u,[d].concat(G.NS(c.slice(1))));f=a.p4s(f,[1,0]),f=a.XLQ(f,p),t.push(f),l=!0}else if(h>1){let m=G.w6(1,h).concat([0]);t.push(a.p4s(u,m)),l=!0}else t.push(u)}let g=this.mergeFunction(t),y=g.rank;if(l){if(null==y){let b=g.shape,x=b.length,v=b[x-1],w=[v].concat(b.slice(0,b.length-1));g=a.XLQ(a.p4s(a.XLQ(g,[-1,v]),[1,0]),w)}else if(y>1){let I=[y-1].concat(G.w6(0,y-1));g=a.p4s(g,I)}}return g}}})}computeOutputShape(e){let t;t=null==e[0]?null:e[0].slice(1);for(let n=1;n<e.length;++n){let r=null==e[n]?null:e[n].slice(1);t=this.computeElementwiseOpOutputShape(t,r)}let a=[];for(let i of e)null!=i&&null!==i[0]&&a.push(i[0]);return 1===(a=m.Tw(a)).length?a.concat(t):[null].concat(t)}computeMask(e,t){return a.lub(()=>{if(null==t)return null;if(!Array.isArray(t))throw new p.nu("`mask` should be an Array");if(!Array.isArray(e))throw new p.nu("`inputs` should be an Array");if(t.length!==e.length)throw new p.nu(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every(e=>null==e))return null;let n=(t=t.map(e=>null==e?e:a.dt4(e,0)))[0];for(let r=1;r<t.length-1;++r)n=a.HvI(n,t[r]);return n})}}class er extends en{constructor(e){super(e)}mergeFunction(e){return(0,a.lub)(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=a.IHx(t,e[n]);return t})}}er.className="Add",a.m7h.registerClass(er);class ea extends en{constructor(e){super(e)}mergeFunction(e){return(0,a.lub)(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=a.dC7(t,e[n]);return t})}}ea.className="Multiply",a.m7h.registerClass(ea);class ei extends en{constructor(e){super(e)}mergeFunction(e){return(0,a.lub)(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=a.IHx(t,e[n]);return a.dC7(1/e.length,t)})}}ei.className="Average",a.m7h.registerClass(ei);class es extends en{constructor(e){super(e)}mergeFunction(e){return(0,a.lub)(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=a.gWQ(t,e[n]);return t})}}es.className="Maximum",a.m7h.registerClass(es);class eo extends en{constructor(e){super(e)}mergeFunction(e){return(0,a.lub)(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=a.LTh(t,e[n]);return t})}}eo.className="Minimum",a.m7h.registerClass(eo);class el extends en{constructor(e){super(e),this.DEFAULT_AXIS=-1,null==e&&(e={}),this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||1===e.length)throw new p.nu("A `Concatenate` layer should be called on a list of at least 2 inputs");let t=!0;for(let n of e)if(null!=n){t=!1;break}if(t)return;let r=[];for(let i=0;i<e.length;++i){let s=e[i].slice();s.splice(this.axis,1);let o=!1;for(let l of r)if(a.D5U.arraysEqual(l,s)){o=!0;break}o||r.push(s)}if(r.length>1)throw new p.nu("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return(0,a.lub)(()=>O.mV(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new p.nu("A `Concatenate` layer should be called on a list of inputs.");let t=e[0].slice(),n=this.axis<0?t.length+this.axis:this.axis;for(let r of e.slice(1)){if(null==t[n]||null==r[n]){t[n]=null;break}t[n]+=r[n]}return t}computeMask(e,t){if(null==t)return null;if(!Array.isArray(t))throw new p.nu("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new p.nu("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new p.nu(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return a.lub(()=>{let n=!0;if(t.forEach(e=>{if(null!=e){n=!1;return}}),n)return null;let r=[];for(let i=0;i<e.length;++i)null==t[i]?r.push(a.pju(a.JpU(e[i]),"bool")):t[i].rank<e[i].rank?r.push(a.dt4(t[i],-1)):r.push(t[i]);let s=a.zoF(r,this.axis);return a.$6P(s,-1,!1)})}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}function eu(e,t){for(;e<0;)e+=t;return e}el.className="Concatenate",a.m7h.registerClass(el);class eh extends en{constructor(e){super(e),this.axes=e.axes,this.normalize=null!=e.normalize&&e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){a.D5U.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0],n=e[1];if(t.length>3||n.length>3)throw new p.nj("Dot layer does not support tensors of 4D or higher rank yet.");let r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new p.nu(`Dimension incompatibility: ${t[r[0]]} !== ${n[r[1]]}`)}mergeFunction(e){let t;if(2!==e.length)throw new p.nu(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map((t,n)=>eu(t,e[n].shape.length)):[eu(this.axes,n.shape.length),eu(this.axes,r.shape.length)],this.normalize&&(n=(0,et.Eq)(n,t[0]),r=(0,et.Eq)(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new p.nj("batchDot is not implemented for tensors of 4D or higher rank yet");if(a.D5U.assert(e.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${e.shape.length}`),a.D5U.assert(e.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),"number"==typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new p.nj("batchDot is not implemented for complex64-type Tensors yet.");let r=e.shape.length,i=t.shape.length;null==n&&(n=[r-1,i-2]);let s=n;return a.lub(()=>{let n,o;if(r>i){n=r-i;let l=[];for(let u=0;u<n;++u)l.push(1);t=a.XLQ(t,t.shape.concat(l))}else if(i>r){n=i-r;let h=[];for(let c=0;c<n;++c)h.push(1);e=a.XLQ(e,e.shape.concat(h))}else n=0;if(2===e.shape.length&&2===t.shape.length)o=s[0]===s[1]?a.Smz(a.dC7(e,t),s[0]):a.Smz(a.dC7(a.p4s(e,[1,0]),t),s[1]);else{let d=s[0]!==e.shape.length-1,p=s[1]===t.shape.length-1;o=a.OI3(e,t,d,p)}if(n>0){let f;f=r>i?r+i-3:r-1;let m=[];for(let g=f;g<f+n;++g)m.push(g);o=a.L9e(o,m)}return 1===o.shape.length&&(o=a.dt4(o,1)),o})}(n,r,t)}interpretAxes(e,t){return Array.isArray(this.axes)?this.axes:[eu(this.axes,e.length),eu(this.axes,t.length)]}computeOutputShape(e){a.D5U.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new p.nj("Dot layer does not support tensors of 4D or higher rank yet.");let r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);let i=t.concat(n);return 1===i.length&&i.push(1),i}computeMask(e,t){return null}getConfig(){let e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}eh.className="Dot",a.m7h.registerClass(eh);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ class ec extends h.mh{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return(0,a.lub)(()=>{this.invokeCallHook(e,t);let n=(0,y.nQ)(e),r=()=>(0,a.IHx)(O.nG(n.shape,0,this.stddev),n),i=O.KC(r,()=>n,t.training||!1);return i})}}ec.className="GaussianNoise",a.m7h.registerClass(ec);class ed extends h.mh{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return(0,a.lub)(()=>{this.invokeCallHook(e,t);let n=(0,y.nQ)(e);if(this.rate>0&&this.rate<1){let r=()=>{let e=Math.sqrt(this.rate/(1-this.rate));return(0,a.dC7)(n,O.nG(n.shape,1,e))};return O.KC(r,()=>n,t.training||!1)}return n})}}ed.className="GaussianDropout",a.m7h.registerClass(ed);class ep extends h.mh{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||(0,y.nQ)(e).shape}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return(0,a.lub)(()=>{if(this.rate<1&&this.rate>0){let n=this._getNoiseShape(e),r=()=>{let t=(0,y.nQ)(e),r=(0,a.brS)((0,a.LGj)(n),this.rate);r=O.pj(r,"float32");let i=((1-this.rate)*(1+3.09091329228798*this.rate))**-.5,s=-(-1.7580993408473766*i)*this.rate,o=(0,a.IHx)((0,a.dC7)(t,r),(0,a.dC7)((0,a.IHx)(r,-1),-1.7580993408473766));return(0,a.IHx)((0,a.dC7)(o,i),s)};return O.KC(r,()=>(0,y.nQ)(e),t.training||!1)}return e})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function ef(e,t,n,r,i,s=.001){let o;if(2===e.rank)o=a.Dxk(e,t,n,r,i,s);else if(3===e.rank)o=a.JY5(e,t,n,r,i,s);else if(4===e.rank)o=a.p3b(e,t,n,r,i,s);else throw new p.nj(`batchNormalization is not implemented for array of rank ${e.rank} yet`);return o}ep.className="AlphaDropout",a.m7h.registerClass(ep);class em extends h.mh{constructor(e){null==e&&(e={}),super(e),this.supportsMasking=!0,this.axis=null==e.axis?-1:e.axis,this.momentum=null==e.momentum?.99:e.momentum,this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=(0,l.L5)(e.betaInitializer||"zeros"),this.gammaInitializer=(0,l.L5)(e.gammaInitializer||"ones"),this.movingMeanInitializer=(0,l.L5)(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=(0,l.L5)(e.movingVarianceInitializer||"ones"),this.betaConstraint=(0,o.Ad)(e.betaConstraint),this.gammaConstraint=(0,o.Ad)(e.gammaConstraint),this.betaRegularizer=(0,E.EC)(e.betaRegularizer),this.gammaRegularizer=(0,E.EC)(e.gammaRegularizer)}build(e){e=(0,y.Wf)(e);let t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new p.nu(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new h.Zg({ndim:e.length,axes:{[t]:n}})];let r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return(0,a.lub)(()=>{let n=null!=t.training&&t.training,r=(0,y.nQ)(e),i=r.shape,s=i.length,o=G.w6(0,s),l=this.axis>=0?this.axis:this.axis+s;o.splice(l,1);let u=m.JE(1,s);u[l]=i[l];let h=o.slice();h.sort();let c=!a.D5U.arraysEqual(h,G.w6(0,s).slice(0,s-1));if(!n)return(()=>{if(!c)return ef(r,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon);{let e=(0,a.XLQ)(this.movingMean.read(),u),t=(0,a.XLQ)(this.movingVariance.read(),u),n=this.center?(0,a.XLQ)(this.beta.read(),u):null,i=this.scale?(0,a.XLQ)(this.gamma.read(),u):null;return ef(r,e,t,n,i,this.epsilon)}})();let[d,p,f]=function(e,t,n,r,i=.001){return a.D5U.arraysEqual(r.slice().sort(),G.w6(0,e.rank-1))?function(e,t,n,r,i=.001){return(0,a.lub)(()=>{let s=a.Gi7(e,r),o=s.mean,l=s.variance,u=ef(e,o,l,n,t,i);return[u,o,l]})}(e,t,n,r,i):function(e,t,n,r,i=.001){return(0,a.lub)(()=>{let s=a.Gi7(e,r),o=s.mean,l=s.variance,u=[];for(let h of G.w6(0,e.rank))-1!==r.indexOf(h)?u.push(1):u.push(e.shape[h]);let c=(0,a.XLQ)(o,u),d=(0,a.XLQ)(l,u),p=null==t?null:(0,a.XLQ)(t,u),f=null==n?null:(0,a.XLQ)(n,u),m=ef(e,c,d,f,p,i);return[m,o,l]})}(e,t,n,r,i)}(r,this.gamma.read(),this.beta.read(),o,this.epsilon),g=(e,t,n)=>{a.lub(()=>{let r=e.read(),i=a.dC7(a.luU(r,t),1-n);e.write(a.luU(r,i))})};return(()=>{g(this.movingMean,p,this.momentum),g(this.movingVariance,f,this.momentum)})(),d})}getConfig(){let e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:(0,l.Cx)(this.betaInitializer),gammaInitializer:(0,l.Cx)(this.gammaInitializer),movingMeanInitializer:(0,l.Cx)(this.movingMeanInitializer),movingVarianceInitializer:(0,l.Cx)(this.movingVarianceInitializer),betaRegularizer:(0,E.SG)(this.betaRegularizer),gammaRegularizer:(0,E.SG)(this.gammaRegularizer),betaConstraint:(0,o.xF)(this.betaConstraint),gammaConstraint:(0,o.xF)(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}em.className="BatchNormalization",a.m7h.registerClass(em);class eg extends h.mh{constructor(e){if(null==e&&(e={}),super(e),this.axis=null==e.axis?-1:e.axis,"number"==typeof this.axis){if(!Number.isInteger(this.axis))throw Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(let t of this.axis)if(!Number.isInteger(t))throw Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=(0,l.L5)(e.betaInitializer||"zeros"),this.gammaInitializer=(0,l.L5)(e.gammaInitializer||"ones"),this.betaRegularizer=(0,E.EC)(e.betaRegularizer),this.gammaRegularizer=(0,E.EC)(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=(0,y.Wf)(e);let t=e.length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(let n=0;n<this.axis.length;++n)this.axis[n]<0&&(this.axis[n]+=t);for(let r of this.axis)if(r<0||r>=t)throw Error(`Invalid axis: ${r}`);if(this.axis.length!==m.Tw(this.axis).length)throw Error(`Found duplicate axes in: ${this.axis}`);let a=this.axis.map(t=>e[t]);this.scale?this.gamma=this.addWeight("gamma",a,"float32",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight("beta",a,"float32",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0}call(e,t){let n=(0,y.nQ)(e),r=n.shape,i=r.length;return(0,a.lub)(()=>{let{mean:e,variance:t}=(0,a.Gi7)(n,this.axis,!0),s=m.JE(1,i);for(let o of this.axis)s[o]=r[o];let l=e=>null!=e&&e.shape.length!==i?a.XLQ(e,s):e,u=this.scale?l(this.gamma.read()):null,h=this.center?l(this.beta.read()):null,c=[],d=[];for(let p=0;p<i;++p)-1!==this.axis.indexOf(p)?(c.push(r[p]),d.push(1)):(c.push(1),d.push(r[p]));return e=a.Gg6(e,c),t=a.Gg6(t,c),null!=u&&(u=a.Gg6(u,d)),null!=h&&(h=a.Gg6(h,d)),ef(n,e,t,h,u,this.epsilon)})}getConfig(){let e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:(0,l.Cx)(this.betaInitializer),gammaInitializer:(0,l.Cx)(this.gammaInitializer),betaRegularizer:(0,E.SG)(this.betaRegularizer),gammaRegularizer:(0,E.SG)(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}eg.className="LayerNormalization",a.m7h.registerClass(eg);class ey extends h.mh{constructor(e){if(null==e&&(e={}),super(e),this.dataFormat=null==e.dataFormat?(0,_.rf)():e.dataFormat,null==e.padding)this.padding=[[1,1],[1,1]];else if("number"==typeof e.padding)this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{let t,n;if(e.padding=e.padding,2!==e.padding.length)throw new p.nu(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);if("number"==typeof e.padding[0])t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new p.nu(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],2!==e.padding[1].length)throw new p.nu(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new h.Zg({ndim:4})]}computeOutputShape(e){let t,n;return(e=(0,y.Wf)(e),"channelsFirst"===this.dataFormat)?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}call(e,t){return(0,a.lub)(()=>{var t,n,r;return t=(0,y.nQ)(e),n=this.padding,r=this.dataFormat,(0,a.lub)(()=>{let e;if(4!==t.rank)throw new p.nu(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(null==n&&(n=[[1,1],[1,1]]),2!==n.length||2!==n[0].length||2!==n[1].length)throw new p.nu("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==r&&(r=(0,_.rf)()),"channelsLast"!==r&&"channelsFirst"!==r)throw new p.nu(`Unknown data format: ${r}. Supported data formats are 'channelsLast' and 'channelsFirst.`);return e="channelsFirst"===r?[[0,0],[0,0],n[0],n[1]]:[[0,0],n[0],n[1],[0,0]],a.vku(t,e)})})}getConfig(){let e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function eb(e,t,n,r,i,s){return(0,a.lub)(()=>{let o;(0,M.cj)(i),(0,M.Lp)(s),(0,M.zb)(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==i&&(i=(0,_.rf)()),null==s&&(s="max"),e=(0,R.aP)(e,i);let l="same"===r?"same":"valid";return o="max"===s?a._sB(e,t,n,l):a.wS1(e,t,n,l),"channelsFirst"===i&&(o=a.p4s(o,[0,3,1,2])),o})}function ex(e,t,n,r,i,s){return(0,a.lub)(()=>{let o;(0,M.cj)(i),(0,M.Lp)(s),(0,M.zb)(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==i&&(i=(0,_.rf)()),null==s&&(s="max"),e=(0,R.fN)(e,i);let l="same"===r?"same":"valid";return o="max"===s?a.YQQ(e,t,n,l):a.uR5(e,t,n,l),"channelsFirst"===i&&(o=a.p4s(o,[0,4,1,2,3])),o})}ey.className="ZeroPadding2D",a.m7h.registerClass(ey);class ev extends h.mh{constructor(e){if(null==e.poolSize&&(e.poolSize=2),super(e),"number"==typeof e.poolSize)this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&1===e.poolSize.length&&"number"==typeof e.poolSize[0])this.poolSize=e.poolSize;else throw new p.nu(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if((0,m.iQ)(this.poolSize,"poolSize"),null==e.strides)this.strides=this.poolSize;else if("number"==typeof e.strides)this.strides=[e.strides];else if(Array.isArray(e.strides)&&1===e.strides.length&&"number"==typeof e.strides[0])this.strides=e.strides;else throw new p.nu(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);(0,m.iQ)(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,(0,M.zb)(this.padding),this.inputSpec=[new h.Zg({ndim:3})]}computeOutputShape(e){e=(0,y.Wf)(e);let t=(0,B.kt)(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return(0,a.lub)(()=>{this.invokeCallHook(e,t),e=O.dt((0,y.nQ)(e),2);let n=this.poolingFunction((0,y.nQ)(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return a.L9e(n,[2])})}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class ew extends ev{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return(0,M.cj)(a),(0,M.zb)(r),eb(e,t,n,r,a,"max")}}ew.className="MaxPooling1D",a.m7h.registerClass(ew);class eI extends ev{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return(0,M.cj)(a),(0,M.zb)(r),eb(e,t,n,r,a,"avg")}}eI.className="AveragePooling1D",a.m7h.registerClass(eI);class ek extends h.mh{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new p.nu(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];(0,m.iQ)(this.poolSize,"poolSize"),(0,m.iQ)(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,(0,M.cj)(this.dataFormat),(0,M.zb)(this.padding),this.inputSpec=[new h.Zg({ndim:4})]}computeOutputShape(e){e=(0,y.Wf)(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return(t=(0,B.kt)(t,this.poolSize[0],this.padding,this.strides[0]),n=(0,B.kt)(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat)?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return(0,a.lub)(()=>(this.invokeCallHook(e,t),this.poolingFunction((0,y.nQ)(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class eS extends ek{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return(0,M.cj)(a),(0,M.zb)(r),eb(e,t,n,r,a,"max")}}eS.className="MaxPooling2D",a.m7h.registerClass(eS);class eC extends ek{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return(0,M.cj)(a),(0,M.zb)(r),eb(e,t,n,r,a,"avg")}}eC.className="AveragePooling2D",a.m7h.registerClass(eC);class eE extends h.mh{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new p.nu(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];(0,m.iQ)(this.poolSize,"poolSize"),(0,m.iQ)(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,(0,M.cj)(this.dataFormat),(0,M.zb)(this.padding),this.inputSpec=[new h.Zg({ndim:5})]}computeOutputShape(e){e=(0,y.Wf)(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return(t=(0,B.kt)(t,this.poolSize[0],this.padding,this.strides[0]),n=(0,B.kt)(n,this.poolSize[1],this.padding,this.strides[1]),r=(0,B.kt)(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat)?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}call(e,t){return(0,a.lub)(()=>(this.invokeCallHook(e,t),this.poolingFunction((0,y.nQ)(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class eT extends eE{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return(0,M.cj)(a),(0,M.zb)(r),ex(e,t,n,r,a,"max")}}eT.className="MaxPooling3D",a.m7h.registerClass(eT);class e$ extends eE{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return(0,M.cj)(a),(0,M.zb)(r),ex(e,t,n,r,a,"avg")}}e$.className="AveragePooling3D",a.m7h.registerClass(e$);class eN extends h.mh{constructor(e){super(e),this.inputSpec=[new h.Zg({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new p.nj}}class eA extends eN{constructor(e){super(e||{})}call(e,t){return(0,a.lub)(()=>{let t=(0,y.nQ)(e);return a.J69(t,1)})}}eA.className="GlobalAveragePooling1D",a.m7h.registerClass(eA);class eD extends eN{constructor(e){super(e||{})}call(e,t){return(0,a.lub)(()=>{let t=(0,y.nQ)(e);return a.Fp7(t,1)})}}eD.className="GlobalMaxPooling1D",a.m7h.registerClass(eD);class eF extends h.mh{constructor(e){super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,(0,M.cj)(this.dataFormat),this.inputSpec=[new h.Zg({ndim:4})]}computeOutputShape(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new p.nj}getConfig(){let e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class eR extends eF{call(e,t){return(0,a.lub)(()=>{let t=(0,y.nQ)(e);return"channelsLast"===this.dataFormat?a.J69(t,[1,2]):a.J69(t,[2,3])})}}eR.className="GlobalAveragePooling2D",a.m7h.registerClass(eR);class e_ extends eF{call(e,t){return(0,a.lub)(()=>{let t=(0,y.nQ)(e);return"channelsLast"===this.dataFormat?a.Fp7(t,[1,2]):a.Fp7(t,[2,3])})}}e_.className="GlobalMaxPooling2D",a.m7h.registerClass(e_);var eO=n(4685);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ class eM extends h.mh{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(e){null!=this.layer&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){let e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,n={}){let r=t.layer,a=(0,f.v)(r,n);delete t.layer;let i={layer:a};return Object.assign(i,t),new e(i)}}class eB extends eM{constructor(e){super(e),this.supportsMasking=!0}build(e){if((e=(0,y.Wf)(e)).length<3)throw new p.nu(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];let t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=(0,y.Wf)(e);let t=[e[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}call(e,t){return(0,a.lub)(()=>{e=(0,y.nQ)(e);let n=(e,n)=>{let r=(0,y.nQ)(this.layer.call(e,t));return[r,[]]},r=(0,L.nd)(n,e,[],!1,null,null,!1,!0),a=r[1];return a})}}eB.className="TimeDistributed",a.m7h.registerClass(eB);class eP extends eM{constructor(e){var t;super(e);let n=e.layer.getConfig(),r={};r.className=e.layer.getClassName(),r.config=n,this.forwardLayer=(0,f.v)(r),n.goBackwards=!0!==n.goBackwards;let a={};if(a.className=e.layer.getClassName(),a.config=n,this.backwardLayer=(0,f.v)(a),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,t=this.mergeMode,m.xn(eO.eY,"BidirectionalMergeMode",t),e.weights)throw new p.nj("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){let t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}computeOutputShape(e){let t,n,r,a=this.forwardLayer.computeOutputShape(e);return(Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),this.returnState&&(r=a.slice(1)),t=a[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState)?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):m.Bq(n)}apply(e,t){let n=null==t?null:t.initialState,r=null==t?null:t.constants;null==t&&(t={});let a=(0,L.lx)(e,n,r,this.numConstants);if(e=a.inputs,n=a.initialState,r=a.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(null==n||0===n.length)&&null==r)return super.apply(e,t);let i=[],s=[];if(null!=n){let o=n.length;if(o%2>0)throw new p.nu("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,i.push(...n);let l=n.map(e=>new h.Zg({shape:e.shape}));this.forwardLayer.stateSpec=l.slice(0,o/2),this.backwardLayer.stateSpec=l.slice(o/2),s.push(...l)}if(null!=r)throw new p.nj("Support for constants in Bidirectional layers is not implemented yet.");let u=i[0]instanceof h.Iy;for(let c of i)if(c instanceof h.Iy!==u)throw new p.nu("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(!u)return super.apply(e,t);{let d=[e].concat(i),f=this.inputSpec.concat(s),m=this.inputSpec;this.inputSpec=f;let g=super.apply(d,t);return this.inputSpec=m,g}}call(e,t){return(0,a.lub)(()=>{let n,r,i,s;let o=t.initialState;if(null==o)n=this.forwardLayer.call(e,t),r=this.backwardLayer.call(e,t);else{let l=o.slice(0,o.length/2),u=o.slice(o.length/2);n=this.forwardLayer.call(e,Object.assign(t,{initialState:l})),r=this.backwardLayer.call(e,Object.assign(t,{initialState:u}))}return(this.returnState&&(Array.isArray(n)&&(i=n.slice(1).concat(r.slice(1))),n=n[0],r=r[0]),this.returnSequences&&(r=a.GYS(r,1)),"concat"===this.mergeMode?s=O.mV([n,r]):"sum"===this.mergeMode?s=a.IHx(n,r):"ave"===this.mergeMode?s=a.dC7(.5,a.IHx(n,r)):"mul"===this.mergeMode?s=a.dC7(n,r):null==this.mergeMode&&(s=[n,r]),this.returnState)?null==this.mergeMode?s.concat(i):[s].concat(i):s})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){(0,M.f4)(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),(0,M.f4)(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){let n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,!this.returnState)return n;{let r=this.forwardLayer.states,a=r.map(e=>null);return Array.isArray(n)?n.concat(a).concat(a):[n].concat(a).concat(a)}}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){let e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){let n=(0,f.v)(t.layer);if(delete t.layer,null!=t.numConstants)throw new p.nj("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");let r=t;return r.layer=n,new e(r)}}eP.className="Bidirectional",a.m7h.registerClass(eP);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ class eL extends h.mh{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){let e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return(0,a.lub)(()=>("float32"!==(e=(0,y.nQ)(e)).dtype&&(e=O.pj(e,"float32")),(0,a.IHx)((0,a.dC7)(e,this.scale),this.offset)))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function eU(e){return new u.l(e)}function eW(e){return new A(e)}function ez(e){return new T(e)}function eV(e){return new $(e)}function eG(e){return new N(e)}function ej(e){return new F(e)}function eH(e){return new D(e)}function eK(e){return new R.lM(e)}function eX(e){return new R.mh(e)}function eq(e){return new R.N8(e)}function eY(e){return new R.x1(e)}function eQ(e){return new R.jz(e)}function eZ(e){return new R.do(e)}function eJ(e){return new R.wg(e)}function e0(e){return new R.HV(e)}function e1(e){return new P(e)}function e2(e){return new q(e)}function e3(e){return new K(e)}function e4(e){return new j(e)}function e6(e){return new H(e)}function e5(e){return new X(e)}function e7(e){return new Y(e)}function e8(e){return new Q(e)}function e9(e){return new Z(e)}function te(e){return new ee(e)}function tt(e){return new er(e)}function tn(e){return new ei(e)}function tr(e){return new el(e)}function ta(e){return new es(e)}function ti(e){return new eo(e)}function ts(e){return new ea(e)}function to(e){return new eh(e)}function tl(e){return new em(e)}function tu(e){return new eg(e)}function th(e){return new ey(e)}function tc(e){return new eI(e)}function td(e){return tc(e)}function tp(e){return tc(e)}function tf(e){return new eC(e)}function tm(e){return tf(e)}function tg(e){return tf(e)}function ty(e){return new e$(e)}function tb(e){return ty(e)}function tx(e){return ty(e)}function tv(e){return new eA(e)}function tw(e){return new eR(e)}function tI(e){return new eD(e)}function tk(e){return new e_(e)}function tS(e){return new ew(e)}function tC(e){return new eS(e)}function tE(e){return new eT(e)}function tT(e){return new L.RJ(e)}function t$(e){return new L.SM(e)}function tN(e){return new L.Pl(e)}function tA(e){return new L.U7(e)}function tD(e){return new L.s9(e)}function tF(e){return new L.xR(e)}function tR(e){return new V(e)}function t_(e){return new z(e)}function tO(e){return new L.$p(e)}function tM(e){return new L._1(e)}function tB(e){return new eP(e)}function tP(e){return new eB(e)}eL.className="Rescaling",a.m7h.registerClass(eL);let tL=tI,tU=tk,tW=tS,tz=tC;function tV(e){return new ec(e)}function tG(e){return new ed(e)}function tj(e){return new ep(e)}function tH(e){return new J(e)}function tK(e){return new eL(e)}n(7629),n(3146),n(1653);var tX=n(7385);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ },2599:function(e,t,n){"use strict";n.d(t,{m7:function(){return c},M6:function(){return p},L5:function(){return A},Cx:function(){return N}});var r=n(7671),a=n(9840),i=n(8090),s=n(588);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ let o=["fanIn","fanOut","fanAvg"],l=["normal","uniform","truncatedNormal"];var u=n(2931),h=n(6040);class c extends r.m7h.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class d extends c{apply(e,t){return(0,r.lls)(e,t)}}d.className="Zeros",r.m7h.registerClass(d);class p extends c{apply(e,t){return(0,r.iUs)(e,t)}}p.className="Ones",r.m7h.registerClass(p);class f extends c{constructor(e){if(super(),"object"!=typeof e)throw new s.nu(`Expected argument of type ConstantConfig but got ${e}`);if(void 0===e.value)throw new s.nu(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return(0,r.lub)(()=>(0,r.dC7)((0,r.iD$)(this.value),(0,r.iUs)(e,t)))}getConfig(){return{value:this.value}}}f.className="Constant",r.m7h.registerClass(f);class m extends c{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return(0,r.LGj)(e,this.minval,this.maxval,t)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}m.className="RandomUniform",r.m7h.registerClass(m);class g extends c{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new s.nj(`randomNormal does not support dType ${t}.`);return a.nG(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}g.className="RandomNormal",r.m7h.registerClass(g);class y extends c{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new s.nj(`truncatedNormal does not support dType ${t}.`);return(0,r.Xu6)(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}y.className="TruncatedNormal",r.m7h.registerClass(y);class b extends c{constructor(e){super(),this.gain=null!=e.gain?e.gain:1}apply(e,t){return(0,r.lub)(()=>{if(2===e.length&&e[0]===e[1])return(0,r.dC7)(this.gain,(0,r.iyy)(e[0]));throw new s.nu("Identity matrix initializer can only be used for 2D square matrices.")})}getConfig(){return{gain:this.gain}}}b.className="Identity",r.m7h.registerClass(b);class x extends c{constructor(e){var t,n;if(super(),e.scale<0)throw new s.nu(`scale must be a positive float. Got: ${e.scale}`);this.scale=null==e.scale?1:e.scale,this.mode=null==e.mode?"fanIn":e.mode,t=this.mode,(0,u.xn)(o,"FanMode",t),this.distribution=null==e.distribution?"normal":e.distribution,n=this.distribution,(0,u.xn)(l,"Distribution",n),this.seed=e.seed}apply(e,t){let n=function(e,t="channelsLast"){let n,r;if((0,i.cj)(t),2===e.length)n=e[0],r=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===t){let a=(0,h.NS)(e,2);n=e[1]*a,r=e[0]*a}else if("channelsLast"===t){let s=(0,h.NS)(e,0,e.length-2);n=e[e.length-2]*s,r=e[e.length-1]*s}}else{let o=(0,h.NS)(e);n=Math.sqrt(o),r=Math.sqrt(o)}return[n,r]}(e),a=n[0],o=n[1],l=this.scale;if("fanIn"===this.mode?l/=Math.max(1,a):"fanOut"===this.mode?l/=Math.max(1,o):l/=Math.max(1,(a+o)/2),"normal"===this.distribution){let u=Math.sqrt(l);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new s.nj(`${this.getClassName()} does not support dType ${t}.`);return(0,r.Xu6)(e,0,u,t,this.seed)}{let c=Math.sqrt(3*l);return(0,r.LGj)(e,-c,c,t)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}x.className="VarianceScaling",r.m7h.registerClass(x);class v extends x{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return x.className}}v.className="GlorotUniform",r.m7h.registerClass(v);class w extends x{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return x.className}}w.className="GlorotNormal",r.m7h.registerClass(w);class I extends x{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return x.className}}I.className="HeNormal",r.m7h.registerClass(I);class k extends x{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return x.className}}k.className="HeUniform",r.m7h.registerClass(k);class S extends x{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return x.className}}S.className="LeCunNormal",r.m7h.registerClass(S);class C extends x{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return x.className}}C.className="LeCunNormal",r.m7h.registerClass(C);class E extends c{constructor(e){if(super(),this.DEFAULT_GAIN=1,this.gain=null==e.gain?this.DEFAULT_GAIN:e.gain,this.seed=e.seed,null!=this.seed)throw new s.nj("Random seed is not implemented for Orthogonal Initializer yet.")}apply(e,t){return(0,r.lub)(()=>{if(e.length<2)throw new s.nj("Shape must be at least 2D.");e[0]*e[1]>2e3&&console.warn(`Orthogonal initializer is being called on a matrix with more than 2000 (${e[0]*e[1]}) elements: Slowness may result.`);let t=e[0]>e[1]?[e[1],e[0]]:e,n=a.nG(t,0,1,"float32"),i=r.$r2.gramSchmidt(n);return e[0]>e[1]&&(i=(0,r.p4s)(i)),(0,r.dC7)(this.gain,i)})}getConfig(){return{gain:this.gain,seed:this.seed}}}E.className="Orthogonal",r.m7h.registerClass(E);let T={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function $(e,t={}){return(0,u.tU)(e,r.m7h.SerializationMap.getMap().classNameMap,t,"initializer")}function N(e){return(0,u.Kj)(e)}function A(e){if("string"==typeof e){let t=e in T?T[e]:e;if("GlorotNormal"===t)return new w;if("GlorotUniform"===t)return new v;{if("HeNormal"===t)return new I;if("HeUniform"===t)return new k;if("LeCunNormal"===t)return new S;if("LeCunUniform"===t)return new C;let n={};return n.className=t,n.config={},$(n)}}return e instanceof c?e:$(e)}},4685:function(e,t,n){"use strict";n.d(t,{MK:function(){return s},Mz:function(){return a},PS:function(){return r},eY:function(){return o},zx:function(){return i}});/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ let r=["channelsFirst","channelsLast"],a=["nearest","bilinear"],i=["valid","same","causal"],s=["max","avg"],o=["sum","mul","concat","ave"]},9897:function(e,t,n){"use strict";n.d(t,{v:function(){return i}});var r=n(7671),a=n(2931);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function i(e,t={},n=!1){return(0,a.tU)(e,r.m7h.SerializationMap.getMap().classNameMap,t,"layer",n)}},3146:function(e,t,n){"use strict";n.d(t,{Z:function(){return a},i:function(){return i}});var r=n(7671);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ async function a(e){if(null==e)return;let t=[],n=[],a=[];for(let i in e){let s=e[i];"number"!=typeof s&&(t.push(s.data()),n.push(i),a.push(s))}if(t.length>0){let o=await Promise.all(t);for(let l=0;l<o.length;++l)e[n[l]]=o[l][0];(0,r.B90)(a)}}function i(e){if(null!=e)for(let t in e){let n=e[t];"number"!=typeof n&&n.dispose()}}},6275:function(e,t,n){"use strict";n.d(t,{Eq:function(){return o},FD:function(){return l},KM:function(){return d},Ls:function(){return f},U2:function(){return g},dr:function(){return m},fO:function(){return p},ke:function(){return u},t3:function(){return h},uq:function(){return c}});var r=n(7671),a=n(2012),i=n(9840),s=n(588);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function o(e,t){return(0,r.lub)(()=>{"float32"!==e.dtype&&(e=r.pju(e,"float32"));let n=r.Smz(i.h6(e),t,!0),s=r.hlL(n.shape,(0,a.Ho)()),o=r._b3(r.gWQ(n,s));return r.hiC(e,o)})}function l(e,t){return(0,r.lub)(()=>r.J69(i.h6(r.luU(t,e)),-1))}function u(e,t){return(0,r.lub)(()=>r.J69(r.WnP(r.luU(t,e)),-1))}function h(e,t){return(0,r.lub)(()=>{let n=r.luU(e,t),i=r.iUl(r.WnP(e),(0,a.Ho)(),Number.MAX_VALUE),s=r.WnP(r.hiC(n,i));return r.dC7(100,r.J69(s,-1))})}function c(e,t,n=!1){return(0,r.lub)(()=>{if(n)t=r.XAC(t);else{let i=r.Smz(t,t.shape.length-1,!0);t=r.hiC(t,i)}return t=r.iUl(t,(0,a.Ho)(),1-(0,a.Ho)()),r.W76(r.Smz(r.dC7(r.pju(e,"float32"),r.cM7(t)),t.shape.length-1))})}function d(e,t,n=!1){return(0,r.lub)(()=>{let s=r.pju(r.GWj(i.xH(e)),"int32");t=r.iUl(t,(0,a.Ho)(),1-(0,a.Ho)());let o=t.shape,l=r.XLQ(r.lfX(s,o[o.length-1]),o);return c(l,t,n)})}function p(e,t){return(0,r.lub)(()=>{let n;return n=r.iUl(t,(0,a.Ho)(),1-(0,a.Ho)()),n=r.cM7(r.hiC(n,r.luU(1,n))),r.J69(function(e,t){if(!r.D5U.arraysEqual(e.shape,t.shape))throw new s.nu(`logits and labels must have the same shape, but got shapes ${JSON.stringify(e.shape)} and ${JSON.stringify(t.shape)}`);return(0,r.lub)(()=>{let n=r.UYe(t),a=r.W76(r.WnP(t));return r.IHx(r.luU(n,r.dC7(t,e)),r.Krr(r.Qqt(a)))})}(e,n),-1)})}function f(e,t){return(0,r.lub)(()=>{let n=o(e,-1),a=o(t,-1),i=r.dC7(n,a);return r.W76(r.Smz(i,-1))})}let m={meanSquaredError:l,meanAbsoluteError:u,meanAbsolutePercentageError:h,meanSquaredLogarithmicError:function(e,t){return(0,r.lub)(()=>{let n=r.iUl(t,(0,a.Ho)(),Number.MAX_VALUE),s=r.cM7(r.IHx(1,n)),o=r.iUl(e,(0,a.Ho)(),Number.MAX_VALUE),l=r.cM7(r.IHx(1,o));return r.J69(i.h6(r.luU(s,l)),-1)})},squaredHinge:function(e,t){return(0,r.lub)(()=>{let n=r.gWQ(0,r.luU(1,r.dC7(e,t)));return r.J69(i.h6(n),-1)})},hinge:function(e,t){return(0,r.lub)(()=>{let n=r.gWQ(0,r.luU(1,r.dC7(e,t)));return r.J69(n,-1)})},categoricalHinge:function(e,t){return(0,r.lub)(()=>{let n=r.Smz(r.dC7(e,t),-1),a=r.Fp7(r.dC7(r.luU(1,e),t),-1);return r.gWQ(0,r.IHx(1,r.luU(a,n)))})},logcosh:function(e,t){return(0,r.lub)(()=>{let n=Math.log(2),a=r.luU(t,e),i=r.luU(r.IHx(a,r.Wvh(r.dC7(-2,a))),n);return r.J69(i,-1)})},categoricalCrossentropy:c,sparseCategoricalCrossentropy:d,binaryCrossentropy:p,kullbackLeiblerDivergence:function(e,t){return(0,r.lub)(()=>{let n=r.iUl(e,(0,a.Ho)(),1),i=r.iUl(t,(0,a.Ho)(),1);return r.Smz(r.dC7(e,r.cM7(r.hiC(n,i))),-1)})},poisson:function(e,t){return(0,r.lub)(()=>{let n=r.cM7(r.IHx((0,a.Ho)(),t));return r.J69(r.luU(t,r.dC7(e,n)),-1)})},cosineProximity:f};function g(e){if("string"!=typeof e)return e;{if(e in m)return m[e];let t=`Unknown loss ${e}`;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${e}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new s.nu(t)}}},7629:function(e,t,n){"use strict";n.d(t,{G5:function(){return u},KM:function(){return v},TY:function(){return c},U2:function(){return I},_F:function(){return l},aI:function(){return k},fO:function(){return h},uq:function(){return b}});var r=n(7671),a=n(9840),i=n(588),s=n(6275),o=n(2931);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function l(e,t){return(0,r.lub)(()=>{let n=r.dC7(.5,r.JpU(t)),i=a.pj(r.pjt(t,n),e.dtype);return r.J69(r.DgJ(e,i),-1)})}function u(e,t){return(0,r.lub)(()=>a.pj(r.DgJ(r.NqF(e,-1),r.NqF(t,-1)),"float32"))}function h(e,t){return(0,s.fO)(e,t)}function c(e,t){return e.rank===t.rank&&(e=r.L9e(e,[e.rank-1])),(t=r.NqF(t,-1)).dtype!==e.dtype&&(t=r.pju(t,e.dtype)),r.pju(r.DgJ(e,t),"float32")}let d=s.FD,p=s.FD,f=s.ke,m=s.ke,g=s.t3,y=s.t3,b=s.uq,x=s.Ls,v=s.KM,w={binaryAccuracy:l,categoricalAccuracy:u,precision:function(e,t){return(0,r.lub)(()=>{let n=(0,r.lub)(()=>r.pju(r.Smz(r.HvI(r.DgJ(e,1),r.DgJ(t,1))),"float32")),a=(0,r.lub)(()=>r.pju(r.Smz(r.HvI(r.DgJ(e,0),r.DgJ(t,1))),"float32")),i=r.IHx(n,a);return r.pju(r.arb(r.pjt(i,0),r.hiC(n,i),0),"float32")})},categoricalCrossentropy:b,sparseCategoricalCrossentropy:v,mse:d,MSE:p,mae:f,MAE:m,mape:g,MAPE:y,cosine:x};function I(e){if("string"==typeof e&&e in w)return w[e];if("string"!=typeof e&&null!=e)return e;throw new i.nu(`Unknown metric ${e}`)}function k(e){if(o.hu(null!==e,`Unknown LossOrMetricFn ${e}`),"string"==typeof e)return e;{let t;for(let n of Object.keys(s.dr))if(s.dr[n]===e){t=n;break}if(void 0!==t)return t;for(let r of Object.keys(w))if(w[r]===e){t=r;break}return void 0!==t?t:e.name}}},2328:function(e,t,n){"use strict";n.d(t,{j:function(){return s}});var r=n(7671),a=n(2012),i=n(588);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function s(e){let t={Adagrad:()=>r.p_j.adagrad(.01),Adadelta:()=>r.p_j.adadelta(1,.95,(0,a.Ho)()),Adam:()=>r.p_j.adam(.001,.9,.999,(0,a.Ho)()),Adamax:()=>r.p_j.adamax(.002,.9,.999,(0,a.Ho)(),0),RMSProp:()=>r.p_j.rmsprop(.001,.9,0,(0,a.Ho)()),SGD:()=>r.p_j.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new i.nu(`Unknown Optimizer ${e}`)}},539:function(e,t,n){"use strict";n.d(t,{EC:function(){return c},SG:function(){return u}});var r=n(7671),a=n(9840),i=n(2931);class s extends r.m7h.Serializable{}class o extends s{constructor(e){super(),/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function(e){if(null!=e&&"object"!=typeof e)throw Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${e}`)}(e),this.l1=null==e||null==e.l1?.01:e.l1,this.l2=null==e||null==e.l2?.01:e.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(e){return(0,r.lub)(()=>{let t=(0,r.lls)([1]);return this.hasL1&&(t=(0,r.IHx)(t,(0,r.Smz)(r.dC7(this.l1,(0,r.WnP)(e))))),this.hasL2&&(t=(0,r.IHx)(t,(0,r.Smz)(r.dC7(this.l2,a.h6(e))))),r.XLQ(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}o.className="L1L2",r.m7h.registerClass(o);let l={l1l2:"L1L2"};function u(e){return(0,i.Kj)(e)}function h(e,t={}){return(0,i.tU)(e,r.m7h.SerializationMap.getMap().classNameMap,t,"regularizer")}function c(e){if(null==e)return null;if("string"==typeof e){let t=e in l?l[e]:e;return h({className:t,config:{}})}return e instanceof s?e:h(e)}},8374:function(e,t,n){"use strict";function r(e,t,n=!1){if(null==e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||!function e(t){if(null===t)return!0;if("object"==typeof t){if(Object.getPrototypeOf(t)===Object.prototype){let n=Object.keys(t);for(let r of n)if("string"!=typeof r||!e(t[r]))return!1;return!0}if(!Array.isArray(t))return!1;for(let a of t)if(!e(a))return!1;return!0}{let i=typeof t;return"string"===i||"number"===i||"boolean"===i}}(e))throw Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){let r=JSON.stringify(e);r.length>1048576&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}n.d(t,{WE:function(){return r}})},6517:function(e,t,n){"use strict";n.d(t,{$U:function(){return l},AF:function(){return s},kt:function(){return o}});var r=n(588),a=n(2931),i=n(6040);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function s(e,t,n){if("number"==typeof e)return(0,a.JE)(e,t);if(e.length!==t)throw new r.nu(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${e.length} elements.`);for(let s=0;s<t;++s){let o=e[s];if(!(0,i.U)(o))throw new r.nu(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(e)} including a non-integer number ${o}`)}return e}function o(e,t,n,r,a=1){return null==e?e:Math.floor((("same"===n?e:e-(t+(t-1)*(a-1))+1)+r-1)/r)}function l(e,t,n,a){if(null==e)return null;if("valid"===a)e=e*t+(0,i.Fp)([n-t,0]);else if("same"===a)e*=t;else throw new r.nu(`Unsupport padding mode: ${a}.`);return e}},2931:function(e,t,n){"use strict";n.d(t,{Bq:function(){return l},D1:function(){return h},Ds:function(){return v},JE:function(){return i},Kj:function(){return p},L7:function(){return m},Mx:function(){return x},QX:function(){return o},Tw:function(){return g},WT:function(){return w},hu:function(){return s},iQ:function(){return function e(t,n){Array.isArray(t)?(r.D5U.assert(t.length>0,()=>`${n} is unexpectedly an empty array.`),t.forEach((t,r)=>e(t,`element ${r+1} of ${n}`))):r.D5U.assert(Number.isInteger(t)&&t>0,()=>`Expected ${n} to be a positive integer, but got ${function e(t){return null===t?"null":Array.isArray(t)?"["+t.map(t=>e(t)).join(",")+"]":"string"==typeof t?`"${t}"`:`${t}`}(t)}.`)}},nK:function(){return y},tU:function(){return f},xn:function(){return b},zW:function(){return c},zZ:function(){return u}});var r=n(7671),a=n(588);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function i(e,t){if(Array.isArray(e)){let n=[];for(let r=0;r<t;r++)n=n.concat(e);return n}{let a=Array(t);return a.fill(e),a}}function s(e,t){if(!e)throw new a.ps(t)}function o(e,t){let n=0;for(let r of e)r===t&&n++;return n}function l(e){return 1===e.length?e[0]:e}function u(e){return Array.isArray(e)?e:[e]}function h(e){let t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2"),n=t.replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==n[0]?n:"private"+n}function c(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}let d={};function p(e){if(null==e)return null;let t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function f(e,t={},n={},r="object",i=!1){if("string"==typeof e){let s;if(e in n)s=n[e];else if(e in d)s=d[e];else if(null==(s=t[e]))throw new a.nu(`Unknown ${r}: ${e}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return s}{let o,l;if(null==e.className||null==e.config)throw new a.nu(`${r}: Improper config format: ${JSON.stringify(e)}.
'className' and 'config' must set.`);let u=e.className;if(u in n?[o,l]=n[u]:u in d?[o,l]=d.className:u in t&&([o,l]=t[u]),null==o)throw new a.nu(`Unknown ${r}: ${u}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(null!=l){let h={};for(let c of Object.keys(d))h[c]=d[c];for(let p of Object.keys(n))h[p]=n[p];let f=e.config;f.customObjects=h;let m=Object.assign({},d);for(let g of Object.keys(n))d[g]=n[g];!function e(t){if(null!=t&&"object"==typeof t){if(Array.isArray(t))t.forEach(t=>e(t));else{let n=Object.keys(t);for(let r of n){let a=t[r];null!=a&&"object"==typeof a&&(Array.isArray(a)||"ndarray"!==a.type||"number"!=typeof a.value?e(a):t[r]=a.value)}}}}(e.config);let y=l(o,e.config,n,i);return d=Object.assign({},m),y}{let b=Object.assign({},d);for(let x of Object.keys(n))d[x]=n[x];let v=new o(e.config);return d=Object.assign({},b),v}}}function m(e,t){return -1*(e<t?-1:e>t?1:0)}function g(e){if(null==e)return e;let t=[];for(let n of e)-1===t.indexOf(n)&&t.push(n);return t}function y(e){if(null==e)throw new a.nu(`Invalid value in obj: ${JSON.stringify(e)}`);for(let t in e)if(e.hasOwnProperty(t))return!1;return!0}function b(e,t,n){if(null!=n&&0>e.indexOf(n))throw new a.nu(`${n} is not a valid ${t}.  Valid values are ${e} or null/undefined.`)}function x(e,t,n=0,r=1/0){return s(n>=0),s(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every(e=>typeof e===t)}function v(e,t,n){let a,i=null!=n?n():r.D5U.now(),s=(...s)=>{let o=null!=n?n():r.D5U.now();return o-i<t?a:(i=o,a=e(...s))};return s}function w(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}},618:function(e,t,n){"use strict";n.d(t,{I:function(){return a}});var r=n(3013);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function a(e,t,n,a=console.log){let s;let o=function(e){let t=!0,n=[],r=[];for(let a in e.nodesByDepth)n.push(e.nodesByDepth[a]);for(let i of n){if(i.length>1||1===i.length&&i[0].inboundLayers.length>1){t=!1;break}r.push(...i)}if(t)for(let s of e.layers){let o=!1;for(let l of s.inboundNodes)if(-1!==r.indexOf(l)){if(o){t=!1;break}o=!0}if(!t)break}return t}(e),l=["Layer (type)","Input Shape","Output shape","Param #"];if(o?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(e=>Math.floor(t*e))),!o)for(let u in l.push("Receives inputs"),s=[],e.nodesByDepth)s.push(...e.nodesByDepth[u]);a("_".repeat(t)),i(l,n,a),a("=".repeat(t));let h=e.layers;for(let c=0;c<h.length;++c)o?function(e,t,n){let r,a;try{a=e.inboundNodes.map(e=>JSON.stringify(e.inputShapes)).join(",")}catch(s){a="multiple"}try{r=JSON.stringify(e.outputShape)}catch(o){r="multiple"}let l=e.name,u=e.getClassName(),h=[`${l} (${u})`,a,r,e.countParams().toString()];i(h,t,n)}(h[c],n,a):function(e,t,n,r){let a,s;try{s=e.inboundNodes.map(e=>JSON.stringify(e.inputShapes)).join(",")}catch(o){s="multiple"}try{a=JSON.stringify(e.outputShape)}catch(l){a="multiple"}let u=[];for(let h of e.inboundNodes)if(null==n||!(n.length>0)||-1!==n.indexOf(h))for(let c=0;c<h.inboundLayers.length;++c){let d=h.inboundLayers[c].name,p=h.nodeIndices[c],f=h.tensorIndices[c];u.push(`${d}[${p}][${f}]`)}let m=e.name,g=e.getClassName(),y=0===u.length?"":u[0],b=[`${m} (${g})`,s,a,e.countParams().toString(),y];i(b,t,r);for(let x=1;x<u.length;++x)i(["","","","",u[x]],t,r)}(h[c],n,s,a),a((c===h.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();let d=null!=e.collectedTrainableWeights?(0,r.t)(e.collectedTrainableWeights):(0,r.t)(e.trainableWeights),p=(0,r.t)(e.nonTrainableWeights);a(`Total params: ${d+p}`),a(`Trainable params: ${d}`),a(`Non-trainable params: ${p}`),a("_".repeat(t))}function i(e,t,n=console.log){let r="";for(let a=0;a<e.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r+=e[a],r=r.slice(0,t[a]),r+=" ".repeat(t[a]-r.length);n(r)}},6040:function(e,t,n){"use strict";n.d(t,{Fp:function(){return o},NS:function(){return i},U:function(){return a},VV:function(){return s},w6:function(){return l}});var r=n(588);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function a(e){return e===parseInt(e.toString(),10)}function i(e,t,n){null==t&&(t=0),null==n&&(n=e.length);let r=1;for(let a=t;a<n;++a)r*=e[a];return r}function s(e){if(0===e.length)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){let r=e[n];r<t&&(t=r)}return t}function o(e){if(0===e.length)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){let r=e[n];r>t&&(t=r)}return t}function l(e,t){if(t<e)throw new r.nu(`end (${t}) < begin (${e}) is forbidden.`);let n=[];for(let a=e;a<t;++a)n.push(a);return n}},1977:function(e,t,n){"use strict";n.d(t,{a:function(){return function e(t,n){if(null===t)return null;if("string"==typeof t)return r.zW(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){let i=[],s=t.length;for(let o=0;o<s;++o){let l=t[o];a(n,o,l)?i.push(l):i.push(e(l,n))}return i}{let u={};for(let h of Object.keys(t)){let c=t[h];if("name"===h&&"string"==typeof c)u[h]=c;else{let d=r.zW(h);u[d]=e(c,d)}}return u}}},q:function(){return function e(t,n){if(null==t)return null;if("string"==typeof t)return r.D1(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){let i=[],s=t.length;for(let o=0;o<s;++o){let l=t[o];a(n,o,l)?i.push(l):i.push(e(l,n))}return i}{let u={};for(let h of Object.keys(t)){let c=t[h],d=r.D1(h);("name"===h||"className"===h)&&"string"==typeof c?u[d]=c:u[d]=e(c,h)}return u}}}});var r=n(2931);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function a(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"==typeof n}},7538:function(e,t,n){"use strict";n.d(t,{Wf:function(){return o},XO:function(){return a},nQ:function(){return s},x6:function(){return i}});var r=n(588);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function a(e){return Array.isArray(e)&&Array.isArray(e[0])}function i(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function s(e){let t;if(Array.isArray(e)){if(1!==e.length)throw new r.nu(`Expected Tensor length to be 1; got ${e.length}`);t=e[0]}else t=e;return t}function o(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))return e;if(1===e.length)return e[0];throw new r.nu(`Expected exactly 1 Shape; got ${e.length}`)}},3013:function(e,t,n){"use strict";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ function r(e){let t=0;for(let n of e)0===n.shape.length?t+=1:t+=n.shape.reduce((e,t)=>e*t);return t}n.d(t,{t:function(){return r}})},1653:function(e,t,n){"use strict";n.d(t,{FQ:function(){return l},fU:function(){return o},zb:function(){return u}});var r=n(7671),a=n(9608),i=n(8090);n(588);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */ let s="Variable";class o{constructor(e,t="float32",n=s,o=!0,l=null){this.dtype=null==t?"float32":t,this.shape=e.shape,this.id=(0,a.L)(),n=null==n?s:n,this.originalName=(0,i.MU)(n),this.name=(0,i.w8)(this.originalName),this.trainable_=o,this.constraint=l,this.val=r.VD$(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function l(e){return e.map(e=>e.read())}function u(e){e.forEach(e=>{let t=e[0];t.write(e[1])})}},7385:function(e,t,n){"use strict";n.d(t,{i:function(){return r}});/** @license See the LICENSE file. */ let r="3.21.0"},1767:function(e,t,n){"use strict";let r,a,i;var s,o,l,u,h,c,d,p,f,m,g,y,b,x={};n.r(x),n.d(x,{addImpl:function(){return nc},bincountImpl:function(){return n4},bincountReduceImpl:function(){return n6},castImpl:function(){return ns},ceilImpl:function(){return n8},concatImpl:function(){return ri},equalImpl:function(){return rz},expImpl:function(){return rJ},expm1Impl:function(){return r4},floorImpl:function(){return au},gatherNdImpl:function(){return ay},gatherV2Impl:function(){return ax},greaterEqualImpl:function(){return aS},greaterImpl:function(){return aw},lessEqualImpl:function(){return aB},lessImpl:function(){return a_},linSpaceImpl:function(){return aU},logImpl:function(){return az},maxImpl:function(){return a3},maximumImpl:function(){return a5},minimumImpl:function(){return io},multiplyImpl:function(){return r_},negImpl:function(){return ix},notEqualImpl:function(){return iT},prodImpl:function(){return iU},raggedGatherImpl:function(){return iV},raggedTensorToTensorImpl:function(){return iq},rangeImpl:function(){return iQ},rsqrtImpl:function(){return i9},scatterImpl:function(){return sn},sigmoidImpl:function(){return t7},simpleAbsImpl:function(){return nv},sliceImpl:function(){return n0},sparseFillEmptyRowsImpl:function(){return sv},sparseReshapeImpl:function(){return sI},sparseSegmentReductionImpl:function(){return sS},sqrtImpl:function(){return sN},squaredDifferenceImpl:function(){return sR},stridedSliceImpl:function(){return sP},stringNGramsImpl:function(){return sW},stringSplitImpl:function(){return sV},stringToHashBucketFastImpl:function(){return sj},subImpl:function(){return ae},tileImpl:function(){return sQ},topKImpl:function(){return s0},transposeImpl:function(){return n$},uniqueImpl:function(){return s6}});var v=n(7671);n(2904);var w=n(6235),I=n(974);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.abs=function(){return this.throwIfDisposed(),(0,w.W)(this)};var k=n(196),S=n(9121),C=n(3740),E=n(2668);let T=(0,E.op)({acos_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,C._1)(e,"x","acos");return k.BV.runKernel(S.VGw,{x:t})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.acos=function(){return this.throwIfDisposed(),T(this)};let $=(0,E.op)({acosh_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,C._1)(e,"x","acosh");return k.BV.runKernel(S.SpW,{x:t})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.acosh=function(){return this.throwIfDisposed(),$(this)};var N=n(6407);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.add=function(e){return this.throwIfDisposed(),(0,N.I)(this,e)};var A=n(781);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.all=function(e,t){return this.throwIfDisposed(),(0,A.$)(this,e,t)};var D=n(2998);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.any=function(e,t){return this.throwIfDisposed(),(0,D.Y)(this,e,t)};var F=n(47);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.argMax=function(e){return this.throwIfDisposed(),(0,F.N)(this,e)};let R=(0,E.op)({argMin_:/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=0){let n=(0,C._1)(e,"x","argMin");return k.BV.runKernel(S.aJk,{x:n},{axis:t})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.argMin=function(e){return this.throwIfDisposed(),R(this,e)};var _=n(4968),O=n(569);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.asScalar=function(){return this.throwIfDisposed(),(0,O.hu)(1===this.size,()=>"The array must have only 1 element."),(0,_.X)(this,[])};var M=n(2271);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.asType=function(e){return this.throwIfDisposed(),(0,M.p)(this,e)},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.as1D=function(){return this.throwIfDisposed(),(0,_.X)(this,[this.size])},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.as2D=function(e,t){return this.throwIfDisposed(),(0,_.X)(this,[e,t])},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),(0,_.X)(this,[e,t,n])},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),(0,_.X)(this,[e,t,n,r])},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),(0,_.X)(this,[e,t,n,r,a])};let B=(0,E.op)({asin_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,C._1)(e,"x","asin");return k.BV.runKernel(S.M2y,{x:t})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.asin=function(){return this.throwIfDisposed(),B(this)};let P=(0,E.op)({asinh_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,C._1)(e,"x","asinh");return k.BV.runKernel(S.qw7,{x:t})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.asinh=function(){return this.throwIfDisposed(),P(this)};let L=(0,E.op)({atan_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,C._1)(e,"x","atan");return k.BV.runKernel(S.jMg,{x:t})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.atan=function(){return this.throwIfDisposed(),L(this)};var U=n(747);let W=(0,E.op)({atan2_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,C._1)(e,"a","atan2"),r=(0,C._1)(t,"b","atan2");[n,r]=(0,U.makeTypesMatch)(n,r);let a={a:n,b:r};return k.BV.runKernel(S.QCc,a)}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.atan2=function(e){return this.throwIfDisposed(),W(this,e)};let z=(0,E.op)({atanh_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,C._1)(e,"x","atanh");return k.BV.runKernel(S.Oyi,{x:t})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.atanh=function(){return this.throwIfDisposed(),z(this)};var V=n(5176);(0,I.t3)().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),(0,V.w)(this,e,t,n,r)};var G=n(8441);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),(0,G.E)(this,e,t)};var j=n(94);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.batchNorm=function(e,t,n,r,a){return this.throwIfDisposed(),(0,j.t)(this,e,t,n,r,a)};var H=n(8247);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.broadcastTo=function(e){return this.throwIfDisposed(),(0,H.U)(this,e)},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.cast=function(e){return this.throwIfDisposed(),(0,M.p)(this,e)};let K=(0,E.op)({ceil_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,C._1)(e,"x","ceil","float32");return k.BV.runKernel(S.gJX,{x:t})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.ceil=function(){return this.throwIfDisposed(),K(this)};var X=n(2279);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),(0,X.i)(this,e,t)};var q=n(6884);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof I.es&&(e=[e]),(0,q.z)([this,...e],t)};var Y=n(1355);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.conv1d=function(e,t,n,r,a,i){return this.throwIfDisposed(),(0,Y.P)(this,e,t,n,r,a,i)};var Q=n(1405);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),(0,Q.b)(this,e,t,n,r,a)};var Z=n(4794);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.conv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),(0,Z.T)(this,e,t,n,r,a,i)};var J=n(173);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.cos=function(){return this.throwIfDisposed(),(0,J.m)(this)};var ee=n(2699);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.cosh=function(){return this.throwIfDisposed(),(0,ee.f)(this)};var et=n(5510);/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),(0,et.$)(this,e,t,n)};var en=n(7405);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),(0,en.z)(this,e,t,n)};let er=(0,E.op)({depthToSpace_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n="NHWC"){let r=(0,C._1)(e,"x","depthToSpace","float32"),a="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],s="NHWC"===n?r.shape[3]:r.shape[1];return O.hu(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),O.hu(a*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${t}  for depthToSpace with input shape
    ${r.shape}`),O.hu(i*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${t} for depthToSpace with input shape
        ${r.shape}`),O.hu(s%(t*t)==0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${s} for depthToSpace with input shape ${r.shape}`),k.BV.runKernel(S.T0n,{x:r},{blockSize:t,dataFormat:n})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),er(this,e,t)};var ea=n(4718);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.depthwiseConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),(0,ea.B)(this,e,t,n,r,a,i)};let ei=(0,E.op)({dilation2d_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r,a=[1,1],i="NHWC"){let s=(0,C._1)(e,"x","dilation2d"),o=(0,C._1)(t,"filter","dilation2d");O.hu(3===s.rank||4===s.rank,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${s.rank}.`),O.hu(3===o.rank,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),O.hu("NHWC"===i,()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=s,u=!1;3===s.rank&&(l=(0,_.X)(s,[1,s.shape[0],s.shape[1],s.shape[2]]),u=!0);let h={x:l,filter:o},c=k.BV.runKernel(S.p4S,h,{strides:n,pad:r,dilations:a});return u?(0,_.X)(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.dilation2d=function(e,t,n,r,a){return this.throwIfDisposed(),ei(this,e,t,n,r,a)};var es=n(1274),eo=n(6477),el=n(5912),eu=n(6577);let eh=(0,E.op)({divNoNan_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,C._1)(e,"a","div"),r=(0,C._1)(t,"b","div");[n,r]=(0,U.makeTypesMatch)(n,r);let a=(0,es.h)(n,r),i=(0,eu.P)(a),s=(0,eo.D)(r,i);return(0,el.a)(s,i,a)}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.divNoNan=function(e){return this.throwIfDisposed(),eh(this,e)},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.div=function(e){return this.throwIfDisposed(),(0,es.h)(this,e)};var ec=n(8687);let ed=(0,E.op)({dot_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,C._1)(e,"t1","dot"),r=(0,C._1)(t,"t2","dot");O.hu((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);let a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];if(O.hu(a===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${a} and ${i}.`),1===n.rank&&1===r.rank){let s=(0,_.X)(n,[1,-1]),o=(0,_.X)(r,[-1,1]),l=(0,ec.O)(s,o);return(0,_.X)(l,[])}if(1===n.rank&&2===r.rank){let u=(0,_.X)(n,[1,-1]),h=(0,_.X)(r,[r.shape[0],r.shape[1]]),c=(0,ec.O)(u,h);return(0,_.X)(c,[c.size])}if(2===n.rank&&1===r.rank){let d=(0,_.X)(r,[-1,1]),p=(0,ec.O)(n,d);return(0,_.X)(p,[p.size])}{let f=(0,_.X)(r,[r.shape[0],r.shape[1]]),m=(0,ec.O)(n,f);return m}}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.dot=function(e){return this.throwIfDisposed(),ed(this,e)};var ep=n(3233);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.elu=function(){return this.throwIfDisposed(),(0,ep.p)(this)},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.equal=function(e){return this.throwIfDisposed(),(0,eo.D)(this,e)};let ef=(0,E.op)({erf_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,C._1)(e,"x","erf");O.hu("int32"===t.dtype||"float32"===t.dtype,()=>"Input dtype must be `int32` or `float32`."),"int32"===t.dtype&&(t=(0,M.p)(t,"float32"));let n={x:t};return k.BV.runKernel(S.Omj,n)}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.erf=function(){return this.throwIfDisposed(),ef(this)};var em=n(3561);let eg=(0,E.op)({euclideanNorm_:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=null,n=!1){return(0,em.K)(e,"euclidean",t,n)}});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),eg(this,e,t)};var ey=n(4842);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.exp=function(){return this.throwIfDisposed(),(0,ey.Q)(this)};var eb=n(1300);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.expandDims=function(e){return this.throwIfDisposed(),(0,eb.d)(this,e)};let ex=(0,E.op)({expm1_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,C._1)(e,"x","expm1");return k.BV.runKernel(S.Y0y,{x:t})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.expm1=function(){return this.throwIfDisposed(),ex(this)};var ev=n(7020);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.fft=function(){return this.throwIfDisposed(),(0,ev.k)(this)},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.flatten=function(){return this.throwIfDisposed(),(0,_.X)(this,[this.size])};var ew=n(6943);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.floor=function(){return this.throwIfDisposed(),(0,ew.G)(this)};var eI=n(9165);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.floorDiv=function(e){return this.throwIfDisposed(),(0,eI.q)(this,e)};var ek=n(4926);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.gather=function(e,t){return this.throwIfDisposed(),(0,ek.I)(this,e,t)};var eS=n(7630);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.greaterEqual=function(e){return this.throwIfDisposed(),(0,eS.b)(this,e)};var eC=n(636);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.greater=function(e){return this.throwIfDisposed(),(0,eC.p)(this,e)};var eE=n(8447);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.ifft=function(){return this.throwIfDisposed(),(0,eE.S)(this)};var eT=n(4415);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.irfft=function(){return this.throwIfDisposed(),(0,eT.w)(this)};let e$=(0,E.op)({isFinite_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,C._1)(e,"x","isFinite");return k.BV.runKernel(S.avt,{x:t})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.isFinite=function(){return this.throwIfDisposed(),e$(this)};let eN=(0,E.op)({isInf_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,C._1)(e,"x","isInf");return k.BV.runKernel(S.iWB,{x:t})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.isInf=function(){return this.throwIfDisposed(),eN(this)};let eA=(0,E.op)({isNaN_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,C._1)(e,"x","isNaN");return k.BV.runKernel(S.r7n,{x:t})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.isNaN=function(){return this.throwIfDisposed(),eA(this)};var eD=n(9133);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.leakyRelu=function(e){return this.throwIfDisposed(),(0,eD.h)(this,e)};var eF=n(624);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.lessEqual=function(e){return this.throwIfDisposed(),(0,eF.z)(this,e)};var eR=n(6573);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.less=function(e){return this.throwIfDisposed(),(0,eR.d)(this,e)};let e_=(0,E.op)({localResponseNormalization_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=5,n=1,r=1,a=.5){let i=(0,C._1)(e,"x","localResponseNormalization");O.hu(4===i.rank||3===i.rank,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),O.hu(O.GN(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let s=i,o=!1;3===i.rank&&(o=!0,s=(0,_.X)(i,[1,i.shape[0],i.shape[1],i.shape[2]]));let l={x:s},u=k.BV.runKernel(S.eZ0,l,{depthRadius:t,bias:n,alpha:r,beta:a});return o?(0,_.X)(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),e_(this,e,t,n,r)};var eO=n(633),eM=n(4841),eB=n(7370),eP=n(625),eL=n(3694);let eU=(0,E.op)({logSigmoid_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,C._1)(e,"x","logSigmoid"),n=(0,eO.cb)(e=>{let t=(0,eB.W)((0,eL.W)((0,eB.W)(e))),n=t=>{let n=(0,eM.d)(t,(0,eP.X)((0,eB.W)(e)));return n};return{value:t,gradFunc:n}});return n(t)}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.logSigmoid=function(){return this.throwIfDisposed(),eU(this)};var eW=n(1510);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.logSoftmax=function(e){return this.throwIfDisposed(),(0,eW.C)(this,e)};var ez=n(1391);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),(0,ez.l)(this,e,t)};var eV=n(2597);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.log=function(){return this.throwIfDisposed(),(0,eV.c)(this)};var eG=n(7474);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.log1p=function(){return this.throwIfDisposed(),(0,eG.K)(this)};var ej=n(2856);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.logicalAnd=function(e){return this.throwIfDisposed(),(0,ej.H)(this,e)};var eH=n(8651);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.logicalNot=function(){return this.throwIfDisposed(),(0,eH.h)(this)};var eK=n(2200);let eX=(0,E.op)({logicalOr_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,C._1)(e,"a","logicalOr","bool"),r=(0,C._1)(t,"b","logicalOr","bool");return(0,eK.assertAndGetBroadcastShape)(n.shape,r.shape),k.BV.runKernel(S.MZg,{a:n,b:r})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.logicalOr=function(e){return this.throwIfDisposed(),eX(this,e)};let eq=(0,E.op)({logicalXor_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,C._1)(e,"a","logicalXor","bool"),r=(0,C._1)(t,"b","logicalXor","bool");return(0,eK.assertAndGetBroadcastShape)(n.shape,r.shape),(0,ej.H)(eX(e,t),(0,eH.h)((0,ej.H)(e,t)))}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.logicalXor=function(e){return this.throwIfDisposed(),eq(this,e)},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),(0,ec.O)(this,e,t,n)};var eY=n(1174);(0,I.t3)().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),(0,eY._)(this,e,t,n,r)};var eQ=n(3307);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.max=function(e,t){return this.throwIfDisposed(),(0,eQ.F)(this,e,t)};var eZ=n(632);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.maximum=function(e){return this.throwIfDisposed(),(0,eZ.g)(this,e)};var eJ=n(5130);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.mean=function(e,t){return this.throwIfDisposed(),(0,eJ.J)(this,e,t)};var e0=n(5735);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.min=function(e,t){return this.throwIfDisposed(),(0,e0.V)(this,e,t)};var e1=n(4513);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.minimum=function(e){return this.throwIfDisposed(),(0,e1.L)(this,e)};let e2=(0,E.op)({mirrorPad_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){O.hu("reflect"===n||"symmetric"===n,()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);let r=(0,C._1)(e,"x","mirrorPad");if(0===r.rank)throw Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");O.hu(t.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${t.length}.`);let a="reflect"===n?1:0;for(let i=0;i<r.rank;i++)O.hu(2===t[i].length,()=>"Invalid number of paddings. Must be length of 2 each."),O.hu(t[i][0]>=0&&t[i][0]<=r.shape[i]-a&&t[i][1]>=0&&t[i][1]<=r.shape[i]-a,()=>`Padding in dimension ${i} cannot be greater than or equal to ${r.shape[i]-a} or less than 0 for input of shape ${r.shape}`);return k.BV.runKernel(S.jQs,{x:r},{paddings:t,mode:n})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),e2(this,e,t)};let e3=(0,E.op)({mod_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=(0,C._1)(e,"a","mod"),r=(0,C._1)(t,"b","mod");[n,r]=(0,U.makeTypesMatch)(n,r);let a={a:n,b:r};return k.BV.runKernel(S.Vbg,a)}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.mod=function(e){return this.throwIfDisposed(),e3(this,e)},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.mul=function(e){return this.throwIfDisposed(),(0,eM.d)(this,e)},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.neg=function(){return this.throwIfDisposed(),(0,eB.W)(this)},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.norm=function(e,t,n){return this.throwIfDisposed(),(0,em.K)(this,e,t,n)};var e4=n(6500);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.notEqual=function(e){return this.throwIfDisposed(),(0,e4.Q)(this,e)};var e6=n(6708);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.oneHot=function(e,t=1,n=0){return this.throwIfDisposed(),(0,e6.l)(this,e,t,n)};var e5=n(7846);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.onesLike=function(){return this.throwIfDisposed(),(0,e5.J)(this)};var e7=n(9682);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.pad=function(e,t){return this.throwIfDisposed(),(0,e7.v)(this,e,t)};var e8=n(2582),e9=n(7918);let te=(0,E.op)({pool_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r,a,i,s){let o;null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");let l=(0,C._1)(e,"x","maxPool"),u=l,h=!1;3===l.rank&&(h=!0,u=(0,_.X)(l,[1,l.shape[0],l.shape[1],l.shape[2]])),O.hu(e8.jT(i,a),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${a}'`);let c=e8.Xw(u.shape,t,i,a,r),d=[c.dilationHeight,c.dilationWidth];o="same"===r?function(e,t){let n=e.map((e,n)=>e+(e-1)*(t[n]-1)),r=n.map(e=>e-1),a=r.map(e=>Math.floor(e/2)),i=r.map((e,t)=>e-a[t]);return r.map((e,t)=>[a[t],i[t]])}([c.filterHeight,c.filterWidth],d):[[0,0],[0,0]];let p=1===d[0]&&1===d[1],[f,m]=function(e,t,n){let r=n.map(e=>e[0]),a=n.map(e=>e[1]),i=e.concat(r,a),s=t.map((e,t)=>(e-i[t]%e)%e),o=a.map((e,t)=>e+s[t]),l=t.map((e,t)=>[r[t],o[t]]),u=t.map((e,t)=>[0,s[t]]);return[l,u]}([c.inHeight,c.inWidth],d,o),g=p?r:"valid",y=p?u:(0,e9.f)(u,d,f),b="avg"===n?()=>(0,V.w)(y,t,i,g,s):()=>(0,eY._)(y,t,i,g,s),x=b(),v=p?x:(0,G.E)(x,d,m);return h?(0,_.X)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}});(0,I.t3)().prototype.pool=function(e,t,n,r,a,i){return this.throwIfDisposed(),te(this,e,t,n,r,a,i)};var tt=n(3453);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.pow=function(e){return this.throwIfDisposed(),(0,tt.s)(this,e)};var tn=n(8151);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.prelu=function(e){return this.throwIfDisposed(),(0,tn.A)(this,e)};let tr=(0,E.op)({prod_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=null,n=!1){let r=(0,C._1)(e,"x","prod");"bool"===r.dtype&&(r=(0,M.p)(r,"int32"));let a={x:r};return k.BV.runKernel(S.DlI,a,{axis:t,keepDims:n})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.prod=function(e,t){return this.throwIfDisposed(),tr(this,e,t)};let ta=(0,E.op)({reciprocal_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,C._1)(e,"x","reciprocal");return k.BV.runKernel(S.$HU,{x:t})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.reciprocal=function(){return this.throwIfDisposed(),ta(this)};var ti=n(7409);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.relu=function(){return this.throwIfDisposed(),(0,ti.U)(this)};var ts=n(3582);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.relu6=function(){return this.throwIfDisposed(),(0,ts.b)(this)},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.reshapeAs=function(e){return this.throwIfDisposed(),(0,_.X)(this,e.shape)},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.reshape=function(e){return this.throwIfDisposed(),(0,_.X)(this,e)};var to=n(3305);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),(0,to.I)(this,e,t,n)};var tl=n(5098);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),(0,tl.j)(this,e,t,n)};var tu=n(7486);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.reverse=function(e){return this.throwIfDisposed(),(0,tu.G)(this,e)};var th=n(3710);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.rfft=function(){return this.throwIfDisposed(),(0,th.Q)(this)};var tc=n(7809);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.round=function(){return this.throwIfDisposed(),(0,tc.N)(this)};var td=n(2634);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.rsqrt=function(){return this.throwIfDisposed(),(0,td.b)(this)};var tp=n(5503);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.selu=function(){return this.throwIfDisposed(),(0,tp.U)(this)};var tf=n(8678);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.separableConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),(0,tf.U)(this,e,t,n,r,a,i)},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.sigmoid=function(){return this.throwIfDisposed(),(0,eP.X)(this)};let tm=(0,E.op)({sign_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,C._1)(e,"x","sign");return k.BV.runKernel(S.i5y,{x:t})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.sign=function(){return this.throwIfDisposed(),tm(this)};var tg=n(9331);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.sin=function(){return this.throwIfDisposed(),(0,tg.O)(this)};var ty=n(3254);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.sinh=function(){return this.throwIfDisposed(),(0,ty.R)(this)};var tb=n(2676);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.slice=function(e,t){return this.throwIfDisposed(),(0,tb.t)(this,e,t)};var tx=n(682);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.softmax=function(e){return this.throwIfDisposed(),(0,tx.X)(this,e)},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.softplus=function(){return this.throwIfDisposed(),(0,eL.W)(this)},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),(0,e9.f)(this,e,t)};var tv=n(8644);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.split=function(e,t){return this.throwIfDisposed(),(0,tv.V)(this,e,t)};var tw=n(3261);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.sqrt=function(){return this.throwIfDisposed(),(0,tw._)(this)};var tI=n(248);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.square=function(){return this.throwIfDisposed(),(0,tI.h)(this)};var tk=n(5265);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.squaredDifference=function(e){return this.throwIfDisposed(),(0,tk.$)(this,e)};var tS=n(9590);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.squeeze=function(e){return this.throwIfDisposed(),(0,tS.L)(this,e)};var tC=n(2991);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.stack=function(e,t){this.throwIfDisposed();let n=e instanceof I.es?[this,e]:[this,...e];return(0,tC.k)(n,t)};var tE=n(1901);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.step=function(e){return this.throwIfDisposed(),(0,tE.N)(this,e)};let tT=(0,E.op)({stridedSlice_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r,a=0,i=0,s=0,o=0,l=0){let u=(0,C._1)(e,"x","stridedSlice","string_or_numeric");return k.BV.runKernel(S.jQk,{x:u},{begin:t,end:n,strides:r,beginMask:a,endMask:i,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.stridedSlice=function(e,t,n,r,a,i,s,o){return this.throwIfDisposed(),tT(this,e,t,n,r,a,i,s,o)};var t$=n(827);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.sub=function(e){return this.throwIfDisposed(),(0,t$.l)(this,e)};var tN=n(5475);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.sum=function(e,t){return this.throwIfDisposed(),(0,tN.S)(this,e,t)};let tA=(0,E.op)({tan_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,C._1)(e,"x","tan","float32");return k.BV.runKernel(S.sEM,{x:t})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.tan=function(){return this.throwIfDisposed(),tA(this)};var tD=n(1869);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.tanh=function(){return this.throwIfDisposed(),(0,tD.A)(this)};var tF=n(7501);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.tile=function(e){return this.throwIfDisposed(),(0,tF.G)(this,e)},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.toBool=function(){return this.throwIfDisposed(),(0,M.p)(this,"bool")},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.toFloat=function(){return this.throwIfDisposed(),(0,M.p)(this,"float32")},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.toInt=function(){return this.throwIfDisposed(),(0,M.p)(this,"int32")};let tR=(0,E.op)({topk_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=1,n=!0){let r=(0,C._1)(e,"x","topk");if(0===r.rank)throw Error("topk() expects the input to be of rank 1 or higher");let a=r.shape[r.shape.length-1];if(t<0)throw Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>a)throw Error(`'k' passed to topk() must be <= the last dimension (${a}) but got ${t}`);let[i,s]=k.BV.runKernel(S.cWu,{x:r},{k:t,sorted:n});return{values:i,indices:s}}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.topk=function(e,t){return this.throwIfDisposed(),tR(this,e,t)};var t_=n(9065);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.transpose=function(e){return this.throwIfDisposed(),(0,t_.p)(this,e)};let tO=(0,E.op)({unique_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t=0){let n=(0,C._1)(e,"x","unique","string_or_numeric");(0,O.hu)(n.rank>0,()=>"The input tensor must be at least 1D");let[r,a]=k.BV.runKernel(S.kpP,{x:n},{axis:t});return{values:r,indices:a}}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.unique=function(e){return this.throwIfDisposed(),tO(this,e)};var tM=n(8749);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),(0,tM.p)(this,e,t)};var tB=n(4136);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.unstack=function(e){return this.throwIfDisposed(),(0,tB.H)(this,e)},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.where=function(e,t){return this.throwIfDisposed(),(0,el.a)(e,this,t)},/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,I.t3)().prototype.zerosLike=function(){return this.throwIfDisposed(),(0,eu.P)(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ var tP=n(3780);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let tL=(0,v.OBj)();tL.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")}),(s=p||(p={}))[s.DT_INVALID=0]="DT_INVALID",s[s.DT_FLOAT=1]="DT_FLOAT",s[s.DT_DOUBLE=2]="DT_DOUBLE",s[s.DT_INT32=3]="DT_INT32",s[s.DT_UINT8=4]="DT_UINT8",s[s.DT_INT16=5]="DT_INT16",s[s.DT_INT8=6]="DT_INT8",s[s.DT_STRING=7]="DT_STRING",s[s.DT_COMPLEX64=8]="DT_COMPLEX64",s[s.DT_INT64=9]="DT_INT64",s[s.DT_BOOL=10]="DT_BOOL",s[s.DT_QINT8=11]="DT_QINT8",s[s.DT_QUINT8=12]="DT_QUINT8",s[s.DT_QINT32=13]="DT_QINT32",s[s.DT_BFLOAT16=14]="DT_BFLOAT16",s[s.DT_QINT16=15]="DT_QINT16",s[s.DT_QUINT16=16]="DT_QUINT16",s[s.DT_UINT16=17]="DT_UINT16",s[s.DT_COMPLEX128=18]="DT_COMPLEX128",s[s.DT_HALF=19]="DT_HALF",s[s.DT_RESOURCE=20]="DT_RESOURCE",s[s.DT_VARIANT=21]="DT_VARIANT",s[s.DT_UINT32=22]="DT_UINT32",s[s.DT_UINT64=23]="DT_UINT64",s[s.DT_FLOAT_REF=101]="DT_FLOAT_REF",s[s.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",s[s.DT_INT32_REF=103]="DT_INT32_REF",s[s.DT_UINT8_REF=104]="DT_UINT8_REF",s[s.DT_INT16_REF=105]="DT_INT16_REF",s[s.DT_INT8_REF=106]="DT_INT8_REF",s[s.DT_STRING_REF=107]="DT_STRING_REF",s[s.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",s[s.DT_INT64_REF=109]="DT_INT64_REF",s[s.DT_BOOL_REF=110]="DT_BOOL_REF",s[s.DT_QINT8_REF=111]="DT_QINT8_REF",s[s.DT_QUINT8_REF=112]="DT_QUINT8_REF",s[s.DT_QINT32_REF=113]="DT_QINT32_REF",s[s.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",s[s.DT_QINT16_REF=115]="DT_QINT16_REF",s[s.DT_QUINT16_REF=116]="DT_QUINT16_REF",s[s.DT_UINT16_REF=117]="DT_UINT16_REF",s[s.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",s[s.DT_HALF_REF=119]="DT_HALF_REF",s[s.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",s[s.DT_VARIANT_REF=121]="DT_VARIANT_REF",s[s.DT_UINT32_REF=122]="DT_UINT32_REF",s[s.DT_UINT64_REF=123]="DT_UINT64_REF",(l=(o=f||(f={})).CheckpointFormatVersion||(o.CheckpointFormatVersion={}))[l.LEGACY=0]="LEGACY",l[l.V1=1]="V1",l[l.V2=2]="V2",n(1876).Buffer;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ var tU=n(4634);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function tW(e,t){Array.isArray(e)||(e=[e]),e.forEach(e=>{null!=e&&v.D5U.assert("complex64"!==e.dtype,()=>`${t} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let tz=v.GDt.ZA;class tV extends v.Zuw{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new v.JLz(this,(0,v.SRH)())}nextDataId(){return tV.nextDataId++}write(e,t,n){this.firstUse&&(this.firstUse=!1,(0,v.OBj)().get("IS_NODE")&&v.Wap.warn("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));let r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}makeTensorInfo(e,t,n){let r;if("string"===t&&null!=n&&n.length>0&&v.D5U.isString(n[0])){let a=n.map(e=>v.D5U.encodeString(e));r=this.write(a,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}refCount(e){if(this.data.has(e)){let t=this.data.get(e);return t.refCount}return 0}incRef(e){let t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){let t=this.data.get(e);t.refCount--}}move(e,t,n,r,a){this.data.set(e,{values:t,dtype:r,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){let{dtype:t,complexTensorInfos:n}=this.data.get(e);if("complex64"===t){let r=this.readSync(n.real.dataId),a=this.readSync(n.imag.dataId);return v.Wap.mergeRealAndImagArrays(r,a)}return this.data.get(e).values}bufferSync(e){let t=this.readSync(e.dataId);if("string"===e.dtype)try{let n=t.map(e=>v.D5U.decodeString(e));return(0,v.f3b)(e.shape,e.dtype,n)}catch(r){throw Error("Failed to decode encoded string bytes into utf-8")}return(0,v.f3b)(e.shape,e.dtype,t)}makeOutput(e,t,n){return(0,v.SRH)().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;let{complexTensorInfos:n}=this.data.get(e);null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){let t=v.D5U.now();e();let n=v.D5U.now()-t;return{kernelMs:n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){tW([e],"where");let t=this.readSync(e.dataId);return tz(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function tG(e,t,n){return({inputs:r,attrs:a,backend:i})=>{let{x:s}=r;if(tW(s,e),"string"===s.dtype||"string"===n)throw Error("unaryKernelFunc does not support string input/output");let o=i.data.get(s.dataId).values,l=v.D5U.sizeFromShape(s.shape),u=n||s.dtype,h=v.D5U.getArrayFromDType(u,l);for(let c=0;c<l;++c)h[c]=t(o[c],a);return i.makeTensorInfo(s.shape,u,h)}}function tj(e,t,n){return({inputs:r,attrs:a,backend:i})=>{let{x:s}=r;if(tW(s,e),"string"===s.dtype||"string"===n)throw Error("unaryKernelFunc does not support string input/output");let o=i.data.get(s.dataId).values,l=n||s.dtype,u=t(o,l,a);return i.makeTensorInfo(s.shape,l,u)}}tV.nextDataId=0,/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (0,v.jqO)("cpu",()=>new tV,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let tH=tG(v.SX0,e=>e>=0?e:Math.exp(e)-1),tK={kernelName:v.SX0,backendName:"cpu",kernelFunc:tH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function tX(e){let{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}let tq={kernelName:v.iJz,backendName:"cpu",kernelFunc:tX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function tY(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{alpha:i}=r;tW([a],"leakyRelu");let s=v.D5U.sizeFromShape(a.shape),o=n.data.get(a.dataId).values,l=v.D5U.getTypedArrayFromDType("float32",s);for(let u=0;u<o.length;u++)l[u]=o[u]<0?i*o[u]:o[u];return n.makeTensorInfo(a.shape,"float32",l)}let tQ={kernelName:v.J$2,backendName:"cpu",kernelFunc:tY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function tZ(e){return(t,n,r,a,i)=>{let s=v.Wap.assertAndGetBroadcastShape(t,n),o=s.length,l=v.D5U.computeStrides(s),u=v.D5U.sizeFromShape(s),h=v.D5U.getTypedArrayFromDType(i,u),c=t.length,d=n.length,p=v.D5U.computeStrides(t),f=v.D5U.computeStrides(n),m=v.Wap.getBroadcastDims(t,s),g=v.Wap.getBroadcastDims(n,s);if(m.length+g.length===0)for(let y=0;y<h.length;++y)h[y]=e(r[y%r.length],a[y%a.length]);else for(let b=0;b<h.length;++b){let x=v.D5U.indexToLoc(b,o,l),w=x.slice(-c);m.forEach(e=>w[e]=0);let I=v.D5U.locToIndex(w,c,p),k=x.slice(-d);g.forEach(e=>k[e]=0);let S=v.D5U.locToIndex(k,d,f);h[b]=e(r[I],a[S])}return[h,s]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let tJ=tZ((e,t)=>e<0?t*e:e);function t0(e){let{inputs:t,backend:n}=e,{x:r,alpha:a}=t;tW([r,a],"prelu");let i=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,[o,l]=tJ(r.shape,a.shape,i,s,"float32");return n.makeTensorInfo(l,"float32",o)}let t1={kernelName:v.o0g,backendName:"cpu",kernelFunc:t0},t2=tG(v.qkr,e=>Math.max(0,e)),t3={kernelName:v.qkr,backendName:"cpu",kernelFunc:t2},t4=tG(v.SbG,e=>Math.min(Math.max(0,e),6)),t6={kernelName:v.SbG,backendName:"cpu",kernelFunc:t4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function t5(e){return(t,n,r)=>{let a=v.D5U.getTypedArrayFromDType(n,t.length);for(let i=0;i<t.length;++i)a[i]=e(t[i],r);return a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let t7=t5(e=>1/(1+Math.exp(-e))),t8=tG(v.a5O,e=>1/(1+Math.exp(-e))),t9={kernelName:v.a5O,backendName:"cpu",kernelFunc:t8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function ne(e,t,n,r,a){if("linear"===n)return tX({inputs:{x:t},backend:e});if("relu"===n)return t2({inputs:{x:t},backend:e});if("elu"===n)return tH({inputs:{x:t},backend:e});if("relu6"===n)return t4({inputs:{x:t},backend:e});if("prelu"===n)return t0({inputs:{x:t,alpha:r},backend:e});if("leakyrelu"===n)return tY({inputs:{x:t},backend:e,attrs:{alpha:a}});if("sigmoid"===n)return t8({inputs:{x:t},backend:e});throw Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function nt(e){let{inputs:t,backend:n}=e,{real:r,imag:a}=t,i=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,o=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(o.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",s)},o}let nn={kernelName:v.Zz9,backendName:"cpu",kernelFunc:nt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function nr(e,t,n="float32"){if("complex64"===n){let r=nr(e,t,"float32"),a=nr(e,t,"float32");return nt({inputs:{real:r,imag:a},backend:e})}let i=v.D5U.makeZerosTypedArray(v.D5U.sizeFromShape(t),n);return e.makeTensorInfo(t,n,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function na(e){let{inputs:t,backend:n}=e,{input:r}=t,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}let ni={kernelName:v.xJR,backendName:"cpu",kernelFunc:na};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function ns(e,t,n,r){if("int32"===r){let a=Int32Array.from(e);return[t,"int32",a]}if("bool"===r){let i=v.D5U.toTypedArray([0],n),[s,o]=tZ((e,t)=>e!==t?1:0)(t,[],e,i,"bool");return[o,"bool",s]}throw Error(`Error in Cast: failed to cast ${n} to ${r}`)}function no(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dtype:i}=r;if("complex64"===i){if("complex64"===a.dtype)return tX({inputs:{x:a},backend:n});let s=nr(n,a.shape,a.dtype),o=no({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),l=nt({inputs:{real:o,imag:s},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}if("complex64"===a.dtype){let u=na({inputs:{input:a},backend:n}),h=no({inputs:{x:u},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(u),h}if(!v.D5U.hasEncodingLoss(a.dtype,i)){let c=tX({inputs:{x:a},backend:n});return{dataId:c.dataId,shape:c.shape,dtype:i}}let d=n.data.get(a.dataId).values,[p,f,m]=ns(d,a.shape,a.dtype,i);return n.makeTensorInfo(p,f,m)}let nl={kernelName:v.RFZ,backendName:"cpu",kernelFunc:no};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function nu(e,t,n,r){return null==n?({inputs:n,backend:a})=>{let{a:i,b:s}=n;tW([i,s],e);let o=a.data.get(i.dataId).values,l=a.data.get(s.dataId).values,u="string"===i.dtype?v.Wap.fromUint8ToStringArray(o):o,h="string"===i.dtype?v.Wap.fromUint8ToStringArray(l):l,c=r||i.dtype,[d,p]=t(i.shape,s.shape,u,h,c);return a.makeTensorInfo(p,c,d)}:({inputs:e,backend:a})=>{let{a:i,b:s}=e;if("complex64"===i.dtype||"complex64"===s.dtype){let o=no({inputs:{x:i},backend:a,attrs:{dtype:"complex64"}}),l=a.data.get(o.dataId),u=l.complexTensorInfos.real,h=l.complexTensorInfos.imag,c=a.data.get(u.dataId).values,d=a.data.get(h.dataId).values,p=no({inputs:{x:s},backend:a,attrs:{dtype:"complex64"}}),f=a.data.get(p.dataId),m=f.complexTensorInfos.real,g=f.complexTensorInfos.imag,y=a.data.get(m.dataId).values,b=a.data.get(g.dataId).values,[x,v,w]=n(i.shape,s.shape,c,d,y,b),I=a.makeTensorInfo(w,"float32",x),k=a.makeTensorInfo(w,"float32",v),S=nt({inputs:{real:I,imag:k},backend:a});return a.disposeIntermediateTensorInfo(o),a.disposeIntermediateTensorInfo(p),a.disposeIntermediateTensorInfo(I),a.disposeIntermediateTensorInfo(k),S}{let C=a.data.get(i.dataId).values,E=a.data.get(s.dataId).values,T=r||i.dtype,[$,N]=t(i.shape,s.shape,C,E,T);return a.makeTensorInfo(N,T,$)}}}function nh(e){return(t,n,r,a,i,s)=>{let o=v.Wap.assertAndGetBroadcastShape(t,n),l=v.D5U.sizeFromShape(o),u=o.length,h=v.D5U.computeStrides(o),c=v.D5U.getTypedArrayFromDType("float32",l),d=v.D5U.getTypedArrayFromDType("float32",l),p=v.Wap.getBroadcastDims(t,o),f=v.Wap.getBroadcastDims(n,o),m=v.Wap.mergeRealAndImagArrays(r,a),g=v.Wap.mergeRealAndImagArrays(i,s),y=t.length,b=v.D5U.computeStrides(t),x=n.length,w=v.D5U.computeStrides(n);if(p.length+f.length===0)for(let I=0;I<c.length;I++){let k=I%m.length,S=I%g.length,C=e(m[2*k],m[2*k+1],g[2*S],g[2*S+1]);c[I]=C.real,d[I]=C.imag}else for(let E=0;E<c.length;E++){let T=v.D5U.indexToLoc(E,u,h),$=T.slice(-y);p.forEach(e=>$[e]=0);let N=v.D5U.locToIndex($,y,b),A=T.slice(-x);f.forEach(e=>A[e]=0);let D=v.D5U.locToIndex(A,x,w),F=e(m[2*N],m[2*N+1],g[2*D],g[2*D+1]);c[E]=F.real,d[E]=F.imag}return[c,d,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let nc=tZ((e,t)=>e+t),nd=nh((e,t,n,r)=>({real:e+n,imag:t+r})),np=nu(v.mm_,nc,nd),nf={kernelName:v.mm_,backendName:"cpu",kernelFunc:np};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function nm(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{shape:i}=r,s=v.D5U.sizeFromShape(a.shape),o=v.D5U.inferFromImplicitShape(i,s),l=v.D5U.sizeFromShape(o);v.D5U.assert(s===l,()=>`The new shape (${o}) has ${l} elements and the old shape (${a.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`),n.incRef(a.dataId);let u=n.data.get(a.dataId);if(null!=u.complexTensorInfos){let h=u.complexTensorInfos.real,c=u.complexTensorInfos.imag;h.shape=o,c.shape=o}return{dataId:a.dataId,shape:o,dtype:a.dtype}}let ng={kernelName:v.HZH,backendName:"cpu",kernelFunc:nm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function ny(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:i}=t,{transposeA:s,transposeB:o}=r;tW([a,i],"matMul");let l=a.shape.length,u=i.shape.length,h=s?a.shape[l-2]:a.shape[l-1],c=o?i.shape[u-1]:i.shape[u-2],d=s?a.shape[l-1]:a.shape[l-2],p=o?i.shape[u-2]:i.shape[u-1],f=a.shape.slice(0,-2),m=i.shape.slice(0,-2),g=v.D5U.sizeFromShape(f),y=v.D5U.sizeFromShape(m),b=v.Jyw.assertAndGetBroadcastShape(a.shape.slice(0,-2),i.shape.slice(0,-2)),x=b.concat([d,p]);v.D5U.assert(h===c,()=>`Error in matMul: inner shapes (${h}) and (${c}) of Tensors with shapes ${a.shape} and ${i.shape} and transposeA=${s} and transposeB=${o} must match.`);let w=nm({inputs:{x:a},backend:n,attrs:{shape:s?[g,h,d]:[g,d,h]}}),I=nm({inputs:{x:i},backend:n,attrs:{shape:o?[y,p,c]:[y,c,p]}}),k=s?w.shape[1]:w.shape[2],S=s?w.shape[2]:w.shape[1],C=o?I.shape[1]:I.shape[2],E=Math.max(g,y),T=n.data.get(w.dataId).values,$=n.data.get(I.dataId).values,N=v.D5U.computeStrides(w.shape),A=v.D5U.computeStrides(I.shape),[D,F,R]=s?[N[0],1,N[1]]:[N[0],N[1],1],[_,O,M]=o?[1,A[1],A[0]]:[A[1],1,A[0]],B=S*C,P=(0,v.f3b)([E,S,C],w.dtype),L=P.values,U=n.blockSize;for(let W=0;W<E;W++)for(let z=0;z<S;z+=U)for(let V=0;V<C;V+=U)for(let G=0;G<k;G+=U){let j=Math.min(z+U,S),H=Math.min(V+U,C),K=Math.min(G+U,k);for(let X=z;X<j;X++)for(let q=V;q<H;q++){let Y=0;for(let Q=G;Q<K;Q++){let Z=Math.min(W,g-1)*D,J=Math.min(W,y-1)*M,ee=T[Z+X*F+Q*R],et=$[Q*_+q*O+J];Y+=ee*et}L[W*B+(X*C+q)]+=Y}}return n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(I),n.makeTensorInfo(x,P.dtype,P.values)}let nb={kernelName:v.XLW,backendName:"cpu",kernelFunc:ny},nx={kernelName:v.usg,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t,n,r;let{inputs:a,backend:i,attrs:s}=e,{a:o,b:l,bias:u,preluActivationWeights:h}=a,{transposeA:c,transposeB:d,activation:p,leakyreluAlpha:f}=s,m=[],g=ny({inputs:{a:o,b:l},attrs:{transposeA:c,transposeB:d},backend:i});for(let y of(t=g,u&&(n=np({inputs:{a:t,b:u},backend:i}),m.push(t),t=n),p&&(r=ne(i,t,p,h,f),m.push(t),t=r),m))i.disposeIntermediateTensorInfo(y);return t}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function nv(e){let t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}let nw=e=>{let{x:t}=e.inputs,n=e.backend;tW(t,"abs");let r=new Float32Array(v.D5U.sizeFromShape(t.shape)),a=n.data.get(t.dataId).values;return r=nv(a),n.makeOutput(r,t.shape,t.dtype)},nI={kernelName:v.SYM,backendName:"cpu",kernelFunc:nw},nk=tG(v.VGw,e=>Math.acos(e)),nS={kernelName:v.VGw,backendName:"cpu",kernelFunc:nk},nC=tG(v.SpW,e=>Math.acosh(e)),nE={kernelName:v.SpW,backendName:"cpu",kernelFunc:nC},nT={kernelName:v.Xze,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e;tW(t,"addN");let r=t.map(e=>n.data.get(e.dataId).values),a=(0,v.f3b)(t[0].shape,t[0].dtype),i=a.values;for(let s=0;s<t.length;s++){let o=r[s];for(let l=0;l<i.length;l++)i[l]+=o[l]}return n.makeTensorInfo(a.shape,a.dtype,a.values)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function n$(e,t,n,r,a){let i=t.length,s=v.D5U.sizeFromShape(t),o=v.D5U.computeStrides(t),l=v.D5U.computeStrides(a),u=v.D5U.getTypedArrayFromDType(n,v.D5U.sizeFromShape(a));for(let h=0;h<s;++h){let c=v.D5U.indexToLoc(h,i,o),d=Array(c.length);for(let p=0;p<d.length;p++)d[p]=c[r[p]];let f=v.D5U.locToIndex(d,i,l);u[f]=e[h]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function nN(e){let{inputs:t,attrs:n,backend:r}=e,{x:a}=t,{perm:i}=n;tW(a,"transpose");let s=a.shape.length,o=Array(s);for(let l=0;l<o.length;l++)o[l]=a.shape[i[l]];let u=r.data.get(a.dataId).values,h=n$(u,a.shape,a.dtype,i,o),c=r.write(h,o,a.dtype);return{dataId:c,shape:o,dtype:a.dtype}}let nA={kernelName:v.G3Y,backendName:"cpu",kernelFunc:nN},nD={kernelName:v.oT6,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;tW(a,"all");let o=v.D5U.parseAxisParam(i,a.shape),l=o,u=v.Wap.getAxesPermutation(l,a.shape.length),h=a;null!=u&&(h=nN({inputs:{x:a},backend:n,attrs:{perm:u}}),l=v.Wap.getInnerMostAxes(l.length,a.shape.length)),v.Wap.assertAxesAreInnerMostDims("all",l,h.shape.length);let[c,d]=v.Wap.computeOutAndReduceShapes(h.shape,l),p=v.D5U.sizeFromShape(d),f=v.D5U.makeZerosTypedArray(v.D5U.sizeFromShape(c),h.dtype),m=n.data.get(h.dataId).values;for(let g=0;g<f.length;++g){let y=g*p,b=m[y];for(let x=0;x<p;++x){let w=m[y+x];b=b&&w}f[g]=b}null!=u&&n.disposeIntermediateTensorInfo(h);let I=n.makeTensorInfo(c,h.dtype,f);if(s){let k=v.Wap.expandShapeToKeepDim(c,o),S=nm({inputs:{x:I},backend:n,attrs:{shape:k}});return n.disposeIntermediateTensorInfo(I),S}return I}},nF={kernelName:v.IKK,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;tW(a,"any");let o=v.D5U.parseAxisParam(i,a.shape),l=o,u=v.Wap.getAxesPermutation(l,a.shape.length),h=a;null!=u&&(h=nN({inputs:{x:a},backend:n,attrs:{perm:u}}),l=v.Wap.getInnerMostAxes(l.length,a.shape.length)),v.Wap.assertAxesAreInnerMostDims("any",l,h.shape.length);let[c,d]=v.Wap.computeOutAndReduceShapes(h.shape,l),p=v.D5U.sizeFromShape(d),f=v.D5U.makeZerosTypedArray(v.D5U.sizeFromShape(c),h.dtype),m=n.data.get(h.dataId).values;for(let g=0;g<f.length;++g){let y=g*p,b=m[y];for(let x=0;x<p;++x){let w=m[y+x];b=b||w}f[g]=b}null!=u&&n.disposeIntermediateTensorInfo(h);let I=n.makeTensorInfo(c,h.dtype,f);if(s){let k=v.Wap.expandShapeToKeepDim(c,o),S=nm({inputs:{x:I},backend:n,attrs:{shape:k}});return n.disposeIntermediateTensorInfo(I),S}return I}},nR={kernelName:v.sJF,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r;tW(a,"argMax");let s=v.D5U.parseAxisParam(i,a.shape),o=v.Wap.getAxesPermutation(s,a.shape.length),l=a,u=[];null!=o&&(u.push(l=nN({inputs:{x:a},backend:n,attrs:{perm:o}})),s=v.Wap.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],v.Wap.assertAxesAreInnerMostDims("argMax",s,l.shape.length);let[h,c]=v.Wap.computeOutAndReduceShapes(l.shape,s),d=v.D5U.sizeFromShape(h),p=v.D5U.makeZerosTypedArray(d,"int32"),f=v.D5U.sizeFromShape(c),m=n.data.get(l.dataId).values;for(let g=0;g<p.length;++g){let y=g*f,b=m[y],x=0;for(let w=0;w<f;++w){let I=m[y+w];I>b&&(b=I,x=w)}p[g]=x}return u.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(h,"int32",p)}},n_={kernelName:v.aJk,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r;tW(a,"argMin");let s=v.D5U.parseAxisParam(i,a.shape),o=v.Wap.getAxesPermutation(s,a.shape.length),l=a,u=[];null!=o&&(u.push(l=nN({inputs:{x:a},backend:n,attrs:{perm:o}})),s=v.Wap.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],v.Wap.assertAxesAreInnerMostDims("argMin",s,l.shape.length);let[h,c]=v.Wap.computeOutAndReduceShapes(l.shape,s),d=v.D5U.sizeFromShape(h),p=v.D5U.makeZerosTypedArray(d,"int32"),f=v.D5U.sizeFromShape(c),m=n.data.get(l.dataId).values;for(let g=0;g<p.length;++g){let y=g*f,b=m[y],x=0;for(let w=0;w<f;++w){let I=m[y+w];I<b&&(b=I,x=w)}p[g]=x}return u.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(h,"int32",p)}},nO=tG(v.M2y,e=>Math.asin(e)),nM={kernelName:v.M2y,backendName:"cpu",kernelFunc:nO},nB=tG(v.qw7,e=>Math.asinh(e)),nP={kernelName:v.qw7,backendName:"cpu",kernelFunc:nB},nL=tG(v.jMg,e=>Math.atan(e)),nU={kernelName:v.jMg,backendName:"cpu",kernelFunc:nL},nW=tZ((e,t)=>Math.atan2(e,t)),nz=nu(v.QCc,nW),nV={kernelName:v.QCc,backendName:"cpu",kernelFunc:nz},nG=tG(v.Oyi,e=>Math.atanh(e)),nj={kernelName:v.Oyi,backendName:"cpu",kernelFunc:nG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function nH(e,t,n,r,a,i){let s=a.strideHeight,o=a.strideWidth,l=a.dilationHeight,u=a.dilationWidth,h=a.effectiveFilterHeight,c=a.effectiveFilterWidth,d=a.padInfo.top,p=a.padInfo.left,f="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=(0,v.f3b)(a.outShape,n),g=m.values,y=a.outShape[1]*a.outShape[2]*a.outShape[3],b=a.outShape[2]*a.outShape[3],x=a.outShape[3];for(let w=0;w<a.batchSize;++w){let I=w*y,k=w*r[0];for(let S=0;S<a.inChannels;++S)for(let C=0;C<a.outHeight;++C){let E=C*s-d,T=Math.max(0,E),$=Math.min(a.inHeight,h+E),N=I+C*b;for(let A=0;A<a.outWidth;++A){let D=A*o-p,F=Math.max(0,D),R=Math.min(a.inWidth,c+D),_=f,O=0,M=0;for(let B=T;B<$;B+=l){let P=k+B*r[1];for(let L=F;L<R;L+=u){let U=P+L*r[2],W=e[U+S];"max"===i&&W>_?_=W:"avg"===i&&(O+=W,M++)}if(isNaN(_))break}let z=N+A*x+S;g[z]="avg"===i?O/M:_}}}return m}function nK(e,t,n,r,a=!1,i=!1){let s=(0,v.f3b)(r.outShape,"int32"),o=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,h=r.dilationWidth,c=r.effectiveFilterHeight,d=r.effectiveFilterWidth,p=r.padInfo.top,f=r.padInfo.left,m=(0,v.f3b)(t,n,e);for(let g=0;g<r.batchSize;++g)for(let y=0;y<r.inChannels;++y)for(let b=0;b<r.outHeight;++b){let x=b*o-p,w=x;for(;w<0;)w+=u;let I=Math.min(r.inHeight,c+x);for(let k=0;k<r.outWidth;++k){let S=k*l-f,C=S;for(;C<0;)C+=h;let E=Math.min(r.inWidth,d+S),T=Number.NEGATIVE_INFINITY,$=-1;for(let N=w;N<I;N+=u){let A=N-x;for(let D=C;D<E;D+=h){let F=D-S,R=m.get(g,N,D,y);R>T&&(T=R,$=a?i?((g*r.inHeight+N)*r.inWidth+D)*r.inChannels+y:(N*r.inWidth+D)*r.inChannels+y:A*d+F)}}s.set($,g,b,k,y)}}return s}function nX(e,t,n,r,a,i){let s=a.strideDepth,o=a.strideHeight,l=a.strideWidth,u=a.dilationDepth,h=a.dilationHeight,c=a.dilationWidth,d=a.effectiveFilterDepth,p=a.effectiveFilterHeight,f=a.effectiveFilterWidth,m=a.padInfo.front,g=a.padInfo.top,y=a.padInfo.left,b="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=(0,v.f3b)(a.outShape,n),w=x.values,I=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],k=a.outShape[2]*a.outShape[3]*a.outShape[4],S=a.outShape[3]*a.outShape[4],C=a.outShape[4];for(let E=0;E<a.batchSize;++E){let T=E*I,$=E*r[0];for(let N=0;N<a.inChannels;++N)for(let A=0;A<a.outDepth;++A){let D=A*s-m,F=D;for(;F<0;)F+=u;let R=Math.min(a.inDepth,d+D),_=T+A*k;for(let O=0;O<a.outHeight;++O){let M=O*o-g,B=M;for(;B<0;)B+=h;let P=Math.min(a.inHeight,p+M),L=_+O*S;for(let U=0;U<a.outWidth;++U){let W=U*l-y,z=W;for(;z<0;)z+=c;let V=Math.min(a.inWidth,f+W),G=L+U*C,j=b,H=0,K=0;for(let X=F;X<R;X+=u){let q=$+X*r[1];for(let Y=B;Y<P;Y+=h){let Q=q+Y*r[2];for(let Z=z;Z<V;Z+=c){let J=Q+Z*r[3],ee=e[J+N];if("max"===i&&ee>j?j=ee:"avg"===i&&(H+=ee,K++),isNaN(j))break}if(isNaN(j))break}if(isNaN(j))break}let et=G+N;w[et]="avg"===i?H/K:j}}}}return x}let nq={kernelName:v.JhU,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t;let{inputs:n,backend:r,attrs:a}=e,{x:i}=n;tW(i,"avgPool");let{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=a;v.D5U.assert(v.Wap.eitherStridesOrDilationsAreOne(o,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);let h=v.Wap.computePool2DInfo(i.shape,s,o,1,l,u);if(1===h.filterWidth&&1===h.filterHeight&&v.D5U.arraysEqual(h.inShape,h.outShape))t=tX({inputs:{x:i},backend:r});else{let c=r.data.get(i.dataId).values,d=v.D5U.computeStrides(i.shape),p=nH(c,i.shape,i.dtype,d,h,"avg");t=r.makeTensorInfo(h.outShape,i.dtype,p.values)}return t}},nY={kernelName:v._k9,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:u}=r;tW(a,"avgPool3d");let h=v.Wap.computePool3DInfo(a.shape,i,s,1,o,l,u),c=n.data.get(a.dataId).values,d=nX(c,a.shape,a.dtype,v.D5U.computeStrides(a.shape),h,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}},nQ={kernelName:v.IMb,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=r;tW([a,i],"avgPool3DGrad");let h=v.Wap.computePool3DInfo(i.shape,s,o,1,l,u),c=h.strideDepth,d=h.strideHeight,p=h.strideWidth,f=h.filterDepth,m=h.filterHeight,g=h.filterWidth,y=h.dilationDepth,b=h.dilationHeight,x=h.dilationWidth,w=h.effectiveFilterDepth,I=h.effectiveFilterHeight,k=h.effectiveFilterWidth,S=w-1-h.padInfo.front,C=k-1-h.padInfo.left,E=I-1-h.padInfo.top,T=(0,v.f3b)(i.shape,"float32"),$=1/(f*m*g),N=n.bufferSync(a);for(let A=0;A<h.batchSize;++A)for(let D=0;D<h.inChannels;++D)for(let F=0;F<h.inDepth;++F)for(let R=0;R<h.inHeight;++R)for(let _=0;_<h.inWidth;++_){let O=F-S,M=R-E,B=_-C,P=0;for(let L=0;L<w;L+=y){let U=(O+L)/c;if(!(U<0)&&!(U>=h.outDepth)&&Math.floor(U)===U)for(let W=0;W<I;W+=b){let z=(M+W)/d;if(!(z<0)&&!(z>=h.outHeight)&&Math.floor(z)===z)for(let V=0;V<k;V+=x){let G=(B+V)/p;if(G<0||G>=h.outWidth||Math.floor(G)!==G)continue;let j=N.get(A,U,z,G,D);P+=j}}}T.set(P*$,A,F,R,_,D)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}},nZ={kernelName:v.ROF,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t;tW([a,i],"avgPoolGrad");let{filterSize:s,strides:o,pad:l}=r,u=v.Wap.computePool2DInfo(i.shape,s,o,1,l),h=u.strideHeight,c=u.strideWidth,d=u.filterHeight,p=u.filterWidth,f=u.dilationHeight,m=u.dilationWidth,g=u.effectiveFilterHeight,y=u.effectiveFilterWidth,b=y-1-u.padInfo.left,x=g-1-u.padInfo.top,w=(0,v.f3b)(i.shape,"float32"),I=1/(d*p),k=n.data.get(a.dataId).values,S=(0,v.f3b)(a.shape,"float32",k);for(let C=0;C<u.batchSize;++C)for(let E=0;E<u.inChannels;++E)for(let T=0;T<u.inHeight;++T)for(let $=0;$<u.inWidth;++$){let N=T-x,A=$-b,D=0;for(let F=0;F<g;F+=f){let R=(N+F)/h;if(!(R<0)&&!(R>=u.outHeight)&&Math.floor(R)===R)for(let _=0;_<y;_+=m){let O=(A+_)/c;if(O<0||O>=u.outWidth||Math.floor(O)!==O)continue;let M=S.get(C,R,O,E);D+=M}}w.set(D*I,C,T,$,E)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}},nJ={kernelName:v.sHE,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,scale:i,offset:s,mean:o,variance:l}=t;v.D5U.assert(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),v.D5U.assert(null==s||o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),v.D5U.assert(null==i||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),tW([a,o,l,i,s],"batchNorm");let{varianceEpsilon:u}=r;null==u&&(u=.001);let h=n.data.get(a.dataId).values,c=n.data.get(o.dataId).values,d=n.data.get(l.dataId).values,p=i?n.data.get(i.dataId).values:new Float32Array([1]),f=s?n.data.get(s.dataId).values:new Float32Array([0]),m=new Float32Array(h.length),g=f.length,y=p.length,b=d.length,x=c.length,w=0,I=0,k=0,S=0;for(let C=0;C<h.length;++C)m[C]=f[w++]+(h[C]-c[I++])*p[k++]/Math.sqrt(d[S++]+u),w>=g&&(w=0),I>=x&&(I=0),k>=y&&(k=0),S>=b&&(S=0);return n.makeTensorInfo(a.shape,a.dtype,m)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function n0(e,t,n,r,a){let i=v.kuN.isSliceContinous(r,t,n),s=v.D5U.sizeFromShape(n),o=v.D5U.computeStrides(r);if(i){let l=v.kuN.computeFlatOffset(t,o);return"string"===a?e.slice(l,l+s):e.subarray(l,l+s)}let u="string"===a?v.Wap.fromUint8ToStringArray(e):e,h=(0,v.f3b)(r,a,u),c=(0,v.f3b)(n,a);for(let d=0;d<c.size;++d){let p=c.indexToLoc(d),f=p.map((e,n)=>e+t[n]);c.set(h.get(...f),...p)}return"string"===a?v.Wap.fromStringArrayToUint8(c.values):c.values}function n1(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,size:s}=r;tW(a,"slice");let[o,l]=v.kuN.parseSliceParams(a,i,s);v.kuN.assertParamsValid(a,o,l);let u=n.data.get(a.dataId).values,h=n0(u,o,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,h)}let n2={kernelName:v.p2w,backendName:"cpu",kernelFunc:n1},n3={kernelName:v.zws,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,crops:s}=r;tW([a],"batchToSpaceND");let o=i.reduce((e,t)=>e*t),l=v.Wap.getReshaped(a.shape,i,o),u=v.Wap.getPermuted(l.length,i.length),h=v.Wap.getReshapedPermuted(a.shape,i,o),c=v.Wap.getSliceBeginCoords(s,i.length),d=v.Wap.getSliceSize(h,s,i.length),p=nm({inputs:{x:a},backend:n,attrs:{shape:l}}),f=nN({inputs:{x:p},backend:n,attrs:{perm:u}}),m=nm({inputs:{x:f},backend:n,attrs:{shape:h}}),g=n1({inputs:{x:m},backend:n,attrs:{begin:c,size:d}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function n4(e,t,n,r,a){let i=v.D5U.sizeFromShape(r),s=v.D5U.makeZerosTypedArray(a,n);for(let o=0;o<e.length;o++){let l=e[o];if(l<0)throw Error("Input x must be non-negative!");l>=a||(i>0?s[l]+=t[o]:s[l]+=1)}return s}function n6(e,t,n,r=!1){let a=e.shape[0],i=e.shape[1],s=(0,v.f3b)([a,n],t.dtype);for(let o=0;o<a;o++)for(let l=0;l<i;l++){let u=e.get(o,l);if(u<0)throw Error("Input x must be non-negative!");u>=n||(r?s.set(1,o,u):t.size>0?s.set(s.get(o,u)+t.get(o,l),o,u):s.set(s.get(o,u)+1,o,u))}return s}let n5={kernelName:v.zvY,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:s}=r,o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,u=n4(o,l,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,u)}},n7={kernelName:v.eEB,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{s0:r,s1:a}=t,i=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,o=v.Wap.assertAndGetBroadcastShape(Array.from(i),Array.from(s));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}},n8=t5(e=>Math.ceil(e)),n9=tj(v.gJX,n8),re={kernelName:v.gJX,backendName:"cpu",kernelFunc:n9},rt=tG(v.xnO,(e,t)=>e>t.clipValueMax?t.clipValueMax:e<t.clipValueMin?t.clipValueMin:e),rn={kernelName:v.xnO,backendName:"cpu",kernelFunc:rt},rr=e=>{let{x:t}=e.inputs,n=e.backend,r=new Float32Array(v.D5U.sizeFromShape(t.shape)),a=n.data.get(t.dataId),i=a.complexTensorInfos.real,s=a.complexTensorInfos.imag,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values;for(let u=0;u<o.length;u++){let h=o[u],c=l[u];r[u]=Math.hypot(h,c)}return n.makeOutput(r,t.shape,"float32")},ra={kernelName:v.yj2,backendName:"cpu",kernelFunc:rr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function ri(e,t,n,r){let a=v.D5U.getArrayFromDType(n,v.D5U.sizeFromShape(t));if(r&&"string"!==n){let i=0;e.forEach(e=>{let t=v.D5U.sizeFromShape(e.shape);a.set(e.vals,i),i+=t})}else{let s=0;e.forEach(e=>{let r="string"===n?v.Wap.fromUint8ToStringArray(e.vals):e.vals,i=0;for(let o=0;o<e.shape[0];++o){let l=o*t[1]+s;for(let u=0;u<e.shape[1];++u)a[l+u]=r[i++]}s+=e.shape[1]})}return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function rs(e){let{inputs:t,backend:n}=e,{input:r}=t,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}let ro={kernelName:v.J_u,backendName:"cpu",kernelFunc:rs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function rl(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r,i=v.D5U.parseAxisParam(a,t[0].shape)[0],s=t.map(e=>e.shape);v.Wap.assertParamsConsistent(s,i);let o=v.Wap.computeOutShape(t.map(e=>e.shape),i);if(0===v.D5U.sizeFromShape(o))return n.makeTensorInfo(o,t[0].dtype,[]);let l=t.filter(e=>v.D5U.sizeFromShape(e.shape)>0);if(1===l.length)return tX({inputs:{x:l[0]},backend:n});if("complex64"===l[0].dtype){let u=l.map(e=>na({inputs:{input:e},backend:n})),h=l.map(e=>rs({inputs:{input:e},backend:n})),c=rl({inputs:u,backend:n,attrs:{axis:i}}),d=rl({inputs:h,backend:n,attrs:{axis:i}}),p=nt({inputs:{real:c,imag:d},backend:n});return u.forEach(e=>n.disposeIntermediateTensorInfo(e)),h.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),p}let f=l.map(e=>{let t=v.D5U.sizeFromShape(e.shape.slice(i));return nm({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})}),m=f.map(e=>({vals:n.data.get(e.dataId).values,shape:e.shape}));o=v.Wap.computeOutShape(f.map(e=>e.shape),1);let g=1===f[0].shape[0],y=ri(m,o,t[0].dtype,g),b=v.Wap.computeOutShape(l.map(e=>e.shape),i),x=n.makeTensorInfo(b,t[0].dtype,y);return f.forEach(e=>n.disposeIntermediateTensorInfo(e)),x}let ru={kernelName:v.Eh3,backendName:"cpu",kernelFunc:rl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function rh(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dataFormat:l,dilations:u,dimRoundingMode:h}=r;tW([a,i],"conv2d");let c=v.Wap.convertConv2DDataFormat(l),d=v.Wap.computeConv2DInfo(a.shape,i.shape,s,u,o,h,!1,c),p=d.filterHeight,f=d.filterWidth,m=d.dilationHeight,g=d.dilationWidth,y=d.padInfo.left,b=d.padInfo.top,x="channelsLast"===d.dataFormat,w=new v.YDk(d.outShape,a.dtype),I=v.D5U.computeStrides(a.shape),k=v.D5U.computeStrides(i.shape),S=I[0],C=x?I[1]:I[2],E=x?I[2]:1,T=x?1:I[1],$=w.strides[0],N=x?w.strides[1]:w.strides[2],A=x?w.strides[2]:1,D=x?1:w.strides[1],F=n.data.get(a.dataId).values,R=n.data.get(i.dataId).values,_=w.values;for(let O=0;O<d.batchSize;++O){let M=O*S,B=O*$;for(let P=0;P<d.outHeight;++P){let L=B+P*N,U=P*d.strideHeight-b;for(let W=0;W<p;++W){let z=U+W*m;if(z<0||z>=d.inHeight)continue;let V=W*k[0],G=M+z*C;for(let j=0;j<d.outWidth;++j){let H=L+j*A,K=j*d.strideWidth-y;for(let X=0;X<f;++X){let q=K+X*g;if(q<0||q>=d.inWidth)continue;let Y=V+X*k[1],Q=G+q*E,Z=Y;for(let J=0;J<d.inChannels;++J){let ee=F[Q+J*T];for(let et=0;et<d.outChannels;++et)_[H+et*D]+=ee*R[Z+et];Z+=d.outChannels}}}}}}return n.makeTensorInfo(w.shape,w.dtype,_)}let rc={kernelName:v.mhS,backendName:"cpu",kernelFunc:rh},rd={kernelName:v.wUP,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:h}=r;tW([a,i],"conv2dBackpropFilter");let c=v.Wap.convertConv2DDataFormat(l),d=v.Wap.computeConv2DInfo(a.shape,h,s,1,o,u,!1,c),{strideHeight:p,strideWidth:f,filterHeight:m,filterWidth:g}=d,y="channelsLast"===d.dataFormat,b=new v.YDk(d.filterShape,"float32"),x=d.padInfo.left,w=d.padInfo.top,I=n.data.get(a.dataId).values,k=n.data.get(i.dataId).values,S=new v.YDk(a.shape,a.dtype,I),C=new v.YDk(i.shape,i.dtype,k);for(let E=0;E<m;++E){let T=Math.max(0,Math.ceil((w-E)/p)),$=Math.min(d.outHeight,(d.inHeight+w-E)/p);for(let N=0;N<g;++N){let A=Math.max(0,Math.ceil((x-N)/f)),D=Math.min(d.outWidth,(d.inWidth+x-N)/f);for(let F=0;F<d.inChannels;++F)for(let R=0;R<d.outChannels;++R){let _=0;for(let O=0;O<d.batchSize;++O)for(let M=T;M<$;++M){let B=E+M*p-w;for(let P=A;P<D;++P){let L=N+P*f-x;y?_+=S.get(O,B,L,F)*C.get(O,M,P,R):_+=S.get(O,F,B,L)*C.get(O,R,M,P)}}b.set(_,E,N,F,R)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}},rp={kernelName:v.wm,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{inputShape:s,strides:o,pad:l,dataFormat:u,dimRoundingMode:h}=r;tW([a,i],"conv2dBackpropInput");let c=v.D5U.computeStrides(i.shape),d=v.D5U.computeStrides(a.shape),p=v.Wap.convertConv2DDataFormat(u),f=v.Wap.computeConv2DInfo(s,i.shape,o,1,l,h,!1,p),m=new v.YDk(f.inShape,"float32"),g=m.values,y=n.data.get(a.dataId).values,b=n.data.get(i.dataId).values,[x,w,I]=c,{batchSize:k,filterHeight:S,filterWidth:C,inChannels:E,inHeight:T,inWidth:$,outChannels:N,outHeight:A,outWidth:D,strideHeight:F,strideWidth:R}=f;p=f.dataFormat;let _=S-1-f.padInfo.top,O=C-1-f.padInfo.left,M="channelsLast"===p,B=m.strides[0],P=M?m.strides[1]:m.strides[2],L=M?m.strides[2]:1,U=M?1:m.strides[1],W=d[0],z=M?d[1]:d[2],V=M?d[2]:1,G=M?1:d[1];for(let j=0;j<k;++j)for(let H=0;H<E;++H)for(let K=0;K<T;++K){let X=K-_,q=Math.max(0,Math.ceil(X/F)),Y=Math.min(A,(S+X)/F);for(let Q=0;Q<$;++Q){let Z=Q-O,J=Math.max(0,Math.ceil(Z/R)),ee=Math.min(D,(C+Z)/R),et=0;for(let en=q;en<Y;++en){let er=en*F-X;for(let ea=J;ea<ee;++ea){let ei=ea*R-Z,es=W*j+z*en+V*ea,eo=x*(S-1-er)+w*(C-1-ei)+I*H;for(let el=0;el<N;++el){let eu=y[es+G*el],eh=b[eo+el];et+=eu*eh}}}let ec=B*j+P*K+L*Q+U*H;g[ec]=et}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}},rf={kernelName:v.x12,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l}=r;tW([a,i],"conv3d");let u=v.Wap.computeConv3DInfo(a.shape,i.shape,s,l,o),{filterDepth:h,filterHeight:c,filterWidth:d,dilationDepth:p,dilationHeight:f,dilationWidth:m,padInfo:g}=u,y=g.front,b=g.left,x=g.top,w=new v.YDk(u.outShape,a.dtype),I=n.data.get(a.dataId).values,k=n.data.get(i.dataId).values,S=w.values,C=v.D5U.computeStrides(a.shape),E=v.D5U.computeStrides(i.shape);for(let T=0;T<u.batchSize;++T){let $=T*C[0],N=T*w.strides[0];for(let A=0;A<u.outDepth;++A){let D=N+A*w.strides[1],F=A*u.strideDepth-y;for(let R=0;R<h;++R){let _=F+R*p;if(_<0||_>=u.inDepth)continue;let O=R*E[0],M=$+_*C[1];for(let B=0;B<u.outHeight;++B){let P=D+B*w.strides[2],L=B*u.strideHeight-x;for(let U=0;U<c;++U){let W=L+U*f;if(W<0||W>=u.inHeight)continue;let z=O+U*E[1],V=M+W*C[2];for(let G=0;G<u.outWidth;++G){let j=P+G*u.outChannels,H=G*u.strideWidth-b;for(let K=0;K<d;++K){let X=H+K*m;if(X<0||X>=u.inWidth)continue;let q=z+K*E[2],Y=V+X*u.inChannels,Q=q;for(let Z=0;Z<u.inChannels;++Z){let J=I[Y+Z];for(let ee=0;ee<u.outChannels;++ee)S[j+ee]+=J*k[Q+ee];Q+=u.outChannels}}}}}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}},rm={kernelName:v.o2y,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,pad:o,filterShape:l}=r;tW([a,i],"conv3dBackpropFilterV2");let u=v.D5U.computeStrides(a.shape),h=v.D5U.computeStrides(i.shape),c=v.Wap.computeConv3DInfo(a.shape,l,s,1,o),d=c.strideDepth,p=c.strideHeight,f=c.strideWidth,m=c.filterDepth,g=c.filterHeight,y=c.filterWidth,b=new v.YDk(c.filterShape,"float32"),x=b.values,[w,I,k,S]=b.strides,C=n.data.get(i.dataId).values,[E,T,$,N]=h,A=n.data.get(a.dataId).values,[D,F,R,_]=u,O=c.padInfo.front,M=c.padInfo.left,B=c.padInfo.top;for(let P=0;P<m;++P){let L=Math.max(0,Math.ceil((O-P)/d)),U=Math.min(c.outDepth,(c.inDepth+O-P)/d),W=P*w;for(let z=0;z<g;++z){let V=Math.max(0,Math.ceil((B-z)/p)),G=Math.min(c.outHeight,(c.inHeight+B-z)/p),j=z*I+W;for(let H=0;H<y;++H){let K=Math.max(0,Math.ceil((M-H)/f)),X=Math.min(c.outWidth,(c.inWidth+M-H)/f),q=H*k+j;for(let Y=0;Y<c.inChannels;++Y){let Q=Y*S+q;for(let Z=0;Z<c.outChannels;++Z){let J=0;for(let ee=0;ee<c.batchSize;++ee){let et=ee*D,en=ee*E;for(let er=L;er<U;++er){let ea=P+er*d-O,ei=ea*F+et,es=er*T+en;for(let eo=V;eo<G;++eo){let el=z+eo*p-B,eu=el*R+ei,eh=eo*$+es;for(let ec=K;ec<X;++ec){let ed=H+ec*f-M,ep=ed*_+eu,ef=ec*N+eh;J+=A[ep+Y]*C[ef+Z]}}}}x[Q+Z]=J}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}},rg={kernelName:v.ik2,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{pad:s,strides:o,inputShape:l}=r;tW([a],"conv3dBackpropInputV2");let u=v.D5U.computeStrides(a.shape),h=v.D5U.computeStrides(i.shape),c=v.Wap.computeConv3DInfo(l,i.shape,o,1,s),d=new v.YDk(c.inShape,"float32"),p=d.values,[f,m,g,y]=d.strides,b=n.data.get(a.dataId).values,[x,w,I,k]=u,S=n.data.get(i.dataId).values,[C,E,T,$]=h,{batchSize:N,filterDepth:A,filterHeight:D,filterWidth:F,inChannels:R,inDepth:_,inHeight:O,inWidth:M,outChannels:B,outDepth:P,outHeight:L,outWidth:U,strideDepth:W,strideHeight:z,strideWidth:V}=c,G=A-1-c.padInfo.front,j=D-1-c.padInfo.top,H=F-1-c.padInfo.left;for(let K=0;K<N;++K)for(let X=0;X<R;++X)for(let q=0;q<_;++q){let Y=q-G,Q=Math.max(0,Math.ceil(Y/W)),Z=Math.min(P,(A+Y)/W);for(let J=0;J<O;++J){let ee=J-j,et=Math.max(0,Math.ceil(ee/z)),en=Math.min(L,(D+ee)/z);for(let er=0;er<M;++er){let ea=er-H,ei=Math.max(0,Math.ceil(ea/V)),es=Math.min(U,(F+ea)/V),eo=0;for(let el=Q;el<Z;++el){let eu=el*W-Y;for(let eh=et;eh<en;++eh){let ec=eh*z-ee;for(let ed=ei;ed<es;++ed){let ep=ed*V-ea,ef=x*K+w*el+I*eh+k*ed,em=C*(A-1-eu)+E*(D-1-ec)+T*(F-1-ep)+$*X;for(let eg=0;eg<B;++eg){let ey=b[ef+eg],eb=S[em+eg];eo+=ey*eb}}}}p[f*K+m*q+g*J+y*er+X]=eo}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}},ry=tG(v.mc4,e=>Math.cos(e)),rb={kernelName:v.mc4,backendName:"cpu",kernelFunc:ry},rx=tG(v.TR1,e=>Math.cosh(e)),rv={kernelName:v.TR1,backendName:"cpu",kernelFunc:rx},rw={kernelName:v.VcC,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{image:a,boxes:i,boxInd:s}=t,{cropSize:o,method:l,extrapolationValue:u}=r,[h,c,d,p]=a.shape,f=i.shape[0],[m,g]=o,y=(0,v.f3b)([f,m,g,p],"float32"),b=n.data.get(i.dataId).values,x=n.data.get(s.dataId).values,w=n.data.get(a.dataId).values,I=v.D5U.computeStrides(a.shape),k=v.D5U.computeStrides(y.shape);for(let S=0;S<f;S++){let C=4*S,E=b[C],T=b[C+1],$=b[C+2],N=b[C+3],A=x[S];if(A>=h)continue;let D=m>1?($-E)*(c-1)/(m-1):0,F=g>1?(N-T)*(d-1)/(g-1):0;for(let R=0;R<m;R++){let _=m>1?E*(c-1)+R*D:.5*(E+$)*(c-1);if(_<0||_>c-1){for(let O=0;O<g;O++)for(let M=0;M<p;M++){let B=M+O*k[2]+R*k[1]+S*k[0];y.values[B]=u}continue}if("bilinear"===l){let P=Math.floor(_),L=Math.ceil(_),U=_-P;for(let W=0;W<g;W++){let z=g>1?T*(d-1)+W*F:.5*(T+N)*(d-1);if(z<0||z>d-1){for(let V=0;V<p;V++){let G=V+W*k[2]+R*k[1]+S*k[0];y.values[G]=u}continue}let j=Math.floor(z),H=Math.ceil(z),K=z-j;for(let X=0;X<p;X++){let q=X+j*I[2]+P*I[1]+A*I[0],Y=w[q];q=X+H*I[2]+P*I[1]+A*I[0];let Q=w[q];q=X+j*I[2]+L*I[1]+A*I[0];let Z=w[q];q=X+H*I[2]+L*I[1]+A*I[0];let J=w[q],ee=Y+(Q-Y)*K,et=Z+(J-Z)*K;q=X+W*k[2]+R*k[1]+S*k[0],y.values[q]=ee+(et-ee)*U}}}else for(let en=0;en<g;++en){let er=g>1?T*(d-1)+en*F:.5*(T+N)*(d-1);if(er<0||er>d-1){for(let ea=0;ea<p;ea++){let ei=ea+en*k[2]+R*k[1]+S*k[0];y.values[ei]=u}continue}let es=Math.round(er),eo=Math.round(_);for(let el=0;el<p;el++){let eu=el+es*I[2]+eo*I[1]+A*I[0],eh=el+en*k[2]+R*k[1]+S*k[0];y.values[eh]=w[eu]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}},rI={kernelName:v.Byc,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r;tW(a,"cumprod");let l=v.Wap.getAxesPermutation([i],a.shape.length),u=a;null!=l&&(u=nN({inputs:{x:a},backend:n,attrs:{perm:l}}));let h=v.Wap.getInnerMostAxes(1,a.shape.length)[0];if(h!==u.shape.length-1)throw Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${h}`);let c=(0,v.x8V)(u.dtype,"int32"),d=v.D5U.makeOnesTypedArray(v.D5U.sizeFromShape(u.shape),c),p=n.data.get(u.dataId).values,f=u.shape[u.shape.length-1],m=o?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let g=0;g<p.length;g+=f)for(let y=0;y<f;y++){let b=m(g,y);if(0===y)d[b]=s?1:p[b];else{let x=m(g,y-1);d[b]=s?p[x]*d[x]:p[b]*d[x]}}let w=n.makeTensorInfo(u.shape,c,d);if(null!=l){let I=v.Wap.getUndoAxesPermutation(l),k=nN({inputs:{x:w},backend:n,attrs:{perm:I}});return n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(u),k}return w}},rk={kernelName:v.iHb,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r;tW(a,"cumsum");let l=v.Wap.getAxesPermutation([i],a.shape.length),u=a;null!=l&&(u=nN({inputs:{x:a},backend:n,attrs:{perm:l}}));let h=v.Wap.getInnerMostAxes(1,a.shape.length)[0];if(h!==u.shape.length-1)throw Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${h}`);let c=(0,v.x8V)(u.dtype,"int32"),d=v.D5U.makeZerosTypedArray(v.D5U.sizeFromShape(u.shape),c),p=n.data.get(u.dataId).values,f=u.shape[u.shape.length-1],m=o?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let g=0;g<p.length;g+=f)for(let y=0;y<f;y++){let b=m(g,y);if(0===y)d[b]=s?0:p[b];else{let x=m(g,y-1);d[b]=s?p[x]+d[x]:p[b]+d[x]}}let w=n.makeTensorInfo(u.shape,c,d);if(null!=l){let I=v.Wap.getUndoAxesPermutation(l),k=nN({inputs:{x:w},backend:n,attrs:{perm:I}});return n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(u),k}return w}},rS={kernelName:v.QRR,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:s,binaryOutput:o}=r;if(1===a.shape.length){let l=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,h=n4(l,u,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,h)}if(2===a.shape.length){let c=n.bufferSync(a),d=n.bufferSync(i),p=n6(c,d,s,o);return n.makeTensorInfo(p.shape,i.dtype,p.values)}throw Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}},rC={kernelName:v.T0n,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockSize:i,dataFormat:s}=r;v.D5U.assert("NHWC"===s,()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${s}`);let o=a.shape[0],l=a.shape[1],u=a.shape[2],h=a.shape[3],c=l*i,d=u*i,p=h/(i*i),f=n.data.get(a.dataId).values,m=new Float32Array(o*c*d*p),g=0;for(let y=0;y<o;++y)for(let b=0;b<c;++b){let x=Math.floor(b/i),w=b%i;for(let I=0;I<d;++I){let k=Math.floor(I/i),S=I%i,C=(w*i+S)*p;for(let E=0;E<p;++E){let T=E+C,$=T+h*(k+u*(x+l*y));m[g++]=f[$]}}}return n.makeTensorInfo([o,c,d,p],a.dtype,m)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function rE(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l,dimRoundingMode:u}=r;tW([a,i],"depthwiseConv2DNative");let h=v.D5U.computeStrides(a.shape),c=v.D5U.computeStrides(i.shape),d=l;null==d&&(d=[1,1]),v.D5U.assert(v.Wap.eitherStridesOrDilationsAreOne(s,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${d}'`);let p=v.Wap.computeConv2DInfo(a.shape,i.shape,s,d,o,u,!0),{filterHeight:f,filterWidth:m,dilationHeight:g,dilationWidth:y,padInfo:b}=p,x=b.left,w=b.top,I=p.outChannels/p.inChannels,k=new v.YDk(p.outShape,a.dtype),S=n.data.get(a.dataId).values,C=n.data.get(i.dataId).values,E=k.values;for(let T=0;T<p.batchSize;++T){let $=T*h[0],N=T*k.strides[0];for(let A=0;A<p.outHeight;++A){let D=N+A*k.strides[1],F=A*p.strideHeight-w;for(let R=0;R<f;++R){let _=F+R*g;if(_<0||_>=p.inHeight)continue;let O=R*c[0],M=$+_*h[1];for(let B=0;B<p.outWidth;++B){let P=D+B*k.strides[2],L=B*p.strideWidth-x;for(let U=0;U<m;++U){let W=L+U*y;if(W<0||W>=p.inWidth)continue;let z=O+U*c[1],V=M+W*p.inChannels,G=P,j=z;for(let H=0;H<p.inChannels;++H){let K=S[V+H];for(let X=0;X<I;++X)E[G+X]+=K*C[j+X];G+=I,j+=I}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}let rT={kernelName:v.cie,backendName:"cpu",kernelFunc:rE},r$={kernelName:v.sL$,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:u,filterShape:h}=r;tW([a,i],"depthwiseConv2dNativeBackpropFilter");let c=v.Wap.computeConv2DInfo(a.shape,h,s,o,l,u,!0),{strideHeight:d,strideWidth:p,filterHeight:f,filterWidth:m}=c,g=new v.YDk(c.filterShape,"float32"),y=c.padInfo.left,b=c.padInfo.top,x=c.outChannels/c.inChannels,w=n.data.get(a.dataId).values,I=new v.YDk(a.shape,a.dtype,w),k=n.data.get(i.dataId).values,S=new v.YDk(i.shape,i.dtype,k);for(let C=0;C<f;++C){let E=Math.max(0,Math.ceil((b-C)/d)),T=Math.min(c.outHeight,(c.inHeight+b-C)/d);for(let $=0;$<m;++$){let N=Math.max(0,Math.ceil((y-$)/p)),A=Math.min(c.outWidth,(c.inWidth+y-$)/p);for(let D=0;D<c.outChannels;++D){let F=Math.trunc(D/x),R=D%x,_=0;for(let O=0;O<c.batchSize;++O)for(let M=E;M<T;++M){let B=C+M*d-b;for(let P=N;P<A;++P){let L=$+P*p-y;_+=I.get(O,B,L,F)*S.get(O,M,P,D)}}g.set(_,C,$,F,R)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}},rN={kernelName:v.y7R,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:u,inputShape:h}=r;tW([a,i],"depthwiseConv2DNativeBackpropInput");let c=v.D5U.computeStrides(a.shape),d=v.D5U.computeStrides(i.shape),p=v.Wap.computeConv2DInfo(h,i.shape,s,o,l,u,!0),f=new v.YDk(p.inShape,"float32"),m=f.values,[g,y,b]=f.strides,x=n.data.get(a.dataId).values,[w,I,k]=c,S=n.data.get(i.dataId).values,[C,E,T]=d,{batchSize:$,filterHeight:N,filterWidth:A,inChannels:D,inHeight:F,inWidth:R,outChannels:_,outHeight:O,outWidth:M,strideHeight:B,strideWidth:P}=p,L=N-1-p.padInfo.top,U=A-1-p.padInfo.left,W=_/D;for(let z=0;z<$;++z)for(let V=0;V<D;++V)for(let G=0;G<F;++G){let j=G-L,H=Math.max(0,Math.ceil(j/B)),K=Math.min(O,(N+j)/B);for(let X=0;X<R;++X){let q=X-U,Y=Math.max(0,Math.ceil(q/P)),Q=Math.min(M,(A+q)/P),Z=0;for(let J=H;J<K;++J){let ee=J*B-j;for(let et=Y;et<Q;++et){let en=et*P-q,er=w*z+I*J+k*et,ea=C*(N-1-ee)+E*(A-1-en)+T*V;for(let ei=0;ei<W;++ei){let es=V*W+ei,eo=x[er+es],el=S[ea+ei];Z+=eo*el}}}m[g*z+y*G+b*X+V]=Z}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}},rA={kernelName:v.$w,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{x:r}=t,a=v.D5U.sizeFromShape(r.shape),i=n.data.get(r.dataId).values,s=(0,v.f3b)([a,a],r.dtype),o=s.values;for(let l=0;l<i.length;l++)o[l*a+l]=i[l];let u=[...r.shape,...r.shape];return n.makeTensorInfo(u,s.dtype,s.values)}},rD={kernelName:v.p4S,backendName:"cpu",kernelFunc({inputs:e,backend:t,attrs:n}){let{x:r,filter:a}=e,{strides:i,pad:s,dilations:o}=n,l=t.data.get(r.dataId).values,u=r.shape.length,h=t.data.get(a.dataId).values,c=a.shape.length,{batchSize:d,inHeight:p,inWidth:f,inChannels:m,outHeight:g,outWidth:y,padInfo:b,strideHeight:x,strideWidth:w,filterHeight:I,filterWidth:k,dilationHeight:S,dilationWidth:C,outShape:E}=v.Wap.computeDilation2DInfo(r.shape,a.shape,i,s,"NHWC",o),T=v.D5U.sizeFromShape(E),$=E.length,N=v.D5U.getArrayFromDType(r.dtype,T);for(let A=0;A<d;++A)for(let D=0;D<g;++D){let F=D*x-b.top;for(let R=0;R<y;++R){let _=R*w-b.left;for(let O=0;O<m;++O){let M=Number.MIN_SAFE_INTEGER;for(let B=0;B<I;++B){let P=F+B*S;if(P>=0&&P<p)for(let L=0;L<k;++L){let U=_+L*C;if(U>=0&&U<f){let W=v.D5U.locToIndex([A,P,U,O],u,v.D5U.computeStrides(r.shape)),z=v.D5U.locToIndex([B,L,O],c,v.D5U.computeStrides(a.shape)),V=l[W]+h[z];V>M&&(M=V)}}}let G=v.D5U.locToIndex([A,D,R,O],$,v.D5U.computeStrides(E));N[G]=M}}}let j=t.write(v.D5U.toTypedArray(N,r.dtype),E,r.dtype);return{dataId:j,shape:E,dtype:r.dtype}}},rF={kernelName:v.Vn9,backendName:"cpu",kernelFunc({inputs:e,backend:t,attrs:n}){let{x:r,filter:a,dy:i}=e,{strides:s,pad:o,dilations:l}=n,u=v.D5U.toNestedArray(r.shape,t.data.get(r.dataId).values),h=v.D5U.toNestedArray(a.shape,t.data.get(a.dataId).values),{batchSize:c,inHeight:d,inWidth:p,inChannels:f,outHeight:m,outWidth:g,padInfo:y,strideHeight:b,strideWidth:x,filterHeight:w,filterWidth:I,dilationHeight:k,dilationWidth:S,outShape:C}=v.Wap.computeDilation2DInfo(r.shape,a.shape,s,o,"NHWC",l);v.D5U.assert(i.rank===C.length,()=>`Error in ${v.Vn9}, dy must have the same rank as output ${C.length}, but got ${i.rank}`);let E=v.D5U.toNestedArray(C,t.data.get(i.dataId).values),T=v.D5U.makeZerosNestedTypedArray(a.shape,a.dtype);for(let $=0;$<c;++$)for(let N=0;N<m;++N){let A=N*b-y.top;for(let D=0;D<g;++D){let F=D*x-y.left;for(let R=0;R<f;++R){let _=Number.MIN_SAFE_INTEGER,O=0,M=0;for(let B=0;B<w;++B){let P=A+B*k;if(P>=0&&P<d)for(let L=0;L<I;++L){let U=F+L*S;if(U>=0&&U<p){let W=u[$][P][U][R]+h[B][L][R];W>_&&(_=W,O=B,M=L)}}}T[O][M][R]+=E[$][N][D][R]}}}let z=t.write(v.D5U.toTypedArray(T,r.dtype),a.shape,a.dtype);return{dataId:z,shape:a.shape,dtype:a.dtype}}},rR={kernelName:v.ekb,backendName:"cpu",kernelFunc({inputs:e,backend:t,attrs:n}){let{x:r,filter:a,dy:i}=e,{strides:s,pad:o,dilations:l}=n,u=v.D5U.toNestedArray(r.shape,t.data.get(r.dataId).values),h=v.D5U.toNestedArray(a.shape,t.data.get(a.dataId).values),{batchSize:c,inHeight:d,inWidth:p,inChannels:f,outHeight:m,outWidth:g,padInfo:y,strideHeight:b,strideWidth:x,filterHeight:w,filterWidth:I,dilationHeight:k,dilationWidth:S,outShape:C}=v.Wap.computeDilation2DInfo(r.shape,a.shape,s,o,"NHWC",l);v.D5U.assert(i.rank===C.length,()=>`Error in ${v.ekb}, dy must have the same rank as output ${C.length}, but got ${i.rank}`);let E=v.D5U.toNestedArray(C,t.data.get(i.dataId).values),T=v.D5U.makeZerosNestedTypedArray(r.shape,r.dtype);for(let $=0;$<c;++$)for(let N=0;N<m;++N){let A=N*b-y.top;for(let D=0;D<g;++D){let F=D*x-y.left;for(let R=0;R<f;++R){let _=Number.MIN_SAFE_INTEGER,O=A<0?0:A,M=F<0?0:F;for(let B=0;B<w;++B){let P=A+B*k;if(P>=0&&P<d)for(let L=0;L<I;++L){let U=F+L*S;if(U>=0&&U<p){let W=u[$][P][U][R]+h[B][L][R];W>_&&(_=W,O=P,M=U)}}}T[$][O][M][R]+=E[$][N][D][R]}}}let z=t.write(v.D5U.toTypedArray(T,r.dtype),r.shape,r.dtype);return{dataId:z,shape:r.shape,dtype:r.dtype}}},r_=tZ((e,t)=>e*t),rO=nh((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n})),rM=nu(v.wYn,r_,rO),rB={kernelName:v.wYn,backendName:"cpu",kernelFunc:rM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function rP(e){let t;let{inputs:n,backend:r,attrs:a}=e,{x:i}=n,{axis:s,keepDims:o}=a;tW(i,"sum"),t="bool"===i.dtype?no({inputs:{x:i},backend:r,attrs:{dtype:"int32"}}):tX({inputs:{x:i},backend:r});let l=t.shape.length,u=v.D5U.parseAxisParam(s,t.shape),h=v.Wap.getAxesPermutation(u,l),c=u,d=t;null!=h&&(d=nN({inputs:{x:t},backend:r,attrs:{perm:h}}),c=v.Wap.getInnerMostAxes(c.length,l)),v.Wap.assertAxesAreInnerMostDims("sum",c,d.shape.length);let[p,f]=v.Wap.computeOutAndReduceShapes(d.shape,c),m=v.Wap.upcastType(d.dtype,"int32"),g=nr(r,p,m),y=v.D5U.sizeFromShape(f),b=r.data.get(g.dataId).values,x=r.data.get(d.dataId).values;for(let w=0;w<b.length;++w){let I=w*y,k=0;for(let S=0;S<y;++S)k+=x[I+S];b[w]=k}if(o){let C=v.Wap.expandShapeToKeepDim(g.shape,u),E=g;g=nm({inputs:{x:g},backend:r,attrs:{shape:C}}),r.disposeIntermediateTensorInfo(E)}return r.disposeIntermediateTensorInfo(t),null!=h&&r.disposeIntermediateTensorInfo(d),g}let rL={kernelName:v.GBy,backendName:"cpu",kernelFunc:rP},rU={kernelName:v.$g6,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{equation:a}=r,{allDims:i,summedDims:s,idDims:o}=v.Wap.decodeEinsumEquation(a,t.length);v.Wap.checkEinsumDimSizes(i.length,o,t);let{path:l,steps:u}=v.Wap.getEinsumComputePath(s,o),h=u.length,c=null,d=i.length,p=[];for(let f=0;f<h;++f){for(let m of u[f]){let g;let{permutationIndices:y,expandDims:b}=v.Wap.getEinsumPermutation(d,o[m]);v.Wap.isIdentityPermutation(y)?g=t[m]:(g=nN({inputs:{x:t[m]},backend:n,attrs:{perm:y}}),p.push(g));let x=g.shape.slice();for(let w=0;w<b.length;++w)x.splice(b[w],0,1);v.D5U.arraysEqual(g.shape,x)||(g=nm({inputs:{x:g},backend:n,attrs:{shape:x}}),p.push(g)),null===c?c=g:(c=rM({inputs:{a:g,b:c},backend:n}),p.push(c))}f<h-1&&(l[f]>=0&&(c=rP({inputs:{x:c},backend:n,attrs:{axis:l[f]-(i.length-d),keepDims:!1}}),p.push(c)),d--)}for(let I of p)I!==c&&n.disposeIntermediateTensorInfo(I);return c}},rW={kernelName:v.HEU,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{dy:r,y:a}=t;tW([r,a],"eluGrad");let i=new Float32Array(v.D5U.sizeFromShape(a.shape)),s=n.data.get(a.dataId).values,o=n.data.get(r.dataId).values;for(let l=0;l<s.length;++l){let u=s[l];u>=1?i[l]=o[l]:i[l]=o[l]*(u+1)}return n.makeTensorInfo(a.shape,"float32",i)}},rz=tZ((e,t)=>e===t?1:0),rV=nu(v.hdR,rz,null,"bool"),rG={kernelName:v.hdR,backendName:"cpu",kernelFunc:rV},rj=v.Wap.ERF_P,rH=v.Wap.ERF_A1,rK=v.Wap.ERF_A2,rX=v.Wap.ERF_A3,rq=v.Wap.ERF_A4,rY=v.Wap.ERF_A5,rQ=tG(v.Omj,e=>{let t=Math.sign(e),n=Math.abs(e),r=1/(1+rj*n);return t*(1-((((rY*r+rq)*r+rX)*r+rK)*r+rH)*r*Math.exp(-n*n))}),rZ={kernelName:v.Omj,backendName:"cpu",kernelFunc:rQ},rJ=t5(e=>Math.exp(e)),r0=tj(v.NEP,rJ,"float32"),r1={kernelName:v.NEP,backendName:"cpu",kernelFunc:r0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function r2(e){let{inputs:t,backend:n,attrs:r}=e,{input:a}=t,{dim:i}=r,s=a.shape.length,o=a.shape.slice(),l=i;return i<0&&(v.D5U.assert(-(s+1)<=i,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),l=s+i+1),o.splice(l,0,1),nm({inputs:{x:a},backend:n,attrs:{shape:o}})}let r3={kernelName:v.YFo,backendName:"cpu",kernelFunc:r2},r4=t5(e=>Math.expm1(e)),r6=tj(v.Y0y,r4),r5={kernelName:v.Y0y,backendName:"cpu",kernelFunc:r6},r7=tZ((e,t)=>e/t),r8=nu(v.oHH,r7),r9={kernelName:v.oHH,backendName:"cpu",kernelFunc:r8},ae=tZ((e,t)=>e-t),at=nh((e,t,n,r)=>({real:e-n,imag:t-r})),an=nu(v.Tr8,ae,at),ar={kernelName:v.Tr8,backendName:"cpu",kernelFunc:an};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function aa(e,t,n){let r=e.shape,a=r[0],i=r[1],s=n.data.get(e.dataId),o=s.complexTensorInfos.real,l=s.complexTensorInfos.imag,u=[a,i],h=v.D5U.sizeFromShape(u),c=v.D5U.getTypedArrayFromDType("float32",h),d=v.D5U.getTypedArrayFromDType("float32",h);for(let p=0;p<a;p++){let f=n1({inputs:{x:o},backend:n,attrs:{begin:[p,0],size:[1,i]}}),m=n1({inputs:{x:l},backend:n,attrs:{begin:[p,0],size:[1,i]}}),g=nt({inputs:{real:f,imag:m},backend:n}),{real:y,imag:b}=function(e,t,n){let r=v.D5U.sizeFromShape(e.shape),a=n.data.get(e.dataId),i=n.data.get(a.complexTensorInfos.real.dataId).values,s=n.data.get(a.complexTensorInfos.imag.dataId).values;if((r&r-1)==0){let o=function e(t,n,r,a,i){if(1===r)return{real:t,imag:n};let s=v.Wap.mergeRealAndImagArrays(t,n),o=r/2,l=v.Wap.complexWithEvenIndex(s),u=l.real,h=l.imag,c=[u.length],d=i.makeTensorInfo(c,"float32",u),p=i.makeTensorInfo(c,"float32",h),f=nt({inputs:{real:d,imag:p},backend:i}),m=v.Wap.complexWithOddIndex(s),g=m.real,y=m.imag,b=[g.length],x=i.makeTensorInfo(b,"float32",g),w=i.makeTensorInfo(b,"float32",y),I=nt({inputs:{real:x,imag:w},backend:i}),k=e(u,h,o,a,i),S=k.real,C=k.imag,E=[S.length],T=i.makeTensorInfo(E,"float32",S),$=i.makeTensorInfo(E,"float32",C),N=nt({inputs:{real:T,imag:$},backend:i}),A=e(g,y,o,a,i),D=A.real,F=A.imag,R=[D.length],_=i.makeTensorInfo(R,"float32",D),O=i.makeTensorInfo(R,"float32",F),M=nt({inputs:{real:_,imag:O},backend:i}),B=v.Wap.exponents(r,a),P=[B.real.length],L=i.makeTensorInfo(P,"float32",B.real),U=i.makeTensorInfo(P,"float32",B.imag),W=nt({inputs:{real:L,imag:U},backend:i}),z=rM({inputs:{a:W,b:M},backend:i}),V=np({inputs:{a:N,b:z},backend:i}),G=an({inputs:{a:N,b:z},backend:i}),j=na({inputs:{input:V},backend:i}),H=na({inputs:{input:G},backend:i}),K=rs({inputs:{input:V},backend:i}),X=rs({inputs:{input:G},backend:i}),q=rl({inputs:[j,H],backend:i,attrs:{axis:0}}),Y=rl({inputs:[K,X],backend:i,attrs:{axis:0}}),Q=i.data.get(q.dataId).values,Z=i.data.get(Y.dataId).values;return i.disposeIntermediateTensorInfo(d),i.disposeIntermediateTensorInfo(p),i.disposeIntermediateTensorInfo(f),i.disposeIntermediateTensorInfo(x),i.disposeIntermediateTensorInfo(w),i.disposeIntermediateTensorInfo(I),i.disposeIntermediateTensorInfo(T),i.disposeIntermediateTensorInfo($),i.disposeIntermediateTensorInfo(N),i.disposeIntermediateTensorInfo(_),i.disposeIntermediateTensorInfo(O),i.disposeIntermediateTensorInfo(M),i.disposeIntermediateTensorInfo(L),i.disposeIntermediateTensorInfo(U),i.disposeIntermediateTensorInfo(W),i.disposeIntermediateTensorInfo(z),i.disposeIntermediateTensorInfo(V),i.disposeIntermediateTensorInfo(G),i.disposeIntermediateTensorInfo(j),i.disposeIntermediateTensorInfo(K),i.disposeIntermediateTensorInfo(H),i.disposeIntermediateTensorInfo(X),i.disposeIntermediateTensorInfo(q),i.disposeIntermediateTensorInfo(Y),{real:Q,imag:Z}}(i,s,r,t,n),l=[e.shape[0],e.shape[1]];if(t){let u=n.makeTensorInfo(l,"float32",o.real),h=n.makeTensorInfo(l,"float32",o.imag),c=n.makeTensorInfo([],"float32",v.D5U.createScalarValue(r,"float32")),d=tX({inputs:{x:c},backend:n}),p=r9.kernelFunc({inputs:{a:u,b:c},backend:n}),f=r9.kernelFunc({inputs:{a:h,b:d},backend:n}),m=n.data.get(p.dataId).values,g=n.data.get(f.dataId).values;return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),{real:m,imag:g}}return o}{let y=v.Wap.mergeRealAndImagArrays(i,s),b=function(e,t,n){let r=new Float32Array(2*t);for(let a=0;a<t;a++){let i=0,s=0;for(let o=0;o<t;o++){let l=v.Wap.exponent(a*o,t,n),u=v.Wap.getComplexWithIndex(e,o);i+=u.real*l.real-u.imag*l.imag,s+=u.real*l.imag+u.imag*l.real}n&&(i/=t,s/=t),v.Wap.assignToTypedArray(r,i,s,a)}return r}(y,r,t);return v.Wap.splitRealAndImagArrays(b)}}(g,t,n),x=v.Wap.mergeRealAndImagArrays(y,b);for(let w=0;w<i;w++){let I=v.Wap.getComplexWithIndex(x,w);c[p*i+w]=I.real,d[p*i+w]=I.imag}n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g)}let k=n.makeTensorInfo(u,"float32",c),S=n.makeTensorInfo(u,"float32",d),C=nt({inputs:{real:k,imag:S},backend:n});return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(S),C}let ai={kernelName:v.vwp,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{input:r}=t,a=v.D5U.sizeFromShape(r.shape),i=r.shape[r.shape.length-1],s=nm({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),o=aa(s,!1,n),l=nm({inputs:{x:o},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function as(e){let{backend:t,attrs:n}=e,{shape:r,value:a,dtype:i}=n,s=i||v.D5U.inferDtype(a),o=v.D5U.getArrayFromDType(s,v.D5U.sizeFromShape(r));return function(e,t,n){e.fill(t)}(o,a,0),t.makeTensorInfo(r,s,o)}let ao={kernelName:v.deh,backendName:"cpu",kernelFunc:as},al={kernelName:v.Uyb,backendName:"cpu",kernelFunc({inputs:e,attrs:t,backend:n}){let{image:r}=e,a=v.D5U.getTypedArrayFromDType(r.dtype,v.D5U.sizeFromShape(r.shape)),[i,s,o,l]=r.shape,u=n.data.get(r.dataId).values;for(let h=0;h<i;h++){let c=h*o*s*l;for(let d=0;d<s;d++){let p=d*(o*l);for(let f=0;f<o;f++){let m=f*l;for(let g=0;g<l;g++){let y=Math.round(o-f-1),b=c+p+m+g,x=u[b];if(y>=0&&y<o){let w=y*l,I=c+p+w+g;x=u[I]}a[b]=x}}}}let k=n.write(a,r.shape,r.dtype);return{dataId:k,shape:r.shape,dtype:r.dtype}}},au=t5(e=>Math.floor(e)),ah=tj(v.OR,au),ac={kernelName:v.OR,backendName:"cpu",kernelFunc:ah},ad=tZ((e,t)=>Math.floor(e/t)),ap=nu(v.jeX,ad,null,"int32"),af={kernelName:v.jeX,backendName:"cpu",kernelFunc:ap},am={kernelName:v._V0,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:u,dataFormat:h,dilations:c,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=r,m=rh({inputs:{x:a,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:h,dilations:c,dimRoundingMode:d}});if(s){let g=m;if("NCHW"===h&&1===s.shape.length&&1!==s.shape[0]){let y=nm({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});m=np({inputs:{a:m,b:y},backend:n}),n.disposeIntermediateTensorInfo(y)}else m=np({inputs:{a:m,b:s},backend:n});n.disposeIntermediateTensorInfo(g)}if(p){let b=m;if("NCHW"===h&&"prelu"===p&&1===o.shape.length&&1!==o.shape[0]){let x=nm({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=ne(n,m,p,x,f),n.disposeIntermediateTensorInfo(x)}else m=ne(n,m,p,o,f);n.disposeIntermediateTensorInfo(b)}return m}},ag={kernelName:v.luS,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:u,dataFormat:h,dilations:c,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=r,m=rE({inputs:{x:a,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:h,dilations:c,dimRoundingMode:d}});if(s){let g=m;m=np({inputs:{a:m,b:s},backend:n}),n.disposeIntermediateTensorInfo(g)}if(p){let y=m;m=ne(n,m,p,o,f),n.disposeIntermediateTensorInfo(y)}return m}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function ay(e,t,n,r,a,i,s,o,l){let u=(0,v.f3b)([r,i],n);for(let h=0;h<r;h++){let c=[],d=0;for(let p=0;p<a;p++){let f=e[h*a+p];d+=f*s[p],c.push(f)}if(d<0||d>=l/i)throw Error(`Invalid indices: ${c} does not index into ${o}`);for(let m=0;m<i;m++)u.values[h*i+m]=t.get(...t.indexToLoc(d*i+m))}return u}let ab={kernelName:v.q1x,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{params:r,indices:a}=t,i=v.D5U.sizeFromShape(r.shape),s=a.shape,o=s[s.length-1],[l,u,h,c]=v.Wap.prepareAndValidate(r,a);if(0===u)return n.makeTensorInfo(l,r.dtype,[]);let d=n.data.get(a.dataId).values,p=n.bufferSync(r),f=ay(d,p,r.dtype,u,o,h,c,r.shape,i);return n.makeTensorInfo(l,r.dtype,f.values)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function ax(e,t,n){let r=(0,v.f3b)(n,e.dtype);for(let a=0;a<r.size;++a){let i=r.indexToLoc(a),s=i.slice(),o=s[0],l=s[2],u=t.locToIndex([o,l]);s[2]=t.values[u];let h=e.locToIndex(s);0<=h&&h<e.values.length&&(r.values[a]=e.values[h])}return r}let av={kernelName:v.qi_,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,indices:i}=t,{axis:s,batchDims:o}=r;tW([a,i],"gatherV2");let l=v.D5U.parseAxisParam(s,a.shape)[0],u=n.data.get(i.dataId).values,h=a.shape[l];for(let c=0;c<u.length;++c){let d=u[c];v.D5U.assert(d<=h-1&&d>=0,()=>`GatherV2: the index value ${d} is not in [0, ${h-1}]`)}let p=o;null==o&&(p=0);let f=v.D5U.sizeFromShape(i.shape),m=v.Wap.segment_util.collectGatherOpShapeInfo(a,i,l,p),g=nm({inputs:{x:a},backend:n,attrs:{shape:[m.batchSize,m.outerSize,m.dimSize,m.sliceSize]}}),y=nm({inputs:{x:i},backend:n,attrs:{shape:[m.batchSize,f/m.batchSize]}}),b=[m.batchSize,m.outerSize,f/m.batchSize,m.sliceSize],x=n.bufferSync(y),w=n.bufferSync(g),I=ax(w,x,b);return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),n.makeTensorInfo(m.outputShape,I.dtype,I.values)}},aw=tZ((e,t)=>e>t?1:0),aI=nu(v.iZT,aw,null,"bool"),ak={kernelName:v.iZT,backendName:"cpu",kernelFunc:aI},aS=tZ((e,t)=>e>=t?1:0),aC=nu(v.Acj,aS,null,"bool"),aE={kernelName:v.Acj,backendName:"cpu",kernelFunc:aC},aT={kernelName:v.Qg5,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{input:r}=t,a=v.D5U.sizeFromShape(r.shape),i=r.shape[r.shape.length-1],s=nm({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),o=aa(s,!0,n),l=nm({inputs:{x:o},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}},a$=tG(v.avt,e=>Number.isFinite(e)?1:0,"bool"),aN={kernelName:v.avt,backendName:"cpu",kernelFunc:a$},aA=tG(v.iWB,e=>Math.abs(e)===1/0?1:0,"bool"),aD={kernelName:v.iWB,backendName:"cpu",kernelFunc:aA},aF=tG(v.r7n,e=>Number.isNaN(e)?1:0,"bool"),aR={kernelName:v.r7n,backendName:"cpu",kernelFunc:aF},a_=tZ((e,t)=>e<t?1:0),aO=nu(v.vtC,a_,null,"bool"),aM={kernelName:v.vtC,backendName:"cpu",kernelFunc:aO},aB=tZ((e,t)=>e<=t?1:0),aP=nu(v.CAk,aB,null,"bool"),aL={kernelName:v.CAk,backendName:"cpu",kernelFunc:aP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function aU(e,t,n){let r=(t-e)/(n-1),a=v.D5U.makeZerosTypedArray(n,"float32");a[0]=e;for(let i=1;i<a.length;i++)a[i]=a[i-1]+r;return a}let aW={kernelName:v.e7N,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{backend:t,attrs:n}=e,{start:r,stop:a,num:i}=n,s=aU(r,a,i);return t.makeTensorInfo([s.length],"float32",s)}},az=t5(e=>Math.log(e)),aV=tj(v.ZbH,az),aG={kernelName:v.ZbH,backendName:"cpu",kernelFunc:aV},aj=tG(v.kU,e=>Math.log1p(e)),aH={kernelName:v.kU,backendName:"cpu",kernelFunc:aj},aK=tZ((e,t)=>e&&t),aX=nu(v.PYm,aK,null,"bool"),aq={kernelName:v.PYm,backendName:"cpu",kernelFunc:aX},aY=tG(v.VfG,e=>e?0:1,"bool"),aQ={kernelName:v.VfG,backendName:"cpu",kernelFunc:aY},aZ=tZ((e,t)=>e||t),aJ=nu(v.MZg,aZ,null,"bool"),a0={kernelName:v.MZg,backendName:"cpu",kernelFunc:aJ},a1={kernelName:v.eZ0,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:i,bias:s,alpha:o,beta:l}=r;tW(a,"LRN");let u=a.shape[3],h=u-1,c=n.data.get(a.dataId).values,d=v.D5U.sizeFromShape(a.shape),p=new Float32Array(d);for(let f=0;f<d;f++){let m=function(e){let t=e%u,n=e-t+Math.max(0,t-i),r=e-t+Math.min(t+i,h),a=0;for(;n<=r;n++){let s=c[n];a+=s*s}return a}(f),g=c[f]*Math.pow(s+o*m,-l);p[f]=g}return n.makeTensorInfo(a.shape,a.dtype,p)}},a2={kernelName:v.Hhh,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,y:i,dy:s}=t,{depthRadius:o,bias:l,alpha:u,beta:h}=r;tW(s,"LRNGrad");let c=v.D5U.sizeFromShape(s.shape),d=s.shape[3],p=n.data.get(s.dataId).values,f=n.data.get(a.dataId).values,m=n.data.get(i.dataId).values,g=new Float32Array(c);for(let y=0;y<c;y++){let b=y%d,x=y-b+Math.max(0,b-o),w=y-b+Math.min(d,b+o+1),I=0;for(let k=x;k<w;k++)I+=Math.pow(f[k],2);I=u*I+l;for(let S=x;S<w;S++){let C=-2*u*h*f[S]*m[y]/I;y===S&&(C+=Math.pow(I,-h)),C*=p[y],g[S]+=C}}return n.makeTensorInfo(s.shape,a.dtype,g)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function a3(e,t,n,r){let a=v.D5U.getTypedArrayFromDType(r,v.D5U.sizeFromShape(n));for(let i=0;i<a.length;++i){let s=i*t,o=e[s];for(let l=0;l<t;++l){let u=e[s+l];(Number.isNaN(u)||u>o)&&(o=u)}a[i]=o}return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function a4(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reductionIndices:i,keepDims:s}=r,o=a.shape,l=o.length,u=v.D5U.parseAxisParam(i,o),h=u,c=v.Wap.getAxesPermutation(h,l),d=n.data.get(a.dataId).values;if(null!=c){let p=Array(l);for(let f=0;f<p.length;f++)p[f]=o[c[f]];d=n$(d,o,a.dtype,c,p),h=v.Wap.getInnerMostAxes(h.length,l),o=p}tW(a,"max"),v.Wap.assertAxesAreInnerMostDims("max",h,l);let[m,g]=v.Wap.computeOutAndReduceShapes(o,h),y=v.D5U.sizeFromShape(g),b=a3(d,y,m,a.dtype),x=n.write(b,m,a.dtype),w=m;if(s){let I=v.Wap.expandShapeToKeepDim(m,u);w=I}return{dataId:x,shape:w,dtype:a.dtype}}let a6={kernelName:v.YoZ,backendName:"cpu",kernelFunc:a4},a5=tZ((e,t)=>Math.max(e,t)),a7=nu(v.BMI,a5),a8={kernelName:v.BMI,backendName:"cpu",kernelFunc:a7},a9={kernelName:v.mTV,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t;let{inputs:n,backend:r,attrs:a}=e,{x:i}=n;tW(i,"maxPool");let{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=a;v.D5U.assert(v.Wap.eitherStridesOrDilationsAreOne(o,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);let h=v.Wap.computePool2DInfo(i.shape,s,o,1,l,u);if(1===h.filterWidth&&1===h.filterHeight&&v.D5U.arraysEqual(h.inShape,h.outShape))t=tX({inputs:{x:i},backend:r});else{let c=r.data.get(i.dataId).values,d=v.D5U.computeStrides(i.shape),p=nH(c,i.shape,i.dtype,d,h,"max");t=r.makeTensorInfo(h.outShape,i.dtype,p.values)}return t}},ie={kernelName:v.OAf,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:u}=r;tW(a,"maxPool3d");let h=v.Wap.computePool3DInfo(a.shape,i,s,1,o,l,u),c=n.data.get(a.dataId).values,d=nX(c,a.shape,a.dtype,v.D5U.computeStrides(a.shape),h,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}},it={kernelName:v.OU7,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=r;tW([a,i],"maxPool3DGrad");let h=v.Wap.computePool3DInfo(i.shape,s,o,1,l,u),c=n.bufferSync(i),d=function(e,t){let n=(0,v.f3b)(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,s=t.dilationDepth,o=t.dilationHeight,l=t.dilationWidth,u=t.effectiveFilterDepth,h=t.effectiveFilterHeight,c=t.effectiveFilterWidth,d=t.padInfo.front,p=t.padInfo.top,f=t.padInfo.left;for(let m=0;m<t.batchSize;++m)for(let g=0;g<t.inChannels;++g)for(let y=0;y<t.outDepth;++y){let b=y*r-d,x=b;for(;x<0;)x+=s;let w=Math.min(t.inDepth,u+b);for(let I=0;I<t.outHeight;++I){let k=I*a-p,S=k;for(;S<0;)S+=o;let C=Math.min(t.inHeight,h+k);for(let E=0;E<t.outWidth;++E){let T=E*i-f,$=T;for(;$<0;)$+=l;let N=Math.min(t.inWidth,c+T),A=Number.NEGATIVE_INFINITY,D=-1;for(let F=x;F<w;F+=s){let R=F-b;for(let _=S;_<C;_+=o){let O=_-k;for(let M=$;M<N;M+=l){let B=M-T,P=e.get(m,F,_,M,g);P>=A&&(A=P,D=R*h*c+O*h+B)}}}n.set(D,m,y,I,E,g)}}}return n}(c,h),p=h.strideDepth,f=h.strideHeight,m=h.strideWidth,g=h.dilationDepth,y=h.dilationHeight,b=h.dilationWidth,x=h.effectiveFilterDepth,w=h.effectiveFilterHeight,I=h.effectiveFilterWidth,k=x-1-h.padInfo.front,S=I-1-h.padInfo.left,C=w-1-h.padInfo.top,E=(0,v.f3b)(i.shape,"float32"),T=n.bufferSync(a);for(let $=0;$<h.batchSize;++$)for(let N=0;N<h.inChannels;++N)for(let A=0;A<h.inDepth;++A)for(let D=0;D<h.inHeight;++D)for(let F=0;F<h.inWidth;++F){let R=A-k,_=D-C,O=F-S,M=0;for(let B=0;B<x;B+=g){let P=(R+B)/p;if(!(P<0)&&!(P>=h.outDepth)&&Math.floor(P)===P)for(let L=0;L<w;L+=y){let U=(_+L)/f;if(!(U<0)&&!(U>=h.outHeight)&&Math.floor(U)===U)for(let W=0;W<I;W+=b){let z=(O+W)/m;if(z<0||z>=h.outWidth||Math.floor(z)!==z)continue;let V=x*w*I-1-d.get($,P,U,z,N),G=B*w*I+L*I+W,j=V===G?1:0;if(0===j)continue;let H=T.get($,P,U,z,N);M+=H*j}}}E.set(M,$,A,D,F,N)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}},ir={kernelName:v.OV7,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i,output:s}=t;tW([i,s],"maxPoolGrad");let{filterSize:o,strides:l,pad:u,dimRoundingMode:h}=r,c=v.Wap.computePool2DInfo(i.shape,o,l,1,u,h),d=n.data.get(i.dataId).values,p=(0,v.f3b)(c.outShape,i.dtype,nK(d,i.shape,i.dtype,c).values),f=c.strideHeight,m=c.strideWidth,g=c.dilationHeight,y=c.dilationWidth,b=c.effectiveFilterHeight,x=c.effectiveFilterWidth,w=x-1-c.padInfo.left,I=b-1-c.padInfo.top,k=(0,v.f3b)(i.shape,"float32"),S=n.data.get(a.dataId).values,C=(0,v.f3b)(a.shape,"float32",S);for(let E=0;E<c.batchSize;++E)for(let T=0;T<c.inChannels;++T)for(let $=0;$<c.inHeight;++$)for(let N=0;N<c.inWidth;++N){let A=$-I,D=N-w,F=0;for(let R=0;R<b;R+=g){let _=(A+R)/f;if(!(_<0)&&!(_>=c.outHeight)&&Math.floor(_)===_)for(let O=0;O<x;O+=y){let M=(D+O)/m;if(M<0||M>=c.outWidth||Math.floor(M)!==M)continue;let B=b*x-1-p.get(E,_,M,T),P=R*x+O,L=B===P?1:0;if(0===L)continue;let U=C.get(E,_,M,T);F+=U*L}}k.set(F,E,$,N,T)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}},ia={kernelName:v.vFR,backendName:"cpu",kernelFunc({inputs:e,attrs:t,backend:n}){let{x:r}=e,{filterSize:a,strides:i,pad:s,includeBatchInIndex:o}=t;tW(r,"MaxPoolWithArgmax");let l=n.data.get(r.dataId).values,u=v.Wap.computePool2DInfo(r.shape,a,i,[1,1],s),[h,c]=/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r,a){let i=v.D5U.computeStrides(t),s=nH(e,t,n,i,a,"max"),o=nK(e,t,n,a,!0,r);return[s.values,o.values]}(l,r.shape,r.dtype,o,u),d=n.write(h,u.outShape,r.dtype),p=n.write(c,u.outShape,r.dtype);return[{dataId:d,shape:u.outShape,dtype:r.dtype},{dataId:p,shape:u.outShape,dtype:"int32"}]}},ii={kernelName:v.q2K,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r,o=v.D5U.parseAxisParam(i,a.shape),l=v.Wap.computeOutAndReduceShapes(a.shape,o),u=l[1],h=v.D5U.sizeFromShape(u),c=[],d=n.makeTensorInfo([],"float32",new Float32Array([h]));c.push(d);let p=no({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});c.push(p);let f=r8({inputs:{a:p,b:d},backend:n});c.push(f);let m=rP({inputs:{x:f},backend:n,attrs:{axis:i,keepDims:s}});return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),m}},is={kernelName:v.c17,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;tW(a,"min");let o=v.D5U.parseAxisParam(i,a.shape),l=o,u=v.Wap.getAxesPermutation(l,a.shape.length),h=a;null!=u&&(h=nN({inputs:{x:a},backend:n,attrs:{perm:u}}),l=v.Wap.getInnerMostAxes(l.length,a.shape.length)),v.Wap.assertAxesAreInnerMostDims("min",l,h.shape.length);let[c,d]=v.Wap.computeOutAndReduceShapes(h.shape,l),p=v.D5U.sizeFromShape(d),f=v.D5U.makeZerosTypedArray(v.D5U.sizeFromShape(c),h.dtype),m=n.data.get(h.dataId).values;for(let g=0;g<f.length;++g){let y=g*p,b=m[y];for(let x=0;x<p;++x){let w=m[y+x];(Number.isNaN(w)||w<b)&&(b=w)}f[g]=b}null!=u&&n.disposeIntermediateTensorInfo(h);let I=n.makeTensorInfo(c,h.dtype,f);if(s){let k=v.Wap.expandShapeToKeepDim(c,o),S=nm({inputs:{x:I},backend:n,attrs:{shape:k}});return n.disposeIntermediateTensorInfo(I),S}return I}},io=tZ((e,t)=>Math.min(e,t)),il=nu(v.q8u,io),iu={kernelName:v.q8u,backendName:"cpu",kernelFunc:il},ih={kernelName:v.jQs,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:i,mode:s}=r;tW(a,"mirrorPad");let o=i.map((e,t)=>e[0]+a.shape[t]+e[1]),l=i.map(e=>e[0]),u=i.map((e,t)=>e[0]+a.shape[t]),h="reflect"===s?0:1,c=n.data.get(a.dataId).values,d=a.shape.length,p=v.D5U.computeStrides(a.shape),f=v.D5U.sizeFromShape(o),m=o.length,g=v.D5U.computeStrides(o),y=v.D5U.getTypedArrayFromDType(a.dtype,f);for(let b=0;b<f;b++){let x=v.D5U.indexToLoc(b,m,g);for(let w=0;w<m;w++)x[w]<l[w]?x[w]=2*l[w]-x[w]-h:x[w]>=u[w]&&(x[w]=(u[w]-1)*2-x[w]+h);x=x.map((e,t)=>e-l[t]);let I=v.D5U.locToIndex(x,d,p);y[b]=c[I]}let k=n.write(y,o,a.dtype);return{dataId:k,shape:o,dtype:a.dtype}}},ic=tZ((e,t)=>{let n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}),id=nu(v.Vbg,ic),ip={kernelName:v.Vbg,backendName:"cpu",kernelFunc:id};var im=n(6377);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function ig(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{dim:i}=r,s=a.shape.length,o=i;if(-1===o&&(o=s-1),o!==s-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${s} and dim was ${o}`);let l=v.D5U.parseAxisParam([o],a.shape),u=a4({inputs:{x:a},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),h=v.Wap.expandShapeToKeepDim(u.shape,l),c=nm({inputs:{x:u},backend:n,attrs:{shape:h}}),d=an({inputs:{a:a,b:c},backend:n}),p=r0({inputs:{x:d},backend:n}),f=rP({inputs:{x:p},backend:n,attrs:{axis:l,keepDims:!1}}),m=nm({inputs:{x:f},backend:n,attrs:{shape:h}}),g=r8({inputs:{a:p,b:m},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}let iy={kernelName:v.Gcp,backendName:"cpu",kernelFunc:ig},ib={kernelName:v.NZg,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:i,seed:s,normalized:o}=r;tW(a,"multinomial");let l=o?a:ig({inputs:{logits:a},backend:n,attrs:{dim:-1}}),u=l.shape[0],h=l.shape[1],c=n.data.get(l.dataId).values,d=[u,i],p=v.D5U.makeZerosTypedArray(v.D5U.sizeFromShape(d),"int32");for(let f=0;f<u;++f){let m=f*h,g=new Float32Array(h-1);g[0]=c[m];for(let y=1;y<g.length;++y)g[y]=g[y-1]+c[m+y];let b=im.alea(s.toString()),x=f*i;for(let w=0;w<i;++w){let I=b();p[x+w]=g.length;for(let k=0;k<g.length;k++)if(I<g[k]){p[x+w]=k;break}}}return o||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(d,"int32",p)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function ix(e,t,n){let r=v.D5U.createScalarValue(-1,n);return r_([],t,r,e,n)}let iv={kernelName:v.kuV,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:r}=t;tW(r,"neg");let a=n.data.get(r.dataId).values,[i,s]=ix(a,r.shape,r.dtype);return n.makeTensorInfo(s,r.dtype,i)}},iw=v.GDt.GP,iI={kernelName:v.uv1,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=r;tW(a,"NonMaxSuppression");let u=n.data.get(a.dataId).values,h=n.data.get(i.dataId).values,{selectedIndices:c}=iw(u,h,s,o,l);return n.makeTensorInfo([c.length],"int32",new Int32Array(c))}},ik=v.GDt.qP,iS={kernelName:v.cye,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=r;tW(a,"NonMaxSuppressionPadded");let h=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,{selectedIndices:d,validOutputs:p}=ik(h,c,s,o,l,u);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},iC=v.GDt.pA,iE={kernelName:v.W0H,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=r;tW(a,"NonMaxSuppressionWithScore");let h=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,{selectedIndices:d,selectedScores:p}=iC(h,c,s,o,l,u);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([p.length],"float32",new Float32Array(p))]}},iT=tZ((e,t)=>e!==t?1:0),i$=nu(v.yQU,iT,null,"bool"),iN={kernelName:v.yQU,backendName:"cpu",kernelFunc:i$},iA={kernelName:v.we_,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:i,depth:s,onValue:o,offValue:l}=r;tW(a,"oneHot");let u=v.D5U.sizeFromShape(a.shape),h=new Float32Array(u*s);h.fill(l);let c=n.data.get(a.dataId).values;for(let d=0;d<u;++d)c[d]>=0&&c[d]<s&&(h[d*s+c[d]]=o);return n.makeTensorInfo([...a.shape,s],i,h)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function iD(e){let{inputs:t,backend:n}=e,{x:r}=t;if("string"===r.dtype)throw Error("zerosLike is not supported for string tensors");if("complex64"!==r.dtype)return as({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}});{let a=na({inputs:{input:r},backend:n}),i=iD({inputs:{x:a},backend:n}),s=rs({inputs:{input:r},backend:n}),o=iD({inputs:{x:s},backend:n}),l=nt({inputs:{real:i,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}}let iF={kernelName:v.RuY,backendName:"cpu",kernelFunc:iD},iR={kernelName:v.qWM,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function e(t){let{inputs:n,backend:r}=t,{x:a}=n;if("string"===a.dtype)throw Error("onesLike is not supported for string tensors");if("complex64"!==a.dtype)return as({backend:r,attrs:{shape:a.shape,value:1,dtype:a.dtype}});{let i=na({inputs:{input:a},backend:r}),s=e({inputs:{x:i},backend:r}),o=rs({inputs:{input:a},backend:r}),l=iD({inputs:{x:o},backend:r}),u=nt({inputs:{real:s,imag:l},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(l),u}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function i_(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(1===t.length)return r2({inputs:{input:t[0]},backend:n,attrs:{dim:a}});let i=t[0].shape,s=t[0].dtype;t.forEach(e=>{v.D5U.assertShapesMatch(i,e.shape,"All tensors passed to stack must have matching shapes"),v.D5U.assert(s===e.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=t.map(e=>{let t=r2({inputs:{input:e},backend:n,attrs:{dim:a}});return o.push(t),t}),u=rl({inputs:l,backend:n,attrs:{axis:a}});return o.forEach(e=>n.disposeIntermediateTensorInfo(e)),u}let iO={kernelName:v.QiL,backendName:"cpu",kernelFunc:i_},iM={kernelName:v.lyA,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:i,constantValue:s}=r;tW(a,"pad");let o=i.map((e,t)=>e[0]+a.shape[t]+e[1]),l=i.map(e=>e[0]),u=n.data.get(a.dataId).values,h=v.D5U.sizeFromShape(a.shape),c=a.shape.length,d=v.D5U.computeStrides(a.shape),p=v.D5U.sizeFromShape(o),f=o.length,m=v.D5U.computeStrides(o),g=v.D5U.getTypedArrayFromDType(a.dtype,p);0!==s&&g.fill(s);for(let y=0;y<h;y++){let b=v.D5U.indexToLoc(y,c,d),x=b.map((e,t)=>e+l[t]),w=v.D5U.locToIndex(x,f,m);g[w]=u[y]}let I=n.write(g,o,a.dtype);return{dataId:I,shape:o,dtype:a.dtype}}},iB=tZ((e,t)=>Math.pow(e,t)),iP=nu(v.pe_,iB),iL={kernelName:v.pe_,backendName:"cpu",kernelFunc:iP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function iU(e,t,n,r){let[a,i]=v.Wap.computeOutAndReduceShapes(e,r),s=(0,v.x8V)(t,"int32"),o=v.D5U.makeZerosTypedArray(v.D5U.sizeFromShape(a),s),l=v.D5U.sizeFromShape(i);for(let u=0;u<o.length;++u){let h=u*l,c=1;for(let d=0;d<l;++d)c*=n[h+d];o[u]=c}return{outVals:o,outShape:a,outDtype:s}}let iW={kernelName:v.DlI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;tW(a,"prod");let o=a.shape.length,l=v.D5U.parseAxisParam(i,a.shape),u=v.Wap.getAxesPermutation(l,o),h=l,c=a,d=[];null!=u&&(d.push(c=nN({inputs:{x:a},backend:n,attrs:{perm:u}})),h=v.Wap.getInnerMostAxes(h.length,o));let p=n.data.get(c.dataId).values,{outVals:f,outShape:m,outDtype:g}=iU(c.shape,c.dtype,p,h),y=m;return s&&(y=v.Wap.expandShapeToKeepDim(m,l)),d.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(y,g,f)}};function iz(e,t){let n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function iV(e,t,n,r,a,i,s,o){if(0===e.length)throw Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw Error("Split tensors must not be scalars");let l=t[0][0]-1;if(!/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){e.forEach((e,r)=>{if(e<0||e>=n){let a=v.D5U.indexToLoc(r,t.length,v.D5U.computeStrides(t)).join(",");throw Error(`indices[${a}] = ${e} is not in [0, ${n})`)}})}(i,s,l),0===r.length)throw Error("params.rank must be nonzero");let u=r[0],{outSplits:h,valueSlices:c,numValues:d}=function(e,t,n,r){let a=[],i=0,s=t.length-1+n.length,o=Array(s).fill(null).map(()=>[0]);!function(e,t){for(let n=0;n<e.length;++n){let r=e[n],a=n===e.length-1?t:e[n+1].length;if(0===r.length)throw Error("Ragged splits may not be empty");if(r[0]<0)throw Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw Error("Ragged splits must not point past values");for(let i=1;i<r.length;++i)if(r[i-1]>r[i])throw Error("Ragged splits must be sorted in ascending order")}}(n,r);let l=1;for(let u=0;u<t.length-1;++u){l*=t[u];let h=t[u+1];for(let c=1;c<l+1;++c)o[u].push(c*h)}for(let d=0;d<e.length;++d){let p=e[d],f=e[d]+1;for(let m=0;m<n.length;++m){let g=n[m],y=m+t.length-1;if(y>=0){let b=o[y],x=b[b.length-1]-g[p];for(let v=p;v<f;++v)o[y].push(g[v+1]+x)}p=g[p],f=g[f]}f!==p&&(a.push([p,f]),i+=f-p)}return{outSplits:o,valueSlices:a,numValues:i}}(i,s,e,u),p=function(e){let t=[];for(let n=0;n<e.length;++n){let r=e[n].length,a=v.D5U.getArrayFromDType("int32",r);t.push(a),e[n].forEach((e,t)=>a[t]=e)}return t}(h),f=function(e,t,n,r,a){let i=t.slice();i[0]=a;let s=v.D5U.getArrayFromDType(n,v.D5U.sizeFromShape(i)),o=e.length,l=0===o?0:o/t[0];return!function(e,t,n,r,a,i){let s=iz(t,2)[1],o=iz(i,2)[1],l=0;for(let u of n)for(let h=u[0];h<u[1];++h){for(let c=0;c<r;++c)a[l*o+c]=e[h*s+c];++l}}(e,t,r,l,s,i),[s,i]}(n,r,a,c,d);return[p,f[0],f[1]]}let iG={kernelName:v.dDz,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:a,paramsDenseValues:i,indices:s}=t,{outputRaggedRank:o}=r,l=a.map(e=>n.data.get(e.dataId).values),u=a.map(e=>e.shape),h=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values,[d,p,f]=iV(l,u,h,i.shape,i.dtype,c,s.shape,o),m=d.map(e=>n.makeTensorInfo([e.length],"int32",e)),g=n.makeTensorInfo(f,i.dtype,p);return m.concat([g])}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ var ij=v.Wap.RowPartitionType;class iH{constructor(e,t,n,r,a,i,s,o,l,u){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=r,this.valuesDType=a,this.defaultValue=i,this.defaultValueShape=s,this.rowPartitionValues=o,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=v.Wap.getRowPartitionTypesHelper(u),this.raggedRank=v.Wap.getRaggedRank(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===ij.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===ij.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){let t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case ij.VALUE_ROWIDS:return iH.getMaxWidthValueRowID(t);case ij.ROW_SPLITS:return iH.getMaxWidthRowSplit(t);default:throw Error(`Cannot handle partition type ${ij[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){let t=e.length;if(0===t||1===t)return 0;let n=0;for(let r=0;r<t-1;++r){let a=e[r+1]-e[r];a>n&&(n=a)}return n}static getMaxWidthValueRowID(e){let t=e.length;if(0===t)return 0;let n=0,r=e[0],a=0;for(let i=1;i<t;++i){let s=e[i];s!==r&&(r=s,a=Math.max(i-n,a),n=i)}return Math.max(t-n,a)}tensorShapeFromTensor(e,t,n=!0){if(0===t.length){if(-1===e[0])return[];throw Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return iX(e,n)}calculateOutputSize(e){let t=this.valuesShape,n=this.defaultValueShape;v.Wap.validateDefaultValueShape(n,t);let r=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=v.Wap.combineRaggedTensorToTensorShapes(this.raggedRank,r,t),i=a;i[0]<0&&(i[0]=e);for(let s=1;s<=this.raggedRank;++s)i[s]<0&&(i[s]=this.getMaxWidth(s));return i}calculateFirstParentOutputIndex(e,t,n){let r=Math.min(e,n),a=[],i=0;for(let s=0;s<r;++s,i+=t)a.push(i);for(let o=r;o<e;++o)a.push(-1);return v.D5U.assert(a.length===e,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(e,t,n,r){let a=e.length,i=[];for(let s=0;s<a-1;++s){let o=e[s+1]-e[s],l=Math.min(r,o),u=t[s];-1===u&&(l=0);for(let h=0;h<l;++h)i.push(u),u+=n;for(let c=0;c<o-l;++c)i.push(-1)}if(a>0&&i.length!==e[a-1])throw Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,t,n,r){let a=e.length,i=[];if(0===a)return[];let s=0,o=e[0];if(o>=t.length)throw Error(`Got currentValueRowId=${o}, which is not less than ${t.length}`);let l=t[o];i.push(l);for(let u=1;u<a;++u){let h=e[u];if(h===o)l>=0&&(++s<r?l+=n:l=-1);else{if(s=0,o=h,h>=t.length)throw Error(`Got nextValueRowId=${h} which is not less than ${t.length}`);l=t[h]}i.push(l)}if(i.length!==e.length)throw Error("Invalid row ids.");return i}calculateOutputIndex(e,t,n,r){let a=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case ij.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,t,n,r);case ij.ROW_SPLITS:if(a.length-1>t.length)throw Error(`Row partition size is greater than output size: ${a.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(a,t,n,r);default:throw Error(`Unsupported partition type: ${ij[i]}`)}}getFirstDimensionSize(){let e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw Error("No row_partition_types given.");let t=this.rowPartitionTypes[0];switch(t){case ij.FIRST_DIM_SIZE:return e[0];case ij.VALUE_ROWIDS:throw Error("Cannot handle VALUE_ROWIDS in first dimension.");case ij.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw Error(`Cannot handle type ${ij[t]}`)}}compute(){let e=this.rowPartitionValues[0];if(e.length<=0)throw Error("Invalid first partition input. Tensor requires at least one element.");let t=this.getFirstDimensionSize(),n=this.calculateOutputSize(t),r=Array(this.raggedRank+1);r[r.length-1]=1;for(let a=r.length-2;a>=0;--a)r[a]=r[a+1]*n[a+1];let i=iX(n,!1),s=v.D5U.getArrayFromDType(this.valuesDType,v.D5U.sizeFromShape(i)),o=r[0]*n[0];if(o>0){let l=this.calculateFirstParentOutputIndex(t,r[0],n[0]);for(let u=1;u<=this.raggedRank;++u){let h=this.calculateOutputIndex(u-1,l,r[u],n[u]);l=h}this.setOutput(this.raggedRank,l,s,i)}return[i,s]}setOutput(e,t,n,r){if(0===n.length)return;let a=this.values,i=r.slice();i=i.slice(e+1);let s=v.D5U.sizeFromShape(i),o=t.length,l=this.defaultValue;if(l.length!==s&&1!==l.length){let u=this.defaultValueShape;(0,v.lub)(()=>{let e=(0,v.XLQ)(l,u),t=(0,v.UFq)(e,i);l=t.dataSync()})}let h=0,c=0,d=0;for(let p=0;p<=o;++p){let f=p<o?t[p]:-1;if(f===d){++d;continue}if(c<d){let m=a.subarray(h*s),g=n.subarray(c*s),y=(d-c)*s;iK(g,m,y)}if(p>=o){let b=n.length;f=Math.floor(b/s)}if(f>d){if(1===this.defaultValue.length)n.subarray(d*s,f*s).fill(this.defaultValue[0]),d=f;else for(;f>d;){let x=n.slice(d*s);iK(x,l,s),++d}}f<0?(h=p+1,c=d):(h=p,d=(c=d)+1)}}}function iK(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function iX(e,t){let n=[];for(let r of e){if(r<0){if(!t)throw Error(`Dimension ${r} must be >= 0`);if(r<-1)throw Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function iq(e,t,n,r,a,i,s,o,l,u){return new iH(e,t,n,r,a,i,s,o,l,u).compute()}let iY={kernelName:v.BiW,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{shape:a,values:i,defaultValue:s,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,u=n.data.get(a.dataId).values,h=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values,d=o.map(e=>n.data.get(e.dataId).values),p=o.map(e=>e.shape),[f,m]=iq(u,a.shape,h,i.shape,i.dtype,c,s.shape,d,p,l);return n.makeTensorInfo(f,i.dtype,m)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function iQ(e,t,n,r){let a=e<t&&n<0,i=t<e&&n>1;if(e===t||a||i)return v.D5U.makeZerosTypedArray(0,r);let s=Math.abs(Math.ceil((t-e)/n)),o=v.D5U.makeZerosTypedArray(s,r);t<e&&1===n&&(n=-1),o[0]=e;for(let l=1;l<o.length;l++)o[l]=o[l-1]+n;return o}let iZ={kernelName:v.e6w,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{backend:t,attrs:n}=e,{start:r,stop:a,dtype:i,step:s}=n,o=iQ(r,a,s,i);return t.makeTensorInfo([o.length],i,o)}},iJ=tG(v.$HU,e=>1/e),i0={kernelName:v.$HU,backendName:"cpu",kernelFunc:iJ},i1={kernelName:v._Yw,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:s,size:o}=r;tW(a,"resizeBilinear");let l=v.D5U.computeStrides(a.shape),[u,h]=o,[c,d,p,f]=a.shape,m=n.data.get(a.dataId).values,g=new Float32Array(v.D5U.sizeFromShape([c,u,h,f])),y=[i&&u>1?d-1:d,i&&h>1?p-1:p],b=[i&&u>1?u-1:u,i&&h>1?h-1:h],x=0,w=y[0]/b[0],I=y[1]/b[1];for(let k=0;k<c;k++)for(let S=0;S<u;S++){let C;C=s?w*(S+.5)-.5:w*S;let E=Math.max(0,Math.floor(C)),T=C-E,$=Math.min(d-1,Math.ceil(C)),N=k*l[0]+E*l[1],A=k*l[0]+$*l[1];for(let D=0;D<h;D++){let F;F=s?I*(D+.5)-.5:I*D;let R=Math.max(0,Math.floor(F)),_=F-R,O=Math.min(p-1,Math.ceil(F)),M=N+R*l[2],B=A+R*l[2],P=N+O*l[2],L=A+O*l[2];for(let U=0;U<f;U++){let W=m[M+U],z=m[B+U],V=m[P+U],G=m[L+U],j=W+(V-W)*_,H=z+(G-z)*_,K=j+(H-j)*T;g[x++]=K}}}return n.makeTensorInfo([c,u,h,f],"float32",g)}},i2={kernelName:v.zbQ,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r;tW([i,a],"resizeBilinearGrad");let o=v.D5U.computeStrides(a.shape),[l,u,h,c]=a.shape,[,d,p]=i.shape,f=new Float32Array(l*u*h*c),m=[s&&d>1?u-1:u,s&&p>1?h-1:h],g=[s&&d>1?d-1:d,s&&p>1?p-1:p],y=m[0]/g[0],b=m[1]/g[1],x=n.data.get(i.dataId).values,w=0;for(let I=0;I<l;I++){let k=I*o[0];for(let S=0;S<d;S++){let C=S*y,E=Math.floor(C),T=Math.min(Math.ceil(C),u-1),$=k+E*o[1],N=k+T*o[1],A=C-E,D=1-A;for(let F=0;F<p;F++){let R=F*b,_=Math.floor(R),O=Math.min(Math.ceil(R),h-1),M=R-_,B=1-M,P=$+_*o[2],L=$+O*o[2],U=N+_*o[2],W=N+O*o[2],z=D*B,V=D*M,G=A*B,j=A*M;for(let H=0;H<c;H++){let K=x[w++];f[P+H]+=K*z,f[L+H]+=K*V,f[U+H]+=K*G,f[W+H]+=K*j}}}}return n.makeTensorInfo([l,h,u,c],"float32",f)}},i3={kernelName:v.dpD,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:s,size:o}=r;tW(a,"resizeNearestNeighbor");let l=v.D5U.computeStrides(a.shape),[u,h]=o,[c,d,p,f]=a.shape,m=n.data.get(a.dataId).values,g=new Float32Array(c*u*h*f),y=[i&&u>1?d-1:d,i&&h>1?p-1:p],b=[i&&u>1?u-1:u,i&&h>1?h-1:h],x=y[0]/b[0],w=y[1]/b[1],I=0;for(let k=0;k<c;k++){let S=k*l[0];for(let C=0;C<u;C++){let E=s?x*(C+.5):x*C,T=Math.min(d-1,i?Math.round(E):Math.floor(E));s&&(T=Math.max(0,T));let $=S+T*l[1];for(let N=0;N<h;N++){let A=s?w*(N+.5):w*N,D=Math.min(p-1,i?Math.round(A):Math.floor(A));s&&(D=Math.max(0,D));let F=$+D*l[2];for(let R=0;R<f;R++){let _=m[F+R];g[I++]=_}}}}return n.makeTensorInfo([c,u,h,f],a.dtype,g)}},i4={kernelName:v.Hmb,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r;tW([i,a],"resizeNearestNeighborGrad");let o=v.D5U.computeStrides(a.shape),l=v.D5U.computeStrides(i.shape),[u,h,c,d]=a.shape,[,p,f]=i.shape,m=new Float32Array(u*h*c*d),g=n.data.get(i.dataId).values,y=[s&&p>1?h-1:h,s&&f>1?c-1:c],b=[s&&p>1?p-1:p,s&&f>1?f-1:f],x=y[0]/b[0],w=y[1]/b[1],I=1/x,k=1/w,S=2*Math.ceil(I)+2,C=2*Math.ceil(k)+2;for(let E=0;E<u;E++){let T=E*o[0];for(let $=0;$<h;$++){let N=T+$*o[1],A=Math.floor($*I),D=Math.floor(A-S/2);for(let F=0;F<c;F++){let R=N+F*o[2],_=Math.floor(F*k),O=Math.floor(_-C/2);for(let M=0;M<d;M++){let B=0;for(let P=0;P<S;P++){let L=P+D;if(L<0||L>=p)continue;let U=T+L*l[1],W=L*x,z=Math.min(h-1,s?Math.round(W):Math.floor(W));if($===z)for(let V=0;V<C;V++){let G=V+O;if(G<0||G>=f)continue;let j=U+G*l[2],H=G*w,K=Math.min(c-1,s?Math.round(H):Math.floor(H));F===K&&(B+=g[j+M])}}m[R+M]=B}}}}return n.makeTensorInfo(a.shape,a.dtype,m)}},i6={kernelName:v.mKl,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:i}=r;tW(a,"reverse");let s=a.shape.length,o=v.D5U.parseAxisParam(i,a.shape);if(0===s)return tX({inputs:{x:a},backend:n});let l=new v.YDk(a.shape,a.dtype),u=n.bufferSync(a);for(let h=0;h<l.size;h++){let c=l.indexToLoc(h),d=c.slice();o.forEach(e=>d[e]=a.shape[e]-1-d[e]),l.set(u.get(...d),...c)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}},i5={kernelName:v.b9H,backendName:"cpu",kernelFunc({inputs:e,attrs:t,backend:n}){let{image:r}=e,{radians:a,fillValue:i,center:s}=t,o=v.D5U.getTypedArrayFromDType(r.dtype,v.D5U.sizeFromShape(r.shape)),[l,u,h,c]=r.shape,[d,p]=v.Wap.getImageCenter(s,u,h),f=Math.sin(a),m=Math.cos(a),g=n.data.get(r.dataId).values;for(let y=0;y<l;y++){let b=y*h*u*c;for(let x=0;x<u;x++){let w=x*(h*c);for(let I=0;I<h;I++){let k=I*c;for(let S=0;S<c;S++){let C=[l,x,I,S],E=C[2],T=C[1],$=(E-d)*m-(T-p)*f,N=(E-d)*f+(T-p)*m;$=Math.round($+d),N=Math.round(N+p);let A=i;if("number"!=typeof i&&(A=3===S?255:i[S]),$>=0&&$<h&&N>=0&&N<u){let D=N*(h*c),F=$*c,R=b+D+F+S;A=g[R]}let _=b+w+k+S;o[_]=A}}}}let O=n.write(o,r.shape,r.dtype);return{dataId:O,shape:r.shape,dtype:r.dtype}}},i7=tG(v.e07,e=>{let t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2==0?t:t+1}),i8={kernelName:v.e07,backendName:"cpu",kernelFunc:i7},i9=t5(e=>1/Math.sqrt(e)),se=tj(v.bV0,i9),st={kernelName:v.bV0,backendName:"cpu",kernelFunc:se};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function sn(e,t,n,r,a,i,s,o,l,u){let h=e.values,c=t.values;if(0===r)return(0,v.f3b)(n,t.dtype);let d=(0,v.f3b)([r/a,a],t.dtype);"string"==typeof l?d.values.fill(l):"number"==typeof l?d.values.fill(l):"boolean"==typeof l&&d.values.fill(+l);for(let p=0;p<i;p++){let f=[],m=0;for(let g=0;g<s;g++){let y=h[p*s+g];f.push(y),m+=y*o[g]}if(m<0||m>=r/a)throw Error(`Invalid indices: ${f} does not index into ${n}`);for(let b=0;b<a;b++)u?d.values[m*a+b]+=c[p*a+b]:d.values[m*a+b]=0===t.rank?c[0]:c[p*a+b]}return d}let sr={kernelName:v.xQA,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{indices:a,updates:i}=t,{shape:s}=r,{sliceRank:o,numUpdates:l,sliceSize:u,strides:h,outputSize:c}=v.Wap.calculateShapes(i,a,s),d=n.bufferSync(a),p=n.bufferSync(i),f=sn(d,p,s,c,u,l,o,h,0,!0);return n.makeTensorInfo(s,f.dtype,f.values)}},sa={kernelName:v.nr8,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:i}=t,{side:s}=r,o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,u=function(e,t,n,r,a,i){let s=v.D5U.getArrayFromDType("int32",n*a);for(let o=0;o<n;++o){let l=e.slice(o*r,(o+1)*r),u=o*a;for(let h=0;h<a;++h)s[u+h]="left"===i?/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t){let n=0,r=e.length,a=0;for(;n<r;)e[a=Math.floor((n+r)/2)]<t?n=a+1:r=a;return r}(l,t[h+u]):function(e,t){let n=0,r=e.length,a=0;for(;n<r;)e[a=Math.floor((n+r)/2)]<=t?n=a+1:r=a;return r}(l,t[h+u])}return s}(o,l,a.shape[0],a.shape[1],i.shape[1],s);return n.makeTensorInfo(i.shape,"int32",u)}},si={kernelName:v.PhF,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{condition:r,t:a,e:i}=t;tW([r,a,i],"select");let s=r.shape.length,o=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,h=(0,v.x8V)(a.dtype,i.dtype),c=v.D5U.makeZerosTypedArray(v.D5U.sizeFromShape(a.shape),h),d=0,p=0===s||s>1||1===a.shape.length?1:v.D5U.sizeFromShape(a.shape.slice(1));for(let f=0;f<o.length;f++)for(let m=0;m<p;m++)1===o[f]?c[d++]=l[f]:c[d++]=u[f];return n.makeTensorInfo(a.shape,h,c)}},ss=v.Wap.SELU_SCALEALPHA,so=v.Wap.SELU_SCALE,sl=tG(v.oFR,e=>e>=0?so*e:ss*(Math.exp(e)-1)),su={kernelName:v.oFR,backendName:"cpu",kernelFunc:sl},sh=tG(v.i5y,e=>e<0?-1:e>0?1:0),sc={kernelName:v.i5y,backendName:"cpu",kernelFunc:sh},sd=tG(v.RQH,e=>Math.sin(e)),sp={kernelName:v.RQH,backendName:"cpu",kernelFunc:sd},sf=tG(v.wYB,e=>Math.sinh(e)),sm={kernelName:v.wYB,backendName:"cpu",kernelFunc:sf},sg=Math.log(11920928955078125e-23)+2,sy=tG(v.MRv,e=>{let t=Math.exp(e);return e<sg?t:e>-sg?e:Math.log(1+t)}),sb={kernelName:v.MRv,backendName:"cpu",kernelFunc:sy},sx={kernelName:v.TQc,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,paddings:s}=r;tW([a],"spaceToBatchND");let o=v.D5U.sizeFromShape(i),l=[[0,0]];l.push(...s);for(let u=1+i.length;u<a.shape.length;++u)l.push([0,0]);let h=iM.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),c=v.Wap.getReshaped(h.shape,i,o,!1),d=v.Wap.getPermuted(c.length,i.length,!1),p=v.Wap.getReshapedPermuted(h.shape,i,o,!1),f=nm({inputs:{x:h},backend:n,attrs:{shape:c}}),m=nN({inputs:{x:f},backend:n,attrs:{perm:d}}),g=nm({inputs:{x:m},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function sv(e,t,n,r,a,i,s){let o=t[0],l=i[0],u=Array(l),h=Array(o),c=t[1];if(0===l){if(0!==o)throw Error(v.Wap.getSparseFillEmptyRowsIndicesDenseShapeMismatch(o));let d=v.D5U.getArrayFromDType(n,0),p=v.D5U.getArrayFromDType(a,0);return[d,[0,c],p,u,h]}let f=!0,m=0,g=Array(l).fill(0);for(let y=0;y<o;++y){let b=e[y*c];if(b<0)throw Error(v.Wap.getSparseFillEmptyRowsNegativeIndexErrorMessage(y,b));if(b>=l)throw Error(v.Wap.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(y,b,l));++g[b],f=f&&b>=m,m=b}let x=!0;for(let w=0;w<l;++w){let I=0===g[w];u[w]=I,x=x&&!I,g[w]=Math.max(g[w],1),w>0&&(g[w]+=g[w-1])}if(x&&f){for(let k=0;k<o;++k)h[k]=k;return[e,[o,c],r,u,h]}{let S=g[l-1],C=v.D5U.getArrayFromDType(n,S*c),E=v.D5U.getArrayFromDType(a,S),T=Array(l).fill(0);for(let $=0;$<o;++$){let N=e[$*c],A=T[N],D=(0===N?0:g[N-1])+A;T[N]++;for(let F=0;F<c;++F)C[D*c+F]=e[$*c+F];E[D]=r[$],h[$]=D}for(let R=0;R<l;++R){let _=T[R];if(0===_){let O=0===R?0:g[R-1];C[O*c+0]=R;for(let M=1;M<c;++M)C[O*c+M]=0;E[O]=s}}return[C,[S,c],E,u,h]}}let sw={kernelName:v.O3z,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{indices:r,values:a,denseShape:i,defaultValue:s}=t;if(1!==i.shape.length)throw Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(2!==r.shape.length)throw Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(1!==a.shape.length)throw Error(`Values must be a vector, saw:
        ${a.shape}`);if(0!==s.shape.length)throw Error(`Default value must be a scalar, saw:
        ${s.shape}`);let o=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,h=n.data.get(s.dataId).values[0],[c,d,p,f,m]=sv(o,r.shape,r.dtype,l,a.dtype,u,h);return[n.makeTensorInfo(d,r.dtype,c),n.makeTensorInfo([d[0]],a.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(e=>Number(e)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function sI(e,t,n,r,a){let i=v.D5U.sizeFromShape(r),s=t[0],o=a.length,l=[],u=1,h=-1;for(let c=0;c<o;++c){let d=a[c];if(-1===d){if(-1!==h)throw Error(v.Wap.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(h,c));h=c,l.push(1)}else{if(d<0)throw Error(v.Wap.getSparseReshapeNegativeOutputDimErrorMessage(c,d));u*=d,l.push(d)}}if(-1!==h){if(u<=0)throw Error(v.Wap.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());let p=Math.trunc(i/u);if(u*p!==i)throw Error(v.Wap.getSparseReshapeInputOutputMultipleErrorMessage(r,l));l[h]=p}let f=v.D5U.sizeFromShape(l);if(f!==i)throw Error(v.Wap.getSparseReshapeInputOutputMismatchErrorMessage(r,l));let m=r.length,g=[];if(m>0){g[m-1]=1;for(let y=m-2;y>=0;--y)g[y]=g[y+1]*r[y+1]}let b=[];if(o>0){b[o-1]=1;for(let x=o-2;x>=0;--x)b[x]=b[x+1]*l[x+1]}let w=v.D5U.getArrayFromDType(n,s*o);for(let I=0;I<s;++I){let k=0;for(let S=0;S<m;++S)k+=e[I*m+S]*g[S];for(let C=0;C<o;++C)w[I*o+C]=Math.trunc(k/b[C]),k%=b[C]}return[w,[s,o],l]}let sk={kernelName:v.nhH,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{inputIndices:r,inputShape:a,newShape:i}=t;if(2!==r.shape.length)throw Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(1!==a.shape.length)throw Error(`Input shape should be a vector but received shape
        ${a.shape}`);if(1!==i.shape.length)throw Error(`Target shape should be a vector but received shape ${i.shape}`);let s=Array.from(n.data.get(a.dataId).values),o=n.data.get(r.dataId).values,l=Array.from(n.data.get(i.dataId).values),[u,h,c]=sI(o,r.shape,r.dtype,s,l);return[n.makeTensorInfo(h,r.dtype,u),n.makeTensorInfo([c.length],i.dtype,new Int32Array(c))]}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function sS(e,t,n,r,a,i=!1,s=0){let o=r.length,l=[t[0],e.length/t[0]],u=l[1],h=o>0?a[o-1]+1:0;if(h<0)throw Error(v.Wap.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let c=t.slice();c[0]=h;let d=c.reduce((e,t)=>e*t,1),p=v.D5U.getArrayFromDType(n,d);if(0===o)return h>0&&p.fill(s),[p,c];if(h<=0)throw Error(v.Wap.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let f=0,m=1,g=0,y=a[0];for(;;){let b=0;if(m<o){if(y===(b=a[m])){++m;continue}if(y>=b)throw Error(v.Wap.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(y<0||y>=h)throw Error(v.Wap.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(y,h));y>g&&p.fill(s,g*u,y*u);for(let x=f;x<m;++x){let w=r[x];if(w<0||w>=l[0])throw Error(v.Wap.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(x,r[x],l[0]));for(let I=0;I<u;I++)p[y*u+I]+=e[w*u+I]}if(i)for(let k=0;k<u;k++)p[y*u+k]/=m-f;if(f=m,++m,g=y+1,y=b,m>o)break}return g<h&&p.fill(s,g*u,h*u),[p,c]}let sC={kernelName:v.w3H,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw Error(`Indices should be a vector but received shape
          ${a.shape}`);if(1!==i.shape.length)throw Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(a.shape[0]!==i.shape[0])throw Error("segmentIds and indices should have same size.");let s=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,[u,h]=sS(s,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(h,r.dtype,u)}},sE={kernelName:v.ZjV,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw Error(`Indices should be a vector but received shape
         ${a.shape}`);if(1!==i.shape.length)throw Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(a.shape[0]!==i.shape[0])throw Error("segmentIds and indices should have same size.");let s=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,[u,h]=sS(s,r.shape,r.dtype,o,l);return n.makeTensorInfo(h,r.dtype,u)}},sT={kernelName:v.D2d,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t;let{inputs:n,backend:r,attrs:a}=e,{sparseIndices:i,sparseValues:s,defaultValue:o}=n,{outputShape:l}=a,{sliceRank:u,numUpdates:h,sliceSize:c,strides:d,outputSize:p}=v.Wap.calculateShapes(s,i,l),f=r.bufferSync(i);switch(s.dtype){case"bool":{let m=r.bufferSync(s),g=Boolean(r.data.get(o.dataId).values[0]);t=sn(f,m,l,p,c,h,u,d,g,!1);break}case"float32":{let y=r.bufferSync(s),b=r.data.get(o.dataId).values[0];t=sn(f,y,l,p,c,h,u,d,b,!1);break}case"int32":{let x=r.bufferSync(s),w=r.data.get(o.dataId).values[0];t=sn(f,x,l,p,c,h,u,d,w,!1);break}case"string":{let I=r.bufferSync(s),k=v.D5U.decodeString(r.data.get(o.dataId).values[0]);t=sn(f,I,l,p,c,h,u,d,k,!1);break}default:throw Error(`Unsupported type ${s.dtype}`)}return r.makeTensorInfo(l,t.dtype,t.values)}},s$={kernelName:v.L8s,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{numOrSizeSplits:i,axis:s}=r,o=v.D5U.parseAxisParam(s,a.shape)[0],l=v.Wap.prepareSplitSize(a,i,o),u=Array(a.shape.length).fill(0),h=a.shape.slice();return l.map(e=>{let t=[...h];t[o]=e;let r=n1({inputs:{x:a},backend:n,attrs:{begin:u,size:t}});return u[o]+=e,r})}},sN=t5(e=>Math.sqrt(e)),sA=tG(v.FKq,e=>Math.sqrt(e)),sD={kernelName:v.FKq,backendName:"cpu",kernelFunc:sA},sF={kernelName:v.bK0,backendName:"cpu",kernelFunc({inputs:e,backend:t}){let{x:n}=e;tW(n,"square");let r=t.data.get(n.dataId).values,a=new Float32Array(r.length);for(let i=0;i<r.length;++i){let s=r[i];a[i]=s*s}let o=t.write(a,n.shape,n.dtype);return{dataId:o,shape:n.shape,dtype:n.dtype}}},sR=tZ((e,t)=>{let n=e-t;return n*n}),s_=nu(v._tC,sR),sO={kernelName:v._tC,backendName:"cpu",kernelFunc:s_},sM=tG(v.h8e,(e,t)=>isNaN(e)?NaN:e>0?1:t.alpha),sB={kernelName:v.h8e,backendName:"cpu",kernelFunc:sM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function sP(e,t,n,r){let a=(0,v.f3b)(e,t.dtype);for(let i=0;i<a.size;i++){let s=a.indexToLoc(i),o=Array(s.length);for(let l=0;l<o.length;l++)o[l]=s[l]*n[l]+r[l];a.set(t.get(...o),...s)}return a}let sL={kernelName:v.jQk,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t;let{inputs:n,backend:r,attrs:a}=e,{x:i}=n,{begin:s,end:o,strides:l,beginMask:u,endMask:h,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:p}=a;tW(i,"stridedSlice");let{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:y,isSimpleSlice:b,begin:x,end:w,strides:I}=v.kuN.sliceInfo(i.shape,s,o,l,u,h,c,d,p);if(g)t=nm({inputs:{x:i},backend:r,attrs:{shape:m}});else if(y||b){v.D5U.assert(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);let k=v.kuN.computeOutShape(x,w,I),S=n1({inputs:{x:i},backend:r,attrs:{begin:x,size:k}});t=nm({inputs:{x:S},backend:r,attrs:{shape:m}}),r.disposeIntermediateTensorInfo(S)}else{let C=r.bufferSync(i),E=sP(f,C,I,x);t=r.makeTensorInfo(m,E.dtype,E.values)}return t}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class sU{constructor(e,t,n,r,a,i){this.separator=v.D5U.encodeString(e),this.nGramWidths=t,this.leftPad=v.D5U.encodeString(n),this.rightPad=v.D5U.encodeString(r),this.padWidth=a,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){let n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,r,a,i){for(let s=0;s<a;++s){let o;let l=this.getPadWidth(i),u=Math.max(0,l-s),h=Math.max(0,l-(a-(s+1))),c=i-(u+h),d=t+(u>0?0:s-l);o=0+u*this.leftPad.length;for(let p=0;p<c;++p)o+=e[d+p].length;o+=h*this.rightPad.length;let f=u+h+c-1;o+=f*this.separator.length,n[r+s]=new Uint8Array(o);let m=n[r+s],g=0,y=e=>e.forEach(e=>m[g++]=e);for(let b=0;b<u;++b)y(this.leftPad),y(this.separator);for(let x=0;x<c-1;++x)y(e[d+x]),y(this.separator);if(c>0){y(e[d+c-1]);for(let v=0;v<h;++v)y(this.separator),y(this.rightPad)}else{for(let w=0;w<h-1;++w)y(this.rightPad),y(this.separator);y(this.rightPad)}}}compute(e,t){let n=e.length,r=t.length;if(r>0){let a=t[0];if(0!==a)throw Error(`First split value must be 0, got ${a}`);for(let i=1;i<r;++i){let s=t[i]>=a;if(!(s=s&&t[i]<=n))throw Error(`Invalid split value ${t[i]}, must be in [${a}, ${n}]`);a=t[i]}if(a!==n)throw Error(`Last split value must be data size. Expected ${n}, got ${a}`)}let o=r-1,l=v.D5U.getArrayFromDType("int32",r);if(0===n||0===r){let u=Array(n);for(let h=0;h<=o;++h)l[h]=0;return[u,l]}l[0]=0;for(let c=1;c<=o;++c){let d=t[c]-t[c-1],p=0;this.nGramWidths.forEach(e=>{p+=this.getNumNGrams(d,e)}),this.preserveShort&&d>0&&0===p&&(p=1),l[c]=l[c-1]+p}let f=Array(l[o]);for(let m=0;m<o;++m){let g=t[m],y=l[m];if(this.nGramWidths.forEach(n=>{let r=t[m+1]-t[m],a=this.getNumNGrams(r,n);this.createNGrams(e,g,f,y,a,n),y+=a}),this.preserveShort&&y===l[m]){let b=t[m+1]-t[m];if(0===b)continue;let x=b+2*this.padWidth;this.createNGrams(e,g,f,y,1,x)}}return[f,l]}}function sW(e,t,n,r,a,i,s,o){return new sU(n,r,a,i,s,o).compute(e,t)}let sz={kernelName:v._JP,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{separator:a,nGramWidths:i,leftPad:s,rightPad:o,padWidth:l,preserveShortSequences:u}=r,{data:h,dataSplits:c}=t,d=n.data.get(h.dataId).values,p=n.data.get(c.dataId).values,[f,m]=sW(d,p,a,i,s,o,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(c.shape,"int32",m)]}};function sV(e,t,n){let r=e.length,a=[],i=0,s=0,o=Array(r);for(let l=0;l<r;++l){let u=a.length;!/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r){if(!e.length)return;if(0===t.length){for(let a=0;a<e.length;++a)r.push(e.subarray(a,a+1));return}if(1===t.length){let i=t[0],s=e.indexOf(i);for(;-1!==s;){let o=e.subarray(0,s);n&&0===o.length||r.push(o),s=(e=e.subarray(s+1)).indexOf(i)}n&&0===e.length||r.push(e);return}let l=0;for(let u=0;u<e.length+1;u++)if(u===e.length||-1!==t.indexOf(e[u])){let h=e.subarray(l,u);n&&0===h.length||r.push(h),l=u+1}}(e[l],t,n,a);let h=a.length-u;o[l]=h,i+=h,s=Math.max(s,h)}let c=v.D5U.getArrayFromDType("int32",2*i),d=Array(i),p=[r,s],f=0;for(let m=0;m<r;++m)for(let g=0;g<o[m];++g)c[2*f]=m,c[2*f+1]=g,d[f]=a[f],++f;return[c,d,p]}let sG={kernelName:v.s1s,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{skipEmpty:a}=r,{input:i,delimiter:s}=t;if("string"!==i.dtype)throw Error("Input must be of datatype string");if(1!==i.shape.length)throw Error(`Input must be a vector, got shape: ${i.shape}`);if(0!==s.shape.length)throw Error(`Delimiter must be a scalar, got shape: ${s.shape}`);let o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values[0],[u,h,c]=sV(o,l,a),d=h.length;return[n.makeTensorInfo([d,2],"int32",u),n.makeTensorInfo([d],"string",h),n.makeTensorInfo([2],"int32",new Int32Array(c))]}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function sj(e,t){let n=v.D5U.getArrayFromDType("int32",e.length);for(let r=0;r<e.length;++r)n[r]=v.D5U.fingerPrint64(e[r]).modulo(t).getLowBitsUnsigned();return n}let sH={kernelName:v.XkS,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{numBuckets:a}=r,{input:i}=t;if("string"!==i.dtype)throw Error("Input must be of datatype string");if(a<=0)throw Error("Number of buckets must be at least 1");let s=n.data.get(i.dataId).values,o=sj(s,a);return n.makeTensorInfo(i.shape,"int32",o)}},sK=tG(v.sEM,e=>Math.tan(e)),sX={kernelName:v.sEM,backendName:"cpu",kernelFunc:sK},sq=tG(v.MIZ,e=>Math.tanh(e)),sY={kernelName:v.MIZ,backendName:"cpu",kernelFunc:sq};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function sQ(e,t){let n=Array(e.rank);for(let r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];let a=(0,v.f3b)(n,e.dtype);for(let i=0;i<a.values.length;++i){let s=a.indexToLoc(i),o=Array(e.rank);for(let l=0;l<o.length;l++)o[l]=s[l]%e.shape[l];let u=e.locToIndex(o);a.values[i]=e.values[u]}return a}let sZ={kernelName:v.n9L,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reps:i}=r;tW(a,"tile");let s=sQ(n.bufferSync(a),i);return n.makeTensorInfo(s.shape,s.dtype,s.values)}},sJ=(e,t)=>{let n=t.value-e.value;return 0===n?e.index-t.index:n};function s0(e,t,n,r,a){let i=t[t.length-1],[s,o]=[e.length/i,i],l=v.D5U.getTypedArrayFromDType(n,s*r),u=v.D5U.getTypedArrayFromDType("int32",s*r);for(let h=0;h<s;h++){let c=h*o,d=e.subarray(c,c+o),p=Array(d.length);d.forEach((e,t)=>p[t]={value:e,index:t}),r<p.length&&(function e(t,n,r=0,a=t.length-1){for(;a>r;){if(a-r>600){let i=a-r+1,s=n-r+1,o=Math.log(i),l=.5*Math.exp(2*o/3),u=.5*Math.sqrt(o*l*(i-l)/i)*Math.sign(s-i/2),h=Math.max(r,Math.floor(n-s*l/i+u)),c=Math.min(a,Math.floor(n+(i-s)*l/i+u));e(t,n,h,c)}let d=t[n],p=r,f=a;for(v.D5U.swap(t,r,n),sJ(t[a],d)>0&&v.D5U.swap(t,r,a);p<f;){for(v.D5U.swap(t,p,f),p++,f--;0>sJ(t[p],d);)p+=1;for(;sJ(t[f],d)>0;)f-=1}0===sJ(t[r],d)?v.D5U.swap(t,r,f):(f+=1,v.D5U.swap(t,f,a)),f<=n&&(r=f+1),n<=f&&(a=f-1)}}(p,r),p=p.slice(0,r)),a&&p.sort(sJ);let f=h*r,m=l.subarray(f,f+r),g=u.subarray(f,f+r);for(let y=0;y<r;y++)m[y]=p[y].value,g[y]=p[y].index}let b=t.slice();return b[b.length-1]=r,[(0,v.f3b)(b,n,l),(0,v.f3b)(b,"int32",u)]}let s1={kernelName:v.cWu,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{k:i,sorted:s}=r;tW(a,"topk");let o=n.data.get(a.dataId).values,[l,u]=s0(o,a.shape,a.dtype,i,s);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}},s2={kernelName:v.wx7,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,attrs:n,backend:r}=e,{image:a,transforms:i}=t,{interpolation:s,fillMode:o,fillValue:l,outputShape:u}=n,[h,c,d,p]=a.shape,[f,m]=null!=u?u:[c,d],g=[h,f,m,p],y=v.D5U.computeStrides(a.shape),b=y[0],x=y[1],w=y[2],I=v.D5U.computeStrides(g),k=I[0],S=I[1],C=I[2],E=v.D5U.getTypedArrayFromDType(a.dtype,v.D5U.sizeFromShape(g));E.fill(l);let T=r.data.get(a.dataId).values,$=r.data.get(i.dataId).values;for(let N=0;N<h;++N){let A=1===i.shape[0]?$:$.subarray(8*N,8*N+8);for(let D=0;D<f;++D)for(let F=0;F<m;++F)for(let R=0;R<p;++R){let _;let O=A[6]*F+A[7]*D+1;if(0===O)continue;let M=(A[0]*F+A[1]*D+A[2])/O,B=(A[3]*F+A[4]*D+A[5])/O,P=s3(M,d,o),L=s3(B,c,o);switch(s){case"nearest":_=function(e,t,n,r,a,i,s,o,l,u,h){let c=Math.round(o),d=Math.round(l);return s4(e,t,n,r,a,i,s,c,d,u,h)}(T,c,d,b,x,w,N,L,P,R,l);break;case"bilinear":_=function(e,t,n,r,a,i,s,o,l,u,h){let c=Math.floor(o),d=Math.floor(l),p=c+1,f=d+1,m=(f-l)*s4(e,t,n,r,a,i,s,c,d,u,h)+(l-d)*s4(e,t,n,r,a,i,s,c,f,u,h),g=(f-l)*s4(e,t,n,r,a,i,s,p,d,u,h)+(l-d)*s4(e,t,n,r,a,i,s,p,f,u,h);return(p-o)*m+(o-c)*g}(T,c,d,b,x,w,N,L,P,R,l);break;default:throw Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${s}`)}let U=N*k+D*S+F*C+R;E[U]=_}return r.makeTensorInfo(g,a.dtype,E)}let W=r.write(E,g,a.dtype);return{dataId:W,shape:a.shape,dtype:a.dtype}}};function s3(e,t,n){switch(n){case"reflect":return function(e,t){let n=e;if(n<0){if(t<=1)n=0;else{let r=2*t;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-t?n+r:-n-1}}else if(n>t-1){if(t<=1)n=0;else{let a=2*t;(n-=a*Math.trunc(n/a))>=t&&(n=a-n-1)}}return v.D5U.clamp(0,n,t-1)}(e,t);case"wrap":let r;return(r=e)<0?t<=1?r=0:r+=t*(Math.trunc(-r/(t-1))+1):r>t-1&&(t<=1?r=0:r-=t*Math.trunc(r/(t-1))),v.D5U.clamp(0,r,t-1);case"nearest":return v.D5U.clamp(0,e,t-1);default:return e}}function s4(e,t,n,r,a,i,s,o,l,u,h){return 0<=o&&o<t&&0<=l&&l<n?e[s*r+o*a+l*i+u]:h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function s6(e,t,n,r){let a=v.D5U.parseAxisParam(t,n)[0],i=[1,n[0],1];for(let s=0;s<a;s++)i[0]*=n[s];i[1]=n[a];for(let o=a+1;o<n.length;o++)i[2]*=n[o];let l={},u=new Int32Array(n[a]),h=new v.YDk(i,r,e),c=[],d=1===i[0]&&1===i[2];for(let p=0;p<n[a];p++){let f;if(d)f=e[p].toString();else{let m=[];for(let g=0;g<i[0];g++)for(let y=0;y<i[2];y++)m.push(h.get(g,p,y));f=m.join(",")}if(void 0!==l[f])u[p]=l[f];else{let b=Object.keys(l).length;l[f]=b,u[p]=b,c.push(p)}}let x=i.slice();x[1]=Object.keys(l).length;let w=new v.YDk(x,r);c.forEach((e,t)=>{for(let n=0;n<i[0];n++)for(let r=0;r<i[2];r++)w.set(h.get(n,e,r),n,t,r)});let I=n.slice();return I[a]=x[1],{outputValues:w.values,outputShape:I,indices:u}}let s5={kernelName:v.kpP,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,attrs:n,backend:r}=e,{axis:a}=n,{x:i}=t;tW(i,"unique");let s=r.data.get(i.dataId).values,{outputValues:o,outputShape:l,indices:u}=s6(s,a,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,o),r.makeTensorInfo([u.length],"int32",u)]}},s7={kernelName:v.ToN,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{value:a}=t,{axis:i}=r;i<0&&(i+=a.shape.length);let s=a.shape.length,o=a.shape[i],l=Array(s-1),u=0;for(let h=0;h<s;h++)h!==i&&(l[u++]=a.shape[h]);let c=Array(s).fill(0),d=a.shape.slice();d[i]=1;let p=Array(o);for(let f=0;f<p.length;f++){c[i]=f;let m=n1({inputs:{x:a},backend:n,attrs:{begin:c,size:d}});p[f]=nm({inputs:{x:m},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(m)}return p}},s8={kernelName:v.Qvg,backendName:"cpu",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,segmentIds:i}=t,{numSegments:s}=r;tW(a,"unsortedSegmentSum");let o=a.shape.length,l=i.shape.length,u=[],h=[],c=o-l,d=i;for(let p=0;p<c;++p){let f=r2({inputs:{input:d},backend:n,attrs:{dim:p+1}});d=f,h.push(f)}for(let m=0;m<s;++m){let g=v.D5U.createScalarValue(m,"int32"),y=n.makeTensorInfo([],"int32",g),b=rV({inputs:{a:y,b:d},backend:n}),x=no({inputs:{x:b},backend:n,attrs:{dtype:"float32"}}),w=rM({inputs:{a:x,b:a},backend:n}),I=rP({inputs:{x:w},backend:n,attrs:{axis:0,keepDims:!1}});u.push(I),h.push(y),h.push(b),h.push(x),h.push(w),h.push(I)}let k=i_({inputs:u,backend:n,attrs:{axis:0}});return h.forEach(e=>n.disposeIntermediateTensorInfo(e)),k}};for(let s9 of[nx,nI,nS,nE,nf,nT,nD,nF,nR,n_,nM,nP,nU,nV,nj,nq,nY,nQ,nZ,nb,nJ,n3,n5,n7,nl,re,rn,nn,ra,ru,rc,rd,rp,rf,rm,rg,rb,rv,rw,rI,rk,rS,rC,rT,r$,rN,rA,rD,rF,rR,rU,tK,rW,rG,rZ,r1,r3,r5,ai,ao,al,ac,af,am,ag,ab,av,ak,aE,tq,aT,ro,aN,aD,aR,tQ,aM,aL,aW,aG,aH,aq,aQ,a0,a1,a2,a6,a8,a9,ie,it,ir,ia,ii,is,iu,ih,ip,ib,rB,iv,iI,iS,iE,iN,iA,iR,iO,iM,iL,t1,iW,iG,iY,iZ,ni,r9,i0,t3,t6,ng,i1,i2,i3,i4,i6,i5,i8,st,sr,sa,si,su,t9,sc,sp,sm,n2,iy,sb,sx,sw,sk,sC,sE,sT,s$,sD,sF,sO,sB,sL,sz,sG,sH,ar,rL,sX,sY,sZ,s1,s2,nA,s5,s7,s8,iF])(0,v.wCN)(s9);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let oe={},ot={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function on(e,t){if(!(e in oe)||null!=t){let n=function(e,t){if(1!==e&&2!==e)throw Error("Cannot get WebGL rendering context, WebGL is disabled.");let n=null==t?function(e){if("undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw Error("Cannot create a canvas in this context")}(e):t;return(n.addEventListener("webglcontextlost",t=>{t.preventDefault(),delete oe[e]},!1),(0,v.OBj)().getBool("SOFTWARE_WEBGL_ENABLED")&&(ot.failIfMajorPerformanceCaveat=!1),1===e)?n.getContext("webgl",ot)||n.getContext("experimental-webgl",ot):n.getContext("webgl2",ot)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;oe[e]=n}let r=oe[e];return null==r||r.isContextLost()?(delete oe[e],on(e)):(r.disable(r.DEPTH_TEST),r.disable(r.STENCIL_TEST),r.disable(r.BLEND),r.disable(r.DITHER),r.disable(r.POLYGON_OFFSET_FILL),r.disable(r.SAMPLE_COVERAGE),r.enable(r.SCISSOR_TEST),r.enable(r.CULL_FACE),r.cullFace(r.BACK),oe[e])}function or(e){let t=v.D5U.sizeFromShape(e),n=Math.ceil(t/4);return v.D5U.sizeToSquarishShape(n)}function oa(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function oi(e,t){let n,r,a,i,s,o,l,u,h,c;return 2===(0,v.OBj)().getNumber("WEBGL_VERSION")?(n=e.R32F,r=e.R16F,a=e.RGBA16F,i=e.RGBA32F,s=e.RED,l=4,u=1,h=e.HALF_FLOAT,c=e.FLOAT,o=e.RGBA8):(n=e.RGBA,r=e.RGBA,a=e.RGBA,i=e.RGBA,s=e.RGBA,l=4,u=4,h=null!=t?t.HALF_FLOAT_OES:null,c=e.FLOAT,o=e.RGBA),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:s,downloadTextureFormat:o,downloadUnpackNumChannels:l,defaultNumChannels:u,textureTypeHalfFloat:h,textureTypeFloat:c}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function os(e,t){let n=t();return(0,v.OBj)().getBool("DEBUG")&&function(e){let t=e.getError();if(t!==e.NO_ERROR)throw Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}(e,t))}(e),n}function oo(e,t){return om(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}(u=m||(m={}))[u.DENSE=0]="DENSE",u[u.SHARED_BATCH=1]="SHARED_BATCH",(h=g||(g={}))[h.RENDER=0]="RENDER",h[h.UPLOAD=1]="UPLOAD",h[h.PIXELS=2]="PIXELS",h[h.DOWNLOAD=3]="DOWNLOAD",(c=y||(y={}))[c.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",c[c.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",c[c.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",c[c.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",c[c.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16";let ol=/ERROR: [0-9]+:([0-9]+):/g;function ou(e,t){let n=ol.exec(t);if(null==n){console.log(`Couldn't parse line number in error: ${t}`),console.log(e);return}let r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,s=a.map((e,t)=>v.D5U.rightPad((t+1).toString(),i)+e),o=0;for(let l=0;l<s.length;l++)o=Math.max(s[l].length,o);let u=s.slice(0,r-1),h=s.slice(r-1,r),c=s.slice(r);console.log(u.join("\n")),console.log(t.split("\n")[0]),console.log(`%c ${v.D5U.rightPad(h[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join("\n"))}function oh(e,t){if(os(e,()=>e.validateProgram(t)),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),Error("Shader program validation failed.")}function oc(e,t,n,r,a,i,s){let o=e.getAttribLocation(t,n);return -1!==o&&(os(e,()=>e.bindBuffer(e.ARRAY_BUFFER,r)),os(e,()=>e.vertexAttribPointer(o,a,e.FLOAT,!1,i,s)),os(e,()=>e.enableVertexAttribArray(o)),!0)}function od(e,t,n){os(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),os(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function op(e,t){os(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),os(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function of(e){let t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}(e,t))}function om(e,t,n){let r=os(e,()=>t());if(null==r)throw Error(n);return r}function og(e,t=2){return v.D5U.sizeFromShape(e.slice(0,e.length-t))}function oy(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function ob(e){let t=[1,1,1],n=0===e.length||1===e.length&&1===e[0];return n||(t=[og(e),...oy(e)]),t}function ox(e,t){if(e=e.slice(-2),t=t.slice(-2),v.D5U.arraysEqual(e,t)||!e.length||!t.length||0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){let n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r||n%2==0&&r%2==0&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&e[0]%2==0&&t[0]%2==0}function ov(e,t){let n=e.getExtension(t);return null!=n}function ow(e){try{let t=on(e);if(null!=t)return!0}catch(n){console.log("Error when getting WebGL context: ",n)}return!1}function oI(e){let t=oi(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);let r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);let a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function ok(e,t){Array.isArray(e)||(e=[e]),e.forEach(e=>{null!=e&&v.D5U.assert("complex64"!==e.dtype,()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let oS=(0,v.OBj)();oS.registerFlag("HAS_WEBGL",()=>oS.getNumber("WEBGL_VERSION")>0),oS.registerFlag("WEBGL_VERSION",()=>ow(2)?2:ow(1)?1:0),oS.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),oS.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>2===oS.get("WEBGL_VERSION")),oS.registerFlag("WEBGL_CPU_FORWARD",()=>!0),oS.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),oS.registerFlag("WEBGL_PACK",()=>oS.getBool("HAS_WEBGL")),oS.registerFlag("WEBGL_PACK_NORMALIZATION",()=>oS.getBool("WEBGL_PACK")),oS.registerFlag("WEBGL_PACK_CLIP",()=>oS.getBool("WEBGL_PACK")),oS.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>oS.getBool("WEBGL_PACK")),oS.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>oS.getBool("WEBGL_PACK")),oS.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>oS.getBool("WEBGL_PACK")),oS.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>oS.getBool("WEBGL_PACK")),oS.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>oS.getBool("WEBGL_PACK")),oS.registerFlag("WEBGL_PACK_REDUCE",()=>oS.getBool("WEBGL_PACK")),oS.registerFlag("WEBGL_LAZILY_UNPACK",()=>oS.getBool("WEBGL_PACK")),oS.registerFlag("WEBGL_CONV_IM2COL",()=>oS.getBool("WEBGL_PACK")),oS.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>(function(e){if(null==r){let t=on(e);r=t.getParameter(t.MAX_TEXTURE_SIZE)}return r})(oS.getNumber("WEBGL_VERSION"))),oS.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>(function(e){if(null==a){let t=on(e);a=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,a)})(oS.getNumber("WEBGL_VERSION"))),oS.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{let e=oS.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;let t=on(e);return ov(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:ov(t,"EXT_disjoint_timer_query")?1:0}(e)}),oS.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>oS.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!v.C2$.isMobile()),oS.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>(function(e){if(0===e)return!1;let t=on(e);if(1===e){if(!ov(t,"OES_texture_float"))return!1}else if(!ov(t,"EXT_color_buffer_float"))return!1;let n=oI(t);return n})(oS.getNumber("WEBGL_VERSION"))),oS.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>!oS.getBool("WEBGL_FORCE_F16_TEXTURES")&&oS.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),oS.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>(function(e){if(0===e)return!1;let t=on(e);if(1===e){if(!ov(t,"OES_texture_float")||!ov(t,"WEBGL_color_buffer_float"))return!1}else{if(ov(t,"EXT_color_buffer_float"))return oI(t);let n="EXT_color_buffer_half_float";if(ov(t,n)){let r=t.getExtension(n);return function(e,t){let n=oi(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);let a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);let i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(a),i}(t,r)}return!1}let a=oI(t);return a})(oS.getNumber("WEBGL_VERSION"))),oS.registerFlag("WEBGL_FENCE_API_ENABLED",()=>(function(e){if(2!==e)return!1;let t=on(e),n=null!=t.fenceSync;return n})(oS.getNumber("WEBGL_VERSION"))),oS.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>{let e=oS.getBool("WEBGL_RENDER_FLOAT32_ENABLED");return e?4:0}),oS.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if(e<0&&-1!==e)throw Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)}),oS.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>v.C2$.isMobile()?1:-1,e=>{if(e<0&&-1!==e)throw Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)}),oS.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128),oS.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1),oS.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5),oS.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128),oS.registerFlag("WEBGL_EXP_CONV",()=>!1),oS.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>oS.getBool("IS_TEST")),oS.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0),oS.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1),oS.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);var oC=n(9610),oE=n(5156);function oT(e,t,n){let r,a,i;let s={},o={},l={},u=[],h=null,c=null;c=e.getUniformLocation(n,"NAN",!1),1===(0,v.OBj)().getNumber("WEBGL_VERSION")&&(h=e.getUniformLocation(n,"INFINITY",!1));for(let d=0;d<t.variableNames.length;d++){let p=t.variableNames[d];s[p]=e.getUniformLocation(n,p,!1),s[`offset${p}`]=e.getUniformLocation(n,`offset${p}`,!1),t.enableShapeUniforms&&(o[`${p}Shape`]=e.getUniformLocation(n,`${p}Shape`,!1),l[`${p}TexShape`]=e.getUniformLocation(n,`${p}TexShape`,!1))}return t.enableShapeUniforms&&(r=e.getUniformLocation(n,"outShape",!1),i=e.getUniformLocation(n,"outShapeStrides",!1),a=e.getUniformLocation(n,"outTexShape",!1)),t.customUniforms&&t.customUniforms.forEach((t,r)=>{u[r]=e.getUniformLocation(n,t.name,!1)}),{uniformLocations:s,customUniformLocations:u,infLoc:h,nanLoc:c,inShapesLocations:o,inTexShapesLocations:l,outShapeLocation:r,outShapeStridesLocation:i,outTexShapeLocation:a}}function o$(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach((e,n)=>{let r=e.logicalShape,a=t[n],i=a.shape;if(!v.D5U.arraysEqual(r,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${i} must match`);if(e.isUniform&&a.isUniform)return;let s=e.texShape,o=a.isUniform?null:a.texData.texShape;if(!v.D5U.arraysEqual(s,o))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${s} and ${o} must match`)})}function oN(e){return(0,v.OBj)().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}var oA=n(8110);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class oD{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=m.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=(0,oC.A)();this.outputShape=e,this.enableShapeUniforms=oN(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?oA.Kn(["r","c","d"],e):oA.RW(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class oF{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=m.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=(0,oC.A)();this.outputShape=e,this.enableShapeUniforms=oN(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?oA.Kn(["r","c","d"],e):oA.RW(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class oR{constructor(e){this.variableNames=["A"],this.outTexUsage=g.DOWNLOAD;let t=(0,oC.A)();this.outputShape=e,this.userCode=`
      ${oA.ye}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class o_{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=g.DOWNLOAD;let t=(0,oC.A)();this.outputShape=e,this.userCode=`
      ${oA.ye}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class oO{constructor(e,t=!1){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];let n=(0,oC.A)();this.outputShape=e,this.enableShapeUniforms=oN(this.outputShape.length);let r="result";t&&(r="floor(result * 255. + 0.5)"),this.userCode=`
      ${this.enableShapeUniforms?oA.nc():oA.ku(e)}

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);

        int r = flatIndex / texShape[1];
        int c = imod(flatIndex, texShape[1]);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
        vec4 values = ${n.texture2D}(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        ${n.output} = vec4(${r}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class oM{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];let n=(0,oC.A)();this.outputShape=e,this.enableShapeUniforms=oN(this.outputShape.length);let r="",a="result";t&&(a="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let s=0;s<=1;s++){let o=2*i+s;r+=`
          localCoords = coords;
          if(localCoords[2] + ${s} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${s};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${n.texture2D}(A, uv);

            if (offset == 0) {
              result[${o}] = values[0];
            } else if (offset == 1) {
              result[${o}] = values[1];
            } else if (offset == 2) {
              result[${o}] = values[2];
            } else {
              result[${o}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?oA.nc():oA.ku(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${n.output} = ${a};
        }
    `}}function oB(e,t,n,r,a,i){!function(e,t){let n=(0,v.OBj)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){let r=`[${e}x${t}]`;throw Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){let a=`[${e}x${t}]`,i=`[${n}x${n}]`;throw Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU "+i+".")}}(t,n);let s=om(e,()=>e.createTexture(),"Unable to create WebGLTexture."),o=e.TEXTURE_2D;return os(e,()=>e.bindTexture(o,s)),os(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),os(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),os(e,()=>e.texParameteri(o,e.TEXTURE_MIN_FILTER,e.NEAREST)),os(e,()=>e.texParameteri(o,e.TEXTURE_MAG_FILTER,e.NEAREST)),1===(0,v.OBj)().getNumber("WEBGL_VERSION")?os(e,()=>e.texImage2D(o,0,r,t,n,0,a,i,null)):os(e,()=>e.texStorage2D(o,1,r,t,n)),os(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:s,texShape:[n,t]}}function oP(e){return e.internalFormatFloat}function oL(e){return e.internalFormatHalfFloat}function oU(e){return e.downloadTextureFormat}function oW(e){return e.internalFormatPackedFloat}function oz(e){return e.internalFormatPackedHalfFloat}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class oV{constructor(e){var t;this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];let n=(0,v.OBj)().getNumber("WEBGL_VERSION");null!=e?(this.gl=e,oe[n]=e):this.gl=on(n);let r="WEBGL_color_buffer_float",a="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===(0,v.OBj)().getNumber("WEBGL_VERSION")){let i="OES_texture_half_float";if(this.textureFloatExtension=oo(this.gl,"OES_texture_float"),ov(this.gl,i))this.textureHalfFloatExtension=oo(this.gl,i);else if((0,v.OBj)().get("WEBGL_FORCE_F16_TEXTURES"))throw Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),ov(this.gl,a))this.colorBufferHalfFloatExtension=oo(this.gl,a);else if((0,v.OBj)().get("WEBGL_FORCE_F16_TEXTURES"))throw Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",ov(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(ov(this.gl,a))this.colorBufferHalfFloatExtension=this.gl.getExtension(a);else throw Error("GL context does not support color renderable floats");this.vertexBuffer=function(e){let t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return function(e,t){let n=om(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return os(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),os(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}(e,t)}(this.gl),this.indexBuffer=function(e){let t=new Uint16Array([0,1,2,2,1,3]);return function(e,t){let n=om(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return os(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),os(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}(e,t)}(this.gl),this.framebuffer=om(t=this.gl,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer."),this.textureConfig=oi(this.gl,this.textureHalfFloatExtension)}get debug(){return(0,v.OBj)().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");let e=this.gl;os(e,()=>e.finish()),os(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),os(e,()=>e.deleteFramebuffer(this.framebuffer)),os(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),os(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),os(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){let[a,i]=[n,t];return oB(e,a,i,oP(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){let[a,i]=[n,t];return oB(e,a,i,oL(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){let[a,i]=[n,t];return oB(e,a,i,oU(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){var n;this.throwIfDisposed(),os(n=this.gl,()=>n.bindTexture(n.TEXTURE_2D,e)),t.data instanceof Uint8Array?2===(0,v.OBj)().getNumber("WEBGL_VERSION")?os(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.width,t.height,n.RGBA,n.UNSIGNED_BYTE,t.data)):os(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,t.data)):2===(0,v.OBj)().getNumber("WEBGL_VERSION")?os(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,t)):os(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),os(n,()=>n.bindTexture(n.TEXTURE_2D,null))}uploadDenseMatrixToTexture(e,t,n,r){var a,i;let s,o,l;this.throwIfDisposed(),a=this.gl,i=this.textureConfig,os(a,()=>a.bindTexture(a.TEXTURE_2D,e)),r instanceof Uint8Array?(s=new Uint8Array(t*n*4),o=a.UNSIGNED_BYTE,l=a.RGBA):(s=new Float32Array(t*n*4),o=a.FLOAT,l=i.internalFormatPackedFloat),s.set(r),2===(0,v.OBj)().getNumber("WEBGL_VERSION")?os(a,()=>a.texSubImage2D(a.TEXTURE_2D,0,0,0,t,n,a.RGBA,o,s)):os(a,()=>a.texImage2D(a.TEXTURE_2D,0,l,t,n,0,a.RGBA,o,s)),os(a,()=>a.bindTexture(a.TEXTURE_2D,null))}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){let[a,i]=oa(t,n);return oB(e,a,i,oz(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){let[a,i]=oa(t,n);return oB(e,a,i,oW(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(op(this.gl,this.framebuffer),this.outputTexture=null),os(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,()=>(function(e,t,n,r){let[a,i]=[n,t],s=new Uint8Array(t*n*4);return os(e,()=>e.readPixels(0,0,a,i,r.downloadTextureFormat,e.UNSIGNED_BYTE,s)),new Float32Array(s.buffer)})(this.gl,t,n,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,n,r,a,i){return function(e,t,n,r,a,i,s,o){let l=new Float32Array(function(e,t){let[n,r]=oa(e,t);return n*r*4}(i,s));return e.bindBuffer(e.PIXEL_PACK_BUFFER,t),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,l),e.bindBuffer(e.PIXEL_PACK_BUFFER,null),l}(this.gl,e,0,0,0,a,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return function(e,t,n){let r=new Float32Array(n);return e.bindBuffer(e.PIXEL_PACK_BUFFER,t),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,r),e.bindBuffer(e.PIXEL_PACK_BUFFER,null),r}(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);let r=function(e,t,n,r){let a=e.createBuffer();os(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,a));let i=16*t*n;return os(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)),os(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),os(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),a}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){let e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if((0,v.OBj)().getBool("WEBGL_FENCE_API_ENABLED")){let r=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{let t=e.clientWaitSync(r,0,0);return t===e.ALREADY_SIGNALED||t===e.CONDITION_SATISFIED},t=r}else(0,v.OBj)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,(0,v.OBj)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,()=>(function(e,t,n){let r=new Float32Array(t*n*4);return os(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)),r})(this.gl,t,n))}createProgram(e){this.throwIfDisposed();let t=this.gl;null==this.vertexShader&&(this.vertexShader=/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=(0,oC.A)(),n=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return function(e,t){let n=om(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(os(e,()=>e.shaderSource(n,t)),os(e,()=>e.compileShader(n)),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),Error("Failed to compile vertex shader.");return n}(e,n)}(t));let n=om(t,()=>t.createProgram(),"Unable to create WebGLProgram.");return os(t,()=>t.attachShader(n,this.vertexShader)),os(t,()=>t.attachShader(n,e)),!function(e,t){if(os(e,()=>e.linkProgram(t)),!(0,v.OBj)().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),Error("Failed to link vertex and fragment shaders.")}(t,n),this.debug&&oh(t,n),this.vertexAttrsAreBound||(this.setProgram(n),this.vertexAttrsAreBound=function(e,t,n){os(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n));let r=oc(e,t,"clipSpacePos",n,3,20,0);return r&&oc(e,t,"uv",n,2,20,12)}(t,this.program,this.vertexBuffer)),n}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&os(this.gl,()=>this.gl.deleteProgram(e))}setProgram(e){this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&oh(this.gl,this.program),os(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,n=!0){var r,a;return(this.throwIfDisposed(),n)?om(r=this.gl,()=>r.getUniformLocation(e,a),'uniform "'+(a=t)+'" not present in program.'):this.gl.getUniformLocation(e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),os(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){var r;this.throwIfDisposed(),this.throwIfNoProgram(),os(r=this.gl,()=>{(function(e,t){let n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){let a=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw Error(`textureUnit must be in ${a}.`)}})(r,n),os(r,()=>r.activeTexture(r.TEXTURE0+n)),os(r,()=>r.bindTexture(r.TEXTURE_2D,e))}),os(r,()=>r.uniform1i(t,n))}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();let[r,a]=oa(t,n);this.setOutputMatrixTextureDriver(e,r,a)}setOutputMatrixWriteRegion(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,n,r){throw Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&oh(this.gl,this.program),of(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();let e=this.gl;this.debug&&this.debugValidate(),os(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),os(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=oo(this.gl,2===(0,v.OBj)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===(0,v.OBj)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){let e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}let r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a}endQuery(){if(2===(0,v.OBj)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){let e=this.gl,t=this.getQueryTimerExtensionWebGL2();e.endQuery(t.TIME_ELAPSED_EXT);return}let n=this.getQueryTimerExtensionWebGL1();n.endQueryEXT(n.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await v.D5U.repeatedTry(()=>this.disposed||this.isQueryAvailable(e,(0,v.OBj)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,(0,v.OBj)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(0===t)return null;if(2===t){let n=this.gl,r=n.getQueryParameter(e,n.QUERY_RESULT);return r/1e6}{let a=this.getQueryTimerExtensionWebGL1(),i=a.getQueryObjectEXT(e,a.QUERY_RESULT_EXT);return i/1e6}}isQueryAvailable(e,t){if(0===t)return!0;if(2===t){let n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}{let i=this.getQueryTimerExtensionWebGL1(),s=i.getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){let e=function(e){let t=0;for(;t<e.length;++t){let n=e[t]();if(!n)break}return t-1}(this.itemsToPoll.map(e=>e.isDoneFn));for(let t=0;t<=e;++t){let{resolveFn:n}=this.itemsToPoll[t];n()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){let n;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||("setTimeoutCustom"in(0,v.OBj)().platform&&(n=(0,v.OBj)().platform.setTimeoutCustom.bind((0,v.OBj)().platform)),v.D5U.repeatedTry(()=>(this.pollItems(),0===this.itemsToPoll.length),()=>0,null,n))}bindTextureToFrameBuffer(e){this.throwIfDisposed(),od(this.gl,e,this.framebuffer),this.debug&&of(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(od(this.gl,this.outputTexture,this.framebuffer),this.debug&&of(this.gl)):op(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);let n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();let r=this.gl;od(r,e,this.framebuffer),this.debug&&of(r),this.outputTexture=e,os(r,()=>r.viewport(0,0,t,n)),os(r,()=>r.scissor(0,0,t,n))}setOutputMatrixWriteRegionDriver(e,t,n,r){this.throwIfDisposed(),os(this.gl,()=>this.gl.scissor(e,t,n,r))}throwIfDisposed(){if(this.disposed)throw Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw Error("No GPU program is currently set.")}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let{addImpl:oG,bincountImpl:oj,bincountReduceImpl:oH,castImpl:oK,ceilImpl:oX,concatImpl:oq,equalImpl:oY,expImpl:oQ,expm1Impl:oZ,floorImpl:oJ,gatherNdImpl:o0,gatherV2Impl:o1,greaterImpl:o2,greaterEqualImpl:o3,lessImpl:o4,lessEqualImpl:o6,linSpaceImpl:o5,logImpl:o7,maxImpl:o8,maximumImpl:o9,minimumImpl:le,multiplyImpl:lt,negImpl:ln,notEqualImpl:lr,prodImpl:la,raggedGatherImpl:li,raggedTensorToTensorImpl:ls,rangeImpl:lo,rsqrtImpl:ll,scatterImpl:lu,sigmoidImpl:lh,simpleAbsImpl:lc,sliceImpl:ld,sparseFillEmptyRowsImpl:lp,sparseReshapeImpl:lf,sparseSegmentReductionImpl:lm,sqrtImpl:lg,stridedSliceImpl:ly,stringNGramsImpl:lb,stringSplitImpl:lx,stringToHashBucketFastImpl:lv,subImpl:lw,tileImpl:lI,topKImpl:lk,transposeImpl:lS,uniqueImpl:lC}=x;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function lE(e,t){return["x","y","z","w","u","v"].slice(0,t).map(t=>`${e}.${t}`)}function lT(e,t){return 1===t?[e]:lE(e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class l${constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=oN(this.outputShape.length),0===this.rank)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{let t=lT("rc",this.rank),n=(0,oE.kW)(this.rank),r=this.getOutOfBoundsCondition(t),a=this.getSetup(t),i=this.getOutput(t);this.userCode=`
        void main() {
          ${n} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${a}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){let t=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let a=`${0===n?"r":"rp1"}, ${0===r?"c":"cp1"}`;for(let i=2;i<this.rank;i++)a=`${e[e.length-1-i]},`+a;t.push(a)}return t}getOutOfBoundsCondition(e){if(1===this.rank)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let n=this.rank-2;n<this.rank;n++)t+=`${e[n]} >= ${this.enableShapeUniforms?`outShape[${n}]`:this.outputShape[n]}`,n<this.rank-1&&(t+="||");return t}getSetup(e){if(1===this.rank)return"";let t=e.slice(-2),n=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${n};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){let t=this.getSourceCoordsArr(e);if(1===this.rank){let n=this.enableShapeUniforms?"outShape":this.outputShape[0];return`getA(rc), (rc + 1 >= ${n} ? 0. : getA(rc + 1)), 0, 0`}return`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class lN{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=oN(this.outputShape.length);let n="";for(let r=0;r<4;r++){let a="thisRC = rc;";r%2==1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),n+=`
        ${a}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${function(e,t){let n=t?oA.al(["r","c","d"],"inputShape"):oA.RW(["r","c","d"],e);return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${n}
      return ivec3(r, c, d);
    }
  `}(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?oA.nc():oA.ku(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${n}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class lA{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(e,t,n){let r;let a=lF(t,n),i=lR(e,a,n);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);let s=lD(e,a,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=s,this.log();let o=this.freeTextures[i].shift();return this.usedTextures[i].push(o),o}return a===y.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):a===y.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):a===y.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):a===y.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):a===y.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(r),this.numUsedTextures++,this._numBytesAllocated+=s,this.log(),r}releaseTexture(e,t,n,r){if(null==this.freeTextures)return;let a=lF(n,r),i=lR(t,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);let s=lD(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),o=(0,v.OBj)().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==o&&this._numBytesAllocated>o?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=s):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=s),this.numUsedTextures--;let l=this.usedTextures[i],u=l.indexOf(e);if(u<0)throw Error("Cannot release a texture that was never provided by this texture manager");l.splice(u,1),this.log()}log(){if(!this.logEnabled)return;let e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);let t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(let e in this.freeTextures)this.freeTextures[e].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});for(let t in this.usedTextures)this.usedTextures[t].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function lD(e,t,n,r,a){let i;let s=function(e,t){switch(e){case y.PACKED_2X2_FLOAT32:return oW(t);case y.PACKED_2X2_FLOAT16:return oz(t);case y.UNPACKED_FLOAT32:return oP(t);case y.UNPACKED_FLOAT16:return oL(t);case y.PACKED_4X1_UNSIGNED_BYTE:return oU(t);default:throw Error(`Unknown physical texture type ${e}`)}}(t,r);if(a){let[o,l]=oa(e[0],e[1]);i=o*l}else{var u;let[h,c]=(u=e[0],[e[1],u]);i=h*c}let d=function(e,t){if(t===e.R32F)return 4;if(t===e.R16F)return 2;if(t===e.RGBA32F||t===e.RGBA)return 16;if(t===e.RGBA16F)return 8;if(t===e.RGBA8)return 4;throw Error(`Unknown internal format ${t}`)}(n,s);return i*d}function lF(e,t){if(e===g.UPLOAD)return y.PACKED_2X2_FLOAT32;if(e===g.RENDER||null==e)return(0,v.OBj)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?y.PACKED_2X2_FLOAT32:y.UNPACKED_FLOAT32:t?y.PACKED_2X2_FLOAT16:y.UNPACKED_FLOAT16;if(e===g.DOWNLOAD||e===g.PIXELS)return y.PACKED_4X1_UNSIGNED_BYTE;throw Error(`Unknown logical texture type ${e}`)}function lR(e,t,n){return`${e[0]}_${e[1]}_${t}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class l_{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=oN(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}let lO="if (isnan(x)) return x;",lM="return abs(x);",lB=lO+`
  return (x < 0.0) ? 0.0 : x;
`,lP=lO+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,lL="return x;",lU=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,lW=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,lz=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;class lV{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=oN(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class lG{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=oN(this.outputShape.length);let t=e.length,n=lT("rc",t),r=(0,oE.kW)(t),a=function(e,t){if(1===e)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),i=n.slice(-2),s=t<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${a});

        setOutput(getChannel(packedInput, ${s}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let lj=v.GDt.ZA,lH={},lK=(0,v.OBj)().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");class lX extends v.Zuw{constructor(e){let t;if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!(0,v.OBj)().getBool("HAS_WEBGL"))throw Error("WebGL is not supported on this device");if(null!=e){if(e instanceof oV)t=e;else{let n=on((0,v.OBj)().getNumber("WEBGL_VERSION"),e);t=new oV(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{var r;let a=on((0,v.OBj)().getNumber("WEBGL_VERSION"));t=new oV(a),this.binaryCache=((r=(0,v.OBj)().getNumber("WEBGL_VERSION"))in lH||(lH[r]={}),lH[r]),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new lA(this.gpgpu),this.numMBBeforeWarning=null==(0,v.OBj)().global.screen?1024:(0,v.OBj)().global.screen.height*(0,v.OBj)().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new v.JLz(this,(0,v.SRH)())}nextDataId(){return lX.nextDataId++}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}write(e,t,n){if(((0,v.OBj)().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||(0,v.OBj)().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");let r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:g.UPLOAD,refCount:1}),r}refCount(e){if(this.texData.has(e)){let t=this.texData.get(e);return t.refCount}return 0}incRef(e){let t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){let t=this.texData.get(e);t.refCount--}}move(e,t,n,r,a){if((0,v.OBj)().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:g.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){let t,n;let r=this.texData.get(e),{values:a,dtype:i,complexTensorInfos:s,slice:o,shape:l,isPacked:u}=r;if(null!=o){let h;h=u?new lV(l,lL):new l_(l,lL);let c=this.runWebGLProgram(h,[{dataId:e,shape:l,dtype:i}],i),d=this.readSync(c.dataId);return this.disposeIntermediateTensorInfo(c),d}if(null!=a)return this.convertAndCacheOnCPU(e);if("string"===i)return a;let p=null!=this.activeTimers;if(p&&(t=v.D5U.now()),"complex64"===i){let f=this.readSync(s.real.dataId),m=this.readSync(s.imag.dataId);n=v.Wap.mergeRealAndImagArrays(f,m)}else n=this.getValuesFromTexture(e);return p&&(this.downloadWaitMs+=v.D5U.now()-t),this.convertAndCacheOnCPU(e,n)}async read(e){let t,n;if(this.pendingRead.has(e)){let r=this.pendingRead.get(e);return new Promise(e=>r.push(e))}let a=this.texData.get(e),{values:i,shape:s,slice:o,dtype:l,complexTensorInfos:u,isPacked:h}=a;if(null!=o){let c;c=h?new lV(s,lL):new l_(s,lL);let d=this.runWebGLProgram(c,[{dataId:e,shape:s,dtype:l}],l),p=this.read(d.dataId);return this.disposeIntermediateTensorInfo(d),p}if(null!=i)return this.convertAndCacheOnCPU(e);if((0,v.OBj)().getBool("DEBUG")&&!(0,v.OBj)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===(0,v.OBj)().getNumber("WEBGL_VERSION"))throw Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let f=null;if("complex64"!==l&&(0,v.OBj)().get("WEBGL_BUFFER_SUPPORTED")){t=this.decode(e);let m=this.texData.get(t.dataId);f=this.gpgpu.createBufferFromTexture(m.texture.texture,...or(s))}if(this.pendingRead.set(e,[]),"complex64"!==l&&await this.gpgpu.createAndWaitForFence(),"complex64"===l){let g=await Promise.all([this.read(u.real.dataId),this.read(u.imag.dataId)]),y=g[0],b=g[1];n=v.Wap.mergeRealAndImagArrays(y,b)}else if(null==f)n=this.getValuesFromTexture(e);else{let x=v.D5U.sizeFromShape(s);n=this.gpgpu.downloadFloat32MatrixFromBuffer(f,x)}if(null!=t&&this.disposeIntermediateTensorInfo(t),null!=f){let w=this.gpgpu.gl;os(w,()=>w.deleteBuffer(f))}let I=this.convertAndCacheOnCPU(e,n),k=this.pendingRead.get(e);return this.pendingRead.delete(e),k.forEach(e=>e(I)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&(0,v.SRH)().removeDataId(e,this),this.pendingDeletes--),I}readToGPU(e,t={}){let n=this.texData.get(e),{values:r,shape:a,slice:i,dtype:s,isPacked:o,texture:l}=n;if("complex64"===s)throw Error("Does not support reading texture for complex64 dtype.");if(null!=i){let u;u=o?new lV(a,lL):new l_(a,lL);let h=this.runWebGLProgram(u,[{dataId:e,shape:a,dtype:s}],s),c=this.readToGPU(h,t);return this.disposeIntermediateTensorInfo(h),c}if(null==l){if(null!=r)throw Error("Data is not on GPU but on CPU.");throw Error("There is no data on GPU or CPU.")}let d=this.decode(e,t.customTexShape),p=(0,v.SRH)().makeTensorFromTensorInfo(d),f=this.texData.get(d.dataId);return Object.assign({tensorRef:p},f.texture)}bufferSync(e){let t=this.readSync(e.dataId);if("string"===e.dtype)try{let n=t.map(e=>v.D5U.decodeString(e));return(0,v.f3b)(e.shape,e.dtype,n)}catch(r){throw Error("Failed to decode encoded string bytes into utf-8")}return(0,v.f3b)(e.shape,e.dtype,t)}checkNumericalProblems(e){if(null!=e)for(let t=0;t<e.length;t++){let n=e[t];if(!((0,v.OBj)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===n||596e-10<Math.abs(n)&&65504>Math.abs(n))){if((0,v.OBj)().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error(`The value ${n} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`);throw Error(`The value ${n} cannot be represented on this device.`)}}}getValuesFromTexture(e){let{shape:t,dtype:n,isPacked:r}=this.texData.get(e),a=v.D5U.sizeFromShape(t);if((0,v.OBj)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){let i=this.decode(e),s=this.texData.get(i.dataId),o=this.gpgpu.downloadMatrixFromPackedTexture(s.texture.texture,...or(t)).subarray(0,a);return this.disposeIntermediateTensorInfo(i),o}let l=(0,v.OBj)().getBool("WEBGL_PACK")&&!0===r,u=l?ob(t):t,h=l?new o_(u):new oR(u),c=this.runWebGLProgram(h,[{shape:u,dtype:n,dataId:e}],"float32"),d=this.texData.get(c.dataId),p=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(d.texture.texture,d.texShape[0],d.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(c),p}timerAvailable(){return(0,v.OBj)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){let t=this.activeTimers,n=[],r=!1;null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e();let a=v.D5U.flatten(this.activeTimers.map(e=>e.query)).filter(e=>null!=e),i=v.D5U.flatten(this.activeTimers.map(e=>e.name)).filter(e=>null!=e);this.activeTimers=t,r&&(this.programTimersStack=null);let s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if((0,v.OBj)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){let e=await Promise.all(a);s.kernelMs=v.D5U.sum(e),s.getExtraProfileInfo=()=>e.map((e,t)=>({name:i[t],ms:e})).map(e=>`${e.name}: ${e.ms}`).join(", ")}else s.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,s})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return(0,v.OBj)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:v.D5U.now(),endMs:null}}endTimer(e){return(0,v.OBj)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=v.D5U.now(),e)}async getQueryTime(e){return(0,v.OBj)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.waitForQueryAndGetTime(e):e.endMs-e.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);let{complexTensorInfos:n}=this.texData.get(e);return null!=n&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){let{texture:t,dtype:n,texShape:r,usage:a,isPacked:i,slice:s}=this.texData.get(e),o=s&&s.origDataId||e,l=this.dataRefCount.get(o);l>1?this.dataRefCount.set(o,l-1):(this.dataRefCount.delete(o),null!=t&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(t,r,a,i)));let u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=lK){return(0,v.OBj)().getBool("WEBGL_CPU_FORWARD")&&e.every(e=>null==this.texData.get(e.dataId).texture&&v.D5U.sizeFromShape(e.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){v.Wap.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");let t=e.dataSync();return lj(e.shape,t)}packedUnaryOp(e,t,n){let r=new lV(e.shape,t),a=this.compileAndRun(r,[e],n);return(0,v.SRH)().makeTensorFromTensorInfo(a)}abs(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){let t=lc(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if((0,v.OBj)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,lM,e.dtype);let n=new l_(e.shape,lM),r=this.compileAndRun(n,[e]);return(0,v.SRH)().makeTensorFromTensorInfo(r)}makeTensorInfo(e,t,n){let r;if("string"===t&&null!=n&&n.length>0&&v.D5U.isString(n[0])){let a=n.map(e=>v.D5U.encodeString(e));r=this.write(a,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}makeOutput(e,t,n){return(0,v.SRH)().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){let t=new lG(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){let t=new l$(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){let n=[og(e.shape),...oy(e.shape)],r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[og(t),...oy(t)],i=new lN(a,n),s=this.runWebGLProgram(i,[r],e.dtype,[n],!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}decode(e,t){let n;let r=this.texData.get(e),{isPacked:a,shape:i,dtype:s}=r;if(null!=t){let o=v.D5U.sizeFromShape(i),l=t[0]*t[1]*4;v.D5U.assert(o<=l,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}let u=ob(i);n=a?new oF(u):new oD(u);let h=[null!=t?t:or(u)],c=this.runWebGLProgram(n,[{shape:u,dtype:s,dataId:e}],s,h,!0,t);return{dtype:s,shape:i,dataId:c.dataId}}runWebGLProgram(e,t,n,r,a=!1,i){let s;let o=this.makeTensorInfo(e.outputShape,n),l=this.texData.get(o.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===m.DENSE){let u=null!=i?i:or(e.outputShape);l.texShape=u.map(e=>2*e)}if(null!=e.outTexUsage&&(l.usage=e.outTexUsage),0===v.D5U.sizeFromShape(o.shape))return l.values=v.D5U.getTypedArrayFromDType(o.dtype,0),o;let h=[],c=t.map(t=>{if("complex64"===t.dtype)throw Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&v.D5U.sizeFromShape(t.shape)<=(0,v.OBj)().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(this.uploadToGPU(t.dataId),!!n.isPacked!=!!e.packedInputs)t=n.isPacked?this.unpackTensor(t):this.packTensor(t),h.push(t),n=this.texData.get(t.dataId);else if(n.isPacked&&!ox(n.shape,t.shape)){let r=t,a=t.shape;t.shape=n.shape,t=this.packedReshape(t,a),h.push(t),n=this.texData.get(t.dataId),r.shape=a}return{shape:t.shape,texData:n,isUniform:!1}});this.uploadToGPU(o.dataId);let d={shape:o.shape,texData:l,isUniform:!1},p=function(e,t,n){let r="";t.concat(n).forEach(t=>{let a=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){let i=t.texData.texShape,{useSqueezeShape:s,uniformShape:o,keptDims:l}=oE.Tt(e.packedInputs,t.shape,i),u="",h="",c="";if(1===o.length&&e.packedInputs){let d=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];u=`${d[0]>1}_${d[1]>1}`}else if(2!==o.length||e.packedInputs){if(o.length>2&&!e.packedInputs){let p=v.D5U.computeStrides(o);c=`${p[0]===i[1]}_${p[p.length-1]===i[1]}`}}else h=`${o[0]>1}_${o[1]>1}`;let f=t.shape.length,m=2===o.length&&v.D5U.arraysEqual(t.shape,i),g=1===v.D5U.sizeFromShape(t.shape),y=v.Wap.getBroadcastDims(t.shape,n.shape),b=!e.packedInputs&&f===n.shape.length&&v.D5U.arraysEqual(i,n.texData.texShape),x=e.packedInputs||o.length>2?"":`${i[0]>1}_${i[1]>1}`;r+=`${f}_${b}_${s?l:""}_${o.length}_${g}_${y}_${m}_${u}_${h}_${c}_${x}_${a}`}else{let w=t.isUniform?"uniform":t.texData.texShape;r+=`${t.shape}_${w}_${a}`}});let a=e.userCode;return e.constructor.name+("_"+r+"_"+a)+`${(0,v.OBj)().getNumber("WEBGL_VERSION")}`}(e,c,d),f=this.getAndSaveBinary(p,()=>/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ (function(e,t,n,r){let a=n.map((e,n)=>{let r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}}),i=a.map(e=>e.shapeInfo),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},o=oE.Vm(a,s,t),l=function(e,t){let n=om(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(os(e,()=>e.shaderSource(n,t)),os(e,()=>e.compileShader(n)),(0,v.OBj)().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw ou(t,e.getShaderInfoLog(n)),Error("Failed to compile fragment shader.");return n}(e.gl,o),u=e.createProgram(l);return(0,v.OBj)().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:i,outShapeInfo:s,uniformLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,inShapesLocations:null,inTexShapesLocations:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:t,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:i,outShapeInfo:s},oT(e,t,u))})(this.gpgpu,e,c,d)),g=null!=this.activeTimers;g&&(s=this.startTimer()),(0,v.OBj)().get("ENGINE_COMPILE_ONLY")||function(e,t,n,r,a){t.program.enableShapeUniforms||(o$(t.inShapeInfos,n),o$([t.outShapeInfo],[r]));let i=r.texData.texture,s=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i.texture,s[0],s[1]):e.setOutputMatrixTexture(i.texture,s[0],s[1]),e.setProgram(t.webGLProgram),1===(0,v.OBj)().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach((n,r)=>{let a=t.program.variableNames[r],i=t.uniformLocations[a],s=t.uniformLocations[`offset${a}`],o=t.inShapesLocations[`${a}Shape`],l=t.inTexShapesLocations[`${a}TexShape`];if(o){let{uniformShape:u}=oE.Tt(t.program.packedInputs,n.shape,n.texData.texShape);switch(u.length){case 1:e.gl.uniform1iv(o,new Int32Array(u));break;case 2:e.gl.uniform2iv(o,new Int32Array(u));break;case 3:e.gl.uniform3iv(o,new Int32Array(u));break;case 4:e.gl.uniform4iv(o,new Int32Array(u))}}if(l&&e.gl.uniform2i(l,n.texData.texShape[0],n.texData.texShape[1]),null!=i){if(n.isUniform){if(2>v.D5U.sizeFromShape(n.shape))e.gl.uniform1f(i,n.uniformValues[0]);else{let h=n.uniformValues;h instanceof Float32Array||(h=new Float32Array(h)),e.gl.uniform1fv(i,h)}return}null!=n.texData.slice&&null!=s&&e.gl.uniform1i(s,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture.texture,i,r)}});let o=t.outShapeLocation;if(o)switch(r.shape.length){case 1:e.gl.uniform1iv(o,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(o,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(o,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(o,new Int32Array(r.shape))}if(t.outShapeStridesLocation){let l=v.D5U.computeStrides(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(l));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(l));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(l))}}t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&a&&t.program.customUniforms.forEach((n,r)=>{let i=t.customUniformLocations[r],s=a[r];if("float"===n.type)e.gl.uniform1fv(i,s);else if("vec2"===n.type)e.gl.uniform2fv(i,s);else if("vec3"===n.type)e.gl.uniform3fv(i,s);else if("vec4"===n.type)e.gl.uniform4fv(i,s);else if("int"===n.type)e.gl.uniform1iv(i,s);else if("ivec2"===n.type)e.gl.uniform2iv(i,s);else if("ivec3"===n.type)e.gl.uniform3iv(i,s);else if("ivec4"===n.type)e.gl.uniform4iv(i,s);else throw Error(`uniform type ${n.type} is not supported yet.`)}),e.executeProgram()}(this.gpgpu,f,c,d,r),h.forEach(e=>this.disposeIntermediateTensorInfo(e)),g&&(s=this.endTimer(s),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(s)}));let y=(0,v.OBj)().get("WEBGL_FLUSH_THRESHOLD");if(y>0){let b=v.D5U.now();b-this.lastGlFlushTime>y&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=b)}if(!(0,v.OBj)().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&!1===a){let x=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),x}return o}compileAndRun(e,t,n,r,a=!1){n=n||t[0].dtype;let i=this.runWebGLProgram(e,t,n,r,a);return i}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){if(!this.disposed){if(!(0,v.OBj)().getBool("IS_TEST")){let e=Object.keys(this.binaryCache);e.forEach(e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]})}this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=(0,v.lub)(()=>{if(!(0,v.OBj)().get("WEBGL_RENDER_FLOAT32_ENABLED")){let e=(0,v.OBj)().getBool("DEBUG");(0,v.OBj)().set("DEBUG",!1);let t=this.abs((0,v.iD$)(1e-8)).dataSync()[0];if((0,v.OBj)().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(e){let t;let n=this.texData.get(e),{shape:r,dtype:a,values:i,texture:s,usage:o,isPacked:l}=n;if(null!=s)return;let u=null!=this.activeTimers;u&&(t=v.D5U.now());let h=n.texShape;if(null==h&&(h=function(e,t=!1){let n=(0,v.OBj)().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=(0,v.OBj)().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(r===1/0&&(0,v.OBj)().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n*=2,r*=2,1===(e=e.map((t,n)=>n>=e.length-2?v.D5U.nearestLargerEven(e[n]):e[n])).length&&(e=[2,e[0]])),2!==e.length){let a=v.D5U.squeezeShape(e);e=a.newShape}let i=v.D5U.sizeFromShape(e),s=null;e.length<=1&&i<=n?s=[1,i]:2===e.length&&e[0]<=n&&e[1]<=n?s=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?s=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?s=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?s=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(s=[e[0],e[1]*e[2]*e[3]]);let o=null!=s&&Math.max(...s)>r&&Math.min(...s)<=(t?2:1)&&Math.min(...s)>0;if(null==s||o){if(t){let l=og(e),u=2,h=2;e.length&&([u,h]=oy(e)),i=l*(u/2)*(h/2),s=v.D5U.sizeToSquarishShape(i).map(e=>2*e)}else s=v.D5U.sizeToSquarishShape(i)}return s}(r,l),n.texShape=h),null!=i){let c;let d=ob(r),p=h[1],f=h[0],m=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!m)&&([p,f]=oa(h[0],h[1])),c=l?new oM(d,m):new oO(d,m);let y=m?[f,p]:h,b=this.makeTensorInfo(y,a),x=this.texData.get(b.dataId);m?x.usage=g.PIXELS:x.usage=g.UPLOAD,x.texShape=y,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),p,f,i);let w=[[f,p]],I=this.runWebGLProgram(c,[b],a,w,!0),k=this.texData.get(I.dataId);n.texShape=k.texShape,n.isPacked=k.isPacked,n.usage=k.usage,(0,v.OBj)().get("ENGINE_COMPILE_ONLY")?this.disposeData(I.dataId):(n.texture=k.texture,n.values=null,this.texData.delete(I.dataId)),this.disposeIntermediateTensorInfo(b),u&&(this.uploadWaitMs+=v.D5U.now()-t)}else{let S=this.acquireTexture(h,o,a,l);n.texture=S}}convertAndCacheOnCPU(e,t){let n=this.texData.get(e),{dtype:r}=n;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){let n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length);for(let r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw Error(`Unknown dtype ${t}`)}(t,r)),n.values}acquireTexture(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1048576*this.numMBBeforeWarning){let a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${a} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,r)}computeBytes(e,t){return e[0]*e[1]*v.D5U.bytesPerElement(t)}checkCompileCompletion(){for(let[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){let e=[];if(this.gpgpu.parallelCompilationExtension){for(let[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}for(let[,n]of Object.entries(this.binaryCache)){let r=new Promise(e=>{try{this.checkCompletion_(n),e(!0)}catch(t){throw t}});e.push(r)}return Promise.all(e)}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await (0,v.glt)(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw ou(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),Error("Failed to compile fragment shader.");throw Error("Failed to link vertex and fragment shaders.")}return!0}getUniformLocations(){for(let[,e]of Object.entries(this.binaryCache)){let{uniformLocations:t,customUniformLocations:n,infLoc:r,nanLoc:a,inShapesLocations:i,inTexShapesLocations:s,outShapeLocation:o,outShapeStridesLocation:l,outTexShapeLocation:u}=oT(this.gpgpu,e.program,e.webGLProgram);e.uniformLocations=t,e.customUniformLocations=n,e.infLoc=r,e.nanLoc=a,e.inShapesLocations=i,e.inTexShapesLocations=s,e.outShapeLocation=o,e.outShapeStridesLocation=l,e.outTexShapeLocation=u}}}lX.nextDataId=0,v.C2$.isBrowser()&&(0,v.jqO)("webgl",()=>new lX,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let lq=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class lY{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=v.Wap.assertAndGetBroadcastShape(t,n),this.enableShapeUniforms=oN(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let lQ=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class lZ{constructor(e,t,n,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=v.Wap.assertAndGetBroadcastShape(t,n);let a=this.outputShape.length;this.enableShapeUniforms=oN(a);let i="";if(r){if(0===a||1===v.D5U.sizeFromShape(this.outputShape))i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else{let s=(0,oE.kW)(a);if(i=`
          ${s} coords = getOutputCoords();
        `,1===a)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{let o=lT("coords",a);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${o[a-2]} + 1) >= outShape[${a} - 2];
            bool nextColOutOfBounds =
              (${o[a-1]} + 1) >= outShape[${a} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${o[a-2]} + 1) >= ${this.outputShape[a-2]};
            bool nextColOutOfBounds =
              (${o[a-1]} + 1) >= ${this.outputShape[a-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}}}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function lJ(e){let{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}let l0={kernelName:v.iJz,backendName:"webgl",kernelFunc:lJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function l1(e){let{inputs:t,backend:n}=e,{real:r,imag:a}=t,i=n.makeTensorInfo(r.shape,"complex64"),s=n.texData.get(i.dataId),o=lJ({inputs:{x:r},backend:n}),l=lJ({inputs:{x:a},backend:n});return s.complexTensorInfos={real:o,imag:l},i}let l2={kernelName:v.Zz9,backendName:"webgl",kernelFunc:l1},l3="return (a < 0.) ? b * a : a;",l4=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,l6={kernelName:v.J$2,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{alpha:i}=r,s=n.makeTensorInfo([],"float32",v.D5U.createScalarValue(i,"float32")),o=(0,v.OBj)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new lZ(l4,a.shape,s.shape):new lY(l3,a.shape,s.shape),l=n.runWebGLProgram(o,[a,s],"float32");return n.disposeIntermediateTensorInfo(s),l}},l5="return (a < 0.) ? b * a : a;",l7=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,l8={kernelName:v.o0g,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:r,alpha:a}=t,i=(0,v.OBj)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new lZ(l7,r.shape,a.shape):new lY(l5,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],"float32")}},l9="if (isnan(x)) return x;";function ue({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:n,dtype:r}){return({inputs:a,backend:i})=>{let s;let{x:o}=a,l=r||o.dtype;if(i.shouldExecuteOnCPU([o])&&null!=n){let u=i.texData.get(o.dataId),h=n(u.values,l);return i.makeTensorInfo(o.shape,l,h)}let c=(0,v.OBj)().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=t;return s=c?new lV(o.shape,t):new l_(o.shape,e),i.runWebGLProgram(s,[o],l)}}function ut({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:a,dtype:i}){return({inputs:s,backend:o})=>{let l;let{a:u,b:h}=s;if(r&&"complex64"===u.dtype){let c=o.texData.get(u.dataId),d=o.texData.get(h.dataId),[p,f]=[[c.complexTensorInfos.real,d.complexTensorInfos.real],[c.complexTensorInfos.imag,d.complexTensorInfos.imag]].map(t=>{let[n,r]=t,a={dataId:n.dataId,dtype:n.dtype,shape:u.shape},i={dataId:r.dataId,dtype:r.dtype,shape:h.shape},s=new lY(e,u.shape,h.shape);return o.runWebGLProgram(s,[a,i],(0,v.x8V)(n.dtype,r.dtype))}),m=l1({inputs:{real:p,imag:f},backend:o});return o.disposeIntermediateTensorInfo(p),o.disposeIntermediateTensorInfo(f),m}let g=i||(0,v.x8V)(u.dtype,h.dtype);if(("string"===u.dtype||"string"===h.dtype||o.shouldExecuteOnCPU([u,h]))&&null!=a){let y=o.texData.get(u.dataId).values,b=o.texData.get(h.dataId).values,x="string"===u.dtype?v.Wap.fromUint8ToStringArray(y):y,w="string"===u.dtype?v.Wap.fromUint8ToStringArray(b):b,[I,k]=a(u.shape,h.shape,x,w,g),S=o.makeTensorInfo(k,g),C=o.texData.get(S.dataId);return C.values=I,S}let E=(0,v.OBj)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=t;return l=E?new lZ(t,u.shape,h.shape,n):new lY(e,u.shape,h.shape),o.runWebGLProgram(l,[u,h],g)}}function un(e,t=!1){if("linear"===e)return"return x;";if("relu"===e)return t?lW:lB;if("elu"===e)return t?lU:"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===e)return t?lz:lP;if("prelu"===e)return t?l7:l5;if("leakyrelu"===e)return t?l4:l3;if("sigmoid"===e)return"return 1.0 / (1.0 + exp(-1.0 * x));";throw Error(`Activation ${e} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class ur{constructor(e,t,n,r=!1,a=!1,i=!1,s=null,o=!1,l=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=oN(this.outputShape.length);let u=r?e[1]:e[2],h=Math.ceil(u/2),c=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],d=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],p="",f="";s&&(p=o?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:l?`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:`vec4 activation(vec4 x) {
          ${s}
        }`,f="result = activation(result);"),i&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let m="rc.x",g="rc.x";e[0]<t[0]?m=`int(min(float(rc.x), ${e[0]-1}.))`:t[0]<e[0]&&(g=`int(min(float(rc.x), ${t[0]-1}.))`),this.userCode=`
      ${p}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${h}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < ${h}; i++) {
          int batchA = ${m};
          int batchB = ${g};
          vec4 a = getMatrixA(batchA, ${r?"i * 2, rc.y":"rc.y, i * 2"});
          vec4 b = getMatrixB(batchB, ${a?"rc.z, i * 2":"i * 2, rc.z"});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${c[0]} * ${d[0]});
          result += (${c[1]} * ${d[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${i?"result += getBiasAtOutCoords();":""}

        ${f}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let ua={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class ui{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=v.Wap.assertAndGetBroadcastShape(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let us="return a * b;";function uo(e){let t;let{inputs:n,backend:r}=e,{a,b:i}=n,s=v.Wap.upcastType(a.dtype,i.dtype);if("complex64"===a.dtype){let o=r.texData.get(a.dataId),l=r.texData.get(i.dataId),u=new ui(ua.REAL,a.shape,i.shape),h=new ui(ua.IMAG,a.shape,i.shape),c=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:a.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:a.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:i.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:i.shape}],d=r.runWebGLProgram(u,c,"float32"),p=r.runWebGLProgram(h,c,"float32"),f=l1({inputs:{real:d,imag:p},backend:r});return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(p),f}if(r.shouldExecuteOnCPU([a,i])){let m=r.texData.get(a.dataId),g=r.texData.get(i.dataId),[y,b]=lt(a.shape,i.shape,m.values,g.values,s),x=r.makeTensorInfo(b,s),w=r.texData.get(x.dataId);return w.values=y,x}return t=(0,v.OBj)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new lZ(us,a.shape,i.shape):new lY(us,a.shape,i.shape),r.runWebGLProgram(t,[a,i],s)}let ul={kernelName:v.wYn,backendName:"webgl",kernelFunc:uo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function uu(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{shape:i}=r,s=v.D5U.sizeFromShape(a.shape),o=v.D5U.inferFromImplicitShape(i,s),l=v.D5U.sizeFromShape(o);v.D5U.assert(s===l,()=>`The new shape (${o}) has ${l} elements and the old shape (${a.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`);let u=n.texData.get(a.dataId);return!u.isPacked||ox(a.shape,o)||null!==u.texture&&ox(u.shape,o)?(n.incRef(a.dataId),{dataId:a.dataId,shape:o,dtype:a.dtype}):/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n){let r=[og(e.shape),...oy(e.shape)],a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[og(t),...oy(t)],s=new lN(i,r),o=n.runWebGLProgram(s,[a],e.dtype,[r],!0);return{dataId:o.dataId,shape:t,dtype:o.dtype}}(a,o,n)}let uh={kernelName:v.HZH,backendName:"webgl",kernelFunc:uu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class uc{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:r,inSize:a,outSize:i}=e;this.outputShape=[r,i];let s=4*Math.floor(n/4),o=n%4,l="sumValue += dot(values, ones);";if(null!=t){let u=1/t;l=`sumValue += dot(values * ${v.D5U.isInt(u)?u.toPrecision(2):u}, ones);`}let h="";a%n>0&&(h=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${n};

        float sumValue = 0.0;

        for (int i = 0; i < ${s}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${l}
        }

        int inIdx = inOffset + ${s};
        if (${1===o}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${l}
        } else if (${2===o}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${l}
        } else if (${3===o}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${l}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class ud{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:r,inSize:a,outSize:i}=e;this.outputShape=[r,i];let s="0.0",o="";"prod"===t?s="1.0":"min"===t?(s="1.0 / 1e-20",o="min"):"max"===t&&(s="-1.0 / 1e-20",o="max");let l=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"sum"===t?l="sumValue":"prod"===t?l="prodValue":"all"===t?l="allValue":"any"===t&&(l="anyValue");let u=4*Math.floor(n/4),h=n%4,c=`
      if (${"sum"===t}) {
        sumValue += dot(values, ones);
      } else if (${"prod"===t}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${o}(values, minMaxValue);
        if (${"min"===t} || ${"max"===t}) {
          minMaxValue = ${o}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,d="vec4";"all"===t?(s="1.0",c=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,d="bvec4"):"any"===t&&(s="0.0",c=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,d="bvec4");let p="";a%n>0&&(p=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${s};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${n};

        vec4 minMaxValue = vec4(${s});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${u};
        if (${1===h}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${c}
        } else if (${2===h}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${c}
        } else if (${3===h}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${c}
        }
        setOutput(${l});
      }
    `}}function up(e,t,n,r){let a=/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t=[];for(;0===t.length||1!==t[t.length-1].outSize;){let n=t.length?t[t.length-1].outSize:e[1],r=v.Wap.computeOptimalWindowSize(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape),i=e;for(let s=0;s<a.length;s++){let o,l;let{inSize:u,windowSize:h,outSize:c}=a[s];o="mean"===n?0===s?new uc({windowSize:h,inSize:u,batchSize:e.shape[0],outSize:c},u):new uc({windowSize:h,inSize:u,batchSize:e.shape[0],outSize:c}):new ud({windowSize:h,inSize:u,batchSize:e.shape[0],outSize:c},n),l=i,i=r.runWebGLProgram(o,[i],t),l.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(l)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class uf{constructor(e,t){this.variableNames=["A"];let n=Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;let a=(0,oE.kW)(this.rank),i=function(e){let t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=Array(t);for(let a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(t);this.userCode=`
    void main() {
      ${a} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class um{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;let n=Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);let a=(0,oE.kW)(this.rank),i=lE("rc",this.rank),s=Array(this.rank);for(let o=0;o<t.length;o++)s[t[o]]=i[o];let l=`vec2(${s.slice(-2).join()})`,u=`++${i[this.rank-1]} < ${n[this.rank-1]}`,h=`getChannel(getA(${s.join()}), ${l})`;this.userCode=`
    void main() {
      ${a} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${h};
      if(${u}) {
        result[1] = ${h};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${n[this.rank-2]}) {
        result[2] = ${h};
        if(${u}) {
          result[3] = ${h};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function ug(e,t,n){let r=(0,v.OBj)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new um(e.shape,t):new uf(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function uy(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;return(/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r){let a=e.shape.length,i=v.D5U.parseAxisParam(t,e.shape),s=i,o=v.Wap.getAxesPermutation(s,a),l=null!=o,u=e;l&&(u=ug(e,o,r),s=v.Wap.getInnerMostAxes(s.length,a)),v.Wap.assertAxesAreInnerMostDims("sum",s,a);let[h,c]=v.Wap.computeOutAndReduceShapes(u.shape,s),d=h;n&&(d=v.Wap.expandShapeToKeepDim(h,i));let p=v.D5U.sizeFromShape(c),f=v.D5U.sizeFromShape(e.shape),m=uu({inputs:{x:u},attrs:{shape:[f/p,p]},backend:r}),g=(0,v.z4k)(e.dtype),y=up(m,g,"sum",r),b=uu({inputs:{x:y},attrs:{shape:d},backend:r});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(y),l&&r.disposeIntermediateTensorInfo(u),b}(a,i,s,n))}let ub={kernelName:v.GBy,backendName:"webgl",kernelFunc:uy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function ux(e){let t;let{inputs:n,backend:r,attrs:a}=e,{x:i}=n,{perm:s}=a,o=i.shape.length,l=Array(o);for(let u=0;u<l.length;u++)l[u]=i.shape[s[u]];if(r.shouldExecuteOnCPU([i])){let h=r.texData.get(i.dataId),c=h.values,d=lS(c,i.shape,i.dtype,s,l);t=r.makeTensorInfo(l,i.dtype);let p=r.texData.get(t.dataId);p.values=d}else t=ug(i,s,r);return t}let uv={kernelName:v.G3Y,backendName:"webgl",kernelFunc:ux};function uw({a:e,b:t,transposeA:n,transposeB:r,backend:a,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:l=null}){let u;let h=e.shape.length,c=t.shape.length,d=n?e.shape[h-2]:e.shape[h-1],p=r?t.shape[c-1]:t.shape[c-2],f=n?e.shape[h-1]:e.shape[h-2],m=r?t.shape[c-2]:t.shape[c-1],g=e.shape.slice(0,-2),y=t.shape.slice(0,-2),b=v.D5U.sizeFromShape(g),x=v.D5U.sizeFromShape(y),w=v.Jyw.assertAndGetBroadcastShape(e.shape.slice(0,-2),t.shape.slice(0,-2)),I=w.concat([f,m]);v.D5U.assert(d===p,()=>`Error in matMul: inner shapes (${d}) and (${p}) of Tensors with shapes ${e.shape} and ${t.shape} and transposeA=${n} and transposeB=${r} must match.`);let k=n?[b,d,f]:[b,f,d],S=r?[x,m,p]:[x,p,m],C=uu({inputs:{x:e},backend:a,attrs:{shape:k}}),E=uu({inputs:{x:t},backend:a,attrs:{shape:S}}),T=[C,E],$=Math.max(b,x),N=n?C.shape[1]:C.shape[2],A=null!=i,D=null!=s,F="leakyrelu"===l,R=null!=l?un(l,!0):null;if((1===f||1===m)&&N>1e3&&!1===(A||D||F||null!=R)){let _=C,O=E;n&&(_=ux({inputs:{x:C},backend:a,attrs:{perm:[0,2,1]}}),T.push(_)),r&&(O=ux({inputs:{x:E},backend:a,attrs:{perm:[0,2,1]}}),T.push(O));let M=_;1!==m&&(M=uu({inputs:{x:_},backend:a,attrs:{shape:[$,N,1]}}),T.push(M));let B=O;1===m&&(B=uu({inputs:{x:O},backend:a,attrs:{shape:[$,1,N]}}),T.push(B));let P=uo({inputs:{a:M,b:B},backend:a});u=uy({inputs:{x:P},backend:a,attrs:{axis:1===m?2:1,keepDims:!0}}),T.push(P)}else{let L=(0,v.x8V)(e.dtype,t.dtype),U=new ur(k,S,[$,f,m],n,r,A,R,D,F),W=[C,E];if(null!=i&&W.push(i),D&&W.push(s),F){let z=a.makeTensorInfo([],"float32",v.D5U.createScalarValue(o,"float32"));W.push(z),T.push(z)}u=a.runWebGLProgram(U,W,L)}let V=uu({inputs:{x:u},backend:a,attrs:{shape:I}});for(let G of(T.push(u),T))a.disposeIntermediateTensorInfo(G);return V}let uI={kernelName:v.usg,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:i,bias:s,preluActivationWeights:o}=t,{transposeA:l,transposeB:u,activation:h,leakyreluAlpha:c}=r;return uw({a,b:i,transposeA:l,transposeB:u,backend:n,bias:s,preluActivationWeights:o,leakyreluAlpha:c,activation:h})}},uk="return abs(x);",uS={kernelName:v.SYM,backendName:"webgl",kernelFunc:function(e){let t;let{inputs:n,backend:r}=e,{x:a}=n;if(r.shouldExecuteOnCPU([a])&&"complex64"!==a.dtype){let i=r.texData.get(a.dataId),s=lc(i.values);return r.makeTensorInfo(a.shape,a.dtype,s)}return t=(0,v.OBj)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new lV(a.shape,uk):new l_(a.shape,uk),r.runWebGLProgram(t,[a],a.dtype)}},uC=lO+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,uE=ue({opSnippet:uC}),uT={kernelName:v.VGw,backendName:"webgl",kernelFunc:uE},u$=lO+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,uN=ue({opSnippet:u$}),uA={kernelName:v.SpW,backendName:"webgl",kernelFunc:uN},uD="return a + b;",uF=ut({opSnippet:uD,packedOpSnippet:uD,supportsComplex:!0,cpuKernelImpl:oG}),uR={kernelName:v.mm_,backendName:"webgl",kernelFunc:uF};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class u_{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((e,t)=>`T${t}`);let n=[];this.variableNames.forEach(e=>{n.push(`float v${e} = get${e}AtOutCoords();`)});let r=this.variableNames.map(e=>`v${e}`).join(" + ");this.userCode=`
      void main() {
        ${n.join("\n        ")}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class uO{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((e,t)=>`T${t}`);let n=[];this.variableNames.forEach(e=>{n.push(`vec4 v${e} = get${e}AtOutCoords();`)});let r=this.variableNames.map(e=>`v${e}`).join(" + ");this.userCode=`
      void main() {
        ${n.join("\n        ")}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}let uM={kernelName:v.Xze,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function e(t){let{inputs:n,backend:r}=t;if(1===n.length)return lJ({inputs:{x:n[0]},backend:r});if(n.length>(0,v.OBj)().get("WEBGL_MAX_TEXTURES_IN_SHADER")){let a=Math.floor(n.length/2),i=e({inputs:n.slice(0,a),backend:r}),s=e({inputs:n.slice(a),backend:r});return e({inputs:[i,s],backend:r})}let o=n.map(e=>e.dtype).reduce((e,t)=>(0,v.x8V)(e,t)),l=n.map(e=>e.shape),u=(0,v.OBj)().getBool("WEBGL_PACK"),h=u?new uO(n[0].shape,l):new u_(n[0].shape,l);return r.runWebGLProgram(h,n,o)}},uB={kernelName:v.oT6,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t;let{inputs:n,backend:r,attrs:a}=e,{x:i}=n,{axis:s,keepDims:o}=a,l=i.shape.length,u=v.D5U.parseAxisParam(s,i.shape),h=u,c=v.Wap.getAxesPermutation(h,l),d=i;null!=c&&(d=ux({inputs:{x:i},backend:r,attrs:{perm:c}}),h=v.Wap.getInnerMostAxes(h.length,l)),v.Wap.assertAxesAreInnerMostDims("all",h,l);let[p,f]=v.Wap.computeOutAndReduceShapes(d.shape,h),m=v.D5U.sizeFromShape(f),g=uu({inputs:{x:d},backend:r,attrs:{shape:[-1,m]}}),y=up(g,g.dtype,"all",r);if(o){let b=v.Wap.expandShapeToKeepDim(p,u);t=uu({inputs:{x:y},backend:r,attrs:{shape:b}})}else t=uu({inputs:{x:y},backend:r,attrs:{shape:p}});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(y),null!=c&&r.disposeIntermediateTensorInfo(d),t}},uP={kernelName:v.IKK,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t;let{inputs:n,backend:r,attrs:a}=e,{x:i}=n,{axis:s,keepDims:o}=a,l=i.shape.length,u=v.D5U.parseAxisParam(s,i.shape),h=u,c=v.Wap.getAxesPermutation(h,l),d=i;null!=c&&(d=ux({inputs:{x:i},backend:r,attrs:{perm:c}}),h=v.Wap.getInnerMostAxes(h.length,l)),v.Wap.assertAxesAreInnerMostDims("any",h,l);let[p,f]=v.Wap.computeOutAndReduceShapes(d.shape,h),m=v.D5U.sizeFromShape(f),g=uu({inputs:{x:d},backend:r,attrs:{shape:[-1,m]}}),y=up(g,g.dtype,"any",r);if(o){let b=v.Wap.expandShapeToKeepDim(p,u);t=uu({inputs:{x:y},backend:r,attrs:{shape:b}})}else t=uu({inputs:{x:y},backend:r,attrs:{shape:p}});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(y),null!=c&&r.disposeIntermediateTensorInfo(d),t}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class uL{constructor(e,t,n){this.variableNames=["A"];let{windowSize:r,batchSize:a,outSize:i}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[a,i],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));"};
          float candidate = getA(batch, inIdx);
          if (candidate ${"max"===t?">":"<"} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class uU{constructor(e,t,n,r){let a,i;this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,v.D5U.assert(e.length>2,()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`);let s=e[e.length-1],o=Math.ceil(s/t);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");let l=this.outputShape,u=l.length,h=(0,oE.kW)(u),c=lT("coords",u);if(1===o){i=u+1;let d=(0,oE.kW)(i);a=`
        ${d} sourceLocR = ${d}(${c.join()}, 0);
        ++${c[u-1]};
        ${d} sourceLocG = ${d}(${c.join()}, 0);
        ++${c[u-2]};
        ${d} sourceLocA = ${d}(${c.join()}, 0);
        --${c[u-1]};
        ${d} sourceLocB = ${d}(${c.join()}, 0);
        --${c[u-2]};`}else i=u,a=`
        ${h} sourceLocR = coords;
        ++${c[u-1]};
        ${h} sourceLocG = coords;
        ++${c[u-2]};
        ${h} sourceLocA = coords;
        --${c[u-1]};
        ${h} sourceLocB = coords;
        --${c[u-2]};`;let p=["x","y","z","w","u","v"].slice(0,i),f="."+p[i-1],m=p.map(e=>"int "+e),g=lT("sourceLocR",i-1).concat("inIdx.r"),y=lT("sourceLocG",i-1).concat("inIdx.g"),b=lT("sourceLocB",i-1).concat("inIdx.b"),x=lT("sourceLocA",i-1).concat("inIdx.a"),w=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${x.join()})));`,I=`vec4(
            getAChannel(${g.join()}),
            hasNextCol ? getAChannel(${y.join()}) : 0.,
            hasNextRow ? getAChannel(${b.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${x.join()}) : 0.)`,k=r?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${p.join()}),
                                          vec2(${p.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${p.join()}),
                               vec2(${p.slice(-2).join()}));
      }
      ${k}
      void main() {
        ${h} coords = getOutputCoords();
        bool hasNextCol = ${c[u-1]} < ${l[u-1]-1};
        bool hasNextRow = ${c[u-2]} < ${l[u-2]-1};
        ${a}
        ivec4 srcIdx = ivec4(sourceLocR${f}, sourceLocG${f},
          sourceLocB${f}, sourceLocA${f}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${I};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${w}
          vec4 candidate = ${I};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${"max"===n?"greaterThan":"lessThan"}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}function uW(e,t,n,r){let a=[n];if(v.Wap.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,t.shape.length),!(0,v.OBj)().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){let i=[],s=e.texData.get(t.dataId),o=null!==s&&s.isPacked,l=t;o&&i.push(l=e.unpackTensor(t));let[u,h]=v.Wap.computeOutAndReduceShapes(l.shape,a),c=v.D5U.sizeFromShape(h),d=uu({inputs:{x:l},backend:e,attrs:{shape:[-1,c]}});i.push(d);let p=/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function e(t,n,r,a=null){let i=n.shape[0],s=n.shape[1];null!=a&&(i=a.shape[0],s=a.shape[1]);let o=v.Wap.computeOptimalWindowSize(s),l={windowSize:o,inSize:s,batchSize:i,outSize:Math.ceil(s/o)},u=new uL(l,r,null==a),h=[n];null!=a&&h.push(a);let c=t.runWebGLProgram(u,h,"int32");if(1===c.shape[1])return c;let d=e(t,n,r,c);return t.disposeIntermediateTensorInfo(c),d}(e,d,r);i.push(p);let f=uu({inputs:{x:p},backend:e,attrs:{shape:u}});return i.forEach(t=>e.disposeIntermediateTensorInfo(t)),f}return function e(t,n,r,a=null){let i=null!=a?a.shape:n.shape,s=i[i.length-1],o=v.Wap.computeOptimalWindowSize(s),l=new uU(i,o,r,null==a),u=t.runWebGLProgram(l,null==a?[n]:[n,a],"int32");if(u.shape.length===n.shape.length){let h=e(t,n,r,u);return t.disposeIntermediateTensorInfo(u),h}return u}(e,t,r)}let uz={kernelName:v.sJF,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r,s=v.D5U.parseAxisParam(i,a.shape),o=v.Wap.getAxesPermutation(s,a.shape.length),l=a,u=[];null!=o&&(u.push(l=ux({inputs:{x:a},backend:n,attrs:{perm:o}})),s=v.Wap.getInnerMostAxes(s.length,l.shape.length)),v.Wap.assertAxesAreInnerMostDims("argMax",[s[0]],l.shape.length);let h=uW(n,l,s[0],"max");return u.forEach(e=>n.disposeIntermediateTensorInfo(e)),h}},uV={kernelName:v.aJk,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r,s=v.D5U.parseAxisParam(i,a.shape),o=v.Wap.getAxesPermutation(s,a.shape.length),l=a,u=[];null!=o&&(u.push(l=ux({inputs:{x:a},backend:n,attrs:{perm:o}})),s=v.Wap.getInnerMostAxes(s.length,l.shape.length)),v.Wap.assertAxesAreInnerMostDims("argMin",[s[0]],l.shape.length);let h=uW(n,l,s[0],"min");return u.forEach(e=>n.disposeIntermediateTensorInfo(e)),h}},uG=lO+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,uj=ue({opSnippet:uG}),uH={kernelName:v.M2y,backendName:"webgl",kernelFunc:uj},uK=ue({opSnippet:lO+"return log(x + sqrt(x * x + 1.0));"}),uX={kernelName:v.qw7,backendName:"webgl",kernelFunc:uK},uq=lO+`
  return atan(x);
`,uY=ue({opSnippet:uq}),uQ={kernelName:v.jMg,backendName:"webgl",kernelFunc:uY},uZ=lq+`
  return atan(a, b);
`,uJ=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+lQ+`
  return result;
`,u0=ut({opSnippet:uZ,packedOpSnippet:uJ}),u1={kernelName:v.QCc,backendName:"webgl",kernelFunc:u0},u2=lO+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,u3=ue({opSnippet:u2}),u4={kernelName:v.Oyi,backendName:"webgl",kernelFunc:u3};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class u6{constructor(e,t,n,r=!1,a=!1){if(this.variableNames=["x"],"avg"===t&&n)throw Error("Cannot compute positions for average pool.");let i=e.filterWidth,s=e.strideHeight,o=e.strideWidth,l=e.dilationHeight,u=e.dilationWidth,h=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;let f="avg"===t,m=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,g=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`,y="0.0";if(f||(y="-1.0 / 1e-20"),n){this.userCode=`
        const ivec2 strides = ivec2(${s}, ${o});
        const ivec2 pads = ivec2(${d}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${h};
              wR += ${l}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${c};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?a?m:g:`wR * ${c} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let b=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===t&&(b="avgValue / count");let x=4*Math.floor(i/4),v=i%4,w=`
      if (${f}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${s}, ${o});
      const ivec2 pads = ivec2(${d}, ${p});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${h};
            wR += ${l}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${x}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${w}
          }

          int xC = xCCorner + ${x};
          if (${1===v}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${w}
          } else if (${2===v}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${w}
          } else if (${3===v}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${w}
          }
        }
        setOutput(${b});
      }
    `}}class u5{constructor(e,t,n,r=!1,a=!1){if(this.variableNames=["x"],"avg"===t&&n)throw Error("Cannot compute positions for average pool.");let i=e.filterWidth,s=e.strideDepth,o=e.strideHeight,l=e.strideWidth,u=e.dilationDepth,h=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,p=e.effectiveFilterHeight,f=e.effectiveFilterWidth,m=e.padInfo.front,g=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;let b="avg"===t,x="0.0";if(b||(x="-1.0 / 1e-20"),n){this.userCode=`
        const ivec3 strides =
            ivec3(${s}, ${o}, ${l});
        const ivec3 pads = ivec3(${m}, ${g}, ${y});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${d};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${h}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${f};
                  wC += ${c}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?a?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${f} +
                      wR * ${f} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let v=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===t&&(v="avgValue / count");let w=4*Math.floor(i/4),I=i%4,k=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${s}, ${o}, ${l});
      const ivec3 pads = ivec3(${m}, ${g}, ${y});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${h}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${w}; wC += 4) {
              int xC = xCCorner + wC * ${c};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${c}, ch),
                getValue(batch, xD, xR, xC + 2 * ${c}, ch),
                getValue(batch, xD, xR, xC + 3 * ${c}, ch)
              );

              ${k}
            }

            int xC = xCCorner + ${w};
            if (${1===I}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${k}
            } else if (${2===I}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${c}, ch),
                initializationValue,
                initializationValue
              );

              ${k}
            } else if (${3===I}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${c}, ch),
                getValue(batch, xD, xR, xC + 2 * ${c}, ch),
                initializationValue
              );

              ${k}
            }
          }
          setOutput(${v});
        }
      }
    `}}let u7={kernelName:v.JhU,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;ok(a,"avgPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=r;v.D5U.assert(v.Wap.eitherStridesOrDilationsAreOne(s,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '1'`);let u=v.Wap.computePool2DInfo(a.shape,i,s,1,o,l);if(1===u.filterWidth&&1===u.filterHeight&&v.D5U.arraysEqual(u.inShape,u.outShape))return lJ({inputs:{x:a},backend:n});let h=new u6(u,"avg",!1);return n.runWebGLProgram(h,[a],"float32")}},u8={kernelName:v._k9,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:u}=r,h=v.Wap.computePool3DInfo(a.shape,i,s,[1,1,1],o,l,u),c=new u5(h,"avg",!1);return n.runWebGLProgram(c,[a],"float32")}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class u9{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=e.dilationHeight,s=e.dilationWidth,o=e.effectiveFilterHeight,l=e.effectiveFilterWidth,u=o-1-e.padInfo.top,h=l-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${u}, ${h});
      const float avgMultiplier = float(${1/(t*n)});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${l};
            wC+= ${s}) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class he{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,h=e.effectiveFilterDepth,c=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=h-1-e.padInfo.front,f=c-1-e.padInfo.top,m=d-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${p}, ${f}, ${m});
      const float avgMultiplier = float(${1/(t*n*r)});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${a}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${l}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${d};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}let ht={kernelName:v.IMb,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=r,h=v.Wap.computePool3DInfo(i.shape,s,o,[1,1,1],l,u),c=new he(h);return n.runWebGLProgram(c,[a],i.dtype)}},hn={kernelName:v.ROF,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t;ok([a,i],"avgPoolGrad");let{filterSize:s,strides:o,pad:l}=r,u=v.Wap.computePool2DInfo(i.shape,s,o,1,l),h=new u9(u);return n.runWebGLProgram(h,[a],i.dtype)}},hr={kernelName:v.XLW,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:i}=t,{transposeA:s,transposeB:o}=r;return uw({a,b:i,transposeA:s,transposeB:o,backend:n})}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class ha{constructor(e,t,n,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],v.Wap.assertAndGetBroadcastShape(e,t),v.Wap.assertAndGetBroadcastShape(e,n);let s="0.0";null!=r&&(v.Wap.assertAndGetBroadcastShape(e,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let o="1.0";null!=a&&(v.Wap.assertAndGetBroadcastShape(e,a),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${s};
        float scale = ${o};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class hi{constructor(e,t,n,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],v.Wap.assertAndGetBroadcastShape(e,t),v.Wap.assertAndGetBroadcastShape(e,n);let s="vec4(0.0)";null!=r&&(v.Wap.assertAndGetBroadcastShape(e,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let o="vec4(1.0)";null!=a&&(v.Wap.assertAndGetBroadcastShape(e,a),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${s};
        vec4 scale = ${o};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let hs=({inputs:e,backend:t,attrs:n})=>{let{x:r,mean:a,variance:i,offset:s,scale:o}=e;v.D5U.assert(a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),v.D5U.assert(null==s||a.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),v.D5U.assert(null==o||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;null==l&&(l=.001);let u=[r,a,i],h=null;null!=s&&(h=s.shape,u.push(s));let c=null;null!=o&&(c=o.shape,u.push(o));let d=(0,v.OBj)().getBool("WEBGL_PACK_NORMALIZATION")?new hi(r.shape,a.shape,i.shape,h,c,l):new ha(r.shape,a.shape,i.shape,h,c,l),p=t.runWebGLProgram(d,u,u[0].dtype);return p},ho={kernelName:v.sHE,backendName:"webgl",kernelFunc:hs};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class hl{constructor(e){let t;this.variableNames=["source"],this.outputShape=e,this.rank=e.length;let n=(0,oE.kW)(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let r=function(e){if(1===e)return"sourceLoc";if(e<=6)return hu.slice(0,e).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}(this.rank),a=e.map((e,t)=>`sourceLoc.${hu[t]} = start[${t}] + coords.${hu[t]};`);t=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${a.join("\n")}
      `,this.userCode=`
      void main() {
        ${t}
        setOutput(getSource(${r}));
      }
    `}}let hu=["x","y","z","w","u","v"];/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class hh{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let t=(0,oE.kW)(this.rank),n=lT("coords",this.rank),r=lT("sourceLoc",this.rank),a=1===this.rank?"sourceLoc":`vec2(${r.slice(-2).join()})`,i=`getChannel(getSource(${r.join()}), ${a})`,s=`
      result.x = ${i};
      if (++${n[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${i};
        --${r[this.rank-1]};
      }
    `,o=1===this.rank?"":`
      --${n[this.rank-1]};
      if (++${n[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${i};
        if (++${n[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${i};
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((e,t)=>`start[${t}]`).join()});`:e.map((e,t)=>`${r[t]} = ${n[t]} + start[${t}];`).join("\n");this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${l}
        vec4 result = vec4(0.);
        ${s}
        ${o}
        setOutput(result);
      }
    `}}function hc(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,size:s}=r,[o,l]=v.kuN.parseSliceParams(a,i,s);if(v.kuN.assertParamsValid(a,o,l),0===v.D5U.sizeFromShape(l))return n.makeTensorInfo(l,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){let u=n.texData.get(a.dataId),h=ld(u.values,o,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,h)}let{isPacked:c}=n.texData.get(a.dataId),d=v.kuN.isSliceContinous(a.shape,o,l);if(c||!d){let p=(0,v.OBj)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new hh(l):new hl(l);return n.runWebGLProgram(p,[a],a.dtype,[o])}return n.uploadToGPU(a.dataId),/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r){let a=r.texData.get(e.dataId),i=r.makeTensorInfo(n,e.dtype),s=r.texData.get(i.dataId);Object.assign(s,a),s.refCount=1,s.shape=n,s.dtype=e.dtype;let o=v.kuN.computeFlatOffset(t,v.D5U.computeStrides(e.shape));a.slice&&(o+=a.slice.flatOffset),s.slice={flatOffset:o,origDataId:a.slice&&a.slice.origDataId||e.dataId};let l=r.dataRefCount.get(s.slice.origDataId)||1;return r.dataRefCount.set(s.slice.origDataId,l+1),i}(a,o,l,n)}let hd={kernelName:v.p2w,backendName:"webgl",kernelFunc:hc},hp=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,crops:s}=r;v.D5U.assert(a.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");let o=i.reduce((e,t)=>e*t),l=v.Wap.getReshaped(a.shape,i,o),u=v.Wap.getPermuted(l.length,i.length),h=v.Wap.getReshapedPermuted(a.shape,i,o),c=v.Wap.getSliceBeginCoords(s,i.length),d=v.Wap.getSliceSize(h,s,i.length),p=[],f=uu({inputs:{x:a},backend:n,attrs:{shape:l}}),m=ux({inputs:{x:f},backend:n,attrs:{perm:u}}),g=uu({inputs:{x:m},backend:n,attrs:{shape:h}}),y=hc({inputs:{x:g},backend:n,attrs:{begin:c,size:d}});return p.push(f),p.push(m),p.push(g),p.forEach(e=>n.disposeIntermediateTensorInfo(e)),y},hf={kernelName:v.zws,backendName:"webgl",kernelFunc:hp},hm={kernelName:v.zvY,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:s}=r,o=n.readSync(a.dataId),l=n.readSync(i.dataId),u=oj(o,l,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,u)}},hg={kernelName:v.eEB,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{s0:r,s1:a}=t,i=n.readSync(r.dataId),s=n.readSync(a.dataId),o=v.Wap.assertAndGetBroadcastShape(Array.from(i),Array.from(s));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}},hy=ut({opSnippet:"return float(a != b);",cpuKernelImpl:lr,dtype:"bool"}),hb={kernelName:v.yQU,backendName:"webgl",kernelFunc:hy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function hx(e){let{inputs:t,backend:n}=e,{input:r}=t,a=n.texData.get(r.dataId);return lJ({inputs:{x:a.complexTensorInfos.real},backend:n})}let hv={kernelName:v.xJR,backendName:"webgl",kernelFunc:hx},hw={kernelName:v.RFZ,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function e(t){let{inputs:n,backend:r,attrs:a}=t,{x:i}=n,{dtype:s}=a;if("complex64"===s){if("complex64"===i.dtype)return lJ({inputs:{x:i},backend:r});let o=v.lls(i.shape),l=e({inputs:{x:i},backend:r,attrs:{dtype:"float32"}}),u=l1({inputs:{real:l,imag:o},backend:r});return o.dispose(),r.disposeIntermediateTensorInfo(l),u}if("complex64"===i.dtype){let h=hx({inputs:{input:i},backend:r}),c=e({inputs:{x:h},backend:r,attrs:{dtype:s}});return r.disposeIntermediateTensorInfo(h),c}if(!v.D5U.hasEncodingLoss(i.dtype,s)){let d=lJ({inputs:{x:i},backend:r});return{dataId:d.dataId,shape:d.shape,dtype:s}}if(r.shouldExecuteOnCPU([i])){let p=r.texData.get(i.dataId).values,[f,m,g]=oK(p,i.shape,i.dtype,s);return r.makeTensorInfo(f,m,g)}if("int32"===s)return function(e,t){let n=new l_(e.shape,"return float(int(x));"),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(i,r);if("bool"===s){let y=r.makeTensorInfo([],"bool",v.D5U.getTypedArrayFromDType("bool",1)),b=hy({inputs:{a:i,b:y},backend:r});return r.disposeIntermediateTensorInfo(y),b}throw Error(`Error in Cast: failed to cast ${i.dtype} to ${s}`)}},hI="return ceil(x);",hk=ue({opSnippet:hI,packedOpSnippet:hI,cpuKernelImpl:oX}),hS={kernelName:v.gJX,backendName:"webgl",kernelFunc:hk};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class hC{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class hE{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}let hT={kernelName:v.xnO,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t;let{inputs:n,backend:r,attrs:a}=e,{x:i}=n,{clipValueMin:s,clipValueMax:o}=a;return t=(0,v.OBj)().getBool("WEBGL_PACK_CLIP")?new hE(i.shape):new hC(i.shape),r.runWebGLProgram(t,[i],i.dtype,[[s],[o]])}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class h${constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function hN(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}let hA={kernelName:v.yj2,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:r}=t,a=n.texData.get(r.dataId),i=new h$(r.shape),s=[hN(r,a.complexTensorInfos.real),hN(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,s,s[0].dtype)}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class hD{constructor(e){this.outputShape=[],this.outputShape=v.Wap.computeOutShape(e,1),this.variableNames=e.map((e,t)=>`T${t}`);let t=Array(e.length-1);t[0]=e[0][1];for(let n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];let r=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let a=1;a<t.length;a++){let i=t[a-1];r.push(`else if (yC < ${t[a]}) setOutput(getT${a}(yR, yC-${i}));`)}let s=t.length,o=t[t.length-1];r.push(`else setOutput(getT${s}(yR, yC-${o}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join("\n        ")}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class hF{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=v.Wap.computeOutShape(e,t);let n=this.outputShape,r=n.length,a=(0,oE.kW)(r),i=lT("coords",r),s=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((e,t)=>`T${t}`);let o=Array(e.length-1);o[0]=e[0][t];for(let l=1;l<o.length;l++)o[l]=o[l-1]+e[l][t];let u=s[t],h=s.slice(-2),c=s.join(),d=`if (${u} < ${o[0]}) {
        return getChannel(
            getT0(${c}), vec2(${h.join()}));
        }`;for(let p=1;p<o.length;p++){let f=o[p-1];d+=`
        if (${u} < ${o[p]}  && ${u} >= ${o[p-1]}) {
          return getChannel(
            getT${p}(${hR(s,u,f)}),
            vec2(${hR(h,u,f)}));
        }`}let m=o.length,g=o[o.length-1];d+=`
        return getChannel(
          getT${m}(${hR(s,u,g)}),
          vec2(${hR(h,u,g)}));`,this.userCode=`
      float getValue(${s.map(e=>"int "+e)}) {
        ${d}
      }

      void main() {
        ${a} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[r-1]} = ${i[r-1]} + 1;
        if (${i[r-1]} < ${n[r-1]}) {
          result.g = getValue(${i});
        }

        ${i[r-2]} = ${i[r-2]} + 1;
        if (${i[r-2]} < ${n[r-2]}) {
          result.a = getValue(${i});
        }

        ${i[r-1]} = ${i[r-1]} - 1;
        if (${i[r-2]} < ${n[r-2]} &&
            ${i[r-1]} < ${n[r-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function hR(e,t,n){let r=e.indexOf(t),a=e.map((e,t)=>t===r?`${e} - ${n}`:e);return a.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function h_(e){let{inputs:t,backend:n}=e,{input:r}=t,a=n.texData.get(r.dataId);return lJ({inputs:{x:a.complexTensorInfos.imag},backend:n})}let hO={kernelName:v.J_u,backendName:"webgl",kernelFunc:h_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function hM(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r,i=v.D5U.parseAxisParam(a,t[0].shape)[0],s=t.map(e=>e.shape);v.Wap.assertParamsConsistent(s,i);let o=v.Wap.computeOutShape(t.map(e=>e.shape),i);if(0===v.D5U.sizeFromShape(o))return n.makeTensorInfo(o,t[0].dtype,[]);let l=t.filter(e=>v.D5U.sizeFromShape(e.shape)>0);return 1===l.length?lJ({inputs:{x:l[0]},backend:n}):/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function e(t,n,r){let a=t[0].dtype;if("complex64"===a){let i=t.map(e=>hx({inputs:{input:e},backend:r})),s=t.map(e=>h_({inputs:{input:e},backend:r})),o=e(i,n,r),l=e(s,n,r),u=l1({inputs:{real:o,imag:l},backend:r});return i.forEach(e=>r.disposeIntermediateTensorInfo(e)),s.forEach(e=>r.disposeIntermediateTensorInfo(e)),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(l),u}let h=r.shouldExecuteOnCPU(t);if("string"===a&&(h=!0),h){let c=t.map(e=>{let t=v.D5U.sizeFromShape(e.shape.slice(n));return uu({inputs:{x:e},backend:r,attrs:{shape:[-1,t]}})}),d=c.map(e=>({vals:r.readSync(e.dataId),shape:e.shape})),p=v.Wap.computeOutShape(c.map(e=>e.shape),1),f=1===c[0].shape[0],m=oq(d,p,a,f),g=v.Wap.computeOutShape(t.map(e=>e.shape),n),y=r.makeTensorInfo(g,a,m);return c.forEach(e=>r.disposeIntermediateTensorInfo(e)),y}let b=(0,v.OBj)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(t.length>b){let x=[];for(let w=0;w<t.length;w+=b){let I=t.slice(w,w+b);x.push(e(I,n,r))}let k=e(x,n,r);for(let S of x)r.disposeIntermediateTensorInfo(S);return k}if((0,v.OBj)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].shape.length>1){let C=new hF(t.map(e=>e.shape),n);return r.runWebGLProgram(C,t,a)}let{tensors2D:E,outShape:T}=function(e,t,n){let r=v.Wap.computeOutShape(e.map(e=>e.shape),t),a=e.map(e=>uu({inputs:{x:e},attrs:{shape:[-1,v.D5U.sizeFromShape(e.shape.slice(t))]},backend:n}));return{tensors2D:a,outShape:r}}(t,n,r),$=new hD(E.map(e=>e.shape)),N=r.runWebGLProgram($,E,a);E.forEach(e=>r.disposeIntermediateTensorInfo(e));let A=uu({inputs:{x:N},attrs:{shape:T},backend:r});return r.disposeIntermediateTensorInfo(N),A}(l,i,n)}let hB={kernelName:v.Eh3,backendName:"webgl",kernelFunc:hM};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class hP{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;let i=e.padInfo.top,s=e.padInfo.left,o=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,h=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4,m="channelsLast"===e.dataFormat,g="",y="";n&&(g=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:a?`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:`
          float activation(float x) {
            ${n}
          }
        `,y="result = activation(result);"),t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${g}

      const ivec2 strides = ivec2(${o}, ${l});
      const ivec2 pads = ivec2(${i}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${m?3:1}];

        ivec2 xRCCorner =
            ivec2(coords[${m?1:2}], coords[${m?2:3}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${c}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${d}; wC++) {
            int xC = xCCorner + wC * ${h};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${m}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${1===f}) {

              if (${m}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${2===f}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${m}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${3===f}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${m}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${t?"result += getBiasAtOutCoords();":""}
        ${y}
        setOutput(result);
      }
    `}}class hL{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,a=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,h=e.filterDepth,c=e.filterHeight,d=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${a}, ${i}, ${s});
      const ivec3 pads = ivec3(${t}, ${n}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${h}; wF++) {
          int xF = xFCorner + wF * ${o};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${c}; wR++) {
            int xR = xRCorner + wR * ${l};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${1===f}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${2===f}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${3===f}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class hU{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=oN(this.outputShape.length);let i=e.padInfo.left,s=e.strideWidth,o=e.dilationWidth,l=e.filterHeight,u=e.filterWidth,h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let c=0;c<u;c++)h+=`
           vec4 xTexelC${2*c};
           int xTexelC${2*c}Ready;
           vec4 xTexelC${2*c+1};
           int xTexelC${2*c+1}Ready;
           vec4 xC${c};`;h+=`
     for (int r = 0; r < ${l}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let d=0;d<u;d++)h+=`
           xTexelC${2*d} = vec4(0.0);
           xTexelC${2*d}Ready = 0;
           xTexelC${2*d+1} = vec4(0.0);
           xTexelC${2*d+1}Ready = 0;
           xC${d} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let p=0;p<(u+1)/2;p++){let f=2*p;if(h+=`
           xC = xCCorner + ${f*o};
           `,1===s){if(f<u&&(i%2==1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${f}Ready == 0) {
                   xTexelC${f} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${f}.zw = vec2(0.0);
                   }
                   xTexelC${f}Ready = 1;
                 }
               `,1===o&&f>0?h+=`
                 xC${f} = vec4(xTexelC${f-2}.zw, xTexelC${f}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${f} = vec4(previous.zw, xTexelC${f}.xy);
                   } else {
                     xC${f} = vec4(0.0, 0.0, xTexelC${f}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${f}Ready == 0) {
                   xTexelC${f} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${f}.zw = vec2(0.0);
                   }
                   xTexelC${f}Ready = 1;
                 }

                 xC${f} = xTexelC${f};
                 `,f+1<u)){let m=i%2==0?v.D5U.nearestLargerEven(o):o;o%2==0&&i%2==1||o%2!=0&&i%2!=1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${m};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${f+1}Ready == 0) {
                     xTexelC${f+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${f+1}.zw = vec2(0.0);
                     }
                     xTexelC${f+1}Ready = 1;
                   }
                   `,o>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${f+1} = vec4(previous.zw, xTexelC${f+1}.xy);
                     } else {
                      xC${f+1} = vec4(0.0, 0.0, xTexelC${f+1}.xy);
                     }
                     `:h+=`
                     xC${f+1} = vec4(xTexelC${f}.zw, xTexelC${f+1}.xy);
                     `):1===m?h+=`
                     xC${f+1} = xTexelC${f};
                     `:h+=`
                     xCOffset = xC + ${m};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${f+1}Ready == 0) {
                       xTexelC${f+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${f+1}.zw = vec2(0.0);
                       }
                       xTexelC${f+1}Ready = 1;
                     }

                     xC${f+1} = xTexelC${f+1};
                     `}}else f<u&&(i%2==1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${f}Ready == 0) {
                   xTexelC${f} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${f}.zw = vec2(0.0);
                   }
                   xTexelC${f}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${f+1}Ready == 0) {
                   xTexelC${f+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${f+1}.zw = vec2(0.0);
                   }
                   xTexelC${f+1}Ready = 1;
                 }

                 xC${f} = vec4(xTexelC${f}.zw, xTexelC${f+1}.zw);
               `,f+1<u&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${f+1} = vec4(xTexelC${f+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${f}Ready == 0) {
                   xTexelC${f} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${f}.zw = vec2(0.0);
                   }
                   xTexelC${f}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${f+1}Ready == 0) {
                   xTexelC${f+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${f+1}.zw = vec2(0.);
                   }
                   xTexelC${f+1}Ready = 1;
                 }

                 xC${f} = vec4(
                   xTexelC${f}.xy, xTexelC${f+1}.xy);
               `,f+1<u&&(h+=`
                   xC${f+1} = vec4(xTexelC${f}.zw, xTexelC${f+1}.zw);
                 `)));f<u&&(h+=`
             wTexel = getW(r, ${f}, d1, d2);
             dotProd += xC${f}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${f}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,f+1<u&&(h+=`
               wTexel = getW(r, ${f+1}, d1, d2);
               dotProd += xC${f+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${f+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h=`
     }
   
     }
   
     }
   `;let g="",y="";n&&(g=r?`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${n}
         }`:a?`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${n}
         }`:`vec4 activation(vec4 x) {
           ${n}
         }`,y="result = activation(result);"),t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${g}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${t?"result += getBiasAtOutCoords();":""}
         ${y}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class hW{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=oN(this.outputShape.length);let{dataFormat:n}=t,r=(0,oC.A)(),a="channelsLast"===n,i=a?1:2,s=a?2:3,o=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`,l="";for(let u=0;u<=1;u++)for(let h=0;h<=1;h++)l+=`
          blockIndex = rc.z + ${h};
          pos = rc.y + ${u};

          ${o}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${s}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${a}) {
                  innerDims = vec2(d1, ch);
                  result[${2*u+h}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${2*u+h}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${l}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function hz(e,t){let n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&1===n&&e[0]>1?[e[0],1]:null}function hV({x:e,filter:t,convInfo:n,backend:r,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:s=0,activation:o=null}){let l;let u=e.shape,h=r.texData.get(e.dataId),c=n.inChannels,d=u[0]*u[1]*u[2],p=n.outChannels,f="channelsLast"===n.dataFormat,m=[];if(null!=i){let g=hz(i.shape,f);null!=g&&(i=uu({inputs:{x:i},backend:r,attrs:{shape:g}}),m.push(i))}if(null!=a){let y=hz(a.shape,f);null!=y&&(a=uu({inputs:{x:a},backend:r,attrs:{shape:y}}),m.push(a))}let b=!((1===d||1===p)&&c>1e3)&&h.isPacked&&f&&null!=h.texture&&u[2]%2!=0&&v.D5U.arraysEqual(h.shape.slice(-3),u.slice(-3));if(b){let x=u[0]*u[1]*(u[2]+1),w={dataId:e.dataId,shape:[1,x,n.inChannels],dtype:e.dtype},I=h.shape;h.shape=h.shape.slice(),h.shape[h.shape.length-2]++,v.D5U.assert(ox(h.shape,w.shape),()=>`packed reshape ${h.shape} to ${w.shape} isn't free`);let k=uu({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});m.push(k);let S=uw({a:w,b:k,backend:r,transposeA:!1,transposeB:!1,bias:a,activation:o,preluActivationWeights:i,leakyreluAlpha:s}),C=r.texData.get(S.dataId);v.D5U.assert(C.isPacked,()=>"batchMatMul result is expected to be packed"),h.shape=I,C.shape=n.outShape,(l=lJ({inputs:{x:S},backend:r})).shape=n.outShape,m.push(S)}else{let E=n.outHeight*n.outWidth,T=uu({inputs:{x:e},backend:r,attrs:{shape:f?[n.batchSize,E,n.inChannels]:[n.batchSize,n.inChannels,E]}}),$=uu({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),N=uw({a:f?T:$,b:f?$:T,transposeA:!f,transposeB:!1,backend:r,bias:a,activation:o,preluActivationWeights:i,leakyreluAlpha:s});l=uu({inputs:{x:N},backend:r,attrs:{shape:n.outShape}}),m.push(T),m.push($),m.push(N)}for(let A of m)r.disposeIntermediateTensorInfo(A);return l}function hG({x:e,filter:t,convInfo:n,backend:r,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:s=0,activation:o=null}){let{filterWidth:l,filterHeight:u,inChannels:h,outWidth:c,outHeight:d,dataFormat:p}=n,f="channelsLast"===p,m=l*u*h,g=d*c,y=[n.batchSize,m,g],b=[];if(null!=i){let x=hz(i.shape,f);null!=x&&(i=uu({inputs:{x:i},backend:r,attrs:{shape:x}}),b.push(i))}if(null!=a){let w=hz(a.shape,f);null!=w&&(a=uu({inputs:{x:a},backend:r,attrs:{shape:w}}),b.push(a))}let I=uu({inputs:{x:t},backend:r,attrs:{shape:[1,m,v.D5U.sizeFromShape(t.shape)/m]}});b.push(I);let k=new hW(y,n),S=[e.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],C=r.runWebGLProgram(k,[e],"float32",S),E=uu({inputs:{x:C},backend:r,attrs:{shape:y}});b.push(C),b.push(E);let T=null!=a,$=null!=i,N="leakyrelu"===o,A=o?un(o,!0):null,D=new ur(f?E.shape:I.shape,f?I.shape:E.shape,f?[n.batchSize,g,n.outChannels]:[n.batchSize,n.outChannels,g],!0,!1,T,A,$,N),F=f?[E,I]:[I,E];if(a&&F.push(a),$&&F.push(i),N){let R=r.makeTensorInfo([],"float32",v.D5U.createScalarValue(s,"float32"));F.push(R),b.push(R)}let _=r.runWebGLProgram(D,F,"float32"),O=uu({inputs:{x:_},backend:r,attrs:{shape:n.outShape}});for(let M of(b.push(_),b))r.disposeIntermediateTensorInfo(M);return O}let hj={kernelName:v.mhS,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t;let{inputs:n,backend:r,attrs:a}=e,{x:i,filter:s}=n,{strides:o,pad:l,dataFormat:u,dilations:h,dimRoundingMode:c}=a,d=v.Wap.convertConv2DDataFormat(u),p=v.Wap.computeConv2DInfo(i.shape,s.shape,o,h,l,c,!1,d);if(1===p.filterHeight&&1===p.filterWidth&&1===p.dilationHeight&&1===p.dilationWidth&&1===p.strideHeight&&1===p.strideWidth&&("SAME"===p.padInfo.type||"VALID"===p.padInfo.type))t=hV({x:i,filter:s,convInfo:p,backend:r});else if(p.strideWidth<=2&&"channelsLast"===d&&(0,v.OBj)().getBool("WEBGL_EXP_CONV")){let f=new hU(p),m=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];t=r.runWebGLProgram(f,[i,s],"float32",m)}else if((0,v.OBj)().getBool("WEBGL_CONV_IM2COL"))t=hG({x:i,filter:s,convInfo:p,backend:r});else{let g=new hP(p);t=r.runWebGLProgram(g,[i,s],"float32")}let y=uu({inputs:{x:t},backend:r,attrs:{shape:p.outShape}});return r.disposeIntermediateTensorInfo(t),y}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class hH{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i="channelsLast"===e.dataFormat;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${n} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              if (${i}) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class hK{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i="channelsLast"===e.dataFormat,s=t-1-e.padInfo.top,o=n-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${i?3:1}];

        ivec2 dyCorner = ivec2(coords[${i?1:2}], coords[${i?2:3}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${n} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class hX{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.padInfo.front,i=e.padInfo.top,s=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${a};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${n} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${s};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class hq{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=t-1-e.padInfo.front,l=n-1-e.padInfo.top,u=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${o}, ${l}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${a}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${n}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${n} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}let hY={kernelName:v.wUP,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:h}=r,c=v.Wap.convertConv2DDataFormat(l),d=v.Wap.computeConv2DInfo(a.shape,h,s,1,o,u,!1,c),p=new hH(d);return n.runWebGLProgram(p,[a,i],"float32")}},hQ={kernelName:v.wm,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{inputShape:s,strides:o,pad:l,dataFormat:u,dimRoundingMode:h}=r,c=v.Wap.convertConv2DDataFormat(u),d=v.Wap.computeConv2DInfo(s,i.shape,o,1,l,h,!1,c),p=new hK(d);return n.runWebGLProgram(p,[a,i],"float32")}},hZ={kernelName:v.x12,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l}=r,u=v.Wap.computeConv3DInfo(a.shape,i.shape,s,l,o),h=new hL(u);return n.runWebGLProgram(h,[a,i],"float32")}},hJ={kernelName:v.o2y,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,pad:o,filterShape:l}=r,u=v.Wap.computeConv3DInfo(a.shape,l,s,1,o),h=new hX(u);return n.runWebGLProgram(h,[a,i],"float32")}},h0={kernelName:v.ik2,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{pad:s,strides:o,inputShape:l}=r,u=v.Wap.computeConv3DInfo(l,i.shape,o,1,s),h=new hq(u);return n.runWebGLProgram(h,[a,i],"float32")}},h1=l9+`
  return cos(x);
`,h2=ue({opSnippet:h1}),h3={kernelName:v.mc4,backendName:"webgl",kernelFunc:h2},h4=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,h6=ue({opSnippet:h4}),h5={kernelName:v.TR1,backendName:"webgl",kernelFunc:h6};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class h7{constructor(e,t,n,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];let[i,s,o,l]=e,[u]=t,[h,c]=n;this.outputShape=[u,h,c,l];let[d,p]=[`${s-1}.0`,`${o-1}.0`],[f,m,g]=h>1?[`${(s-1)/(h-1)}`,"(y2-y1) * height_ratio",`y1*${d} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${d}`],[y,b,x]=c>1?[`${(o-1)/(c-1)}`,"(x2-x1) * width_ratio",`x1*${p} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${p}`];this.userCode=`
      const float height_ratio = float(${f});
      const float width_ratio = float(${y});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${m};
        float width_scale = ${b};

        float in_y = ${g};
        if( in_y < 0.0 || in_y > ${d} ) {
          setOutput(float(${a}));
          return;
        }
        float in_x = ${x};
        if( in_x < 0.0 || in_x > ${p} ) {
          setOutput(float(${a}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${"bilinear"===r?1:0} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let h8=e=>{let{inputs:t,backend:n,attrs:r}=e,{image:a,boxes:i,boxInd:s}=t,{cropSize:o,method:l,extrapolationValue:u}=r,h=new h7(a.shape,i.shape,o,l,u);return n.runWebGLProgram(h,[a,i,s],"float32")},h9={kernelName:v.VcC,backendName:"webgl",kernelFunc:h8};(d=b||(b={})).Prod="*",d.Sum="+";class ce{constructor(e,t,n,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];let a=this.outputShape.length,i=this.op===b.Prod?"1.0":"0.0",s=n?i:`getX(${ct(a,"coords",this.op)})`,o=this.outputShape[this.outputShape.length-1],l="",u="";n?(l=r?`end != ${o-1}`:"end != 0",u=r?"end + 1":"end - 1"):(l=r?`end + pow2 < ${o}`:"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${(0,oE.kW)(a)} coords = getOutputCoords();
        int end = ${cn(a,"coords",this.op)};
        float val = ${s};
        int pow2 = int(pow(2.0, index));
        if (${l}) {
          int idx = ${u};
          ${cn(a,"coords",this.op)} = idx;
          val ${this.op}= getX(${ct(a,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function ct(e,t,n){if(1===e)return`${t}`;if(2===e)return`${t}.x, ${t}.y`;if(3===e)return`${t}.x, ${t}.y, ${t}.z`;if(4===e)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function cn(e,t,n){if(1===e)return`${t}`;if(2===e)return`${t}.y`;if(3===e)return`${t}.z`;if(4===e)return`${t}.w`;throw Error(`Cumulative ${n} for rank ${e} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function cr(e,t,n,r,a,i){let s=t.shape.length,o=v.Wap.getAxesPermutation([r],s),l=t;null!=o&&(l=ux({inputs:{x:t},backend:n,attrs:{perm:o}}));let u=v.Wap.getInnerMostAxes(1,s)[0];if(u!==s-1)throw Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${r}`);let h=l.shape[u],c=lJ({inputs:{x:l},backend:n});for(let d=0;d<=Math.ceil(Math.log2(h))-1;d++){let p=new ce(e,l.shape,!1,i),f=[[d]],m=c;c=n.runWebGLProgram(p,[c],c.dtype,f),n.disposeIntermediateTensorInfo(m)}if(a){let g=new ce(e,l.shape,a,i),y=c;c=n.runWebGLProgram(g,[c],c.dtype),n.disposeIntermediateTensorInfo(y)}if(null!=o){let b=v.Wap.getUndoAxesPermutation(o),x=ux({inputs:{x:c},backend:n,attrs:{perm:b}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),x}return c}let ca={kernelName:v.Byc,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r;return cr(b.Prod,a,n,i,s,o)}},ci={kernelName:v.iHb,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r;return cr(b.Sum,a,n,i,s,o)}},cs={kernelName:v.QRR,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:s,binaryOutput:o}=r;if(1===a.shape.length){let l=n.readSync(a.dataId),u=n.readSync(i.dataId),h=oj(l,u,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,h)}if(2===a.shape.length){let c=n.bufferSync(a),d=n.bufferSync(i),p=oH(c,d,s,o);return n.makeTensorInfo(p.shape,i.dtype,p.values)}throw Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class co{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}let cl={kernelName:v.T0n,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockSize:i,dataFormat:s}=r,o=a.shape[0],l="NHWC"===s?a.shape[1]:a.shape[2],u="NHWC"===s?a.shape[2]:a.shape[3],h="NHWC"===s?a.shape[3]:a.shape[1],c=l*i,d=u*i,p=h/(i*i),f=new co("NHWC"===s?[o,c,d,p]:[o,p,c,d],i,s);return n.runWebGLProgram(f,[a],a.dtype)}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class cu{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=oN(this.outputShape.length);let i=e.filterHeight,s=e.filterWidth,o=e.outChannels/e.inChannels,l="",u="";n&&(l=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:a?`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:`
          float activation(float x) {
            ${n}
          }
        `,u="result = activation(result);"),t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${l}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${s}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${t?"result += getBiasAtOutCoords();":""}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class ch{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=oN(this.outputShape.length);let i=e.outChannels/e.inChannels,s=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,h=e.filterWidth,c=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let d=0;d<h;d++)c+=`
          vec4 xTexelC${2*d};
          int xTexelC${2*d}Ready;
          vec4 xTexelC${2*d+1};
          int xTexelC${2*d+1}Ready;
          vec4 xC${d};`;c+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let p=0;p<h;p++)c+=`
          xTexelC${2*p} = vec4(0.0);
          xTexelC${2*p}Ready = 0;
          xTexelC${2*p+1} = vec4(0.0);
          xTexelC${2*p+1}Ready = 0;
          xC${p} = vec4(0.0);`;c+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let f=0;f<(h+1)/2;f++){let m=2*f;if(c+=`
          xC = xCCorner + ${m*l};
          `,1===o){if(m<h&&(s%2==1?(c+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m}Ready == 0) {
                  xTexelC${m} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${m}.zw = vec2(0.0);
                  }
                  xTexelC${m}Ready = 1;
                }
              `,1===l&&m>0?c+=`
                xC${m} = vec4(xTexelC${m-2}.zw, xTexelC${m}.xy);
                `:c+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${m} = vec4(previous.zw, xTexelC${m}.xy);
                  } else {
                    xC${m} = vec4(0.0, 0.0, xTexelC${m}.xy);
                  }
                  `):c+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${m}Ready == 0) {
                  xTexelC${m} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${m}.zw = vec2(0.0);
                  }
                  xTexelC${m}Ready = 1;
                }

                xC${m} = xTexelC${m};
                `,m+1<h)){let g=s%2==0?v.D5U.nearestLargerEven(l):l;l%2==0&&s%2==1||l%2!=0&&s%2!=1?(c+=`
                  xCOffset = xC + imod(pads[1], 2) + ${g};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m+1}Ready == 0) {
                    xTexelC${m+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${m+1}.zw = vec2(0.0);
                    }
                    xTexelC${m+1}Ready = 1;
                  }
                  `,l>1?c+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${m+1} = vec4(previous.zw, xTexelC${m+1}.xy);
                    } else {
                     xC${m+1} = vec4(0.0, 0.0, xTexelC${m+1}.xy);
                    }
                    `:c+=`
                    xC${m+1} = vec4(xTexelC${m}.zw, xTexelC${m+1}.xy);
                    `):1===g?c+=`
                    xC${m+1} = xTexelC${m};
                    `:c+=`
                    xCOffset = xC + ${g};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m+1}Ready == 0) {
                      xTexelC${m+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${m+1}.zw = vec2(0.0);
                      }
                      xTexelC${m+1}Ready = 1;
                    }

                    xC${m+1} = xTexelC${m+1};
                    `}}else m<h&&(s%2==1?(c+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m}Ready == 0) {
                  xTexelC${m} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${m}.zw = vec2(0.0);
                  }
                  xTexelC${m}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${m+1}Ready == 0) {
                  xTexelC${m+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${m+1}.zw = vec2(0.0);
                  }
                  xTexelC${m+1}Ready = 1;
                }

                xC${m} = vec4(xTexelC${m}.zw, xTexelC${m+1}.zw);
              `,m+1<h&&(c+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${m+1} = vec4(xTexelC${m+1}.xy, final.xy);
                `)):(c+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${m}Ready == 0) {
                  xTexelC${m} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${m}.zw = vec2(0.0);
                  }
                  xTexelC${m}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m+1}Ready == 0) {
                  xTexelC${m+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${m+1}.zw = vec2(0.);
                  }
                  xTexelC${m+1}Ready = 1;
                }

                xC${m} = vec4(
                  xTexelC${m}.xy, xTexelC${m+1}.xy);
              `,m+1<h&&(c+=`
                  xC${m+1} = vec4(xTexelC${m}.zw, xTexelC${m+1}.zw);
                `)));m<h&&(c+=`
            wTexel = getW(r, ${m}, d1, q);
            dotProd += xC${m} * vec4(wTexel.xz, wTexel.xz);
          `,m+1<h&&(c+=`
              wTexel = getW(r, ${m+1}, d1, q);
              dotProd += xC${m+1} * vec4(wTexel.xz, wTexel.xz);
            `))}c=`
    }
  
      }
    `;let y="",b="";n&&(y=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:a?`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:`vec4 activation(vec4 x) {
          ${n}
        }`,b="result = activation(result);"),t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${y}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${c}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${t?"result += getBiasAtOutCoords();":""}
        ${b}
        setOutput(result);
      }
    `}}let cc={kernelName:v.cie,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t;let{inputs:n,backend:r,attrs:a}=e,{x:i,filter:s}=n,{strides:o,pad:l,dilations:u,dimRoundingMode:h}=a,c=u;null==c&&(c=[1,1]),v.D5U.assert(v.Wap.eitherStridesOrDilationsAreOne(o,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);let d=v.Wap.computeConv2DInfo(i.shape,s.shape,o,c,l,h,!0);t=(0,v.OBj)().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels==1?new ch(d):new cu(d);let p=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return r.runWebGLProgram(t,[i,s],"float32",p)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class cd{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${n} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class cp{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=t-1-e.padInfo.top,s=n-1-e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${n} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${o}; dm++) {
              int d2 = d1 * ${o} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}let cf={kernelName:v.sL$,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:u,filterShape:h}=r,c=v.Wap.computeConv2DInfo(a.shape,h,s,o,l,u,!0),d=new cd(c);return n.runWebGLProgram(d,[a,i],"float32")}},cm={kernelName:v.y7R,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:u,inputShape:h}=r,c=v.Wap.computeConv2DInfo(h,i.shape,s,o,l,u,!0),d=new cp(c);return n.runWebGLProgram(d,[a,i],"float32")}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class cg{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}let cy={kernelName:v.$w,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{x:r}=t,a=[...r.shape,...r.shape],i=v.D5U.sizeFromShape(r.shape),s=uu({inputs:{x:r},backend:n,attrs:{shape:[i]}}),o=new cg(i),l=n.runWebGLProgram(o,[s],s.dtype),u=uu({inputs:{x:l},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),u}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class cb{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let{inHeight:t,inWidth:n,padInfo:r,strideHeight:a,strideWidth:i,filterHeight:s,filterWidth:o,dilationHeight:l,dilationWidth:u}=e,{top:h,left:c}=r;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${i});
      const ivec2 pads = ivec2(${h}, ${c});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${s}; h++) {
          int hIn = hBeg + h * ${l};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${o}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${n}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}let cx={kernelName:v.p4S,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t;let{inputs:n,backend:r,attrs:a}=e,{x:i,filter:s}=n,{strides:o,pad:l,dilations:u}=a,h=v.Wap.computeDilation2DInfo(i.shape,s.shape,o,l,"NHWC",u),c=new cb(h);t=r.runWebGLProgram(c,[i,s],"float32");let d=uu({inputs:{x:t},backend:r,attrs:{shape:h.outShape}});return r.disposeIntermediateTensorInfo(t),d}},cv={kernelName:v.$g6,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{equation:a}=r,{allDims:i,summedDims:s,idDims:o}=v.Wap.decodeEinsumEquation(a,t.length);v.Wap.checkEinsumDimSizes(i.length,o,t);let{path:l,steps:u}=v.Wap.getEinsumComputePath(s,o),h=u.length,c=null,d=i.length,p=[];for(let f=0;f<h;++f){for(let m of u[f]){let g;let{permutationIndices:y,expandDims:b}=v.Wap.getEinsumPermutation(d,o[m]);v.Wap.isIdentityPermutation(y)?g=t[m]:(g=ux({inputs:{x:t[m]},backend:n,attrs:{perm:y}}),p.push(g));let x=g.shape.slice();for(let w=0;w<b.length;++w)x.splice(b[w],0,1);v.D5U.arraysEqual(g.shape,x)||(g=uu({inputs:{x:g},backend:n,attrs:{shape:x}}),p.push(g)),null===c?c=g:(c=uo({inputs:{a:g,b:c},backend:n}),p.push(c))}f<h-1&&(l[f]>=0&&(c=uy({inputs:{x:c},backend:n,attrs:{axis:l[f]-(i.length-d),keepDims:!1}}),p.push(c)),d--)}for(let I of p)I!==c&&n.disposeIntermediateTensorInfo(I);return c}},cw=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,cI=ue({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:cw}),ck={kernelName:v.SX0,backendName:"webgl",kernelFunc:cI},cS=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,cC=e=>{let{inputs:t,backend:n}=e,{dy:r,y:a}=t,i=(0,v.OBj)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new lZ(cS,r.shape,a.shape):new lY("return (b >= 1.0) ? a : a * (b + 1.0);",r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)},cE={kernelName:v.HEU,backendName:"webgl",kernelFunc:cC},cT=`
  return vec4(equal(a, b));
`,c$=ut({opSnippet:"return float(a == b);",packedOpSnippet:cT,dtype:"bool",cpuKernelImpl:oY}),cN={kernelName:v.hdR,backendName:"webgl",kernelFunc:c$},cA=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${v.Wap.ERF_P};
  float a1 = ${v.Wap.ERF_A1};
  float a2 = ${v.Wap.ERF_A2};
  float a3 = ${v.Wap.ERF_A3};
  float a4 = ${v.Wap.ERF_A4};
  float a5 = ${v.Wap.ERF_A5};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,cD=ue({opSnippet:cA}),cF={kernelName:v.Omj,backendName:"webgl",kernelFunc:cD},cR=l9+`
  return exp(x);
`,c_=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,cO=ue({opSnippet:cR,packedOpSnippet:c_,cpuKernelImpl:oQ,dtype:"float32"}),cM={kernelName:v.NEP,backendName:"webgl",kernelFunc:cO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function cB(e){let{inputs:t,attrs:n,backend:r}=e,{dim:a}=n,{input:i}=t,s=i.shape.length,o=i.shape.slice(),l=a;return a<0&&(v.D5U.assert(-(s+1)<=a,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),l=s+a+1),o.splice(l,0,1),uu({inputs:{x:i},backend:r,attrs:{shape:o}})}let cP={kernelName:v.YFo,backendName:"webgl",kernelFunc:cB},cL="return exp(x) - 1.0;",cU=ue({opSnippet:cL,packedOpSnippet:cL,cpuKernelImpl:oZ}),cW={kernelName:v.Y0y,backendName:"webgl",kernelFunc:cU};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class cz{constructor(e,t,n){let r;this.variableNames=["real","imag"];let a=t[1];this.outputShape=t;let i=n?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,s=n?`${a}.0`:"1.0";if("real"===e)r="return real * expR - imag * expI;";else if("imag"===e)r="return real * expI + imag * expR;";else throw Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${r}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${a});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${a}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${s};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function cV(e,t,n){let r=n.texData.get(e.dataId),a=v.D5U.sizeFromShape(e.shape),i=e.shape[e.shape.length-1],s=uu({inputs:{x:e},backend:n,attrs:{shape:[a/i,i]}}),o=s.shape,l=new cz("real",o,t),u=new cz("imag",o,t),h=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:o},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:o}],c=n.runWebGLProgram(l,h,"float32"),d=n.runWebGLProgram(u,h,"float32"),p=l1({inputs:{real:c,imag:d},backend:n});n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d);let f=uu({inputs:{x:p},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(p),f}let cG={kernelName:v.vwp,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{input:r}=t;return cV(r,!1,n)}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class cj{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function cH(e){let{backend:t,attrs:n}=e,{shape:r,value:a}=n,{dtype:i}=n;if("string"===(i=i||v.D5U.inferDtype(a))){let s=v.D5U.getArrayFromDType(i,v.D5U.sizeFromShape(r));return s.fill(a),t.makeTensorInfo(r,i,s)}{let o=new cj(r,a);return t.runWebGLProgram(o,[],i,[[a]])}}let cK={kernelName:v.deh,backendName:"webgl",kernelFunc:cH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class cX{constructor(e){this.variableNames=["Image"],this.outputShape=[];let t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let cq={kernelName:v.Uyb,backendName:"webgl",kernelFunc({inputs:e,backend:t}){let{image:n}=e,r=new cX(n.shape),a=t.runWebGLProgram(r,[n],n.dtype);return a}},cY="return floor(x);",cQ=ue({opSnippet:cY,packedOpSnippet:cY,cpuKernelImpl:oJ}),cZ={kernelName:v.OR,backendName:"webgl",kernelFunc:cQ},cJ=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,c0=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,c1=ut({opSnippet:cJ,packedOpSnippet:c0,dtype:"int32"}),c2={kernelName:v.jeX,backendName:"webgl",kernelFunc:c1};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class c3{constructor(e){this.variableNames=["A"];let t=(0,oC.A)(),[n,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${n}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class c4{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let t=(0,oC.A)(),[n,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${n}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let c6={kernelName:v.eBW,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{pixels:a}=t,{numChannels:s}=r,o="undefined"!=typeof HTMLVideoElement&&a instanceof HTMLVideoElement,l="undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement,[u,h]=o?[a.videoWidth,a.videoHeight]:[a.width,a.height],c=[h,u,s];if(l||o){let d=(0,v.OBj)().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(null==i||d!==c5)&&(c5=d,i=document.createElement("canvas").getContext("2d",{willReadFrequently:c5})),i.canvas.width=u,i.canvas.height=h,i.drawImage(a,0,0,u,h),a=i.canvas}let p=n.makeTensorInfo([h,u],"int32");n.texData.get(p.dataId).usage=g.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),a);let f=(0,v.OBj)().getBool("WEBGL_PACK")?new c4(c):new c3(c),m=n.runWebGLProgram(f,[p],"int32");return n.disposeData(p.dataId),m}},c5=(0,v.OBj)().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU"),c7={kernelName:v._V0,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t;let{inputs:n,backend:r,attrs:a}=e,{x:i,filter:s,bias:o,preluActivationWeights:l}=n,{strides:u,pad:h,dataFormat:c,dilations:d,dimRoundingMode:p,activation:f,leakyreluAlpha:m}=a,g=v.Wap.convertConv2DDataFormat(c),y=v.Wap.computeConv2DInfo(i.shape,s.shape,u,d,h,p,!1,g),b=[],x=null!=o,w=null!=l,I="leakyrelu"===f,k=()=>{let e=[i,s],t=(e,t)=>{if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){let n=uu({inputs:{x:e},backend:r,attrs:{shape:[e.shape[0],1,1]}});return b.push(n),n}return e};if(x&&e.push(t(o,c)),w&&e.push(t(l,c)),I){let n=r.makeTensorInfo([],"float32",v.D5U.createScalarValue(m,"float32"));e.push(n),b.push(n)}return e};if(1===y.filterHeight&&1===y.filterWidth&&1===y.dilationHeight&&1===y.dilationWidth&&1===y.strideHeight&&1===y.strideWidth&&("SAME"===y.padInfo.type||"VALID"===y.padInfo.type))t=hV({x:i,filter:s,convInfo:y,backend:r,bias:o,activation:f,preluActivationWeights:l,leakyreluAlpha:m});else if(y.strideWidth<=2&&"channelsLast"===g&&(0,v.OBj)().getBool("WEBGL_EXP_CONV")){let S=f?un(f,!0):null,C=new hU(y,x,S,w,I),E=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],T=k();t=r.runWebGLProgram(C,T,"float32",E)}else if((0,v.OBj)().getBool("WEBGL_CONV_IM2COL"))t=hG({x:i,filter:s,convInfo:y,backend:r,bias:o,activation:f,preluActivationWeights:l,leakyreluAlpha:m});else{let $=f?un(f,!1):null,N=new hP(y,x,$,w,I),A=k();t=r.runWebGLProgram(N,A,"float32")}let D=uu({inputs:{x:t},backend:r,attrs:{shape:y.outShape}});return b.push(t),b.forEach(e=>r.disposeIntermediateTensorInfo(e)),D}},c8={kernelName:v.luS,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t;let{inputs:n,backend:r,attrs:a}=e,{x:i,filter:s,bias:o,preluActivationWeights:l}=n,{strides:u,pad:h,dilations:c,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=a,m=[],g=c;null==g&&(g=[1,1]),v.D5U.assert(v.Wap.eitherStridesOrDilationsAreOne(u,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${u} and dilations '${g}'`);let y=v.Wap.computeConv2DInfo(i.shape,s.shape,u,g,h,d,!0),b=(0,v.OBj)().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels==1,x=p?un(p,b):null,w=[i,s],I=null!=o,k=null!=l,S="leakyrelu"===p;if(I&&w.push(o),k&&w.push(l),S){let C=r.makeTensorInfo([],"float32",v.D5U.createScalarValue(f,"float32"));w.push(C),m.push(C)}t=b?new ch(y,I,x,k,S):new cu(y,I,x,k,S);let E=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],T=r.runWebGLProgram(t,w,"float32",E);return m.forEach(e=>r.disposeIntermediateTensorInfo(e)),T}};class c9{constructor(e,t,n,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;let a=(0,oE.kW)(n.length),i=`
    int index;`;for(let s=0;s<this.sliceDim;s++)i+=`
          index = round(getIndices(coords[0], ${s}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[s]};
          flattenIndex += index * ${this.strides[s]};`;this.userCode=`
         void main() {
          ${a} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}let de={kernelName:v.q1x,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{params:r,indices:a}=t,i=a.shape,s=i[i.length-1],o=v.D5U.sizeFromShape(r.shape),[l,u,h,c]=v.Wap.prepareAndValidate(r,a),d=uu({inputs:{x:a},backend:n,attrs:{shape:[u,s]}}),p=uu({inputs:{x:r},backend:n,attrs:{shape:[v.D5U.sizeFromShape(r.shape)/h,h]}});if(n.shouldExecuteOnCPU([r,a])||"string"===r.dtype){let f=n.readSync(a.dataId),m=n.bufferSync(r),g=o0(f,m,r.dtype,u,s,h,c,r.shape,o);return n.makeTensorInfo(l,r.dtype,g.values)}let y=new c9(s,c,[u,h],r.shape),b=n.runWebGLProgram(y,[p,d],p.dtype),x=uu({inputs:{x:b},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(b),x}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class dt{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;let n=(0,oE.kW)(this.rank),r=function(e,t){let n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let a=0;a<e.length;a++)2===a?r.push("index"):r.push(`${n[a]}`);return r.join()}(e,0);this.userCode=`
      void main() {
        ${n} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function dn(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,indices:i}=t,{axis:s,batchDims:o}=r,l=v.D5U.parseAxisParam(s,a.shape)[0];if((0,v.OBj)().get("DEBUG")){let u=n.readSync(i.dataId),h=a.shape[l];for(let c=0;c<u.length;++c){let d=u[c];v.D5U.assert(d<=h-1&&d>=0,()=>`GatherV2: the index value ${d} is not in [0, ${h-1}]`)}}let p=v.Wap.segment_util.collectGatherOpShapeInfo(a,i,l,o),f=v.D5U.sizeFromShape(i.shape),m=[],g=uu({inputs:{x:a},backend:n,attrs:{shape:[p.batchSize,p.outerSize,p.dimSize,p.sliceSize]}}),y=uu({inputs:{x:i},backend:n,attrs:{shape:[p.batchSize,f/p.batchSize]}});m.push(g),m.push(y);let b=[p.batchSize,p.outerSize,f/p.batchSize,p.sliceSize];if(n.shouldExecuteOnCPU([a,i])||"string"===a.dtype){let x=n.bufferSync(y),w=n.bufferSync(g),I=o1(w,x,b);return m.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(p.outputShape,I.dtype,I.values)}let k=new dt(g.shape,b),S=n.runWebGLProgram(k,[g,y],g.dtype);m.push(S);let C=uu({inputs:{x:S},backend:n,attrs:{shape:p.outputShape}});return m.forEach(e=>n.disposeIntermediateTensorInfo(e)),C}let dr={kernelName:v.qi_,backendName:"webgl",kernelFunc:dn},da=`
  return vec4(greaterThan(a, b));
`,di=ut({opSnippet:"return float(a > b);",packedOpSnippet:da,cpuKernelImpl:o2,dtype:"bool"}),ds={kernelName:v.iZT,backendName:"webgl",kernelFunc:di},dl=`
  return vec4(greaterThanEqual(a, b));
`,du=ut({opSnippet:"return float(a >= b);",packedOpSnippet:dl,dtype:"bool",cpuKernelImpl:o3}),dh={kernelName:v.Acj,backendName:"webgl",kernelFunc:du},dc={kernelName:v.Qg5,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{input:r}=t;return cV(r,!0,n)}},dd=ue({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),dp={kernelName:v.avt,backendName:"webgl",kernelFunc:dd},df=ue({opSnippet:"return float(isinf(x));",dtype:"bool"}),dm={kernelName:v.iWB,backendName:"webgl",kernelFunc:df},dg=ue({opSnippet:"return float(isnan(x));",dtype:"bool"}),dy={kernelName:v.r7n,backendName:"webgl",kernelFunc:dg},db=`
  return vec4(lessThan(a, b));
`,dx=ut({opSnippet:"return float(a < b);",packedOpSnippet:db,cpuKernelImpl:o4,dtype:"bool"}),dv={kernelName:v.vtC,backendName:"webgl",kernelFunc:dx},dw=`
  return vec4(lessThanEqual(a, b));
`,dI=ut({opSnippet:"return float(a <= b);",packedOpSnippet:dw,cpuKernelImpl:o6,dtype:"bool"}),dk={kernelName:v.CAk,backendName:"webgl",kernelFunc:dI},dS={kernelName:v.e7N,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{backend:t,attrs:n}=e,{start:r,stop:a,num:i}=n,s=o5(r,a,i);return t.makeTensorInfo([s.length],"float32",s)}},dC=l9+`
  return x < 0.0 ? 0./0. : log(x);
`,dE=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,dT=ue({opSnippet:dC,packedOpSnippet:dE,cpuKernelImpl:o7}),d$={kernelName:v.ZbH,backendName:"webgl",kernelFunc:dT},dN=l9+`
  return log(1.0 + x);
`,dA=ue({opSnippet:dN}),dD={kernelName:v.kU,backendName:"webgl",kernelFunc:dA},dF=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,dR=ut({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:dF,dtype:"bool"}),d_={kernelName:v.PYm,backendName:"webgl",kernelFunc:dR},dO=ue({opSnippet:"return float(!(x >= 1.0));"}),dM={kernelName:v.VfG,backendName:"webgl",kernelFunc:dO},dB=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,dP=ut({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:dB,dtype:"bool"}),dL={kernelName:v.MZg,backendName:"webgl",kernelFunc:dP};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class dU{constructor(e,t,n,r,a){let i;this.variableNames=["x"],this.outputShape=[];let s=e[3]-1;this.outputShape=e;let o=`float(${n}) + float(${r}) * sum`;i=.5===a?`inversesqrt(${o})`:1===a?`1.0/(${o})`:`exp(log(${o}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${t}; j <= ${t}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${s}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${i};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class dW{constructor(e,t,n,r,a){let i;this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;let s=e[3]-1;this.outputShape=e;let o=`float(${n}) + float(${r}) * sum`;i=.5===a?`inversesqrt(${o})`:1===a?`1.0/(${o})`:`exp(log(${o}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${t};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${t}; j <= ${t}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${s}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${i};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let dz=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:i,bias:s,alpha:o,beta:l}=r,u=(0,v.OBj)().getBool("WEBGL_PACK_NORMALIZATION")?new dW(a.shape,i,s,o,l):new dU(a.shape,i,s,o,l);return n.runWebGLProgram(u,[a],a.dtype)},dV={kernelName:v.eZ0,backendName:"webgl",kernelFunc:dz};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class dG{constructor(e,t,n,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${n});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${a})
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${a});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let dj=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a,y:i,dy:s}=t,{depthRadius:o,bias:l,alpha:u,beta:h}=r,c=new dG(a.shape,o,l,u,h);return n.runWebGLProgram(c,[a,i,s],a.dtype)},dH={kernelName:v.Hhh,backendName:"webgl",kernelFunc:dj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function dK(e){let t;let{inputs:n,backend:r,attrs:a}=e,{x:i}=n,{reductionIndices:s,keepDims:o}=a,l=i.shape.length,u=v.D5U.parseAxisParam(s,i.shape),h=u,c=v.Wap.getAxesPermutation(h,l),d=null!=c,p=r.shouldExecuteOnCPU([i]),f=i;if(d){if(p){let m=r.texData.get(f.dataId),g=m.values,y=Array(l);for(let b=0;b<y.length;b++)y[b]=i.shape[c[b]];let x=lS(g,i.shape,i.dtype,c,y);f=r.makeTensorInfo(y,i.dtype);let w=r.texData.get(f.dataId);w.values=x}else f=ug(i,c,r);h=v.Wap.getInnerMostAxes(h.length,l)}v.Wap.assertAxesAreInnerMostDims("max",h,l);let[I,k]=v.Wap.computeOutAndReduceShapes(f.shape,h),S=I;if(o&&(S=v.Wap.expandShapeToKeepDim(I,u)),p){let C=r.texData.get(f.dataId),E=C.values,T=o8(E,v.D5U.sizeFromShape(k),S,i.dtype);t=r.makeTensorInfo(S,i.dtype);let $=r.texData.get(t.dataId);$.values=T}else t=/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r){let a=v.D5U.sizeFromShape(t),i=v.D5U.sizeFromShape(e.shape),s=uu({inputs:{x:e},attrs:{shape:[i/a,a]},backend:r}),o=up(s,e.dtype,"max",r),l=uu({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(o),l}(f,k,S,r);return d&&r.disposeIntermediateTensorInfo(f),t}let dX={kernelName:v.YoZ,backendName:"webgl",kernelFunc:dK},dq=lq+`
  return max(a, b);
`,dY=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+lQ+`
  return result;
`,dQ=ut({opSnippet:dq,packedOpSnippet:dY,cpuKernelImpl:o9}),dZ={kernelName:v.BMI,backendName:"webgl",kernelFunc:dQ},dJ={kernelName:v.mTV,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;ok(a,"maxPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=r;v.D5U.assert(v.Wap.eitherStridesOrDilationsAreOne(s,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '1'`);let u=v.Wap.computePool2DInfo(a.shape,i,s,1,o,l);if(1===u.filterWidth&&1===u.filterHeight&&v.D5U.arraysEqual(u.inShape,u.outShape))return lJ({inputs:{x:a},backend:n});let h=new u6(u,"max",!1);return n.runWebGLProgram(h,[a],a.dtype)}},d0={kernelName:v.OAf,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dataFormat:l,dimRoundingMode:u}=r,h=v.Wap.computePool3DInfo(a.shape,i,s,[1,1,1],o,u,l),c=new u5(h,"max",!1);return n.runWebGLProgram(c,[a],a.dtype)}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class d1{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,a=e.effectiveFilterHeight,i=e.effectiveFilterWidth,s=a-1-e.padInfo.top,o=i-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${a};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${n}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${a*i-1} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class d2{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.dilationDepth,i=e.dilationHeight,s=e.dilationWidth,o=e.effectiveFilterDepth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,h=o-1-e.padInfo.front,c=l-1-e.padInfo.top,d=u-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${h}, ${c}, ${d});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${o};
           wD += ${a}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${l};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${n}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${s}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${o*l*u-1} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${l} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}let d3={kernelName:v.OU7,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=r,h=v.Wap.computePool3DInfo(i.shape,s,o,[1,1,1],l,u),c=new u5(h,"max",!0),d=n.runWebGLProgram(c,[i],i.dtype),p=new d2(h),f=n.runWebGLProgram(p,[a,d],i.dtype);return n.disposeIntermediateTensorInfo(d),f}},d4={kernelName:v.OV7,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i,output:s}=t;ok([i,s],"maxPoolGrad");let{filterSize:o,strides:l,pad:u,dimRoundingMode:h}=r,c=v.Wap.computePool2DInfo(i.shape,o,l,1,u,h),d=new u6(c,"max",!0),p=n.runWebGLProgram(d,[i],i.dtype),f=new d1(c),m=n.runWebGLProgram(f,[a,p],i.dtype);return n.disposeIntermediateTensorInfo(p),m}},d6={kernelName:v.vFR,backendName:"webgl",kernelFunc({inputs:e,attrs:t,backend:n}){let{x:r}=e,{filterSize:a,strides:i,pad:s,includeBatchInIndex:o}=t;v.D5U.assert(4===r.shape.length,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);let l=[1,1];v.D5U.assert(v.Wap.eitherStridesOrDilationsAreOne(i,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${l}'`);let u=v.Wap.computePool2DInfo(r.shape,a,i,l,s),[h,c]=/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r){let a=new u6(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");a=new u6(n,"max",!0,!0,t);let s=r.runWebGLProgram(a,[e],"float32");return[i,s]}(r,o,u,n);return[h,c]}},d5={kernelName:v.q2K,backendName:"webgl",kernelFunc({inputs:e,attrs:t,backend:n}){let{x:r}=e,{keepDims:a,axis:i}=t,s=r.shape.length,o=v.D5U.parseAxisParam(i,r.shape),l=o,u=v.Wap.getAxesPermutation(l,s),h=n.shouldExecuteOnCPU([r]),c=[],d=r;if(null!=u){if(h){let p=n.texData.get(d.dataId),f=p.values,m=Array(s);for(let g=0;g<m.length;g++)m[g]=r.shape[u[g]];let y=lS(f,r.shape,r.dtype,u,m);d=n.makeTensorInfo(m,r.dtype);let b=n.texData.get(d.dataId);b.values=y}else d=ug(r,u,n);c.push(d),l=v.Wap.getInnerMostAxes(l.length,s)}v.Wap.assertAxesAreInnerMostDims("sum",l,s);let[x,w]=v.Wap.computeOutAndReduceShapes(d.shape,l),I=x;a&&(I=v.Wap.expandShapeToKeepDim(x,o));let k=/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e,t,n,r){let a=v.D5U.sizeFromShape(t),i=v.D5U.sizeFromShape(e.shape),s=uu({inputs:{x:e},attrs:{shape:[i/a,a]},backend:r}),o=up(s,"float32","mean",r),l=uu({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(o),l}(d,w,I,n);for(let S of c)n.disposeIntermediateTensorInfo(S);return k}},d7={kernelName:v.c17,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t;let{inputs:n,backend:r,attrs:a}=e,{x:i}=n,{axis:s,keepDims:o}=a,l=i.shape.length,u=v.D5U.parseAxisParam(s,i.shape),h=u,c=v.Wap.getAxesPermutation(h,l),d=i;null!=c&&(d=ux({inputs:{x:i},backend:r,attrs:{perm:c}}),h=v.Wap.getInnerMostAxes(h.length,i.shape.length)),v.Wap.assertAxesAreInnerMostDims("min",h,l);let[p,f]=v.Wap.computeOutAndReduceShapes(d.shape,h),m=v.D5U.sizeFromShape(f),g=uu({inputs:{x:d},backend:r,attrs:{shape:[-1,m]}}),y=up(g,g.dtype,"min",r);if(o){let b=v.Wap.expandShapeToKeepDim(p,u);t=uu({inputs:{x:y},backend:r,attrs:{shape:b}})}else t=uu({inputs:{x:y},backend:r,attrs:{shape:p}});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(y),null!=c&&r.disposeIntermediateTensorInfo(d),t}},d8=lq+`
  return min(a, b);
`,d9=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+lQ+`
  return result;
`,pe=ut({opSnippet:d8,packedOpSnippet:d9,cpuKernelImpl:le}),pt={kernelName:v.q8u,backendName:"webgl",kernelFunc:pe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class pn{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let r=e.length,a=(0,oE.kW)(r),i=t.map(e=>e[0]).join(","),s=t.map((t,n)=>t[0]+e[n]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),l="reflect"===n?0:1;if(1===r){this.userCode=`
        int start = ${i};
        int end = ${s};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${l};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${l};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${i});
      ${a} end = ${a}(${s});

      void main() {
        ${a} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${l};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${l};
          }
        }
        ${a} coords = outC - start;
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class pr{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let r=e.length,a=(0,oE.kW)(r),i=t.map(e=>e[0]).join(","),s=t.map((t,n)=>t[0]+e[n]).join(","),o=lT("rc",r),l=lT("source",r),u=`${o[r-1]} < ${this.outputShape[r-1]}`,h=1===r?"source":`vec2(${l.slice(-2).join()})`,c="reflect"===n?0:1,d="";if(1===r){let p=`
        ${a} source = rc;
        if (source < start) {
          source = start * 2 - source - ${c};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${c};
        }
        source -= start;
      `;d=`
        ${a} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${l.join()}), ${h});
        ${o[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${l.join()}), ${h});
        }
      `}else{let f=`
        ${a} source = rc;
        ${a} lt = ${a}(lessThan(source, start));
        ${a} gte = ${a}(greaterThanEqual(source, end));
        ${a} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${c}) +
                gte * ((end - 1) * 2 - source + ${c});
        source -= start;
      `;d=`
        ${a} rc = outputLoc;
        ${f}
        result[0] = getChannel(getX(${l.join()}), ${h});
        ${o[r-1]} += 1;
        if(${u}) {
          ${f}
          result[1] = getChannel(getX(${l.join()}), ${h});
        }
        rc = outputLoc;
        ${o[r-2]} += 1;
        if(${o[r-2]} < ${this.outputShape[r-2]}) {
          ${f}
          result[2] = getChannel(getX(${l.join()}), ${h});
          ${o[r-1]} += 1;
          if(${u}) {
            ${f}
            result[3] = getChannel(getX(${l.join()}), ${h});
          }
        }
      `}this.userCode=`
      const ${a} start = ${a}(${i});
      const ${a} end = ${a}(${s});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${d}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let pa=({inputs:e,backend:t,attrs:n})=>{let{x:r}=e,{paddings:a,mode:i}=n,s=(0,v.OBj)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new pr(r.shape,a,i):new pn(r.shape,a,i),o=t.runWebGLProgram(s,[r],r.dtype);return o},pi={kernelName:v.jQs,backendName:"webgl",kernelFunc:pa},ps=`if (b == 0.0) return NAN;
  return mod(a, b);`,po=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+lQ+`
  return result;
`,pl=ut({opSnippet:ps,packedOpSnippet:po}),pu={kernelName:v.Vbg,backendName:"webgl",kernelFunc:pl};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class ph{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let pc=`
if (a == b) {
  return 1.0;
};
return a / b;`,pd=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,pp=ut({opSnippet:pc,packedOpSnippet:pd,checkOutOfBounds:!0}),pf={kernelName:v.oHH,backendName:"webgl",kernelFunc:pp},pm="return a - b;",pg=ut({opSnippet:pm,packedOpSnippet:pm,supportsComplex:!0,cpuKernelImpl:lw}),py={kernelName:v.Tr8,backendName:"webgl",kernelFunc:pg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function pb(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{dim:i}=r,s=v.D5U.parseAxisParam([i],a.shape),o=dK({inputs:{x:a},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),l=v.Wap.expandShapeToKeepDim(o.shape,s),u=uu({inputs:{x:o},backend:n,attrs:{shape:l}}),h=pg({inputs:{a:a,b:u},backend:n}),c=cO({inputs:{x:h},backend:n}),d=uy({inputs:{x:c},backend:n,attrs:{axis:s,keepDims:!1}}),p=uu({inputs:{x:d},backend:n,attrs:{shape:l}}),f=pp({inputs:{a:c,b:p},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),f}let px={kernelName:v.Gcp,backendName:"webgl",kernelFunc:pb},pv={kernelName:v.NZg,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:i,seed:s,normalized:o}=r,l=o?a:pb({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),u=l.shape[0],h=l.shape[1],c=new ph(u,h,i),d=n.runWebGLProgram(c,[l],"int32",[[s]]);return o||n.disposeIntermediateTensorInfo(l),d}},pw=lO+`
  return -x;
`,pI=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,pk={kernelName:v.kuV,backendName:"webgl",kernelFunc:function(e){let t;let{inputs:n,backend:r}=e,{x:a}=n;if(r.shouldExecuteOnCPU([a])){let i=r.texData.get(a.dataId),[s,o]=ln(i.values,a.shape,a.dtype);return r.makeTensorInfo(o,a.dtype,s)}return t=(0,v.OBj)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new lV(a.shape,pI):new l_(a.shape,pw),r.runWebGLProgram(t,[a],a.dtype)}},pS=v.GDt.GP,pC={kernelName:v.uv1,backendName:"webgl",kernelFunc:function(e){v.Wap.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=r,u=n.readSync(a.dataId),h=n.readSync(i.dataId),{selectedIndices:c}=pS(u,h,s,o,l);return n.makeTensorInfo([c.length],"int32",new Int32Array(c))}},pE=v.GDt.qP,pT={kernelName:v.cye,backendName:"webgl",kernelFunc:function(e){v.Wap.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=r,h=n.readSync(a.dataId),c=n.readSync(i.dataId),{selectedIndices:d,validOutputs:p}=pE(h,c,s,o,l,u);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},p$=v.GDt.pA,pN={kernelName:v.W0H,backendName:"webgl",kernelFunc:function(e){v.Wap.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=r,h=n.readSync(a.dataId),c=n.readSync(i.dataId),{selectedIndices:d,selectedScores:p}=p$(h,c,s,o,l,u);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([p.length],"float32",new Float32Array(p))]}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class pA{constructor(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${n}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let pD=e=>{let{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:i,depth:s,onValue:o,offValue:l}=r,u=v.D5U.sizeFromShape(a.shape),h=new pA(u,s,o,l),c=uu({inputs:{x:a},backend:n,attrs:{shape:[u]}}),d=n.runWebGLProgram(h,[c],i);n.disposeIntermediateTensorInfo(c);let p=[...a.shape,s],f=uu({inputs:{x:d},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(d),f},pF={kernelName:v.we_,backendName:"webgl",kernelFunc:pD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function pR(e){let{inputs:t,backend:n}=e,{x:r}=t;if("complex64"!==r.dtype)return cH({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n});{let a=hx({inputs:{input:r},backend:n}),i=pR({inputs:{x:a},backend:n}),s=h_({inputs:{input:r},backend:n}),o=pR({inputs:{x:s},backend:n}),l=l1({inputs:{real:i,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}}let p_={kernelName:v.RuY,backendName:"webgl",kernelFunc:pR},pO={kernelName:v.qWM,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function e(t){let{inputs:n,backend:r}=t,{x:a}=n;if("string"===a.dtype)throw Error("onesLike is not supported under string dtype");if("complex64"!==a.dtype)return cH({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r});{let i=hx({inputs:{input:a},backend:r}),s=e({inputs:{x:i},backend:r}),o=h_({inputs:{input:a},backend:r}),l=pR({inputs:{x:o},backend:r}),u=l1({inputs:{real:s,imag:l},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(l),u}}},pM={kernelName:v.QiL,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(1===t.length)return cB({inputs:{input:t[0]},backend:n,attrs:{dim:a}});let i=t[0].shape,s=t[0].dtype;t.forEach(e=>{v.D5U.assertShapesMatch(i,e.shape,"All tensors passed to stack must have matching shapes"),v.D5U.assert(s===e.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=t.map(e=>{let t=cB({inputs:{input:e},backend:n,attrs:{dim:a}});return o.push(t),t}),u=hM({inputs:l,backend:n,attrs:{axis:a}});return o.forEach(e=>n.disposeIntermediateTensorInfo(e)),u}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class pB{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let r=e.length,a=(0,oE.kW)(r),i=t.map(e=>e[0]).join(","),s=t.map((t,n)=>t[0]+e[n]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(1===r){this.userCode=`
        int start = ${i};
        int end = ${s};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${i});
      ${a} end = ${a}(${s});

      void main() {
        ${a} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${a} coords = outC - start;
          setOutput(getX(${o}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class pP{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let r=e.length,a=(0,oE.kW)(r),i=t.map(e=>e[0]).join(","),s=t.map((t,n)=>t[0]+e[n]).join(","),o=lT("rc",r),l=lT("source",r),u=`${o[r-1]} < ${this.outputShape[r-1]}`,h=1===r?"source":`vec2(${l.slice(-2).join()})`,c=[`${a} rc = outputLoc;`,`${o[r-1]} += 1;
       if(${u}) {
      `,1===r?"":`}
       rc = outputLoc;
       ${o[r-2]} += 1;
       if(${o[r-2]} < ${this.outputShape[r-2]}) {`,1===r?"":`  ${o[r-1]} += 1;
         if(${u}) {`],d=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="";for(let f=0,m=1===r?2:4;f<m;f++)p+=`
        ${c[f]}
        if (${d}) {
          result[${f}] = float(value);
        } else {
          ${a} source = rc - start;
          result[${f}] = getChannel(getX(${l.join()}), ${h});
        }
      `;p+=1===r?"} ":"}}",this.userCode=`
      const ${a} start = ${a}(${i});
      const ${a} end = ${a}(${s});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let pL=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:i,constantValue:s}=r;if(0===v.D5U.sizeFromShape(a.shape)){let o=i.map((e,t)=>e[0]+a.shape[t]+e[1]);return cH({backend:n,attrs:{shape:o,value:s,dtype:a.dtype}})}let l=(0,v.OBj)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new pP(a.shape,i,s):new pB(a.shape,i,s);return n.runWebGLProgram(l,[a],a.dtype,[[s]])},pU={kernelName:v.lyA,backendName:"webgl",kernelFunc:pL},pW=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,pz=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+lQ+`
  return result;
`,pV=ut({opSnippet:pW,packedOpSnippet:pz}),pG={kernelName:v.pe_,backendName:"webgl",kernelFunc:pV},pj={kernelName:v.DlI,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t;let{inputs:n,backend:r,attrs:a}=e,{x:i}=n,{axis:s,keepDims:o}=a,l=i.shape.length,u=[],h=v.D5U.parseAxisParam(s,i.shape),c=h,d=v.Wap.getAxesPermutation(c,l),p=i;if(null!=d&&(p=ux({inputs:{x:i},backend:r,attrs:{perm:d}}),c=v.Wap.getInnerMostAxes(c.length,l),u.push(p)),v.Wap.assertAxesAreInnerMostDims("prod",c,l),r.shouldExecuteOnCPU([p])){let f=r.texData.get(p.dataId).values,{outVals:m,outShape:g,outDtype:y}=la(p.shape,p.dtype,f,c);t=r.makeTensorInfo(g,y,m)}else{let[b,x]=v.Wap.computeOutAndReduceShapes(p.shape,c),w=v.D5U.sizeFromShape(x),I=uu({inputs:{x:p},backend:r,attrs:{shape:[-1,w]}}),k=(0,v.z4k)(i.dtype),S=up(I,k,"prod",r);t=uu({inputs:{x:S},backend:r,attrs:{shape:b}}),u.push(I),u.push(S)}if(o){u.push(t);let C=v.Wap.expandShapeToKeepDim(t.shape,h);t=uu({inputs:{x:t},backend:r,attrs:{shape:C}})}return u.forEach(e=>r.disposeIntermediateTensorInfo(e)),t}},pH={kernelName:v.dDz,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:a,paramsDenseValues:i,indices:s}=t,{outputRaggedRank:o}=r,l=a.map(e=>n.readSync(e.dataId)),u=a.map(e=>e.shape),h=n.readSync(i.dataId),c=n.readSync(s.dataId),[d,p,f]=li(l,u,h,i.shape,i.dtype,c,s.shape,o),m=d.map(e=>n.makeTensorInfo([e.length],"int32",e)),g=n.makeTensorInfo(f,i.dtype,p);return m.concat([g])}},pK={kernelName:v.BiW,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{shape:a,values:i,defaultValue:s,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,u=n.readSync(a.dataId),h=n.readSync(i.dataId),c=n.readSync(s.dataId),d=o.map(e=>n.readSync(e.dataId)),p=o.map(e=>e.shape),[f,m]=ls(u,a.shape,h,i.shape,i.dtype,c,s.shape,d,p,l);return n.makeTensorInfo(f,i.dtype,m)}},pX=e=>{let{backend:t,attrs:n}=e,{start:r,stop:a,step:i,dtype:s}=n,o=lo(r,a,i,s);return t.makeTensorInfo([o.length],s,o)},pq={kernelName:v.e6w,backendName:"webgl",kernelFunc:pX},pY=ue({opSnippet:"return 1.0 / x;"}),pQ={kernelName:v.$HU,backendName:"webgl",kernelFunc:pY},pZ=lO+`
  return (x < 0.0) ? 0.0 : x;
`,pJ=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,p0=ue({opSnippet:pZ,packedOpSnippet:pJ}),p1={kernelName:v.qkr,backendName:"webgl",kernelFunc:p0},p2=lO+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,p3=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,p4=ue({opSnippet:p2,packedOpSnippet:p3}),p6={kernelName:v.SbG,backendName:"webgl",kernelFunc:p4};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class p5{constructor(e,t,n,r,a){this.variableNames=["A"],this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let u=[r&&t>1?s-1:s,r&&n>1?o-1:o],h=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/h[0]},
          ${u[1]/h[1]});
      const vec2 inputShapeRC = vec2(${s}.0, ${o}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${a?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC"};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class p7{constructor(e,t,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let u=[r&&t>1?s-1:s,r&&n>1?o-1:o],h=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/h[0]},
          ${u[1]/h[1]},
          ${u[1]/h[1]});
      const vec3 inputShapeRC = vec3(${s}.0, ${o}.0,
                                     ${o}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${a?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC"};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${n-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}let p8={kernelName:v._Yw,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:s,size:o}=r,[l,u]=o,h=(0,v.OBj)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new p7(a.shape,l,u,i,s):new p5(a.shape,l,u,i,s);return n.runWebGLProgram(h,[a],"float32")}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class p9{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,r,a]=t,[,i,s]=e,o=[n&&i>1?r-1:r,n&&s>1?a-1:a],l=[n&&i>1?i-1:i,n&&s>1?s-1:s],u=o[0]/l[0],h=o[1]/l[1],c=1/u,d=1/h,p=2*Math.ceil(c)+2,f=2*Math.ceil(d)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${h});

        const float invHeightScale = float(${c});
        const float invWidthScale = float(${d});

        const int winHeight = int(${p});
        const int winWidth = int(${f});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${s}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${a-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}let fe={kernelName:v.zbQ,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r,o=new p9(i.shape,a.shape,s);return n.runWebGLProgram(o,[i],i.dtype)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class ft{constructor(e,t,n,r,a){this.variableNames=["A"],this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let u=[r&&t>1?s-1:s,r&&n>1?o-1:o],h=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/h[0]},
          ${u[1]/h[1]});
      const vec2 inputShapeRC = vec2(${s}.0, ${o}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${a?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC"};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${r?"0.5":"0.0"})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class fn{constructor(e,t,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let u=[r&&t>1?s-1:s,r&&n>1?o-1:o],h=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/h[0]},
          ${u[1]/h[1]},
          ${u[1]/h[1]});
      const vec3 inputShapeRC = vec3(${s}.0, ${o}.0,
                                     ${o}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${a?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC"};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${r?"0.5":"0.0"})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${n-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}let fr={kernelName:v.dpD,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:s,size:o}=r,[l,u]=o,h=(0,v.OBj)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new fn(a.shape,l,u,i,s):new ft(a.shape,l,u,i,s);return n.runWebGLProgram(h,[a],a.dtype)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class fa{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,r,a]=t,[,i,s]=e,o=[n&&i>1?r-1:r,n&&s>1?a-1:a],l=[n&&i>1?i-1:i,n&&s>1?s-1:s],u=o[0]/l[0],h=o[1]/l[1],c=1/u,d=1/h,p=2*Math.ceil(c)+2,f=2*Math.ceil(d)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${h});

        const float invHeightScale = float(${c});
        const float invWidthScale = float(${d});

        const int winHeight = int(${p});
        const int winWidth = int(${f});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${s}) {
              continue;
            }

            float sourceFracRow =
              float(${o[0]}) *
                (float(dyR) / float(${l[0]}));

            float sourceFracCol =
                float(${o[1]}) *
                  (float(dyC) / float(${l[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${n} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${a}) - 1),
                ${n} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}let fi={kernelName:v.Hmb,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r,o=new fa(i.shape,a.shape,s);return n.runWebGLProgram(o,[i],i.dtype)}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class fs{constructor(e,t){this.variableNames=["x"];let n=e.length;if(n>4)throw Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=e,1===n){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}let r=n=>-1!==t.indexOf(n)&&1!==e[n]?`${e[n]} - coords[${n}] - 1`:`coords[${n}]`,a=e.map((e,t)=>r(t)).join(","),i=(0,oE.kW)(n);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class fo{constructor(e,t){var n,r,a;this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;let i=e.length;if(i>4)throw Error(`WebGL backend: Reverse of rank-${i} tensor is not yet supported`);this.outputShape=e;let s=lT("rc",i),o=`${s[i-1]} + 1 < ${this.outputShape[i-1]}`,l=`${s[i-2]} + 1 < ${this.outputShape[i-2]}`,u=(0,oE.kW)(i);function h(n){let r=e.map((r,a)=>-1!==t.indexOf(a)&&1!==e[a]?`${e[a]} - ${n[a]} - 1`:`${n[a]}`),a=r.join(","),i=r.slice(-2).join(",");return`getChannel(getX(${a}), vec2(${i}))`}1===i?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${o}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${u} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${h(s.slice())};
          if(${o}){
            result.g = ${(n=s.slice())[i-1]="("+n[i-1]+" + 1)",h(n)};
          }
          if(${l}) {
            result.b = ${(r=s.slice())[i-2]="("+r[i-2]+" + 1)",h(r)};
            if(${o}) {
              result.a = ${(a=s.slice())[i-1]="("+a[i-1]+" + 1)",a[i-2]="("+a[i-2]+" + 1)",h(a)};
            }
          }
          setOutput(result);
        }
    `}}let fl={kernelName:v.mKl,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:i}=r,s=a.shape.length,o=v.D5U.parseAxisParam(i,a.shape);if(0===s)return lJ({inputs:{x:a},backend:n});let l=(0,v.OBj)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new fo(a.shape,o):new fs(a.shape,o);return n.runWebGLProgram(l,[a],a.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class fu{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];let n=e[1],r=e[2];this.outputShape=e;let a="";a="number"==typeof t?`float outputValue = ${t.toFixed(2)};`:`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${a}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${n}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ let fh={kernelName:v.b9H,backendName:"webgl",kernelFunc({inputs:e,attrs:t,backend:n}){let{image:r}=e,{radians:a,fillValue:i,center:s}=t,o=new fu(r.shape,i),[l,u]=v.Wap.getImageCenter(s,r.shape[1],r.shape[2]),h=[[l,u,Math.sin(a),Math.cos(a)]],c=n.runWebGLProgram(o,[r],r.dtype,h);return c}},fc=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,fd=ue({opSnippet:fc}),fp={kernelName:v.e07,backendName:"webgl",kernelFunc:fd},ff=ue({opSnippet:"return inversesqrt(x);",cpuKernelImpl:ll}),fm={kernelName:v.bV0,backendName:"webgl",kernelFunc:ff};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class fg{constructor(e,t,n,r,a,i,s=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;let o=(0,oE.kW)(a.length),l=(0,oE.kW)(i.length),u="";1===n?u="i":2===n&&(u="i, j");let h=`getIndices(${u})`,c="";1===r?c="i":2===r&&(c="i, coords[1]");let d=`getUpdates(${c})`;this.userCode=`
        ${o} strides = ${o}(${a});

        void main() {
          ${l} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${t>1?"strides[j]":"strides"};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${d};
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}}let fy={kernelName:v.xQA,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{indices:a,updates:i}=t,{shape:s}=r,{sliceRank:o,numUpdates:l,sliceSize:u,strides:h,outputSize:c}=v.Wap.calculateShapes(i,a,s);if(0===c)return n.makeTensorInfo(s,a.dtype);let d=uu({inputs:{x:a},backend:n,attrs:{shape:[l,o]}}),p=uu({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),f=n.makeTensorInfo([],"float32",new Float32Array([0])),m=new fg(l,o,d.shape.length,p.shape.length,h,[c/u,u]),g=n.runWebGLProgram(m,[p,d,f],p.dtype),y=uu({inputs:{x:g},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(f),y}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class fb{constructor(e,t,n,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];let a=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,i=2===(0,v.OBj)().getNumber("WEBGL_VERSION")?"while (left < right) {":a;this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${i}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${"left"===r?"<":"<="} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}let fx={kernelName:v.nr8,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:i}=t,{side:s}=r,o=new fb(a.shape[0],a.shape[1],i.shape[1],s),l=[[a.shape[1]]];return n.runWebGLProgram(o,[a,i],"int32",l)}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class fv{constructor(e,t,n){let r,a;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error(`Where for rank ${n} is not yet supported`);if(1===n)a="resRC",r="resRC";else{let i=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],o=[];for(let l=0;l<t.length;l++)o.push(`${i[l]}`),l<e&&s.push(`${i[l]}`);r=s.join(),a=o.join()}let u=(0,oE.kW)(n);this.userCode=`
      void main() {
        ${u} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${a}));
        } else {
          setOutput(getB(${a}));
        }
      }
    `}}let fw={kernelName:v.PhF,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{condition:r,t:a,e:i}=t,s=new fv(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(s,[r,a,i],(0,v.x8V)(a.dtype,i.dtype))}},fI=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${v.Wap.SELU_SCALEALPHA};
  float scale = ${v.Wap.SELU_SCALE};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,fk=ue({opSnippet:fI}),fS={kernelName:v.oFR,backendName:"webgl",kernelFunc:fk},fC=l9+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,fE=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,fT=ue({opSnippet:fC,packedOpSnippet:fE,cpuKernelImpl:lh}),f$={kernelName:v.a5O,backendName:"webgl",kernelFunc:fT},fN=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,fA=ue({opSnippet:fN}),fD={kernelName:v.i5y,backendName:"webgl",kernelFunc:fA},fF=l9+`
  return sin(x);
`,fR=ue({opSnippet:fF}),f_={kernelName:v.RQH,backendName:"webgl",kernelFunc:fR},fO=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,fM=ue({opSnippet:fO}),fB={kernelName:v.wYB,backendName:"webgl",kernelFunc:fM},fP=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,fL=ue({opSnippet:fP}),fU={kernelName:v.MRv,backendName:"webgl",kernelFunc:fL},fW=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,paddings:s}=r;v.D5U.assert(a.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");let o=i.reduce((e,t)=>e*t),l=[[0,0]];l.push(...s);for(let u=1+i.length;u<a.shape.length;++u)l.push([0,0]);let h=[],c=pL({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),d=v.Wap.getReshaped(c.shape,i,o,!1),p=v.Wap.getPermuted(d.length,i.length,!1),f=v.Wap.getReshapedPermuted(c.shape,i,o,!1),m=uu({inputs:{x:c},backend:n,attrs:{shape:d}}),g=ux({inputs:{x:m},backend:n,attrs:{perm:p}}),y=uu({inputs:{x:g},backend:n,attrs:{shape:f}});return h.push(c),h.push(m),h.push(g),h.forEach(e=>n.disposeIntermediateTensorInfo(e)),y},fz={kernelName:v.TQc,backendName:"webgl",kernelFunc:fW},fV={kernelName:v.O3z,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{indices:r,values:a,denseShape:i,defaultValue:s}=t;if(1!==i.shape.length)throw Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(2!==r.shape.length)throw Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(1!==a.shape.length)throw Error(`Values must be a vector, saw:
         ${a.shape}`);if(0!==s.shape.length)throw Error(`Default value must be a scalar, saw:
        ${s.shape}`);let o=n.readSync(r.dataId),l=n.readSync(a.dataId),u=n.readSync(i.dataId),h=n.readSync(s.dataId)[0],[c,d,p,f,m]=lp(o,r.shape,r.dtype,l,a.dtype,u,h);return[n.makeTensorInfo(d,r.dtype,c),n.makeTensorInfo([d[0]],a.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(e=>Number(e)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}},fG={kernelName:v.nhH,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{inputIndices:r,inputShape:a,newShape:i}=t;if(2!==r.shape.length)throw Error(`Input indices should be a matrix but received shape ${r.shape}`);if(1!==a.shape.length)throw Error(`Input shape should be a vector but received shape ${a.shape}`);if(1!==i.shape.length)throw Error(`Target shape should be a vector but received shape ${i.shape}`);let s=Array.from(n.readSync(a.dataId)),o=n.readSync(r.dataId),l=Array.from(n.readSync(i.dataId)),[u,h,c]=lf(o,r.shape,r.dtype,s,l);return[n.makeTensorInfo(h,r.dtype,u),n.makeTensorInfo([c.length],i.dtype,new Int32Array(c))]}},fj={kernelName:v.w3H,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw Error(`Indices should be a vector but received shape
              ${a.shape}`);if(1!==i.shape.length)throw Error(`Segment ids should be a vector but received shape
              ${i.shape}`);let s=n.readSync(r.dataId),o=n.readSync(a.dataId),l=n.readSync(i.dataId),[u,h]=lm(s,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(h,r.dtype,u)}},fH={kernelName:v.ZjV,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw Error(`Indices should be a vector but received shape
             ${a.shape}`);if(1!==i.shape.length)throw Error(`Segment ids should be a vector but received shape
             ${i.shape}`);let s=n.readSync(r.dataId),o=n.readSync(a.dataId),l=n.readSync(i.dataId),[u,h]=lm(s,r.shape,r.dtype,o,l);return n.makeTensorInfo(h,r.dtype,u)}},fK={kernelName:v.D2d,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{sparseIndices:a,sparseValues:i,defaultValue:s}=t,{outputShape:o}=r,{sliceRank:l,numUpdates:u,sliceSize:h,strides:c,outputSize:d}=v.Wap.calculateShapes(i,a,o);if("string"===i.dtype){let p=n.bufferSync(a),f=n.bufferSync(i),m=v.D5U.decodeString(n.readSync(s.dataId)[0]),g=lu(p,f,o,d,h,u,l,c,m,!1);return n.makeTensorInfo(o,g.dtype,g.values)}let y=new fg(u,l,a.shape.length,i.shape.length,c,[d,1],!1),b=n.runWebGLProgram(y,[i,a,s],i.dtype),x=uu({inputs:{x:b},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(b),x}},fX={kernelName:v.L8s,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{numOrSizeSplits:i,axis:s}=r,o=v.D5U.parseAxisParam(s,a.shape)[0],l=v.Wap.prepareSplitSize(a,i,o),u=a.shape.length,h=Array(u).fill(0),c=a.shape.slice();return l.map(e=>{let t=[...c];t[o]=e;let r=hc({inputs:{x:a},backend:n,attrs:{begin:h,size:t}});return h[o]+=e,r})}},fq="return sqrt(x);",fY=ue({opSnippet:fq,packedOpSnippet:fq,cpuKernelImpl:lg}),fQ={kernelName:v.FKq,backendName:"webgl",kernelFunc:fY},fZ=ue({opSnippet:"return x * x;"}),fJ={kernelName:v.bK0,backendName:"webgl",kernelFunc:fZ},f0="return (a - b) * (a - b);",f1=ut({opSnippet:f0,packedOpSnippet:f0}),f2={kernelName:v._tC,backendName:"webgl",kernelFunc:f1},f3={kernelName:v.h8e,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function({inputs:e,attrs:t,backend:n}){let{x:r}=e,a=lO+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,i=new l_(r.shape,a);return n.runWebGLProgram(i,[r],r.dtype)}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class f4{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;let r=n.length,a=(0,oE.kW)(n.length),i=(0,oE.kW)(n.length),s="";if(1===r)s="coords * strides + begin";else{let o=0;s=n.map((e,t)=>(o++,1===n.length?`coords * strides[${t}] + begin[${t}]`:`coords[${o-1}] * strides[${t}] + begin[${t}]`)).join(",")}this.userCode=`
      ${a} begin = ${a}(${e});
      ${a} strides = ${a}(${t});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${s}));
      }
    `}}let f6={kernelName:v.jQk,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let t;let{inputs:n,backend:r,attrs:a}=e,{x:i}=n,{begin:s,end:o,strides:l,beginMask:u,endMask:h,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:p}=a,{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:y,isSimpleSlice:b,begin:x,end:w,strides:I}=v.kuN.sliceInfo(i.shape,s,o,l,u,h,c,d,p);if(g)t=uu({inputs:{x:i},backend:r,attrs:{shape:m}});else if(y||b){v.D5U.assert(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);let k=v.kuN.computeOutShape(x,w,I),S=hc({inputs:{x:i},backend:r,attrs:{begin:x,size:k}});t=uu({inputs:{x:S},backend:r,attrs:{shape:m}}),r.disposeIntermediateTensorInfo(S)}else{let C=r.shouldExecuteOnCPU([i]);if(C){let E=r.readSync(i.dataId),T=(0,v.f3b)(i.shape,i.dtype,E),$=ly(f,T,I,x);t=r.makeTensorInfo(m,i.dtype,$.values)}else{let N=new f4(x,I,f);t=r.runWebGLProgram(N,[i],i.dtype)}}let A=uu({inputs:{x:t},backend:r,attrs:{shape:m}});return r.disposeIntermediateTensorInfo(t),A}},f5={kernelName:v._JP,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{separator:a,nGramWidths:i,leftPad:s,rightPad:o,padWidth:l,preserveShortSequences:u}=r,{data:h,dataSplits:c}=t,d=n.readSync(h.dataId),p=n.readSync(c.dataId),[f,m]=lb(d,p,a,i,s,o,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(c.shape,"int32",m)]}},f7={kernelName:v.s1s,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{skipEmpty:a}=r,{input:i,delimiter:s}=t;if("string"!==i.dtype)throw Error("Input must be of datatype string");if(1!==i.shape.length)throw Error(`Input must be a vector, got shape: ${i.shape}`);if(0!==s.shape.length)throw Error(`Delimiter must be a scalar, got shape: ${s.shape}`);let o=n.readSync(i.dataId),l=n.readSync(s.dataId)[0],[u,h,c]=lx(o,l,a),d=h.length;return[n.makeTensorInfo([d,2],"int32",u),n.makeTensorInfo([d],"string",h),n.makeTensorInfo([2],"int32",new Int32Array(c))]}},f8={kernelName:v.XkS,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{numBuckets:a}=r,{input:i}=t;if("string"!==i.dtype)throw Error("Input must be of datatype string");if(a<=0)throw Error("Number of buckets must be at least 1");let s=n.readSync(i.dataId),o=lv(s,a);return n.makeTensorInfo(i.shape,"int32",o)}},f9=ue({opSnippet:"return tan(x);"}),me={kernelName:v.sEM,backendName:"webgl",kernelFunc:f9},mt=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,mn=ue({opSnippet:mt}),mr={kernelName:v.MIZ,backendName:"webgl",kernelFunc:mn};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class ma{constructor(e,t){this.variableNames=["A"];let n=Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;let a=(0,oE.kW)(this.rank),i=function(e){let t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(1===t)return`imod(resRC, ${e[0]})`;let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let a=0;a<e.length;a++)r.push(`imod(${n[a]}, ${e[a]})`);return r.join()}(e);this.userCode=`
      void main() {
        ${a} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function mi(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reps:i}=r;if("string"===a.dtype||a.shape.length>5){let s=n.readSync(a.dataId),o="string"===a.dtype?s.map(e=>v.D5U.decodeString(e)):s,l=(0,v.f3b)(a.shape,a.dtype,o),u=lI(l,i);return n.makeTensorInfo(u.shape,u.dtype,u.values)}let h=new ma(a.shape,i),c=n.runWebGLProgram(h,[a],a.dtype);return c}let ms={kernelName:v.n9L,backendName:"webgl",kernelFunc:mi};class mo{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class ml{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function mu(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function mh(e){let t=1;for(;t<e;)t*=2;return t}let mc={kernelName:v.cWu,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{k:i,sorted:s}=r,o=(0,v.OBj)().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=(0,v.OBj)().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=a.shape,h=u[u.length-1];if(n.shouldExecuteOnCPU([a])||h<o||i>l){let c=n.readSync(a.dataId),[d,p]=lk(c,u,a.dtype,i,s);return[n.makeTensorInfo(d.shape,d.dtype,d.values),n.makeTensorInfo(p.shape,p.dtype,p.values)]}if(0===i)return u[u.length-1]=0,[n.makeTensorInfo(u,a.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(1===h)return[a,cH({attrs:{shape:u,dtype:"int32",value:0},backend:n})];let f=n.texData.get(a.dataId),m=null!==f&&f.isPacked,g=m?n.unpackTensor(a):a,y=v.D5U.sizeFromShape(u),b=y/h,x=uu({inputs:{x:g},attrs:{shape:[b,h]},backend:n});m&&mu(n,g);let w=mh(i),I=mh(h),k=null,S=()=>null===k?[x,x]:[x,k],C=(e,t,r)=>{let a=S(),i=new mo(r),s=null===k?1:0,o=[[h],[s],[Number.NEGATIVE_INFINITY],[e],[t]],l=k;k=n.runWebGLProgram(i,a,"int32",o),mu(n,l)};for(let E=1;E<w;E*=2){let T=2*E;for(let $=E;$>=1;$/=2)C(T,$,[b,I])}for(let N=I;N>w;N/=2){let A=S(),D=new ml([b,N/2]),F=null===k?1:0,R=[[h],[F],[w]],_=k;k=n.runWebGLProgram(D,A,"int32",R),mu(n,_);let O=w/2,M=2*O;for(let B=O;B>=1;B/=2)C(M,B,k.shape)}let P=k;k=hc({inputs:{x:k},backend:n,attrs:{begin:0,size:[b,i]}}),mu(n,P);let L=dn({inputs:{x:x,indices:k},backend:n,attrs:{axis:1,batchDims:1}});mu(n,x);let U=u.slice(0,-1);U.push(i),P=k,k=uu({inputs:{x:k},attrs:{shape:U},backend:n}),mu(n,P);let W=L;return L=uu({inputs:{x:L},attrs:{shape:U},backend:n}),mu(n,W),[L,k]}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class md{constructor(e,t,n,r,a,i){let s;switch(this.variableNames=["Image","Transforms"],this.outputShape=i,r){case"constant":default:s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${s} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${s} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${s} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${a});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${a});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${"nearest"===n?1:2} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}let mp={kernelName:v.wx7,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{image:a,transforms:i}=t,{interpolation:s,fillMode:o,fillValue:l,outputShape:u}=r,[h,c,d,p]=a.shape,[f,m]=null!=u?u:[c,d],g=new md(c,d,s,o,l,[h,f,m,p]);return n.runWebGLProgram(g,[a,i],"float32")}},mf={kernelName:v.kpP,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,attrs:n,backend:r}=e,{axis:a}=n,{x:i}=t;ok(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");let s=r.readSync(i.dataId),{outputValues:o,outputShape:l,indices:u}=lC(s,a,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,o),r.makeTensorInfo([u.length],"int32",u)]}},mm={kernelName:v.ToN,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{value:a}=t,{axis:i}=r;i<0&&(i+=a.shape.length);let s=a.shape.length,o=a.shape[i],l=Array(s-1),u=0;for(let h=0;h<s;h++)h!==i&&(l[u++]=a.shape[h]);let c=[],d=Array(s).fill(0),p=a.shape.slice();p[i]=1;let f=Array(o);for(let m=0;m<f.length;m++){d[i]=m;let g=hc({inputs:{x:a},backend:n,attrs:{begin:d,size:p}}),y=uu({inputs:{x:g},backend:n,attrs:{shape:l}});f[m]=y,c.push(g)}return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),f}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ class mg{constructor(e,t){this.variableNames=["x","segmentIds"];let n=e.windowSize,r=e.batchSize,a=e.inSize,i=e.numSegments,s=i*Math.ceil(a/n);this.outputShape=[r,s];let o=4*Math.floor(n/4),l=n%4,u=`
        sumValue += dot(values, segFilter);
    `,h="";a%n>0&&(h=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `);let c="";a%n>0&&(c=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${c}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${n}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${o}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${u}
        }

        int inIdx = inOffset + ${o};
        if (${1===l}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${u}
        } else if (${2===l}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${u}
        } else if (${3===l}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${u}
        }
        setOutput(sumValue);
      }
    `}}let my={kernelName:v.Qvg,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ function(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,segmentIds:i}=t,{numSegments:s}=r,o=a.shape.length,l=[],u=0,h=v.Wap.getAxesPermutation([u],o),c=a;null!=h&&(c=ux({inputs:{x:a},backend:n,attrs:{perm:h}}),l.push(c),u=v.Wap.getInnerMostAxes(1,o)[0]);let d=v.Wap.segment_util.computeOutShape(c.shape,u,s),p=v.D5U.sizeFromShape([c.shape[u]]),f=uu({inputs:{x:c},backend:n,attrs:{shape:[-1,p]}});l.push(f);let m=(0,v.z4k)(a.dtype),g=(e,t,r,a,i)=>{let s=e.shape[0],o=e.shape[1],u=v.Wap.segment_util.segOpComputeOptimalWindowSize(o,i),h=new mg({windowSize:u,inSize:o,batchSize:s,numSegments:i},t),c=n.compileAndRun(h,[e,r],a);if(l.push(c),c.shape[1]===i)return c;let d=pX({backend:n,attrs:{start:0,stop:i,step:1,dtype:"float32"}}),p=mi({inputs:{x:d},backend:n,attrs:{reps:[o/u]}});l.push(d),l.push(p);let f=g(c,t,p,a,i);return f},y=g(f,"unsortedSegmentSum",i,m,s),b=uu({inputs:{x:y},backend:n,attrs:{shape:d}}),x=b;if(null!=h){l.push(b);let w=v.Wap.getUndoAxesPermutation(h);x=ux({inputs:{x:x},backend:n,attrs:{perm:w}})}return l.forEach(e=>n.disposeIntermediateTensorInfo(e)),x}};for(let mb of[uI,uS,uT,uA,uR,uM,uB,uP,uz,uV,uH,uX,uQ,u1,u4,u7,u8,ht,hn,hr,ho,hf,hm,hg,hw,hS,hT,l2,hA,hB,hj,hY,hQ,hZ,hJ,h0,h3,h5,h9,ca,ci,cs,cl,cc,cf,cm,cy,cx,cv,ck,cE,cN,cF,cM,cP,cW,cG,cK,cq,cZ,c2,c6,c7,c8,de,dr,ds,dh,l0,dc,hO,dp,dm,dy,l6,dv,dk,dS,d$,dD,d_,dM,dL,dV,dH,dX,dZ,dJ,d0,d3,d4,d6,d5,d7,pt,pi,pu,pv,ul,pk,pC,pT,pN,hb,pF,pO,pM,pU,pG,l8,pj,pH,pK,pq,hv,pf,pQ,p1,p6,uh,p8,fe,fr,fi,fl,fh,fp,fm,fy,fx,fw,fS,f$,fD,f_,fB,hd,px,fU,fz,fV,fG,fj,fH,fK,fX,fQ,fJ,f2,f3,f6,f5,f7,f8,py,ub,me,mr,ms,mc,mp,uv,mf,mm,my,p_])(0,v.wCN)(mb);v.jTM,tU.$7,tP.H6},3720:function(e){e.exports=r;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(n){}function r(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function a(e){return!0===(e&&e.__isLong__)}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=a;var i={},s={};function o(e,t){var n,r,a;return t?(e>>>=0,(a=0<=e&&e<256)&&(r=s[e]))?r:(n=u(e,(0|e)<0?-1:0,!0),a&&(s[e]=n),n):(e|=0,(a=-128<=e&&e<128)&&(r=i[e]))?r:(n=u(e,e<0?-1:0,!1),a&&(i[e]=n),n)}function l(e,t){if(isNaN(e))return t?b:y;if(t){if(e<0)return b;if(e>=f)return k}else{if(e<=-m)return S;if(e+1>=m)return I}return e<0?l(-e,t).neg():u(e%p|0,e/p|0,t)}function u(e,t,n){return new r(e,t,n)}r.fromInt=o,r.fromNumber=l,r.fromBits=u;var h=Math.pow;function c(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return y;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return c(e.substring(1),t,n).neg();for(var r,a=l(h(n,8)),i=y,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),u=parseInt(e.substring(s,s+o),n);if(o<8){var d=l(h(n,o));i=i.mul(d).add(l(u))}else i=(i=i.mul(a)).add(l(u))}return i.unsigned=t,i}function d(e,t){return"number"==typeof e?l(e,t):"string"==typeof e?c(e,t):u(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=c,r.fromValue=d;var p=4294967296,f=18446744073709552e3,m=0x7fffffffffffffff,g=o(16777216),y=o(0);r.ZERO=y;var b=o(0,!0);r.UZERO=b;var x=o(1);r.ONE=x;var v=o(1,!0);r.UONE=v;var w=o(-1);r.NEG_ONE=w;var I=u(-1,2147483647,!1);r.MAX_VALUE=I;var k=u(-1,-1,!0);r.MAX_UNSIGNED_VALUE=k;var S=u(0,-2147483648,!1);r.MIN_VALUE=S;var C=r.prototype;C.toInt=function(){return this.unsigned?this.low>>>0:this.low},C.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},C.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(!this.eq(S))return"-"+this.neg().toString(e);var t=l(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}for(var a=l(h(e,6),this.unsigned),i=this,s="";;){var o=i.div(a),u=(i.sub(o.mul(a)).toInt()>>>0).toString(e);if((i=o).isZero())return u+s;for(;u.length<6;)u="0"+u;s=""+u+s}},C.getHighBits=function(){return this.high},C.getHighBitsUnsigned=function(){return this.high>>>0},C.getLowBits=function(){return this.low},C.getLowBitsUnsigned=function(){return this.low>>>0},C.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return 0!=this.high?t+33:t+1},C.isZero=function(){return 0===this.high&&0===this.low},C.eqz=C.isZero,C.isNegative=function(){return!this.unsigned&&this.high<0},C.isPositive=function(){return this.unsigned||this.high>=0},C.isOdd=function(){return(1&this.low)==1},C.isEven=function(){return(1&this.low)==0},C.equals=function(e){return a(e)||(e=d(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},C.eq=C.equals,C.notEquals=function(e){return!this.eq(e)},C.neq=C.notEquals,C.ne=C.notEquals,C.lessThan=function(e){return 0>this.comp(e)},C.lt=C.lessThan,C.lessThanOrEqual=function(e){return 0>=this.comp(e)},C.lte=C.lessThanOrEqual,C.le=C.lessThanOrEqual,C.greaterThan=function(e){return this.comp(e)>0},C.gt=C.greaterThan,C.greaterThanOrEqual=function(e){return this.comp(e)>=0},C.gte=C.greaterThanOrEqual,C.ge=C.greaterThanOrEqual,C.compare=function(e){if(a(e)||(e=d(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},C.comp=C.compare,C.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(x)},C.neg=C.negate,C.add=function(e){a(e)||(e=d(e));var t,n,r=this.high>>>16,i=65535&this.high,s=this.low>>>16,o=65535&this.low,l=e.high>>>16,h=65535&e.high,c=e.low>>>16,p=65535&e.low,f=0,m=0;return t=0+((n=0+(o+p))>>>16),n&=65535,t+=s+c,m+=t>>>16,t&=65535,m+=i+h,f+=m>>>16,m&=65535,f+=r+l,u(t<<16|n,(f&=65535)<<16|m,this.unsigned)},C.subtract=function(e){return a(e)||(e=d(e)),this.add(e.neg())},C.sub=C.subtract,C.multiply=function(e){if(this.isZero())return y;if(a(e)||(e=d(e)),t)return u(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return y;if(this.eq(S))return e.isOdd()?S:y;if(e.eq(S))return this.isOdd()?S:y;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(g)&&e.lt(g))return l(this.toNumber()*e.toNumber(),this.unsigned);var n,r,i=this.high>>>16,s=65535&this.high,o=this.low>>>16,h=65535&this.low,c=e.high>>>16,p=65535&e.high,f=e.low>>>16,m=65535&e.low,b=0,x=0;return n=0+((r=0+h*m)>>>16),r&=65535,n+=o*m,x+=n>>>16,n&=65535,n+=h*f,x+=n>>>16,n&=65535,x+=s*m,b+=x>>>16,x&=65535,x+=o*f,b+=x>>>16,x&=65535,x+=h*p,b+=x>>>16,x&=65535,b+=i*m+s*f+o*p+h*c,u(n<<16|r,(b&=65535)<<16|x,this.unsigned)},C.mul=C.multiply,C.divide=function(e){if(a(e)||(e=d(e)),e.isZero())throw Error("division by zero");if(t){var n,r,i;return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this}if(this.isZero())return this.unsigned?b:y;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return b;if(e.gt(this.shru(1)))return v;i=b}else{if(this.eq(S))return e.eq(x)||e.eq(w)?S:e.eq(S)?x:(n=this.shr(1).div(e).shl(1)).eq(y)?e.isNegative()?x:w:(r=this.sub(e.mul(n)),i=n.add(r.div(e)));if(e.eq(S))return this.unsigned?b:y;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=y}for(r=this;r.gte(e);){for(var s=Math.ceil(Math.log(n=Math.max(1,Math.floor(r.toNumber()/e.toNumber())))/Math.LN2),o=s<=48?1:h(2,s-48),c=l(n),p=c.mul(e);p.isNegative()||p.gt(r);)n-=o,p=(c=l(n,this.unsigned)).mul(e);c.isZero()&&(c=x),i=i.add(c),r=r.sub(p)}return i},C.div=C.divide,C.modulo=function(e){return(a(e)||(e=d(e)),t)?u((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},C.mod=C.modulo,C.rem=C.modulo,C.not=function(){return u(~this.low,~this.high,this.unsigned)},C.and=function(e){return a(e)||(e=d(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},C.or=function(e){return a(e)||(e=d(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},C.xor=function(e){return a(e)||(e=d(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},C.shiftLeft=function(e){return(a(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},C.shl=C.shiftLeft,C.shiftRight=function(e){return(a(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},C.shr=C.shiftRight,C.shiftRightUnsigned=function(e){if(a(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?u(this.low>>>e|t<<32-e,t>>>e,this.unsigned):32===e?u(t,0,this.unsigned):u(t>>>e-32,0,this.unsigned)},C.shru=C.shiftRightUnsigned,C.shr_u=C.shiftRightUnsigned,C.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},C.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},C.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},C.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},C.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},1876:function(e){!function(){var t={675:function(e,t){"use strict";t.byteLength=function(e){var t=l(e),n=t[0],r=t[1];return(n+r)*3/4-r},t.toByteArray=function(e){var t,n,i=l(e),s=i[0],o=i[1],u=new a((s+o)*3/4-o),h=0,c=o>0?s-4:s;for(n=0;n<c;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],u[h++]=t>>16&255,u[h++]=t>>8&255,u[h++]=255&t;return 2===o&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,u[h++]=255&t),1===o&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,u[h++]=t>>8&255,u[h++]=255&t),u},t.fromByteArray=function(e){for(var t,r=e.length,a=r%3,i=[],s=0,o=r-a;s<o;s+=16383)i.push(function(e,t,r){for(var a,i=[],s=t;s<r;s+=3)i.push(n[(a=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]))>>18&63]+n[a>>12&63]+n[a>>6&63]+n[63&a]);return i.join("")}(e,s,s+16383>o?o:s+16383));return 1===a?i.push(n[(t=e[r-1])>>2]+n[t<<4&63]+"=="):2===a&&i.push(n[(t=(e[r-2]<<8)+e[r-1])>>10]+n[t>>4&63]+n[t<<2&63]+"="),i.join("")};for(var n=[],r=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,o=i.length;s<o;++s)n[s]=i[s],r[i.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");-1===n&&(n=t);var r=n===t?0:4-n%4;return[n,r]}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},72:function(e,t,n){"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */ var r=n(675),a=n(783),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function s(e){if(e>2147483647)throw RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,o.prototype),t}function o(e,t,n){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return h(e)}return l(e,t,n)}function l(e,t,n){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!o.isEncoding(t))throw TypeError("Unknown encoding: "+t);var n=0|p(e,t),r=s(n),a=r.write(e,t);return a!==n&&(r=r.slice(0,a)),r}(e,t);if(ArrayBuffer.isView(e))return c(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(N(e,ArrayBuffer)||e&&N(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(N(e,SharedArrayBuffer)||e&&N(e.buffer,SharedArrayBuffer)))return function(e,t,n){var r;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),o.prototype),r}(e,t,n);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return o.from(r,t,n);var a=function(e){if(o.isBuffer(e)){var t,n=0|d(e.length),r=s(n);return 0===r.length||e.copy(r,0,0,n),r}return void 0!==e.length?"number"!=typeof e.length||(t=e.length)!=t?s(0):c(e):"Buffer"===e.type&&Array.isArray(e.data)?c(e.data):void 0}(e);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return o.from(e[Symbol.toPrimitive]("string"),t,n);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return u(e),s(e<0?0:0|d(e))}function c(e){for(var t=e.length<0?0:0|d(e.length),n=s(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function d(e){if(e>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function p(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||N(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var a=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return C(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return T(e).length;default:if(a)return r?-1:C(e).length;t=(""+t).toLowerCase(),a=!0}}function f(e,t,n){var a,i,s=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===n||n>this.length)&&(n=this.length),n<=0||(n>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var a="",i=t;i<n;++i)a+=A[e[i]];return a}(this,t,n);case"utf8":case"utf-8":return b(this,t,n);case"ascii":return function(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(127&e[a]);return r}(this,t,n);case"latin1":case"binary":return function(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(e[a]);return r}(this,t,n);case"base64":return a=t,i=n,0===a&&i===this.length?r.fromByteArray(this):r.fromByteArray(this.slice(a,i));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,n){for(var r=e.slice(t,n),a="",i=0;i<r.length;i+=2)a+=String.fromCharCode(r[i]+256*r[i+1]);return a}(this,t,n);default:if(s)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),s=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,a){var i;if(0===e.length)return -1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),(i=n=+n)!=i&&(n=a?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(a)return -1;n=e.length-1}else if(n<0){if(!a)return -1;n=0}if("string"==typeof t&&(t=o.from(t,r)),o.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,a);if("number"==typeof t)return(t&=255,"function"==typeof Uint8Array.prototype.indexOf)?a?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,r,a);throw TypeError("val must be string, number or Buffer")}function y(e,t,n,r,a){var i,s=1,o=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return -1;s=2,o/=2,l/=2,n/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(a){var h=-1;for(i=n;i<o;i++)if(u(e,i)===u(t,-1===h?0:i-h)){if(-1===h&&(h=i),i-h+1===l)return h*s}else -1!==h&&(i-=i-h),h=-1}else for(n+l>o&&(n=o-l),i=n;i>=0;i--){for(var c=!0,d=0;d<l;d++)if(u(e,i+d)!==u(t,d)){c=!1;break}if(c)return i}return -1}function b(e,t,n){n=Math.min(e.length,n);for(var r=[],a=t;a<n;){var i,s,o,l,u=e[a],h=null,c=u>239?4:u>223?3:u>191?2:1;if(a+c<=n)switch(c){case 1:u<128&&(h=u);break;case 2:(192&(i=e[a+1]))==128&&(l=(31&u)<<6|63&i)>127&&(h=l);break;case 3:i=e[a+1],s=e[a+2],(192&i)==128&&(192&s)==128&&(l=(15&u)<<12|(63&i)<<6|63&s)>2047&&(l<55296||l>57343)&&(h=l);break;case 4:i=e[a+1],s=e[a+2],o=e[a+3],(192&i)==128&&(192&s)==128&&(192&o)==128&&(l=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&o)>65535&&l<1114112&&(h=l)}null===h?(h=65533,c=1):h>65535&&(h-=65536,r.push(h>>>10&1023|55296),h=56320|1023&h),r.push(h),a+=c}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}function x(e,t,n){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>n)throw RangeError("Trying to access beyond buffer length")}function v(e,t,n,r,a,i){if(!o.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<i)throw RangeError('"value" argument is out of bounds');if(n+r>e.length)throw RangeError("Index out of range")}function w(e,t,n,r,a,i){if(n+r>e.length||n<0)throw RangeError("Index out of range")}function I(e,t,n,r,i){return t=+t,n>>>=0,i||w(e,t,n,4,34028234663852886e22,-34028234663852886e22),a.write(e,t,n,r,23,4),n+4}function k(e,t,n,r,i){return t=+t,n>>>=0,i||w(e,t,n,8,17976931348623157e292,-17976931348623157e292),a.write(e,t,n,r,52,8),n+8}t.Buffer=o,t.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},t.INSPECT_MAX_BYTES=50,t.kMaxLength=2147483647,o.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(n){return!1}}(),o.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(e,t,n){return l(e,t,n)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(e,t,n){return(u(e),e<=0)?s(e):void 0!==t?"string"==typeof n?s(e).fill(t,n):s(e).fill(t):s(e)},o.allocUnsafe=function(e){return h(e)},o.allocUnsafeSlow=function(e){return h(e)},o.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==o.prototype},o.compare=function(e,t){if(N(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),N(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,a=0,i=Math.min(n,r);a<i;++a)if(e[a]!==t[a]){n=e[a],r=t[a];break}return n<r?-1:r<n?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);if(void 0===t)for(n=0,t=0;n<e.length;++n)t+=e[n].length;var n,r=o.allocUnsafe(t),a=0;for(n=0;n<e.length;++n){var i=e[n];if(N(i,Uint8Array)&&(i=o.from(i)),!o.isBuffer(i))throw TypeError('"list" argument must be an Array of Buffers');i.copy(r,a),a+=i.length}return r},o.byteLength=p,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},o.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?b(this,0,e):f.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(e){if(!o.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},i&&(o.prototype[i]=o.prototype.inspect),o.prototype.compare=function(e,t,n,r,a){if(N(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===a&&(a=this.length),t<0||n>e.length||r<0||a>this.length)throw RangeError("out of range index");if(r>=a&&t>=n)return 0;if(r>=a)return -1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,a>>>=0,this===e)return 0;for(var i=a-r,s=n-t,l=Math.min(i,s),u=this.slice(r,a),h=e.slice(t,n),c=0;c<l;++c)if(u[c]!==h[c]){i=u[c],s=h[c];break}return i<s?-1:s<i?1:0},o.prototype.includes=function(e,t,n){return -1!==this.indexOf(e,t,n)},o.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},o.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},o.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var a,i,s,o,l,u,h,c,d,p,f,m,g=this.length-t;if((void 0===n||n>g)&&(n=g),e.length>0&&(n<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var y=!1;;)switch(r){case"hex":return function(e,t,n,r){n=Number(n)||0;var a=e.length-n;r?(r=Number(r))>a&&(r=a):r=a;var i=t.length;r>i/2&&(r=i/2);for(var s=0;s<r;++s){var o=parseInt(t.substr(2*s,2),16);if(o!=o)break;e[n+s]=o}return s}(this,e,t,n);case"utf8":case"utf-8":return l=t,u=n,$(C(e,this.length-l),this,l,u);case"ascii":return h=t,c=n,$(E(e),this,h,c);case"latin1":case"binary":return a=this,i=e,s=t,o=n,$(E(i),a,s,o);case"base64":return d=t,p=n,$(T(e),this,d,p);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return f=t,m=n,$(function(e,t){for(var n,r,a=[],i=0;i<e.length&&!((t-=2)<0);++i)r=(n=e.charCodeAt(i))>>8,a.push(n%256),a.push(r);return a}(e,this.length-f),this,f,m);default:if(y)throw TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),y=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},o.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,o.prototype),r},o.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||x(e,t,this.length);for(var r=this[e],a=1,i=0;++i<t&&(a*=256);)r+=this[e+i]*a;return r},o.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||x(e,t,this.length);for(var r=this[e+--t],a=1;t>0&&(a*=256);)r+=this[e+--t]*a;return r},o.prototype.readUInt8=function(e,t){return e>>>=0,t||x(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return e>>>=0,t||x(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return e>>>=0,t||x(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return e>>>=0,t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return e>>>=0,t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||x(e,t,this.length);for(var r=this[e],a=1,i=0;++i<t&&(a*=256);)r+=this[e+i]*a;return r>=(a*=128)&&(r-=Math.pow(2,8*t)),r},o.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||x(e,t,this.length);for(var r=t,a=1,i=this[e+--r];r>0&&(a*=256);)i+=this[e+--r]*a;return i>=(a*=128)&&(i-=Math.pow(2,8*t)),i},o.prototype.readInt8=function(e,t){return(e>>>=0,t||x(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},o.prototype.readInt16LE=function(e,t){e>>>=0,t||x(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(e,t){e>>>=0,t||x(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(e,t){return e>>>=0,t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e>>>=0,t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return e>>>=0,t||x(e,4,this.length),a.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e>>>=0,t||x(e,4,this.length),a.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e>>>=0,t||x(e,8,this.length),a.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e>>>=0,t||x(e,8,this.length),a.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){var a=Math.pow(2,8*n)-1;v(this,e,t,n,a,0)}var i=1,s=0;for(this[t]=255&e;++s<n&&(i*=256);)this[t+s]=e/i&255;return t+n},o.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){var a=Math.pow(2,8*n)-1;v(this,e,t,n,a,0)}var i=n-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+n},o.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,1,255,0),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},o.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var a=Math.pow(2,8*n-1);v(this,e,t,n,a-1,-a)}var i=0,s=1,o=0;for(this[t]=255&e;++i<n&&(s*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+n},o.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var a=Math.pow(2,8*n-1);v(this,e,t,n,a-1,-a)}var i=n-1,s=1,o=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+n},o.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||v(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeFloatLE=function(e,t,n){return I(this,e,t,!0,n)},o.prototype.writeFloatBE=function(e,t,n){return I(this,e,t,!1,n)},o.prototype.writeDoubleLE=function(e,t,n){return k(this,e,t,!0,n)},o.prototype.writeDoubleBE=function(e,t,n){return k(this,e,t,!1,n)},o.prototype.copy=function(e,t,n,r){if(!o.isBuffer(e))throw TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw RangeError("Index out of range");if(r<0)throw RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var a=r-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,n,r);else if(this===e&&n<t&&t<r)for(var i=a-1;i>=0;--i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,r),t);return a},o.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw TypeError("Unknown encoding: "+r);if(1===e.length){var a,i=e.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw RangeError("Out of range index");if(n<=t)return this;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var s=o.isBuffer(e)?e:o.from(e,r),l=s.length;if(0===l)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<n-t;++a)this[a+t]=s[a%l]}return this};var S=/[^+/0-9A-Za-z-_]/g;function C(e,t){t=t||1/0;for(var n,r=e.length,a=null,i=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!a){if(n>56319||s+1===r){(t-=3)>-1&&i.push(239,191,189);continue}a=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),a=n;continue}n=(a-55296<<10|n-56320)+65536}else a&&(t-=3)>-1&&i.push(239,191,189);if(a=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else if(n<1114112){if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}else throw Error("Invalid code point")}return i}function E(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function T(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(S,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function $(e,t,n,r){for(var a=0;a<r&&!(a+n>=t.length)&&!(a>=e.length);++a)t[a+n]=e[a];return a}function N(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}var A=function(){for(var e="0123456789abcdef",t=Array(256),n=0;n<16;++n)for(var r=16*n,a=0;a<16;++a)t[r+a]=e[n]+e[a];return t}()},783:function(e,t){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ t.read=function(e,t,n,r,a){var i,s,o=8*a-r-1,l=(1<<o)-1,u=l>>1,h=-7,c=n?a-1:0,d=n?-1:1,p=e[t+c];for(c+=d,i=p&(1<<-h)-1,p>>=-h,h+=o;h>0;i=256*i+e[t+c],c+=d,h-=8);for(s=i&(1<<-h)-1,i>>=-h,h+=r;h>0;s=256*s+e[t+c],c+=d,h-=8);if(0===i)i=1-u;else{if(i===l)return s?NaN:(p?-1:1)*(1/0);s+=Math.pow(2,r),i-=u}return(p?-1:1)*s*Math.pow(2,i-r)},t.write=function(e,t,n,r,a,i){var s,o,l,u=8*i-a-1,h=(1<<u)-1,c=h>>1,d=23===a?5960464477539062e-23:0,p=r?0:i-1,f=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(o=isNaN(t)?1:0,s=h):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+c>=1?t+=d/l:t+=d*Math.pow(2,1-c),t*l>=2&&(s++,l/=2),s+c>=h?(o=0,s=h):s+c>=1?(o=(t*l-1)*Math.pow(2,a),s+=c):(o=t*Math.pow(2,c-1)*Math.pow(2,a),s=0));a>=8;e[n+p]=255&o,p+=f,o/=256,a-=8);for(s=s<<a|o,u+=a;u>0;e[n+p]=255&s,p+=f,s/=256,u-=8);e[n+p-f]|=128*m}}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var i=n[e]={exports:{}},s=!0;try{t[e](i,i.exports,r),s=!1}finally{s&&delete n[e]}return i.exports}r.ab="//";var a=r(72);e.exports=a}()},9720:function(e,t,n){var r=n(1876).Buffer,a=n(3454);!function(){var t={992:function(e){e.exports=function(e,n,r){if(e.filter)return e.filter(n,r);if(null==e||"function"!=typeof n)throw TypeError();for(var a=[],i=0;i<e.length;i++)if(t.call(e,i)){var s=e[i];n.call(r,s,i,e)&&a.push(s)}return a};var t=Object.prototype.hasOwnProperty},256:function(e,t,n){"use strict";var r=n(500),a=n(139),i=a(r("String.prototype.indexOf"));e.exports=function(e,t){var n=r(e,!!t);return"function"==typeof n&&i(e,".prototype.")>-1?a(n):n}},139:function(e,t,n){"use strict";var r=n(174),a=n(500),i=a("%Function.prototype.apply%"),s=a("%Function.prototype.call%"),o=a("%Reflect.apply%",!0)||r.call(s,i),l=a("%Object.getOwnPropertyDescriptor%",!0),u=a("%Object.defineProperty%",!0),h=a("%Math.max%");if(u)try{u({},"a",{value:1})}catch(c){u=null}e.exports=function(e){var t=o(r,s,arguments);return l&&u&&l(t,"length").configurable&&u(t,"length",{value:1+h(0,e.length-(arguments.length-1))}),t};var d=function(){return o(r,i,arguments)};u?u(e.exports,"apply",{value:d}):e.exports.apply=d},144:function(e){var t=Object.prototype.hasOwnProperty,n=Object.prototype.toString;e.exports=function(e,r,a){if("[object Function]"!==n.call(r))throw TypeError("iterator must be a function");var i=e.length;if(i===+i)for(var s=0;s<i;s++)r.call(a,e[s],s,e);else for(var o in e)t.call(e,o)&&r.call(a,e[o],o,e)}},426:function(e){"use strict";var t=Array.prototype.slice,n=Object.prototype.toString;e.exports=function(e){var r,a=this;if("function"!=typeof a||"[object Function]"!==n.call(a))throw TypeError("Function.prototype.bind called on incompatible "+a);for(var i=t.call(arguments,1),s=Math.max(0,a.length-i.length),o=[],l=0;l<s;l++)o.push("$"+l);if(r=Function("binder","return function ("+o.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(!(this instanceof r))return a.apply(e,i.concat(t.call(arguments)));var n=a.apply(this,i.concat(t.call(arguments)));return Object(n)===n?n:this}),a.prototype){var u=function(){};u.prototype=a.prototype,r.prototype=new u,u.prototype=null}return r}},174:function(e,t,n){"use strict";var r=n(426);e.exports=Function.prototype.bind||r},500:function(e,t,n){"use strict";var r,a=SyntaxError,i=Function,s=TypeError,o=function(e){try{return i('"use strict"; return ('+e+").constructor;")()}catch(t){}},l=Object.getOwnPropertyDescriptor;if(l)try{l({},"")}catch(u){l=null}var h=function(){throw new s},c=l?function(){try{return arguments.callee,h}catch(t){try{return l(arguments,"callee").get}catch(e){return h}}}():h,d=n(115)(),p=Object.getPrototypeOf||function(e){return e.__proto__},f={},m="undefined"==typeof Uint8Array?r:p(Uint8Array),g={"%AggregateError%":"undefined"==typeof AggregateError?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?r:ArrayBuffer,"%ArrayIteratorPrototype%":d?p([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":f,"%AsyncGenerator%":f,"%AsyncGeneratorFunction%":f,"%AsyncIteratorPrototype%":f,"%Atomics%":"undefined"==typeof Atomics?r:Atomics,"%BigInt%":"undefined"==typeof BigInt?r:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?r:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?r:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?r:FinalizationRegistry,"%Function%":i,"%GeneratorFunction%":f,"%Int8Array%":"undefined"==typeof Int8Array?r:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?r:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":d?p(p([][Symbol.iterator]())):r,"%JSON%":"object"==typeof JSON?JSON:r,"%Map%":"undefined"==typeof Map?r:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&d?p((new Map)[Symbol.iterator]()):r,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?r:Promise,"%Proxy%":"undefined"==typeof Proxy?r:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?r:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?r:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&d?p((new Set)[Symbol.iterator]()):r,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":d?p(""[Symbol.iterator]()):r,"%Symbol%":d?Symbol:r,"%SyntaxError%":a,"%ThrowTypeError%":c,"%TypedArray%":m,"%TypeError%":s,"%Uint8Array%":"undefined"==typeof Uint8Array?r:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?r:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?r:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?r:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?r:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?r:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?r:WeakSet},y=function e(t){var n;if("%AsyncFunction%"===t)n=o("async function () {}");else if("%GeneratorFunction%"===t)n=o("function* () {}");else if("%AsyncGeneratorFunction%"===t)n=o("async function* () {}");else if("%AsyncGenerator%"===t){var r=e("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===t){var a=e("%AsyncGenerator%");a&&(n=p(a.prototype))}return g[t]=n,n},b={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},x=n(174),v=n(101),w=x.call(Function.call,Array.prototype.concat),I=x.call(Function.apply,Array.prototype.splice),k=x.call(Function.call,String.prototype.replace),S=x.call(Function.call,String.prototype.slice),C=x.call(Function.call,RegExp.prototype.exec),E=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,T=/\\(\\)?/g,$=function(e){var t=S(e,0,1),n=S(e,-1);if("%"===t&&"%"!==n)throw new a("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new a("invalid intrinsic syntax, expected opening `%`");var r=[];return k(e,E,function(e,t,n,a){r[r.length]=n?k(a,T,"$1"):t||e}),r},N=function(e,t){var n,r=e;if(v(b,r)&&(r="%"+(n=b[r])[0]+"%"),v(g,r)){var i=g[r];if(i===f&&(i=y(r)),void 0===i&&!t)throw new s("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:i}}throw new a("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new s('"allowMissing" argument must be a boolean');if(null===C(/^%?[^%]*%?$/g,e))throw new a("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=$(e),r=n.length>0?n[0]:"",i=N("%"+r+"%",t),o=i.name,u=i.value,h=!1,c=i.alias;c&&(r=c[0],I(n,w([0,1],c)));for(var d=1,p=!0;d<n.length;d+=1){var f=n[d],m=S(f,0,1),y=S(f,-1);if(('"'===m||"'"===m||"`"===m||'"'===y||"'"===y||"`"===y)&&m!==y)throw new a("property names with quotes must have matching quotes");if("constructor"!==f&&p||(h=!0),r+="."+f,v(g,o="%"+r+"%"))u=g[o];else if(null!=u){if(!(f in u)){if(!t)throw new s("base intrinsic for "+e+" exists, but the property is not available.");return}if(l&&d+1>=n.length){var b=l(u,f);u=(p=!!b)&&"get"in b&&!("originalValue"in b.get)?b.get:u[f]}else p=v(u,f),u=u[f];p&&!h&&(g[o]=u)}}return u}},942:function(e,t,n){"use strict";var r="undefined"!=typeof Symbol&&Symbol,a=n(773);e.exports=function(){return"function"==typeof r&&"function"==typeof Symbol&&"symbol"==typeof r("foo")&&"symbol"==typeof Symbol("bar")&&a()}},773:function(e){"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),n=Object(t);if("string"==typeof t||"[object Symbol]"!==Object.prototype.toString.call(t)||"[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length||"function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var a=Object.getOwnPropertyDescriptor(e,t);if(42!==a.value||!0!==a.enumerable)return!1}return!0}},115:function(e,t,n){"use strict";var r="undefined"!=typeof Symbol&&Symbol,a=n(832);e.exports=function(){return"function"==typeof r&&"function"==typeof Symbol&&"symbol"==typeof r("foo")&&"symbol"==typeof Symbol("bar")&&a()}},832:function(e){"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),n=Object(t);if("string"==typeof t||"[object Symbol]"!==Object.prototype.toString.call(t)||"[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length||"function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var a=Object.getOwnPropertyDescriptor(e,t);if(42!==a.value||!0!==a.enumerable)return!1}return!0}},101:function(e,t,n){"use strict";var r=n(174);e.exports=r.call(Function.call,Object.prototype.hasOwnProperty)},782:function(e){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},157:function(e){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,n=Object.prototype.toString,r=function(e){return(!t||!e||"object"!=typeof e||!(Symbol.toStringTag in e))&&"[object Arguments]"===n.call(e)},a=function(e){return!!r(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==n.call(e)&&"[object Function]"===n.call(e.callee)},i=function(){return r(arguments)}();r.isLegacyArguments=a,e.exports=i?r:a},391:function(e){"use strict";var t=Object.prototype.toString,n=Function.prototype.toString,r=/^\s*(?:function)?\*/,a="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,i=Object.getPrototypeOf,s=function(){if(!a)return!1;try{return Function("return function*() {}")()}catch(e){}}(),o=s?i(s):{};e.exports=function(e){return"function"==typeof e&&(!!r.test(n.call(e))||(a?i(e)===o:"[object GeneratorFunction]"===t.call(e)))}},994:function(e,t,r){"use strict";var a=r(144),i=r(349),s=r(256),o=s("Object.prototype.toString"),l=r(942)()&&"symbol"==typeof Symbol.toStringTag,u=i(),h=s("Array.prototype.indexOf",!0)||function(e,t){for(var n=0;n<e.length;n+=1)if(e[n]===t)return n;return -1},c=s("String.prototype.slice"),d={},p=r(466),f=Object.getPrototypeOf;l&&p&&f&&a(u,function(e){var t=new n.g[e];if(!(Symbol.toStringTag in t))throw EvalError("this engine has support for Symbol.toStringTag, but "+e+" does not have the property! Please report this.");var r=f(t),a=p(r,Symbol.toStringTag);a||(a=p(f(r),Symbol.toStringTag)),d[e]=a.get});var m=function(e){var t=!1;return a(d,function(n,r){if(!t)try{t=n.call(e)===r}catch(a){}}),t};e.exports=function(e){return!!e&&"object"==typeof e&&(l?!!p&&m(e):h(u,c(o(e),8,-1))>-1)}},369:function(e){e.exports=function(e){return e instanceof r}},584:function(e,t,n){"use strict";var r=n(157),a=n(391),i=n(490),s=n(994);function o(e){return e.call.bind(e)}var l="undefined"!=typeof BigInt,u="undefined"!=typeof Symbol,h=o(Object.prototype.toString),c=o(Number.prototype.valueOf),d=o(String.prototype.valueOf),p=o(Boolean.prototype.valueOf);if(l)var f=o(BigInt.prototype.valueOf);if(u)var m=o(Symbol.prototype.valueOf);function g(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(n){return!1}}function y(e){return"[object Map]"===h(e)}function b(e){return"[object Set]"===h(e)}function x(e){return"[object WeakMap]"===h(e)}function v(e){return"[object WeakSet]"===h(e)}function w(e){return"[object ArrayBuffer]"===h(e)}function I(e){return"undefined"!=typeof ArrayBuffer&&(w.working?w(e):e instanceof ArrayBuffer)}function k(e){return"[object DataView]"===h(e)}function S(e){return"undefined"!=typeof DataView&&(k.working?k(e):e instanceof DataView)}t.isArgumentsObject=r,t.isGeneratorFunction=a,t.isTypedArray=s,t.isPromise=function(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},t.isArrayBufferView=function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):s(e)||S(e)},t.isUint8Array=function(e){return"Uint8Array"===i(e)},t.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===i(e)},t.isUint16Array=function(e){return"Uint16Array"===i(e)},t.isUint32Array=function(e){return"Uint32Array"===i(e)},t.isInt8Array=function(e){return"Int8Array"===i(e)},t.isInt16Array=function(e){return"Int16Array"===i(e)},t.isInt32Array=function(e){return"Int32Array"===i(e)},t.isFloat32Array=function(e){return"Float32Array"===i(e)},t.isFloat64Array=function(e){return"Float64Array"===i(e)},t.isBigInt64Array=function(e){return"BigInt64Array"===i(e)},t.isBigUint64Array=function(e){return"BigUint64Array"===i(e)},y.working="undefined"!=typeof Map&&y(new Map),t.isMap=function(e){return"undefined"!=typeof Map&&(y.working?y(e):e instanceof Map)},b.working="undefined"!=typeof Set&&b(new Set),t.isSet=function(e){return"undefined"!=typeof Set&&(b.working?b(e):e instanceof Set)},x.working="undefined"!=typeof WeakMap&&x(new WeakMap),t.isWeakMap=function(e){return"undefined"!=typeof WeakMap&&(x.working?x(e):e instanceof WeakMap)},v.working="undefined"!=typeof WeakSet&&v(new WeakSet),t.isWeakSet=function(e){return v(e)},w.working="undefined"!=typeof ArrayBuffer&&w(new ArrayBuffer),t.isArrayBuffer=I,k.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&k(new DataView(new ArrayBuffer(1),0,1)),t.isDataView=S;var C="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function E(e){return"[object SharedArrayBuffer]"===h(e)}function T(e){return void 0!==C&&(void 0===E.working&&(E.working=E(new C)),E.working?E(e):e instanceof C)}function $(e){return g(e,c)}function N(e){return g(e,d)}function A(e){return g(e,p)}function D(e){return l&&g(e,f)}function F(e){return u&&g(e,m)}t.isSharedArrayBuffer=T,t.isAsyncFunction=function(e){return"[object AsyncFunction]"===h(e)},t.isMapIterator=function(e){return"[object Map Iterator]"===h(e)},t.isSetIterator=function(e){return"[object Set Iterator]"===h(e)},t.isGeneratorObject=function(e){return"[object Generator]"===h(e)},t.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===h(e)},t.isNumberObject=$,t.isStringObject=N,t.isBooleanObject=A,t.isBigIntObject=D,t.isSymbolObject=F,t.isBoxedPrimitive=function(e){return $(e)||N(e)||A(e)||D(e)||F(e)},t.isAnyArrayBuffer=function(e){return"undefined"!=typeof Uint8Array&&(I(e)||T(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(e){Object.defineProperty(t,e,{enumerable:!1,value:function(){throw Error(e+" is not supported in userland")}})})},177:function(e,t,n){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},i=/%[sdj%]/g;t.format=function(e){if(!x(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(u(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,a=r.length,s=String(e).replace(i,function(e){if("%%"===e)return"%";if(n>=a)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return e}}),o=r[n];n<a;o=r[++n])y(o)||!I(o)?s+=" "+o:s+=" "+u(o);return s},t.deprecate=function(e,n){if(void 0!==a&&!0===a.noDeprecation)return e;if(void 0===a)return function(){return t.deprecate(e,n).apply(this,arguments)};var r=!1;return function(){if(!r){if(a.throwDeprecation)throw Error(n);a.traceDeprecation?console.trace(n):console.error(n),r=!0}return e.apply(this,arguments)}};var s={},o=/^$/;if(a.env.NODE_DEBUG){var l=a.env.NODE_DEBUG;o=RegExp("^"+(l=l.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase())+"$","i")}function u(e,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),g(n)?r.showHidden=n:n&&t._extend(r,n),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=h),d(r,e,r.depth)}function h(e,t){var n=u.styles[t];return n?"\x1b["+u.colors[n][0]+"m"+e+"\x1b["+u.colors[n][1]+"m":e}function c(e,t){return e}function d(e,n,r){if(e.customInspect&&n&&C(n.inspect)&&n.inspect!==t.inspect&&!(n.constructor&&n.constructor.prototype===n)){var a,i,s,o,l,u=n.inspect(r,e);return x(u)||(u=d(e,u,r)),u}var h=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(x(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return b(t)?e.stylize(""+t,"number"):g(t)?e.stylize(""+t,"boolean"):y(t)?e.stylize("null","null"):void 0}(e,n);if(h)return h;var c=Object.keys(n),I=(o={},c.forEach(function(e,t){o[e]=!0}),o);if(e.showHidden&&(c=Object.getOwnPropertyNames(n)),S(n)&&(c.indexOf("message")>=0||c.indexOf("description")>=0))return p(n);if(0===c.length){if(C(n)){var E=n.name?": "+n.name:"";return e.stylize("[Function"+E+"]","special")}if(w(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(k(n))return e.stylize(Date.prototype.toString.call(n),"date");if(S(n))return p(n)}var T="",$=!1,A=["{","}"];return(m(n)&&($=!0,A=["[","]"]),C(n)&&(T=" [Function"+(n.name?": "+n.name:"")+"]"),w(n)&&(T=" "+RegExp.prototype.toString.call(n)),k(n)&&(T=" "+Date.prototype.toUTCString.call(n)),S(n)&&(T=" "+p(n)),0!==c.length||$&&0!=n.length)?r<0?w(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),l=$?function(e,t,n,r,a){for(var i=[],s=0,o=t.length;s<o;++s)N(t,String(s))?i.push(f(e,t,n,r,String(s),!0)):i.push("");return a.forEach(function(a){a.match(/^\d+$/)||i.push(f(e,t,n,r,a,!0))}),i}(e,n,r,I,c):c.map(function(t){return f(e,n,r,I,t,$)}),e.seen.pop(),a=T,i=A,s=0,l.reduce(function(e,t){return s++,t.indexOf("\n")>=0&&s++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?i[0]+(""===a?"":a+"\n ")+" "+l.join(",\n  ")+" "+i[1]:i[0]+a+" "+l.join(", ")+" "+i[1]):A[0]+T+A[1]}function p(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,n,r,a,i){var s,o,l;if((l=Object.getOwnPropertyDescriptor(t,a)||{value:t[a]}).get?o=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(o=e.stylize("[Setter]","special")),N(r,a)||(s="["+a+"]"),!o&&(0>e.seen.indexOf(l.value)?(o=y(n)?d(e,l.value,null):d(e,l.value,n-1)).indexOf("\n")>-1&&(o=i?o.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+o.split("\n").map(function(e){return"   "+e}).join("\n")):o=e.stylize("[Circular]","special")),v(s)){if(i&&a.match(/^\d+$/))return o;(s=JSON.stringify(""+a)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+o}function m(e){return Array.isArray(e)}function g(e){return"boolean"==typeof e}function y(e){return null===e}function b(e){return"number"==typeof e}function x(e){return"string"==typeof e}function v(e){return void 0===e}function w(e){return I(e)&&"[object RegExp]"===E(e)}function I(e){return"object"==typeof e&&null!==e}function k(e){return I(e)&&"[object Date]"===E(e)}function S(e){return I(e)&&("[object Error]"===E(e)||e instanceof Error)}function C(e){return"function"==typeof e}function E(e){return Object.prototype.toString.call(e)}function T(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(!s[e=e.toUpperCase()]){if(o.test(e)){var n=a.pid;s[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else s[e]=function(){}}return s[e]},t.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.types=n(584),t.isArray=m,t.isBoolean=g,t.isNull=y,t.isNullOrUndefined=function(e){return null==e},t.isNumber=b,t.isString=x,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=v,t.isRegExp=w,t.types.isRegExp=w,t.isObject=I,t.isDate=k,t.types.isDate=k,t.isError=S,t.types.isNativeError=S,t.isFunction=C,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(369);var $=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function N(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){var e,n;console.log("%s - %s",(n=[T((e=new Date).getHours()),T(e.getMinutes()),T(e.getSeconds())].join(":"),[e.getDate(),$[e.getMonth()],n].join(" ")),t.format.apply(t,arguments))},t.inherits=n(782),t._extend=function(e,t){if(!t||!I(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var A="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function D(e,t){if(!e){var n=Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw TypeError('The "original" argument must be of type Function');if(A&&e[A]){var t=e[A];if("function"!=typeof t)throw TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,A,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise(function(e,r){t=e,n=r}),a=[],i=0;i<arguments.length;i++)a.push(arguments[i]);a.push(function(e,r){e?n(e):t(r)});try{e.apply(this,a)}catch(s){n(s)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),A&&Object.defineProperty(t,A,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=A,t.callbackify=function(e){if("function"!=typeof e)throw TypeError('The "original" argument must be of type Function');function t(){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n]);var r=t.pop();if("function"!=typeof r)throw TypeError("The last argument must be of type Function");var i=this,s=function(){return r.apply(i,arguments)};e.apply(this,t).then(function(e){a.nextTick(s.bind(null,null,e))},function(e){a.nextTick(D.bind(null,e,s))})}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,r(e)),t}},490:function(e,t,r){"use strict";var a=r(144),i=r(349),s=r(256),o=s("Object.prototype.toString"),l=r(942)()&&"symbol"==typeof Symbol.toStringTag,u=i(),h=s("String.prototype.slice"),c={},d=r(466),p=Object.getPrototypeOf;l&&d&&p&&a(u,function(e){if("function"==typeof n.g[e]){var t=new n.g[e];if(!(Symbol.toStringTag in t))throw EvalError("this engine has support for Symbol.toStringTag, but "+e+" does not have the property! Please report this.");var r=p(t),a=d(r,Symbol.toStringTag);a||(a=d(p(r),Symbol.toStringTag)),c[e]=a.get}});var f=function(e){var t=!1;return a(c,function(n,r){if(!t)try{var a=n.call(e);a===r&&(t=a)}catch(i){}}),t},m=r(994);e.exports=function(e){return!!m(e)&&(l?f(e):h(o(e),8,-1))}},349:function(e,t,r){"use strict";var a=r(992);e.exports=function(){return a(["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],function(e){return"function"==typeof n.g[e]})}},466:function(e,t,n){"use strict";var r=n(500)("%Object.getOwnPropertyDescriptor%",!0);if(r)try{r([],"length")}catch(a){r=null}e.exports=r}},i={};function s(e){var n=i[e];if(void 0!==n)return n.exports;var r=i[e]={exports:{}},a=!0;try{t[e](r,r.exports,s),a=!1}finally{a&&delete i[e]}return r.exports}s.ab="//";var o=s(177);e.exports=o}()},8357:function(e,t,n){"use strict";n.d(t,{w_:function(){return l}});var r=n(7294),a={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},i=r.createContext&&r.createContext(a),s=function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)0>t.indexOf(r[a])&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n};function l(e){return function(t){return r.createElement(u,s({attr:s({},e.attr)},t),function e(t){return t&&t.map(function(t,n){return r.createElement(t.tag,s({key:n},t.attr),e(t.child))})}(e.child))}}function u(e){var t=function(t){var n,a=e.attr,i=e.size,l=e.title,u=o(e,["attr","size","title"]),h=i||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),r.createElement("svg",s({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,a,u,{className:n,style:s(s({color:e.color||t.color},t.style),e.style),height:h,width:h,xmlns:"http://www.w3.org/2000/svg"}),l&&r.createElement("title",null,l),e.children)};return void 0!==i?r.createElement(i.Consumer,null,function(e){return t(e)}):t(a)}},6377:function(e,t,n){var r=n(4832),a=n(8652),i=n(801),s=n(2030),o=n(3618),l=n(9049),u=n(1971);u.alea=r,u.xor128=a,u.xorwow=i,u.xorshift7=s,u.xor4096=o,u.tychei=l,e.exports=u},4832:function(e,t,n){var r;!function(e,a,i){function s(e){var t,n=this,r=(t=4022871197,function(e){e=String(e);for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));t=r>>>0,r-=t,r*=t,t=r>>>0,r-=t,t+=4294967296*r}return(t>>>0)*23283064365386963e-26});n.next=function(){var e=2091639*n.s0+23283064365386963e-26*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function o(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function l(e,t){var n=new s(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+(2097152*a()|0)*11102230246251565e-32},a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=l:n.amdD&&n.amdO?void 0!==(r=(function(){return l}).call(t,n,t,a))&&(a.exports=r):this.alea=l}(0,e=n.nmd(e),n.amdD)},9049:function(e,t,n){var r;!function(e,a,i){function s(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function l(e,t){var n=new s(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152;while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=l:n.amdD&&n.amdO?void 0!==(r=(function(){return l}).call(t,n,t,a))&&(a.exports=r):this.tychei=l}(0,e=n.nmd(e),n.amdD)},8652:function(e,t,n){var r;!function(e,a,i){function s(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function l(e,t){var n=new s(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152;while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=l:n.amdD&&n.amdO?void 0!==(r=(function(){return l}).call(t,n,t,a))&&(a.exports=r):this.xor128=l}(0,e=n.nmd(e),n.amdD)},3618:function(e,t,n){var r;!function(e,a,i){function s(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,s,o=[],l=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,l=Math.max(l,t.length)),a=0,i=-32;i<l;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(s=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(s=s+1640531527|0,a=0==(n=o[127&i]^=r+s)?a+1:0);for(a>=128&&(o[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=o[a+34&127],n=o[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,o[a]=r^n;e.w=s,e.X=o,e.i=a}(t,e)}function o(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function l(e,t){null==e&&(e=+new Date);var n=new s(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152;while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=l:n.amdD&&n.amdO?void 0!==(r=(function(){return l}).call(t,n,t,a))&&(a.exports=r):this.xor4096=l}(0,e=n.nmd(e),n.amdD)},2030:function(e,t,n){var r;!function(e,a,i){function s(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],e^=e>>>7,n=e^e<<24,e=r[a+1&7],n^=e^e>>>10,e=r[a+3&7],n^=e^e>>>3,e=r[a+4&7],n^=e^e<<7,e=r[a+7&7],e^=e<<13,n^=e^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(n=0,t=""+t;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function o(e,t){return t.x=e.x.slice(),t.i=e.i,t}function l(e,t){null==e&&(e=+new Date);var n=new s(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152;while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=l:n.amdD&&n.amdO?void 0!==(r=(function(){return l}).call(t,n,t,a))&&(a.exports=r):this.xorshift7=l}(0,e=n.nmd(e),n.amdD)},801:function(e,t,n){var r;!function(e,a,i){function s(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^(e^e<<1))|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function l(e,t){var n=new s(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152;while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=l:n.amdD&&n.amdO?void 0!==(r=(function(){return l}).call(t,n,t,a))&&(a.exports=r):this.xorwow=l}(0,e=n.nmd(e),n.amdD)},1971:function(e,t,n){var r;!function(a,i,s){var o,l=s.pow(256,6),u=s.pow(2,52),h=2*u;function c(e,t,n){var r=[],c=f(function e(t,n){var r,a=[],i=typeof t;if(n&&"object"==i)for(r in t)try{a.push(e(t[r],n-1))}catch(s){}return a.length?a:"string"==i?t:t+"\0"}((t=!0==t?{entropy:!0}:t||{}).entropy?[e,m(i)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(256):(e=new Uint8Array(256),(a.crypto||a.msCrypto).getRandomValues(e)),m(e)}catch(r){var t=a.navigator,n=t&&t.plugins;return[+new Date,a,n,a.screen,m(i)]}}():e,3),r),g=new d(r),y=function(){for(var e=g.g(6),t=l,n=0;e<u;)e=(e+n)*256,t*=256,n=g.g(1);for(;e>=h;)e/=2,t/=2,n>>>=1;return(e+n)/t};return y.int32=function(){return 0|g.g(4)},y.quick=function(){return g.g(4)/4294967296},y.double=y,f(m(g.S),i),(t.pass||n||function(e,t,n,r){return(r&&(r.S&&p(r,g),e.state=function(){return p(g,{})}),n)?(s.random=e,t):e})(y,c,"global"in t?t.global:this==s,t.state)}function d(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,s=r.S=[];for(n||(e=[n++]);a<256;)s[a]=a++;for(a=0;a<256;a++)s[a]=s[i=255&i+e[a%n]+(t=s[a])],s[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,s=r.S;e--;)t=s[a=255&a+1],n=256*n+s[255&(s[a]=s[i=255&i+t])+(s[i]=t)];return r.i=a,r.j=i,n})(256)}function p(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function f(e,t){for(var n,r=e+"",a=0;a<r.length;)t[255&a]=255&(n^=19*t[255&a])+r.charCodeAt(a++);return m(t)}function m(e){return String.fromCharCode.apply(0,e)}if(f(s.random(),i),e.exports){e.exports=c;try{o=n(5042)}catch(g){}}else void 0!==(r=(function(){return c}).call(t,n,t,e))&&(e.exports=r)}("undefined"!=typeof self?self:this,[],Math)}}]);